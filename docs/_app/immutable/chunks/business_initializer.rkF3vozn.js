var iA=Object.defineProperty;var oA=(n,e,t)=>e in n?iA(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var h=(n,e,t)=>(oA(n,typeof e!="symbol"?e+"":e,t),t);import{d as aA,c as ue,g as yw,b as _w,$ as cA,_ as z0}from"./runtime.O5IRQp7y.js";import{w as Po}from"./index.pOZFntLU.js";import{af as Tn}from"./scheduler.rZl0nx9x.js";let zg=Po(null);function Xs(n){zg.set(n),setTimeout(()=>{zg.set(null)},2e3)}const G0={apiKey:"AIzaSyCSIQHCC23Z7ul639fD8JLMHu4yN77_0VA",authDomain:"managementsystemapp-c1fda.firebaseapp.com",databaseURL:"https://managementsystemapp-c1fda-default-rtdb.europe-west1.firebasedatabase.app",projectId:"managementsystemapp-c1fda",storageBucket:"managementsystemapp-c1fda.appspot.com",messagingSenderId:"670820779934",appId:"1:670820779934:web:fdcf77a952b59c3090788f",measurementId:"G-WP8J044JN9"};var Gg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vw={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L=function(n,e){if(!n)throw Ro(e)},Ro=function(n){return new Error("Firebase Database ("+vw.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ww=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let r=n.charCodeAt(s);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},uA=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const r=n[t++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=n[t++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=n[t++],o=n[t++],a=n[t++],c=((r&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[s++]=String.fromCharCode(55296+(c>>10)),e[s++]=String.fromCharCode(56320+(c&1023))}else{const i=n[t++],o=n[t++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},J0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<n.length;r+=3){const i=n[r],o=r+1<n.length,a=o?n[r+1]:0,c=r+2<n.length,u=c?n[r+2]:0,l=i>>2,d=(i&3)<<4|a>>4;let f=(a&15)<<2|u>>6,m=u&63;c||(m=64,o||(f=64)),s.push(t[l],t[d],t[f],t[m])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(ww(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):uA(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<n.length;){const i=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;const u=r<n.length?t[n.charAt(r)]:64;++r;const d=r<n.length?t[n.charAt(r)]:64;if(++r,i==null||a==null||u==null||d==null)throw new lA;const f=i<<2|a>>4;if(s.push(f),u!==64){const m=a<<4&240|u>>2;if(s.push(m),d!==64){const p=u<<6&192|d;s.push(p)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class lA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const xw=function(n){const e=ww(n);return J0.encodeByteArray(e,!0)},Fu=function(n){return xw(n).replace(/\./g,"")},Bu=function(n){try{return J0.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hA(n){return Ew(void 0,n)}function Ew(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!dA(t)||(n[t]=Ew(n[t],e[t]));return n}function dA(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fA(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mA=()=>fA().__FIREBASE_DEFAULTS__,pA=()=>{if(typeof process>"u"||typeof Gg>"u")return;const n=Gg.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},gA=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Bu(n[1]);return e&&JSON.parse(e)},Q0=()=>{try{return mA()||pA()||gA()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Tw=n=>{var e,t;return(t=(e=Q0())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Iw=n=>{const e=Tw(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},Dw=()=>{var n;return(n=Q0())===null||n===void 0?void 0:n.config},Aw=n=>{var e;return(e=Q0())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ic{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bw(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",r=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Fu(JSON.stringify(t)),Fu(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function K0(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Jt())}function yA(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Cw(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function _A(){const n=Jt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function kw(){return vw.NODE_ADMIN===!0}function vA(){try{return typeof indexedDB=="object"}catch{return!1}}function wA(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var i;e(((i=r.error)===null||i===void 0?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xA="FirebaseError";class zs extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=xA,Object.setPrototypeOf(this,zs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Dc.prototype.create)}}class Dc{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?EA(i,s):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new zs(r,a,s)}}function EA(n,e){return n.replace(TA,(t,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const TA=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ha(n){return JSON.parse(n)}function mt(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sw=function(n){let e={},t={},s={},r="";try{const i=n.split(".");e=Ha(Bu(i[0])||""),t=Ha(Bu(i[1])||""),r=i[2],s=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:s,signature:r}},IA=function(n){const e=Sw(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},DA=function(n){const e=Sw(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ls(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function oo(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Nf(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Lu(n,e,t){const s={};for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&(s[r]=e.call(t,n[r],r,n));return s}function Vu(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const r of t){if(!s.includes(r))return!1;const i=n[r],o=e[r];if(Jg(i)&&Jg(o)){if(!Vu(i,o))return!1}else if(i!==o)return!1}for(const r of s)if(!t.includes(r))return!1;return!0}function Jg(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fi(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AA{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const s=this.W_;if(typeof e=="string")for(let d=0;d<16;d++)s[d]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let d=0;d<16;d++)s[d]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let d=16;d<80;d++){const f=s[d-3]^s[d-8]^s[d-14]^s[d-16];s[d]=(f<<1|f>>>31)&4294967295}let r=this.chain_[0],i=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],u,l;for(let d=0;d<80;d++){d<40?d<20?(u=a^i&(o^a),l=1518500249):(u=i^o^a,l=1859775393):d<60?(u=i&o|a&(i|o),l=2400959708):(u=i^o^a,l=3395469782);const f=(r<<5|r>>>27)+u+c+l+s[d]&4294967295;c=a,a=o,o=(i<<30|i>>>2)&4294967295,i=r,r=f}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const s=t-this.blockSize;let r=0;const i=this.buf_;let o=this.inbuf_;for(;r<t;){if(o===0)for(;r<=s;)this.compress_(e,r),r+=this.blockSize;if(typeof e=="string"){for(;r<t;)if(i[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=t&255,t/=256;this.compress_(this.buf_);let s=0;for(let r=0;r<5;r++)for(let i=24;i>=0;i-=8)e[s]=this.chain_[r]>>i&255,++s;return e}}function bA(n,e){const t=new CA(n,e);return t.subscribe.bind(t)}class CA{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let r;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");kA(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:s},r.next===void 0&&(r.next=nd),r.error===void 0&&(r.error=nd),r.complete===void 0&&(r.complete=nd);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function kA(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function nd(){}function Ll(n,e){return`${n} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SA=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let r=n.charCodeAt(s);if(r>=55296&&r<=56319){const i=r-55296;s++,L(s<n.length,"Surrogate pair missing trail surrogate.");const o=n.charCodeAt(s)-56320;r=65536+(i<<10)+o}r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):r<65536?(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},Vl=function(n){let e=0;for(let t=0;t<n.length;t++){const s=n.charCodeAt(t);s<128?e++:s<2048?e+=2:s>=55296&&s<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Te(n){return n&&n._delegate?n._delegate:n}class yr{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PA{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new Ic;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(NA(e))try{this.getOrInitializeService({instanceIdentifier:Mr})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=Mr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Mr){return this.instances.has(e)}getOptions(e=Mr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);s===a&&o.resolve(r)}return r}onInit(e,t){var s;const r=this.normalizeInstanceIdentifier(t),i=(s=this.onInitCallbacks.get(r))!==null&&s!==void 0?s:new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const r of s)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:RA(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Mr){return this.component?this.component.multipleInstances?e:Mr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function RA(n){return n===Mr?void 0:n}function NA(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MA{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new PA(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pe;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(pe||(pe={}));const OA={debug:pe.DEBUG,verbose:pe.VERBOSE,info:pe.INFO,warn:pe.WARN,error:pe.ERROR,silent:pe.SILENT},FA=pe.INFO,BA={[pe.DEBUG]:"log",[pe.VERBOSE]:"log",[pe.INFO]:"info",[pe.WARN]:"warn",[pe.ERROR]:"error"},LA=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),r=BA[e];if(r)console[r](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let Ul=class{constructor(e){this.name=e,this._logLevel=FA,this._logHandler=LA,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in pe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?OA[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,pe.DEBUG,...e),this._logHandler(this,pe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,pe.VERBOSE,...e),this._logHandler(this,pe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,pe.INFO,...e),this._logHandler(this,pe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,pe.WARN,...e),this._logHandler(this,pe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,pe.ERROR,...e),this._logHandler(this,pe.ERROR,...e)}};const VA=(n,e)=>e.some(t=>n instanceof t);let Qg,Kg;function UA(){return Qg||(Qg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function WA(){return Kg||(Kg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Pw=new WeakMap,Mf=new WeakMap,Rw=new WeakMap,sd=new WeakMap,j0=new WeakMap;function HA(n){const e=new Promise((t,s)=>{const r=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(ur(n.result)),r()},o=()=>{s(n.error),r()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Pw.set(t,n)}).catch(()=>{}),j0.set(e,n),e}function $A(n){if(Mf.has(n))return;const e=new Promise((t,s)=>{const r=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{s(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});Mf.set(n,e)}let Of={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Mf.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Rw.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ur(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function qA(n){Of=n(Of)}function YA(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(rd(this),e,...t);return Rw.set(s,e.sort?e.sort():[e]),ur(s)}:WA().includes(n)?function(...e){return n.apply(rd(this),e),ur(Pw.get(this))}:function(...e){return ur(n.apply(rd(this),e))}}function zA(n){return typeof n=="function"?YA(n):(n instanceof IDBTransaction&&$A(n),VA(n,UA())?new Proxy(n,Of):n)}function ur(n){if(n instanceof IDBRequest)return HA(n);if(sd.has(n))return sd.get(n);const e=zA(n);return e!==n&&(sd.set(n,e),j0.set(e,n)),e}const rd=n=>j0.get(n);function GA(n,e,{blocked:t,upgrade:s,blocking:r,terminated:i}={}){const o=indexedDB.open(n,e),a=ur(o);return s&&o.addEventListener("upgradeneeded",c=>{s(ur(o.result),c.oldVersion,c.newVersion,ur(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{i&&c.addEventListener("close",()=>i()),r&&c.addEventListener("versionchange",u=>r(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const JA=["get","getKey","getAll","getAllKeys","count"],QA=["put","add","delete","clear"],id=new Map;function jg(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(id.get(e))return id.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,r=QA.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(r||JA.includes(t)))return;const i=async function(o,...a){const c=this.transaction(o,r?"readwrite":"readonly");let u=c.store;return s&&(u=u.index(a.shift())),(await Promise.all([u[t](...a),r&&c.done]))[0]};return id.set(e,i),i}qA(n=>({...n,get:(e,t,s)=>jg(e,t)||n.get(e,t,s),has:(e,t)=>!!jg(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KA{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(jA(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function jA(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ff="@firebase/app",Xg="0.9.25";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ti=new Ul("@firebase/app"),XA="@firebase/app-compat",ZA="@firebase/analytics-compat",eb="@firebase/analytics",tb="@firebase/app-check-compat",nb="@firebase/app-check",sb="@firebase/auth",rb="@firebase/auth-compat",ib="@firebase/database",ob="@firebase/database-compat",ab="@firebase/functions",cb="@firebase/functions-compat",ub="@firebase/installations",lb="@firebase/installations-compat",hb="@firebase/messaging",db="@firebase/messaging-compat",fb="@firebase/performance",mb="@firebase/performance-compat",pb="@firebase/remote-config",gb="@firebase/remote-config-compat",yb="@firebase/storage",_b="@firebase/storage-compat",vb="@firebase/firestore",wb="@firebase/firestore-compat",xb="firebase",Eb="10.7.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bf="[DEFAULT]",Tb={[Ff]:"fire-core",[XA]:"fire-core-compat",[eb]:"fire-analytics",[ZA]:"fire-analytics-compat",[nb]:"fire-app-check",[tb]:"fire-app-check-compat",[sb]:"fire-auth",[rb]:"fire-auth-compat",[ib]:"fire-rtdb",[ob]:"fire-rtdb-compat",[ab]:"fire-fn",[cb]:"fire-fn-compat",[ub]:"fire-iid",[lb]:"fire-iid-compat",[hb]:"fire-fcm",[db]:"fire-fcm-compat",[fb]:"fire-perf",[mb]:"fire-perf-compat",[pb]:"fire-rc",[gb]:"fire-rc-compat",[yb]:"fire-gcs",[_b]:"fire-gcs-compat",[vb]:"fire-fst",[wb]:"fire-fst-compat","fire-js":"fire-js",[xb]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $a=new Map,Lf=new Map;function Ib(n,e){try{n.container.addComponent(e)}catch(t){ti.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ni(n){const e=n.name;if(Lf.has(e))return ti.debug(`There were multiple attempts to register component ${e}.`),!1;Lf.set(e,n);for(const t of $a.values())Ib(t,n);return!0}function Wl(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Db={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},lr=new Dc("app","Firebase",Db);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ab{constructor(e,t,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new yr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw lr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mi=Eb;function Hl(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s=Object.assign({name:Bf,automaticDataCollectionEnabled:!1},e),r=s.name;if(typeof r!="string"||!r)throw lr.create("bad-app-name",{appName:String(r)});if(t||(t=Dw()),!t)throw lr.create("no-options");const i=$a.get(r);if(i){if(Vu(t,i.options)&&Vu(s,i.config))return i;throw lr.create("duplicate-app",{appName:r})}const o=new MA(r);for(const c of Lf.values())o.addComponent(c);const a=new Ab(t,s,o);return $a.set(r,a),a}function No(n=Bf){const e=$a.get(n);if(!e&&n===Bf&&Dw())return Hl();if(!e)throw lr.create("no-app",{appName:n});return e}function X0(){return Array.from($a.values())}function ts(n,e,t){var s;let r=(s=Tb[n])!==null&&s!==void 0?s:n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ti.warn(a.join(" "));return}ni(new yr(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bb="firebase-heartbeat-database",Cb=1,qa="firebase-heartbeat-store";let od=null;function Nw(){return od||(od=GA(bb,Cb,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(qa)}}}).catch(n=>{throw lr.create("idb-open",{originalErrorMessage:n.message})})),od}async function kb(n){try{return await(await Nw()).transaction(qa).objectStore(qa).get(Mw(n))}catch(e){if(e instanceof zs)ti.warn(e.message);else{const t=lr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ti.warn(t.message)}}}async function Zg(n,e){try{const s=(await Nw()).transaction(qa,"readwrite");await s.objectStore(qa).put(e,Mw(n)),await s.done}catch(t){if(t instanceof zs)ti.warn(t.message);else{const s=lr.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ti.warn(s.message)}}}function Mw(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sb=1024,Pb=30*24*60*60*1e3;class Rb{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Mb(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,t;const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=ey();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=Pb}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=ey(),{heartbeatsToSend:s,unsentEntries:r}=Nb(this._heartbeatsCache.heartbeats),i=Fu(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function ey(){return new Date().toISOString().substring(0,10)}function Nb(n,e=Sb){const t=[];let s=n.slice();for(const r of n){const i=t.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),ty(t)>e){i.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),ty(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class Mb{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return vA()?wA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await kb(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return Zg(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return Zg(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function ty(n){return Fu(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ob(n){ni(new yr("platform-logger",e=>new KA(e),"PRIVATE")),ni(new yr("heartbeat",e=>new Rb(e),"PRIVATE")),ts(Ff,Xg,n),ts(Ff,Xg,"esm2017"),ts("fire-js","")}Ob("");var Fb="firebase",Bb="10.7.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ts(Fb,Bb,"app");const Vf={reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29],black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39],bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]};function Uf(n,e,t,s=!1){const r=String(e),i=(c,u)=>`\x1B[${u[0]}m${c}\x1B[${u[1]}m`,o=(c,u)=>u!=null&&typeof u=="string"?i(c,Vf[u]):u!=null&&Array.isArray(u)?u.reduce((l,d)=>o(l,d),c):u!=null&&u[c.trim()]!=null?o(c,u[c.trim()]):u!=null&&u["*"]!=null?o(c,u["*"]):c,a=null;return r.replace(/{{(.+?)}}/g,(c,u)=>{var d;const l=t[u]!=null?String(t[u]):s?"":c;return n.stylePrettyLogs?o(l,((d=n==null?void 0:n.prettyLogStyles)==null?void 0:d[u])??a)+i("",Vf.reset):l})}function En(n,e=2,t=0){return n!=null&&isNaN(n)?"":(n=n!=null?n+t:n,e===2?n==null?"--":n<10?"0"+n:n.toString():n==null?"---":n<10?"00"+n:n<100?"0"+n:n.toString())}function Lb(n){return{href:n.href,protocol:n.protocol,username:n.username,password:n.password,host:n.host,hostname:n.hostname,port:n.port,pathname:n.pathname,search:n.search,searchParams:[...n.searchParams].map(([e,t])=>({key:e,value:t})),hash:n.hash,origin:n.origin}}function Ow(n){const e=new Set;return JSON.stringify(n,(t,s)=>{if(typeof s=="object"&&s!==null){if(e.has(s))return"[Circular]";e.add(s)}return s})}function Ut(n,e){const t={seen:[],stylize:Fw};return e!=null&&Uw(t,e),Bi(t.showHidden)&&(t.showHidden=!1),Bi(t.depth)&&(t.depth=2),Bi(t.colors)&&(t.colors=!0),Bi(t.customInspect)&&(t.customInspect=!0),t.colors&&(t.stylize=Ub),Uu(t,n,t.depth)}Ut.colors=Vf;Ut.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function Vb(n){return typeof n=="boolean"}function Bi(n){return n===void 0}function Fw(n){return n}function Ub(n,e){var s,r,i,o;const t=Ut.styles[e];return t!=null&&((r=(s=Ut==null?void 0:Ut.colors)==null?void 0:s[t])==null?void 0:r[0])!=null&&((o=(i=Ut==null?void 0:Ut.colors)==null?void 0:i[t])==null?void 0:o[1])!=null?"\x1B["+Ut.colors[t][0]+"m"+n+"\x1B["+Ut.colors[t][1]+"m":n}function cu(n){return typeof n=="function"}function Bw(n){return typeof n=="string"}function Wb(n){return typeof n=="number"}function Lw(n){return n===null}function Vw(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function ad(n){return $l(n)&&Z0(n)==="[object RegExp]"}function $l(n){return typeof n=="object"&&n!==null}function cd(n){return $l(n)&&(Z0(n)==="[object Error]"||n instanceof Error)}function ny(n){return $l(n)&&Z0(n)==="[object Date]"}function Z0(n){return Object.prototype.toString.call(n)}function Hb(n){const e={};return n.forEach(t=>{e[t]=!0}),e}function $b(n,e,t,s,r){const i=[];for(let o=0,a=e.length;o<a;++o)Vw(e,String(o))?i.push(Wf(n,e,t,s,String(o),!0)):i.push("");return r.forEach(o=>{o.match(/^\d+$/)||i.push(Wf(n,e,t,s,o,!0))}),i}function ud(n){return"["+Error.prototype.toString.call(n)+"]"}function Uu(n,e,t=0){if(n.customInspect&&e!=null&&cu(e)&&(e==null?void 0:e.inspect)!==Ut&&!(e!=null&&e.constructor&&(e==null?void 0:e.constructor.prototype)===e)){if(typeof e.inspect!="function"&&e.toString!=null)return e.toString();let l=e==null?void 0:e.inspect(t,n);return Bw(l)||(l=Uu(n,l,t)),l}const s=tr(n,e);if(s)return s;let r=Object.keys(e);const i=Hb(r);try{n.showHidden&&Object.getOwnPropertyNames&&(r=Object.getOwnPropertyNames(e))}catch{}if(cd(e)&&(r.indexOf("message")>=0||r.indexOf("description")>=0))return ud(e);if(r.length===0)if(cu(n.stylize)){if(cu(e)){const l=e.name?": "+e.name:"";return n.stylize("[Function"+l+"]","special")}if(ad(e))return n.stylize(RegExp.prototype.toString.call(e),"regexp");if(ny(e))return n.stylize(Date.prototype.toISOString.call(e),"date");if(cd(e))return ud(e)}else return e;let o="",a=!1,c=[`{
`,`
}`];if(Array.isArray(e)&&(a=!0,c=[`[
`,`
]`]),cu(e)&&(o=" [Function"+(e.name?": "+e.name:"")+"]"),ad(e)&&(o=" "+RegExp.prototype.toString.call(e)),ny(e)&&(o=" "+Date.prototype.toUTCString.call(e)),cd(e)&&(o=" "+ud(e)),r.length===0&&(!a||e.length==0))return c[0]+o+c[1];if(t<0)return ad(e)?n.stylize(RegExp.prototype.toString.call(e),"regexp"):n.stylize("[Object]","special");n.seen.push(e);let u;return a?u=$b(n,e,t,i,r):u=r.map(l=>Wf(n,e,t,i,l,a)),n.seen.pop(),qb(u,o,c)}function Wf(n,e,t,s,r,i){let o,a,c={value:void 0};try{c.value=e[r]}catch{}try{Object.getOwnPropertyDescriptor&&(c=Object.getOwnPropertyDescriptor(e,r)||c)}catch{}if(c.get?c.set?a=n.stylize("[Getter/Setter]","special"):a=n.stylize("[Getter]","special"):c.set&&(a=n.stylize("[Setter]","special")),Vw(s,r)||(o="["+r+"]"),a||(n.seen.indexOf(c.value)<0?(Lw(t)?a=Uu(n,c.value,void 0):a=Uu(n,c.value,t-1),a.indexOf(`
`)>-1&&(i?a=a.split(`
`).map(u=>"  "+u).join(`
`).substr(2):a=`
`+a.split(`
`).map(u=>"   "+u).join(`
`))):a=n.stylize("[Circular]","special")),Bi(o)){if(i&&r.match(/^\d+$/))return a;o=JSON.stringify(""+r),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=n.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,"\\'").replace(/(^"|"$)/g,"'"),o=n.stylize(o,"string"))}return o+": "+a}function tr(n,e){if(Bi(e))return n.stylize("undefined","undefined");if(Bw(e)){const t="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,"\\'")+"'";return n.stylize(t,"string")}if(Wb(e))return n.stylize(""+e,"number");if(Vb(e))return n.stylize(""+e,"boolean");if(Lw(e))return n.stylize("null","null")}function qb(n,e,t){return t[0]+(e===""?"":e+`
`)+"  "+n.join(`,
  `)+" "+t[1]}function Uw(n,e){if(!e||!$l(e))return n;const t={...n},s={...e},r=Object.keys(e);let i=r.length;for(;i--;)t[r[i]]=s[r[i]];return n}function Yb(n,...e){const t={seen:[],stylize:Fw};n!=null&&Uw(t,n);const s=e[0];let r=0,i="",o="";if(typeof s=="string"){if(e.length===1)return s;let a,c=0;for(let u=0;u<s.length-1;u++)if(s.charCodeAt(u)===37){const l=s.charCodeAt(++u);if(r+1!==e.length){switch(l){case 115:{const d=e[++r];typeof d=="number"||typeof d=="bigint"?a=tr(t,d):typeof d!="object"||d===null?a=String(d):a=Ut(d,{...n,compact:3,colors:!1,depth:0});break}case 106:a=Ow(e[++r]);break;case 100:{const d=e[++r];typeof d=="bigint"?a=tr(t,d):typeof d=="symbol"?a="NaN":a=tr(t,d);break}case 79:a=Ut(e[++r],n);break;case 111:a=Ut(e[++r],{...n,showHidden:!0,showProxy:!0,depth:4});break;case 105:{const d=e[++r];typeof d=="bigint"?a=tr(t,d):typeof d=="symbol"?a="NaN":a=tr(t,parseInt(a));break}case 102:{const d=e[++r];typeof d=="symbol"?a="NaN":a=tr(t,parseInt(d));break}case 99:r+=1,a="";break;case 37:i+=s.slice(c,u),c=u+1;continue;default:continue}c!==u-1&&(i+=s.slice(c,u-1)),i+=a,c=u+1}else l===37&&(i+=s.slice(c,u),c=u+1)}c!==0&&(r++,o=" ",c<s.length&&(i+=s.slice(c)))}for(;r<e.length;){const a=e[r];i+=o,i+=typeof a!="string"?Ut(a,n):a,o=" ",r++}return i}const zb={getCallerStackFrame:Ww,getErrorTrace:Hw,getMeta:Qb,transportJSON:Xb,transportFormatted:jb,isBuffer:Zb,isError:qw,prettyFormatLogObj:Kb,prettyFormatErrorObj:Yw};var gw;const Gb={runtime:[typeof window,typeof document].includes("undefined")?"Generic":"Browser",browser:(gw=globalThis==null?void 0:globalThis.navigator)==null?void 0:gw.userAgent},Jb=/(?:(?:file|https?|global code|[^@]+)@)?(?:file:)?((?:\/[^:/]+){2,})(?::(\d+))?(?::(\d+))?/;function Qb(n,e,t,s,r,i){return Object.assign({},Gb,{name:r,parentNames:i,date:new Date,logLevelId:n,logLevelName:e,path:s?void 0:Ww(t)})}function Ww(n,e=Error()){var t,s,r;return $w((r=(s=(t=e==null?void 0:e.stack)==null?void 0:t.split(`
`))==null?void 0:s.filter(i=>!i.includes("Error: ")))==null?void 0:r[n])}function Hw(n){var e,t,s;return(s=(t=(e=n==null?void 0:n.stack)==null?void 0:e.split(`
`))==null?void 0:t.filter(r=>!r.includes("Error: ")))==null?void 0:s.reduce((r,i)=>(r.push($w(i)),r),[])}function $w(n){var s;const e=(s=globalThis==null?void 0:globalThis.location)==null?void 0:s.origin,t={fullFilePath:void 0,fileName:void 0,fileNameWithLine:void 0,fileColumn:void 0,fileLine:void 0,filePath:void 0,filePathWithLine:void 0,method:void 0};if(n!=null){const r=n.match(Jb);if(r){t.filePath=r[1].replace(/\?.*$/,""),t.fullFilePath=`${e}${t.filePath}`;const i=t.filePath.split("/");t.fileName=i[i.length-1],t.fileLine=r[2],t.fileColumn=r[3],t.filePathWithLine=`${t.filePath}:${t.fileLine}`,t.fileNameWithLine=`${t.fileName}:${t.fileLine}`}}return t}function qw(n){return n instanceof Error}function Kb(n,e){return n.reduce((t,s)=>(qw(s)?t.errors.push(Yw(s,e)):t.args.push(s),t),{args:[],errors:[]})}function Yw(n,e){const t=Hw(n).map(r=>Uf(e,e.prettyErrorStackTemplate,{...r},!0)),s={errorName:` ${n.name} `,errorMessage:Object.getOwnPropertyNames(n).reduce((r,i)=>(i!=="stack"&&r.push(n[i]),r),[]).join(", "),errorStack:t.join(`
`)};return Uf(e,e.prettyErrorTemplate,s)}function jb(n,e,t,s){const r=(t.length>0&&e.length>0?`
`:"")+t.join(`
`);s.prettyInspectOptions.colors=s.stylePrettyLogs,console.log(n+Yb(s.prettyInspectOptions,...e)+r)}function Xb(n){console.log(Ow(n))}function Zb(n){return!1}class eC{constructor(e,t,s=4){var r,i,o,a,c,u,l,d;this.logObj=t,this.stackDepthLevel=s,this.runtime=zb,this.settings={type:(e==null?void 0:e.type)??"pretty",name:e==null?void 0:e.name,parentNames:e==null?void 0:e.parentNames,minLevel:(e==null?void 0:e.minLevel)??0,argumentsArrayName:e==null?void 0:e.argumentsArrayName,hideLogPositionForProduction:(e==null?void 0:e.hideLogPositionForProduction)??!1,prettyLogTemplate:(e==null?void 0:e.prettyLogTemplate)??"{{yyyy}}.{{mm}}.{{dd}} {{hh}}:{{MM}}:{{ss}}:{{ms}}	{{logLevelName}}	{{filePathWithLine}}{{nameWithDelimiterPrefix}}	",prettyErrorTemplate:(e==null?void 0:e.prettyErrorTemplate)??`
{{errorName}} {{errorMessage}}
error stack:
{{errorStack}}`,prettyErrorStackTemplate:(e==null?void 0:e.prettyErrorStackTemplate)??`   {{fileName}}	{{method}}
	{{filePathWithLine}}`,prettyErrorParentNamesSeparator:(e==null?void 0:e.prettyErrorParentNamesSeparator)??":",prettyErrorLoggerNameDelimiter:(e==null?void 0:e.prettyErrorLoggerNameDelimiter)??"	",stylePrettyLogs:(e==null?void 0:e.stylePrettyLogs)??!0,prettyLogTimeZone:(e==null?void 0:e.prettyLogTimeZone)??"UTC",prettyLogStyles:(e==null?void 0:e.prettyLogStyles)??{logLevelName:{"*":["bold","black","bgWhiteBright","dim"],SILLY:["bold","white"],TRACE:["bold","whiteBright"],DEBUG:["bold","green"],INFO:["bold","blue"],WARN:["bold","yellow"],ERROR:["bold","red"],FATAL:["bold","redBright"]},dateIsoStr:"white",filePathWithLine:"white",name:["white","bold"],nameWithDelimiterPrefix:["white","bold"],nameWithDelimiterSuffix:["white","bold"],errorName:["bold","bgRedBright","whiteBright"],fileName:["yellow"],fileNameWithLine:"white"},prettyInspectOptions:(e==null?void 0:e.prettyInspectOptions)??{colors:!0,compact:!1,depth:1/0},metaProperty:(e==null?void 0:e.metaProperty)??"_meta",maskPlaceholder:(e==null?void 0:e.maskPlaceholder)??"[***]",maskValuesOfKeys:(e==null?void 0:e.maskValuesOfKeys)??["password"],maskValuesOfKeysCaseInsensitive:(e==null?void 0:e.maskValuesOfKeysCaseInsensitive)??!1,maskValuesRegEx:e==null?void 0:e.maskValuesRegEx,prefix:[...(e==null?void 0:e.prefix)??[]],attachedTransports:[...(e==null?void 0:e.attachedTransports)??[]],overwrite:{mask:(r=e==null?void 0:e.overwrite)==null?void 0:r.mask,toLogObj:(i=e==null?void 0:e.overwrite)==null?void 0:i.toLogObj,addMeta:(o=e==null?void 0:e.overwrite)==null?void 0:o.addMeta,addPlaceholders:(a=e==null?void 0:e.overwrite)==null?void 0:a.addPlaceholders,formatMeta:(c=e==null?void 0:e.overwrite)==null?void 0:c.formatMeta,formatLogObj:(u=e==null?void 0:e.overwrite)==null?void 0:u.formatLogObj,transportFormatted:(l=e==null?void 0:e.overwrite)==null?void 0:l.transportFormatted,transportJSON:(d=e==null?void 0:e.overwrite)==null?void 0:d.transportJSON}}}log(e,t,...s){var d,f,m,p,y,g,x,_,v,w,I,D,E,A;if(e<this.settings.minLevel)return;const r=[...this.settings.prefix,...s],i=((d=this.settings.overwrite)==null?void 0:d.mask)!=null?(f=this.settings.overwrite)==null?void 0:f.mask(r):this.settings.maskValuesOfKeys!=null&&this.settings.maskValuesOfKeys.length>0?this._mask(r):r,o=this.logObj!=null?this._recursiveCloneAndExecuteFunctions(this.logObj):void 0,a=((m=this.settings.overwrite)==null?void 0:m.toLogObj)!=null?(p=this.settings.overwrite)==null?void 0:p.toLogObj(i,o):this._toLogObj(i,o),c=((y=this.settings.overwrite)==null?void 0:y.addMeta)!=null?(g=this.settings.overwrite)==null?void 0:g.addMeta(a,e,t):this._addMetaToLogObj(a,e,t);let u,l;return((x=this.settings.overwrite)==null?void 0:x.formatMeta)!=null&&(u=(_=this.settings.overwrite)==null?void 0:_.formatMeta(c==null?void 0:c[this.settings.metaProperty])),((v=this.settings.overwrite)==null?void 0:v.formatLogObj)!=null&&(l=(w=this.settings.overwrite)==null?void 0:w.formatLogObj(i,this.settings)),this.settings.type==="pretty"&&(u=u??this._prettyFormatLogObjMeta(c==null?void 0:c[this.settings.metaProperty]),l=l??this.runtime.prettyFormatLogObj(i,this.settings)),u!=null&&l!=null?((I=this.settings.overwrite)==null?void 0:I.transportFormatted)!=null?(D=this.settings.overwrite)==null||D.transportFormatted(u,l.args,l.errors,this.settings):this.runtime.transportFormatted(u,l.args,l.errors,this.settings):((E=this.settings.overwrite)==null?void 0:E.transportJSON)!=null?(A=this.settings.overwrite)==null||A.transportJSON(c):this.settings.type!=="hidden"&&this.runtime.transportJSON(c),this.settings.attachedTransports!=null&&this.settings.attachedTransports.length>0&&this.settings.attachedTransports.forEach(C=>{C(c)}),c}attachTransport(e){this.settings.attachedTransports.push(e)}getSubLogger(e,t){var i,o,a;const s={...this.settings,...e,parentNames:((i=this.settings)==null?void 0:i.parentNames)!=null&&((o=this.settings)==null?void 0:o.name)!=null?[...this.settings.parentNames,this.settings.name]:((a=this.settings)==null?void 0:a.name)!=null?[this.settings.name]:void 0,prefix:[...this.settings.prefix,...(e==null?void 0:e.prefix)??[]]};return new this.constructor(s,t??this.logObj,this.stackDepthLevel)}_mask(e){const t=this.settings.maskValuesOfKeysCaseInsensitive!==!0?this.settings.maskValuesOfKeys:this.settings.maskValuesOfKeys.map(s=>s.toLowerCase());return e==null?void 0:e.map(s=>this._recursiveCloneAndMaskValuesOfKeys(s,t))}_recursiveCloneAndMaskValuesOfKeys(e,t,s=[]){var r,i;if(s.includes(e))return{...e};if(typeof e=="object"&&e!==null&&s.push(e),this.runtime.isError(e)||this.runtime.isBuffer(e))return e;if(e instanceof Map)return new Map(e);if(e instanceof Set)return new Set(e);if(Array.isArray(e))return e.map(o=>this._recursiveCloneAndMaskValuesOfKeys(o,t,s));if(e instanceof Date)return new Date(e.getTime());if(e instanceof URL)return Lb(e);if(e!==null&&typeof e=="object"){const o=this.runtime.isError(e)?this._cloneError(e):Object.create(Object.getPrototypeOf(e));return Object.getOwnPropertyNames(e).reduce((a,c)=>{var u;return a[c]=t.includes(((u=this.settings)==null?void 0:u.maskValuesOfKeysCaseInsensitive)!==!0?c:c.toLowerCase())?this.settings.maskPlaceholder:this._recursiveCloneAndMaskValuesOfKeys(e[c],t,s),a},o)}else{if(typeof e=="string"){let o=e;for(const a of((r=this.settings)==null?void 0:r.maskValuesRegEx)||[])o=o.replace(a,((i=this.settings)==null?void 0:i.maskPlaceholder)||"");return o}return e}}_recursiveCloneAndExecuteFunctions(e,t=[]){return this.isObjectOrArray(e)&&t.includes(e)?this.shallowCopy(e):(this.isObjectOrArray(e)&&t.push(e),Array.isArray(e)?e.map(s=>this._recursiveCloneAndExecuteFunctions(s,t)):e instanceof Date?new Date(e.getTime()):this.isObject(e)?Object.getOwnPropertyNames(e).reduce((s,r)=>{const i=Object.getOwnPropertyDescriptor(e,r);if(i){Object.defineProperty(s,r,i);const o=e[r];s[r]=typeof o=="function"?o():this._recursiveCloneAndExecuteFunctions(o,t)}return s},Object.create(Object.getPrototypeOf(e))):e)}isObjectOrArray(e){return typeof e=="object"&&e!==null}isObject(e){return typeof e=="object"&&!Array.isArray(e)&&e!==null}shallowCopy(e){return Array.isArray(e)?[...e]:{...e}}_toLogObj(e,t={}){return e=e==null?void 0:e.map(s=>this.runtime.isError(s)?this._toErrorObject(s):s),this.settings.argumentsArrayName==null?e.length===1&&!Array.isArray(e[0])&&this.runtime.isBuffer(e[0])!==!0&&!(e[0]instanceof Date)?t=typeof e[0]=="object"&&e[0]!=null?{...e[0],...t}:{0:e[0],...t}:t={...t,...e}:t={...t,[this.settings.argumentsArrayName]:e},t}_cloneError(e){const t=new e.constructor;return Object.getOwnPropertyNames(e).forEach(s=>{t[s]=e[s]}),t}_toErrorObject(e){return{nativeError:e,name:e.name??"Error",message:e.message,stack:this.runtime.getErrorTrace(e)}}_addMetaToLogObj(e,t,s){return{...e,[this.settings.metaProperty]:this.runtime.getMeta(t,s,this.stackDepthLevel,this.settings.hideLogPositionForProduction,this.settings.name,this.settings.parentNames)}}_prettyFormatLogObjMeta(e){var o,a,c,u,l,d,f,m,p,y,g,x,_,v,w,I,D,E,A,C,T,b;if(e==null)return"";let t=this.settings.prettyLogTemplate;const s={};t.includes("{{yyyy}}.{{mm}}.{{dd}} {{hh}}:{{MM}}:{{ss}}:{{ms}}")?t=t.replace("{{yyyy}}.{{mm}}.{{dd}} {{hh}}:{{MM}}:{{ss}}:{{ms}}","{{dateIsoStr}}"):this.settings.prettyLogTimeZone==="UTC"?(s.yyyy=((o=e==null?void 0:e.date)==null?void 0:o.getUTCFullYear())??"----",s.mm=En((a=e==null?void 0:e.date)==null?void 0:a.getUTCMonth(),2,1),s.dd=En((c=e==null?void 0:e.date)==null?void 0:c.getUTCDate(),2),s.hh=En((u=e==null?void 0:e.date)==null?void 0:u.getUTCHours(),2),s.MM=En((l=e==null?void 0:e.date)==null?void 0:l.getUTCMinutes(),2),s.ss=En((d=e==null?void 0:e.date)==null?void 0:d.getUTCSeconds(),2),s.ms=En((f=e==null?void 0:e.date)==null?void 0:f.getUTCMilliseconds(),3)):(s.yyyy=((m=e==null?void 0:e.date)==null?void 0:m.getFullYear())??"----",s.mm=En((p=e==null?void 0:e.date)==null?void 0:p.getMonth(),2,1),s.dd=En((y=e==null?void 0:e.date)==null?void 0:y.getDate(),2),s.hh=En((g=e==null?void 0:e.date)==null?void 0:g.getHours(),2),s.MM=En((x=e==null?void 0:e.date)==null?void 0:x.getMinutes(),2),s.ss=En((_=e==null?void 0:e.date)==null?void 0:_.getSeconds(),2),s.ms=En((v=e==null?void 0:e.date)==null?void 0:v.getMilliseconds(),3));const r=this.settings.prettyLogTimeZone==="UTC"?e==null?void 0:e.date:new Date(((w=e==null?void 0:e.date)==null?void 0:w.getTime())-((I=e==null?void 0:e.date)==null?void 0:I.getTimezoneOffset())*6e4);s.rawIsoStr=r==null?void 0:r.toISOString(),s.dateIsoStr=r==null?void 0:r.toISOString().replace("T"," ").replace("Z",""),s.logLevelName=e==null?void 0:e.logLevelName,s.fileNameWithLine=((D=e==null?void 0:e.path)==null?void 0:D.fileNameWithLine)??"",s.filePathWithLine=((E=e==null?void 0:e.path)==null?void 0:E.filePathWithLine)??"",s.fullFilePath=((A=e==null?void 0:e.path)==null?void 0:A.fullFilePath)??"";let i=(C=this.settings.parentNames)==null?void 0:C.join(this.settings.prettyErrorParentNamesSeparator);return i=i!=null&&(e==null?void 0:e.name)!=null?i+this.settings.prettyErrorParentNamesSeparator:void 0,s.name=(e==null?void 0:e.name)!=null||i!=null?(i??"")+(e==null?void 0:e.name):"",s.nameWithDelimiterPrefix=s.name.length>0?this.settings.prettyErrorLoggerNameDelimiter+s.name:"",s.nameWithDelimiterSuffix=s.name.length>0?s.name+this.settings.prettyErrorLoggerNameDelimiter:"",((T=this.settings.overwrite)==null?void 0:T.addPlaceholders)!=null&&((b=this.settings.overwrite)==null||b.addPlaceholders(e,s)),Uf(this.settings,t,s)}}class tC extends eC{constructor(e,t){const s=typeof window<"u"&&typeof document<"u",r=s?window.chrome!==void 0&&window.CSS!==void 0&&window.CSS.supports("color","green"):!1,i=s?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1;e=e||{},e.stylePrettyLogs=e.stylePrettyLogs&&s&&!r?!1:e.stylePrettyLogs,super(e,t,i?4:5)}log(e,t,...s){return super.log(e,t,...s)}silly(...e){return super.log(0,"SILLY",...e)}trace(...e){return super.log(1,"TRACE",...e)}debug(...e){return super.log(2,"DEBUG",...e)}info(...e){return super.log(3,"INFO",...e)}warn(...e){return super.log(4,"WARN",...e)}error(...e){return super.log(5,"ERROR",...e)}fatal(...e){return super.log(6,"FATAL",...e)}getSubLogger(e,t){return super.getSubLogger(e,t)}}const he=new tC({minLevel:4});var nC=(n=>(n.login="login",n.enter="enter",n))(nC||{});const vV={login:"login",enter:"enter"},wV=["+972-504040624","+972-525656377"],sC=new Date(2024,0,9,20,0),rC="production",Ke=`enviroments/${rC}`,on="Users",zw="BookingsObjects",iC="Notifications",xV="Errors",EV="Helpers",dt="PublicData",un="Workers",ld="Invoices",hd="PaymentRequests",xa="Bookings",zn="Phones",bi="collections",kt="Businesses",sy="PaymentsRequestsPreviews",TV="Reports",IV="customersData",oC="publicCustomersData",ry="clients",cn="publicData",aC="scheduleNotifications",Gw="recurrenceEvents",Jw="recurrenceBookings",Qw="multiEventsTimes",DV="BookingsEvents",iy="LikesCollection",oy="BusinessData",cC="Counters",uC="sasimple",lC="phone",ay="^&8@^",cy="^&9@^";var Hf=(n=>(n[n.add=0]="add",n[n.remove=1]="remove",n))(Hf||{}),Ea=(n=>(n[n.increment=0]="increment",n[n.decrement=1]="decrement",n))(Ea||{}),Br=(n=>(n[n.basic=0]="basic",n[n.advanced=1]="advanced",n[n.trial=2]="trial",n[n.landingPage=3]="landingPage",n[n.golden=4]="golden",n))(Br||{}),G;let V=(G=class{constructor({days:e=0,hours:t=0,minutes:s=0,seconds:r=0,milliseconds:i=0,microseconds:o=0}){h(this,"_duration");h(this,"days",0);h(this,"hours",0);h(this,"minutes",0);h(this,"seconds",0);h(this,"milliseconds",0);h(this,"microseconds",0);this._duration=o+G.microsecondsPerMillisecond*i+G.microsecondsPerSecond*r+G.microsecondsPerMinute*s+G.microsecondsPerHour*t+G.microsecondsPerDay*e}static _microseconds(e){return new G({microseconds:e})}add(e){return G._microseconds(this._duration+e._duration)}subtract(e){return G._microseconds(this._duration-e._duration)}multiply(e){return G._microseconds(Math.round(this._duration*e))}divide(e){if(e===0)throw new Error("IntegerDivisionByZeroException");return G._microseconds(Math.floor(this._duration/e))}lessThan(e){return this._duration<e._duration}greaterThan(e){return this._duration>e._duration}lessThanOrEqual(e){return this._duration<=e._duration}greaterThanOrEqual(e){return this._duration>=e._duration}get inDays(){return Math.floor(this._duration/G.microsecondsPerDay)}get inHours(){return Math.floor(this._duration/G.microsecondsPerHour)}get inMinutes(){return Math.floor(this._duration/G.microsecondsPerMinute)}get inSeconds(){return Math.floor(this._duration/G.microsecondsPerSecond)}get inMilliseconds(){return Math.floor(this._duration/G.microsecondsPerMillisecond)}get inMicroseconds(){return this._duration}equals(e){return e instanceof G&&this._duration===e.inMicroseconds}compareTo(e){return this._duration-e._duration}},h(G,"microsecondsPerMillisecond",1e3),h(G,"millisecondsPerSecond",1e3),h(G,"secondsPerMinute",60),h(G,"minutesPerHour",60),h(G,"hoursPerDay",24),h(G,"microsecondsPerSecond",G.microsecondsPerMillisecond*G.millisecondsPerSecond),h(G,"microsecondsPerMinute",G.microsecondsPerSecond*G.secondsPerMinute),h(G,"microsecondsPerHour",G.microsecondsPerMinute*G.minutesPerHour),h(G,"microsecondsPerDay",G.microsecondsPerHour*G.hoursPerDay),h(G,"millisecondsPerMinute",G.millisecondsPerSecond*G.secondsPerMinute),h(G,"millisecondsPerHour",G.millisecondsPerMinute*G.minutesPerHour),h(G,"millisecondsPerDay",G.millisecondsPerHour*G.hoursPerDay),h(G,"secondsPerHour",G.secondsPerMinute*G.minutesPerHour),h(G,"secondsPerDay",G.secondsPerHour*G.hoursPerDay),h(G,"minutesPerDay",G.minutesPerHour*G.hoursPerDay),h(G,"zero",new G({seconds:0})),G);var Ht=(n=>(n.waiting="waiting",n.approved="approved",n))(Ht||{});const Kw={waiting:"waiting",approved:"approved"},jw={waiting:"waiting",approved:"approved"};var In=(n=>(n.app="app",n.web="web",n.byWorker="byWorker",n))(In||{});const Xw={app:"app",web:"web",byWorker:"byWorker"},Zw={app:"app",web:"web",byWorker:"byWorker"};var jt=(n=>(n.regular="regular",n.confirmArrival="confirmArrival",n))(jt||{});const Hi={regular:"regular",confirmArrival:"confirmArrival"},Ur={regular:"regular",confirmArrival:"confirmArrival"};var X=(n=>(n[n.message=0]="message",n[n.push=1]="push",n[n.none=2]="none",n[n.whatsapp=3]="whatsapp",n))(X||{});const hC={0:"message",1:"push",2:"none",3:"whatsapp"},ex={message:0,push:1,whatsapp:3,none:2},uy=new V({hours:3}),AV=new V({minutes:5});var se=(n=>(n[n.sendSms=0]="sendSms",n[n.updateDisplayName=1]="updateDisplayName",n[n.logout=2]="logout",n[n.serverError=3]="serverError",n[n.storageError=4]="storageError",n[n.listener=5]="listener",n[n.notLogedIn=6]="notLogedIn",n[n.illegalFields=7]="illegalFields",n[n.passedLimit=8]="passedLimit",n[n.notFoundItem=9]="notFoundItem",n[n.takenBooking=10]="takenBooking",n[n.overlapWithOntherItem=11]="overlapWithOntherItem",n[n.takenMultiBooking=12]="takenMultiBooking",n[n.alreadyWorker=13]="alreadyWorker",n[n.userNotFound=14]="userNotFound",n[n.verification=15]="verification",n[n.network=16]="network",n[n.emptyField=17]="emptyField",n[n.alreadyExistItem=18]="alreadyExistItem",n[n.uploadImages=19]="uploadImages",n[n.notSelectedImages=20]="notSelectedImages",n[n.wrongOptCode=21]="wrongOptCode",n[n.expiredOpt=22]="expiredOpt",n[n.unknown=23]="unknown",n[n.timeout=24]="timeout",n[n.purchaseError=25]="purchaseError",n[n.anonymouslySignIn=26]="anonymouslySignIn",n[n.lowSubType=27]="lowSubType",n[n.coincidingEvent=28]="coincidingEvent",n[n.coincidingHoliday=29]="coincidingHoliday",n[n.realTimeServerError=30]="realTimeServerError",n[n.blockedUser=31]="blockedUser",n[n.noPermission=32]="noPermission",n[n.paymentProblem=33]="paymentProblem",n[n.currentlyOrderingForTime=34]="currentlyOrderingForTime",n[n.notFoundBusiness=35]="notFoundBusiness",n[n.savePaymentDataError=36]="savePaymentDataError",n[n.redeemDepositError=37]="redeemDepositError",n[n.saveDepositDataError=38]="saveDepositDataError",n[n.endOfWork=39]="endOfWork",n[n.invoiceCreation=40]="invoiceCreation",n[n.cantBookRecurrenceOnDates=41]="cantBookRecurrenceOnDates",n[n.cantBookRecurrenceOnEndlessDates=42]="cantBookRecurrenceOnEndlessDates",n[n.eventHasNoAccurances=43]="eventHasNoAccurances",n[n.workerDeleteTheBookingMeanwhile=44]="workerDeleteTheBookingMeanwhile",n[n.workerUpdatedTheBookingMeanwhile=45]="workerUpdatedTheBookingMeanwhile",n[n.workerDeleteEventMeanwhile=46]="workerDeleteEventMeanwhile",n[n.workerUpdatedTheBookingWhilePayment=47]="workerUpdatedTheBookingWhilePayment",n[n.blockCard=48]="blockCard",n[n.stolenCard=49]="stolenCard",n[n.callCreditCompany=50]="callCreditCompany",n[n.transactionNotConfirmed=51]="transactionNotConfirmed",n[n.fakeCard=52]="fakeCard",n[n.wrongCVV=53]="wrongCVV",n[n.worngCAVVUCAF=54]="worngCAVVUCAF",n[n.worngAvs=55]="worngAvs",n[n.networkDisconnect=56]="networkDisconnect",n[n.partlyConfirm=57]="partlyConfirm",n[n.lackOfPointsStarsMilesOtherBenefit=58]="lackOfPointsStarsMilesOtherBenefit",n[n.unauthorizedCardAtTheTerminal=59]="unauthorizedCardAtTheTerminal",n[n.invalidBalanceCode=60]="invalidBalanceCode",n[n.cardNotAssociatedWithTheNetwork=61]="cardNotAssociatedWithTheNetwork",n[n.cardIsNotValid=62]="cardIsNotValid",n[n.currencyTypeIsNotAllowed=63]="currencyTypeIsNotAllowed",n[n.thereIsNoAuthorizationForACreditTypeInTheTransaction=64]="thereIsNoAuthorizationForACreditTypeInTheTransaction",n[n.invalidId=65]="invalidId",n[n.noTreatment=66]="noTreatment",n[n.terminalNotAuthorizedToWorkWithThisMethodTheTerminalIsNotAuthorized=67]="terminalNotAuthorizedToWorkWithThisMethodTheTerminalIsNotAuthorized",n[n.authenticationErrorTerminalReference=68]="authenticationErrorTerminalReference",n[n.exceedingTheNumberOfPayments=69]="exceedingTheNumberOfPayments",n[n.communicationError=70]="communicationError",n[n.canceledTransaction=71]="canceledTransaction",n[n.invalidToken=72]="invalidToken",n[n.terminalNotAuthorizedToUseTheToken=73]="terminalNotAuthorizedToUseTheToken",n[n.deferredCharge=74]="deferredCharge",n[n.approvalWithoutCharge=75]="approvalWithoutCharge",n[n.receivingTransactionDetails=76]="receivingTransactionDetails",n[n.theCardDetailsWereNotReadInFull=77]="theCardDetailsWereNotReadInFull",n[n.theAmountOfTheItemsDoesNotMatch=78]="theAmountOfTheItemsDoesNotMatch",n[n.YouMustEnterAFirstOrLastName=79]="YouMustEnterAFirstOrLastName",n[n.transactionDescriptionMustBeEntered=80]="transactionDescriptionMustBeEntered",n[n.youCanCreditTheEntireTransactionOrASmallAmount=81]="youCanCreditTheEntireTransactionOrASmallAmount",n[n.bigDiffrentBetweenLoginAndDelete=82]="bigDiffrentBetweenLoginAndDelete",n[n.providerNotAllowed=83]="providerNotAllowed",n[n.userDisable=84]="userDisable",n[n.providerAlreadyLinked=85]="providerAlreadyLinked",n[n.credentialAlreadyInUse=86]="credentialAlreadyInUse",n[n.accountAlreadyExists=87]="accountAlreadyExists",n[n.invalidCredential=88]="invalidCredential",n[n.userMissmatch=89]="userMissmatch",n[n.noSuchProvider=90]="noSuchProvider",n[n.duplicateBusinesssName=91]="duplicateBusinesssName",n[n.alreadyExistPhone=92]="alreadyExistPhone",n[n.userExitManually=93]="userExitManually",n[n.tooManyAttempts=94]="tooManyAttempts",n[n.expiredCode=95]="expiredCode",n[n.cantUpdateEmailTooShortTimeBetween=96]="cantUpdateEmailTooShortTimeBetween",n[n.cantUpdatePhonelTooShortTimeBetween=97]="cantUpdatePhonelTooShortTimeBetween",n[n.invalidPhoneNumber=98]="invalidPhoneNumber",n))(se||{});const Bl=class Bl{constructor(){h(this,"errorCode",100);h(this,"error",se.unknown);h(this,"details","")}static GI(){return this._singleton}addError({code:e,error:t,details:s}){this.error=t||this.error,this.errorCode=e||this.errorCode,this.details=s||this.details}};h(Bl,"_singleton",new Bl);let _e=Bl;class xs{constructor({code:e="",name:t="",symbol:s=""}={}){h(this,"code","");h(this,"name","");h(this,"symbol","");this.code=e,this.name=t,this.symbol=s}static fromJson(e){return new xs({code:e.code||"",name:e.name||"",symbol:e.symbol||""})}toJson(){return{code:this.code,name:this.name,symbol:this.symbol}}isEqual(e){return e.code===this.code}toString(){return JSON.stringify(this.toJson(),null,2)}}const Rs=new xs({code:"USD",name:"US Dollar",symbol:"$"}),ly={ILS:new xs({code:"ILS",name:"Israel Shekel",symbol:""}),USD:new xs({code:"USD",name:"United States Dollar",symbol:"$"}),EUR:new xs({code:"EUR",name:"Euro",symbol:""}),GBP:new xs({code:"GBP",name:"British Pound",symbol:""})},Iu=5,dC="https://icom.yaad.net/cgi-bin/yaadpay/yaadpay3ds.pl?Masof=MASOFNUMBER&action=PrintHesh&asm=INVOICENUMBER&type=PDF&signature=SIGNATURE";class xt{}h(xt,"currentBusinesssId",""),h(xt,"hasPaddingFromTop",!1),h(xt,"paddingFromTop",0),h(xt,"attemptsLeftForCardPassword",Iu),h(xt,"productionVersion",!0),h(xt,"developers",{});const Ua=class Ua{constructor(){}static GI(){return Ua._singleton}getLisksChildPath(e){const t=`${kt}/${xt.currentBusinesssId}/${un}`,s=`${e}/${iy}`;return`${t}/${s}`}getImageStorageName(e,t){const s=e.toUpperCase(),r=t.split(s);return`${s}${r[1].split(".jpg")[0]}`}getLikesChildPath(e,t,s){const r=`${kt}/${t}/${un}`,i=`${e}/${iy}`;return`${r}/${i}/${s}`}getBusinessDataPath(e){return`${kt}/${e}/${oy}`}getWorkerCountersPath(e,t){return`${kt}/${e}/${un}/${t}/${cC}`}getMessageCounterPath(e){return`${kt}/${e}/${oy}/messagesCounter`}userBookingsPathByBooking(e){return`${on}/${e.customerId}/${dt}/${cn}/${xa}`}userBookingsPathByUser(e){return`${on}/${e}/${dt}/${cn}/${xa}`}workerBookingsPath(e){return`${kt}/${e.buisnessId}/${un}/${e.workerId}/${dt}/${cn}/${zw}`}};h(Ua,"_singleton",new Ua);let Ya=Ua;const hy="data:image/webp;base64,UklGRjgGAABXRUJQVlA4WAoAAAAQAAAAfwAAfwAAQUxQSC8DAAABoEbb1iFJehGJtm3btu1S27Zt27Zt27a7x3ZZWcyM+MYT8b77/Z6ImAD63/+y6umL+I2ZPWdM26LplZS6wa7vfOJvve/mFVJOtulfJYh/HTzOpZRsU8PFfzYOpVBIg4/CSnOcMlIujhbWJh7fNLqSSwG5TxjCzl/XF9bA5bwn7I7YXRJalqvCfvPzAA2XvsdkIETyPCesgV7B0zvfAapwuOCa2AeT65LgG1IFUptkRuKkBsh5VXBObAyoRCwrcc2JZ7rgHVkLz01mYjUc7Rdub9OiSe/jllAeTWnBfhqaJvxOoenD71s04/mZmcHM5ycaglkuwTAwKyRYAmapBFvBzJFgH5iREhwFEyTBaTDVlJfZ5HcEDP3Mbx+a6/y2gNGf8LvmwlLI5BdaHUszwd8bhKW9BL6uWBpLkByIpaIEnoZYspr8QgtioR/4vXeBOcHvIIFt6eNmtkGT/jm3Vw401DiY1691CW+bTxmZb9sS4raMTuciyJl/ZuNpRZi1LWyeZgFFbT1MjPmE2nmTybd5YJEfkzWEW3/JIrIUMPLzMTCW6chSnmDwWQmCXvk32xKHE/jxhl0nneiynrUpuCTBL/GTLbFBpMDmYTaY8x0qoH4J1p12kRL1OT6rLmYmRepDDGuuZiZl6p9b04UU+t6azsrrpJJ31nRWyVtruqnkgzXdVfKpNT1U8pnyPrGmpzK0klNjrXncJb0SnPUO/uQVFid8OjMfOC13263fGsLWpHtjamZB5Srbf/dXyYJh1NN1QXl0JFrG3IWrdZp1/GOoV7BNCn6+b1KXuiWyp9Tky9161e0Qn5DUCLsxrUZmqfSySz8zhOSxd4dllsZZ61SkQGh8MyW3JFMSBMx3fmmkaPgKh0jsJwWlXJ6AIn5rWjlID3iN4UNTnaRNt9wjn2d+epK6+E1DrpjrhUl2d8Azrzzm424uApgq6Lkhh/koIBWhbH0zkV/M9dY6AdXLLf7U4GT+tLAkwU3b8lA0l6gDrdMR5pR+u7702BX5yW6/NITcXSxw3d2fk6wxfn60LqCwixTozFKkw9Sdl599E+wxhTA8IV88u7B9UofCmdwkIwBWUDgg4gIAAPASAJ0BKoAAgAA+kUSdSaWkIyEpGAlgsBIJZw3CxcSlHkyPOhk26d2xRwWRYrXywLe8+2egAWMopyguMLJ9ZV1BQaqnj7//iRNIvo+LtU9x5ugDP7vnIlo5PLSXrhJOdyOWq+Bw+jHNKm77brKdRA9KbslKAWeeBAuw3Y2IwABVRdFp31z1AYVORUZ8cebhypTJMwr25HaP6zuhvCaZuIAA/vtAAAAjPSWfXf3X//5OXa7NBHF1z39ZDkUHadB/b5WUA/accoSgsvvE45IP83v09GbK44YxQJsK+Q/O5c5E4YAi192+zzvsh6/A8wKpB73LNYfVgjifBkCbXsawjlgdnJO9KIuCtcYAQ1jlbyD0WYZHxKshat5QwPow3oJn3tLFUVxh4TR76jOjaUwc30/cJt+Rv4/9fvG3m0K5kEGrA/scZJo2rk1eUu3Wcpq+8ni7nu72VaL3gncqrH85o4iH+rfhr3arHWFTfrSoyDmKH6FdwDexpzhAxaOC7InGD2Mf3ZKPNBR/inH+6lPzSNMbIYDzf+F5mnWwubmt0WYD4RfkvA9EgM47lMaerBBoxFPTNXHr+lBIO66//MpxuQboAGW5y/n55f1f/NXZ3JT1sS0/zP/PsP3wxsDpd0EyVnotv8JwHzQPHx7nT/jT//+yi4gDTB9g8Ah5XCMV9qzES1Fkp2BY+3gftkJDLTYuiR6w27amLzJiEM7dh+oR65grCa9BDygHbrvejEqvmV+myfwOZpyVH7ivBGNqLvP/k7MUmx70y7/fdlpIAZRl6tY12CYjzuqXJht09bh63kTdYlu8ZqTHCy/P+t3GQ1GFyItGe2iMBJwDJEiMVUnLsEQXMIgG4obGvf7CPwuLHgSmwb+LTxsJAoNB+qehoNNkrGvc3SqlRptENGUJyixGaTrqQ//dbwWUq4TQ4hgGhZjkpwhSwC5kdh7/7ODeeWhoAW37bOvhIhUQPX2X0Ji6AAAAAA==",fC="data:image/webp;base64,UklGRgwJAABXRUJQVlA4WAoAAAAQAAAAfwAAfwAAQUxQSLIDAAABoEVtmyFJisyqrLFt27Zt2/bMnda2bdvW2LbZNgqT5cqINeL76m4vImICxP83Wh3XvLj9/PWUy4c/vX9y7WRjlOr1dEpC/d3oidsbGUmk9Kx9IfXPU+6vkTTa/hRU/2ri+BAzKZS9LU/965EX6rAr233B5u8d9R/K/Z2ZVRjyzkWfo/7rtBkmK3PID2Gl5c1VLk5VHwwpXYuWm4yabnOUvt6ZhFpcUFrndqTT4LDS/GgVMuW+V7rL100q5uOOdio8iMrIsAI85iFS9ZRClCuJbEhAqOOVaNS8rDATc2jcqlB/tkiULIDxdyIxSeHeyaHkXqBzJoWOESDZhsIDCnkzg1InofaYBNqGoTKrElipoKMD8IyvsdQdeGUKwb614DpLsJRKcGsVeKQl3Kdocjpa6Uto6h60JkVwP6D1ceCuoc1V8BEP2AN4qhuW62sC87FKHCFwN1a5KwTewqqaReB7rHpeAkctqGZhAjfKQbV3CBTUgBqqCAaaQc1kEOoEtYpBfAjU7QycqVCPM1BLoV6jcDfUZxSeg9pO4QOooxS+M5EuUthlAZkpFA6VBCqZTeFkaaAKRRQulAGq5qdwpTxQTZtCSkWgOmEKmZWB6kUp5FQFqh+jkFcNqEGcQkH1ZFdUA6h+jEIxUt0oBW9NoDrhZFfDTnaVvcmubD6FohpA7nQKhUjiMoX86kjHKORWRdpKIbMK0vsUUishPU/hWnmk2yhcLIu0lMKZMkjjKBwtidTBYbDXg9TIZrDVjVQ5i8FXArnUKQZvQ7k+ZvAolNjEYC3WCInnTMFq4cWL9sAqfRmvuAmW+BjvcjmwVXhfmmCtJNztAtxKQZMd0MQTaBkG3Bi0by0sq8mCrRJM+X5Z0dANUn7QfXv9iqHM3/vwkDL6uRec8SmeMnR2mUsvo913UrHd2drQyDUrTxFOW2JoY91SrCiH73LpUu+gIp14qqImot1hUir6oKmJaHiSlDpaVhfRYpek9FNDoW+tzxn9VEPoXPkJm83NJyoJva2V6Vy8cyyhuzHwBJNjPQ0BWPLRMIvQy2UFpjn5JIdzQ00BW+5RG8++t7yAbr7dwQpsbSzQPZOPxHHkwdmWIFhq6lEHQx6YXEqwHL09ol9g62hTEDXbPXjR0Ulm3t9S0C078gO/Lr73RpcTnEtOfOOq/V95L7w5sYxg7mk25ZmdNwJx+WcyEvD5/HYoGk8kYun7n57c2BJJ0F2p0fgtr/945EaeLZ1E1Jd98dC3r2yc0LiSRyACVlA4IDQFAABwHACdASqAAIAAPpFCmkklpCKhJpYs2LASCUAaXMob29CPVjmW/qv8xttur5i/2A3nTqot5K/dL9jrMl/U0QDstlYsFdM8zpvAPRA/YBAFO5pFHJNafid1YMjvQiLMxjEgF4GBOC0mQQr6kLFcY1ytmDddQyENl//HmHZTXIGUh2kxiqBSmmsB+5/R6dHwSkFvkpePmmEVpIsTDlsuD6wuusHSAsegw/lmDPo43TV6NYqbB1WQsJMjM2GusVvmYA48MmyINoMBn3WL2x9+FDw0YtL040bJsxwsKfaaoi5pC8MAutn7kBrCCnsqKAD++/1S0+MtbekZ/OM85Fu+QyDFWBF/ZIWO1ojWq+sj6wH2f0mU1cG/WHikqy3VrJmSr9P4JT5iTv5fQJPmWGQzQAYk0HS2BtyZ+kqhlaY1XQf9zw4cRH1br6vvZ86uc2/bvHoINDSg3gGzoEexXwnkei2qmK5Hiv66YmqMh/GBqIsV4pVgn/PR3Wx8ZX9zDTvF+8SnWlEdZp9wEMaPHSzI4QcbypIrH/7RWndB7Uh5PYcISRP+fwt2A0rl1iQSoq4AhNvFatu/5rnBQ5DS74dBhswrsFYVu0XvBiNvW5tbh2adMPMcNCbe0m6T+c/owQeRNzYaYmsathvC+eDGAi6Tj5QWAkLcAuoJmoatBgs+zR2hWMyYEaC5TO9eeFEkLdyGQCC1KwnrHPydeq6dm0uGWaX4G1avJrR5jQBJYI6tOwnBJrPbH7g9QXRM39hOWO6ESdm3WZr28SLcjGLSUab8pj+0lhsNtEiWJMVo/xfAm9muYKWmELzwvlqFFxgKljXOnOLtqDBuIU4SS06Nbe6NDvQ4C+GYt0jWipm6nbx0uZcdngA4u/3GevkBWQpGHcN0r8GYrIWxq+p30Q3ObeWtvpwTUjrEw4SRUfDrB/NTXjOlooSciN3NekShQHTmkZbDKEhlbsmvwHDwhM/fYD/USMCplAftDcOrHh+aUSdyR9rlDt4XCE2W/SIb+5lygQcIiCJLZd91Wks4iLsSmFSMDSs32gzqgWuG5yStilhe9NijnIsS46zqv0DF0oqpl6CwDBGQ9OxAiHBwoZ99pIu0rMPBn0NFIxw0as5Oc3xvUA/xZtZSNEH0/vNMGUMligoUU7DVqDbBgfwjsZX/mYIxQmGhDsgo2vflmR5Mk7hkyTuSqMrp0jZcpbGIbxwYA6EkZO2yb6hV0f81ILo3h4zJzBUEL6KK6slkXY1wEK77SauOtYT2b6ZGt41mJ+6QPY3y1GNNKQQ89XyES72iMg/9TVKARAJ690/5+JRU1uGGgyOd71mi4oIGsXlw41SYa8qP6+4PDTe/m4pwEjgCnKsG3GSi7IQ9dYk3rAnvLJn2jeSN77lBX2333YWba+7czXWcYEZv6CjdmqPfxg8WRe6l1IC5wXNs6NH6b0OJ9rBnRoWmquT/Pkzhi71sHxps2Kf7R1+8kgWWBiHWRPWcyrYetmxY4WJd/C5Ktexuu7Ih/48On+IqARLONPjymxvgATJT8tBBkM+iYUrbkOiPBTotQLD4iR/3PzBIt7jc3AepvAbt4ASyaAIv9Ibwo6xCc2003f+VsRx57y9aAoJg5sZsLMUAkVazPaihX3YtxpChUGxPyXp2HoQx/q2K4ulpJYBOwkZEI1qxzDDUbIjU4PBWZuFUPvzsXTdpbGLjCHZxGA8RNc+49is2M8JIWPeFhYR654/rV59vekP8L2POM+CA8hfTtxnhp3ufOlSFcZF4rb3q7wAAAAA=";var Ee=(n=>(n[n.male=0]="male",n[n.female=1]="female",n[n.anonymous=2]="anonymous",n))(Ee||{});const dy={" ":" "," ":" "," ":" "," ":" "," ":" ","?":"?",:"",:""," ":" "," ":" ",:"",:"",:""," ":" "," ":" ",:"",:""," ":" "," ":" ",:"",:""," ":" ",:"",:"",:""," ":" ",:""," ":" ",:"",:""," ":" ",:""," ":" "," ":" ",:""," ":" ","  ":"  ","  ":"  ","  ":"  "," ":" ",:"",:"",:""," ":" "," ":" ",:""," ":" ",:"",:""," ":" "," ":" ",:"",:""," ":" ",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:""},ao={0:"male",1:"female",2:"anonymous"},bV={0:hy,1:fC,2:hy},Bs={male:0,female:1,anonymous:2},CV=[0,1,2];var He=(n=>(n[n.SMS=0]="SMS",n[n.SMSOrPush=1]="SMSOrPush",n[n.WhatsAppOrPush=2]="WhatsAppOrPush",n[n.WhatsApp=3]="WhatsApp",n[n.SMSOnly=4]="SMSOnly",n[n.WhatAppOnly=5]="WhatAppOnly",n[n.Push=6]="Push",n[n.PushOrWhatsApp=7]="PushOrWhatsApp",n[n.PushOrSMS=8]="PushOrSMS",n[n.OnlyPush=9]="OnlyPush",n))(He||{});const mC={0:"SMS",4:"SMSOnly",5:"WhatAppOnly",1:"SMSOrPush",2:"WhatsAppOrPush",3:"WhatsApp",9:"OnlyPush",7:"PushOrWhatsApp",8:"PushOrSMS",6:"Push"},ql={SMS:0,SMSOrPush:1,WhatAppOnly:5,SMSOnly:4,WhatsAppOrPush:2,WhatsApp:3,OnlyPush:9,PushOrWhatsApp:7,PushOrSMS:8,Push:6},pC=/^[a-zA-Z0-9-_.~%]{1,900}$/;var $f=(n=>(n[n.muslim=0]="muslim",n[n.christian=1]="christian",n[n.jewish=2]="jewish",n))($f||{});const gC={0:"muslim",1:"christian",2:"jewish"},yC={muslim:0,christian:1,jewish:2},fy={1:{"01-01-0000":"New Year's Day","16-01-0000":"Martin Luther King Jr. Day","20-02-0000":"Presidents' Day","29-05-0000":"Memorial Day","19-06-0000":"Juneteenth","04-07-0000":"Independence Day","04-09-0000":"Labor Day","09-10-0000":"Columbus Day","11-11-0000":"Veterans Day","23-11-0000":"Thanksgiving Day","25-12-0000":"Christmas Day"},2:{"06-04-2023":"Passover (Day 1)","12-04-2023":"Passover (Day 7)","26-04-2023":"Yom HaAtzmaut","26-05-2023":"Shavuot","16-09-2023":"Rosh Hashana","17-09-2023":"Rosh Hashana (Day 2)","25-09-2023":"Yom Kippur","30-09-2023":"Sukkot","07-10-2023":"Simchat Torah","23-04-2024":"Passover (Day 1)","29-04-2024":"Passover (Day 7)","14-05-2024":"Yom HaAtzmaut","12-06-2024":"Shavuot","03-10-2024":"Rosh Hashana","04-10-2024":"Rosh Hashana (Day 2)","12-10-2024":"Yom Kippur","17-10-2024":"Sukkot","24-10-2024":"Simchat Torah","13-04-2025":"Passover (Day 1)","19-04-2025":"Passover (Day 7)","01-05-2025":"Yom HaAtzmaut","02-06-2025":"Shavuot","23-09-2025":"Rosh Hashana","24-09-2025":"Rosh Hashana (Day 2)","02-10-2025":"Yom Kippur","07-10-2025":"Sukkot","14-10-2025":"Simchat Torah"},0:{}},_C=["","monday","tuesday","wednesday","thursday","friday","saturday","sunday"];var zr=(n=>(n[n.onHold=0]="onHold",n[n.needCancel=1]="needCancel",n[n.waitingList=2]="waitingList",n[n.withDebts=3]="withDebts",n[n.withOutRecipts=4]="withOutRecipts",n[n.withOnlinePayment=5]="withOnlinePayment",n[n.withoutConfirmArrival=6]="withoutConfirmArrival",n))(zr||{});const my={0:"waitingsForApproval",1:"waitingsForCancel",2:"waitingList",4:"withOutRecipts",3:"withDebts",5:"withOnlinePayment",6:"withoutConfirmArrival"};function It(n){const e=Object.prototype.toString.call(n);return n instanceof Date||typeof n=="object"&&e==="[object Date]"?new n.constructor(+n):typeof n=="number"||e==="[object Number]"||typeof n=="string"||e==="[object String]"?new Date(n):new Date(NaN)}function et(n,e){return n instanceof Date?new n.constructor(e):new Date(e)}function em(n,e){const t=It(n);return isNaN(e)?et(n,NaN):(e&&t.setDate(t.getDate()+e),t)}const tx=6048e5,vC=864e5,wC=6e4,xC=36e5,EC=1e3;let TC={};function Mo(){return TC}function _r(n,e){var a,c,u,l;const t=Mo(),s=(e==null?void 0:e.weekStartsOn)??((c=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:c.weekStartsOn)??t.weekStartsOn??((l=(u=t.locale)==null?void 0:u.options)==null?void 0:l.weekStartsOn)??0,r=It(n),i=r.getDay(),o=(i<s?7:0)+i-s;return r.setDate(r.getDate()-o),r.setHours(0,0,0,0),r}function co(n){return _r(n,{weekStartsOn:1})}function nx(n){const e=It(n),t=e.getFullYear(),s=et(n,0);s.setFullYear(t+1,0,4),s.setHours(0,0,0,0);const r=co(s),i=et(n,0);i.setFullYear(t,0,4),i.setHours(0,0,0,0);const o=co(i);return e.getTime()>=r.getTime()?t+1:e.getTime()>=o.getTime()?t:t-1}function py(n){const e=It(n);return e.setHours(0,0,0,0),e}function Wu(n){const e=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return e.setUTCFullYear(n.getFullYear()),n.getTime()-e.getTime()}function IC(n,e){const t=py(n),s=py(e),r=t.getTime()-Wu(t),i=s.getTime()-Wu(s);return Math.round((r-i)/vC)}function DC(n){const e=nx(n),t=et(n,0);return t.setFullYear(e,0,4),t.setHours(0,0,0,0),co(t)}function AC(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function bC(n){if(!AC(n)&&typeof n!="number")return!1;const e=It(n);return!isNaN(Number(e))}function CC(n){const e=It(n),t=et(n,0);return t.setFullYear(e.getFullYear(),0,1),t.setHours(0,0,0,0),t}const kC={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},SC=(n,e,t)=>{let s;const r=kC[n];return typeof r=="string"?s=r:e===1?s=r.one:s=r.other.replace("{{count}}",e.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+s:s+" ago":s};function dd(n){return(e={})=>{const t=e.width?String(e.width):n.defaultWidth;return n.formats[t]||n.formats[n.defaultWidth]}}const PC={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},RC={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},NC={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},MC={date:dd({formats:PC,defaultWidth:"full"}),time:dd({formats:RC,defaultWidth:"full"}),dateTime:dd({formats:NC,defaultWidth:"full"})},OC={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},FC=(n,e,t,s)=>OC[n];function sa(n){return(e,t)=>{const s=t!=null&&t.context?String(t.context):"standalone";let r;if(s==="formatting"&&n.formattingValues){const o=n.defaultFormattingWidth||n.defaultWidth,a=t!=null&&t.width?String(t.width):o;r=n.formattingValues[a]||n.formattingValues[o]}else{const o=n.defaultWidth,a=t!=null&&t.width?String(t.width):n.defaultWidth;r=n.values[a]||n.values[o]}const i=n.argumentCallback?n.argumentCallback(e):e;return r[i]}}const BC={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},LC={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},VC={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},UC={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},WC={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},HC={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},$C=(n,e)=>{const t=Number(n),s=t%100;if(s>20||s<10)switch(s%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},qC={ordinalNumber:$C,era:sa({values:BC,defaultWidth:"wide"}),quarter:sa({values:LC,defaultWidth:"wide",argumentCallback:n=>n-1}),month:sa({values:VC,defaultWidth:"wide"}),day:sa({values:UC,defaultWidth:"wide"}),dayPeriod:sa({values:WC,defaultWidth:"wide",formattingValues:HC,defaultFormattingWidth:"wide"})};function ra(n){return(e,t={})=>{const s=t.width,r=s&&n.matchPatterns[s]||n.matchPatterns[n.defaultMatchWidth],i=e.match(r);if(!i)return null;const o=i[0],a=s&&n.parsePatterns[s]||n.parsePatterns[n.defaultParseWidth],c=Array.isArray(a)?zC(a,d=>d.test(o)):YC(a,d=>d.test(o));let u;u=n.valueCallback?n.valueCallback(c):c,u=t.valueCallback?t.valueCallback(u):u;const l=e.slice(o.length);return{value:u,rest:l}}}function YC(n,e){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&e(n[t]))return t}function zC(n,e){for(let t=0;t<n.length;t++)if(e(n[t]))return t}function GC(n){return(e,t={})=>{const s=e.match(n.matchPattern);if(!s)return null;const r=s[0],i=e.match(n.parsePattern);if(!i)return null;let o=n.valueCallback?n.valueCallback(i[0]):i[0];o=t.valueCallback?t.valueCallback(o):o;const a=e.slice(r.length);return{value:o,rest:a}}}const JC=/^(\d+)(th|st|nd|rd)?/i,QC=/\d+/i,KC={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},jC={any:[/^b/i,/^(a|c)/i]},XC={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},ZC={any:[/1/i,/2/i,/3/i,/4/i]},ek={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},tk={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},nk={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},sk={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},rk={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},ik={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},ok={ordinalNumber:GC({matchPattern:JC,parsePattern:QC,valueCallback:n=>parseInt(n,10)}),era:ra({matchPatterns:KC,defaultMatchWidth:"wide",parsePatterns:jC,defaultParseWidth:"any"}),quarter:ra({matchPatterns:XC,defaultMatchWidth:"wide",parsePatterns:ZC,defaultParseWidth:"any",valueCallback:n=>n+1}),month:ra({matchPatterns:ek,defaultMatchWidth:"wide",parsePatterns:tk,defaultParseWidth:"any"}),day:ra({matchPatterns:nk,defaultMatchWidth:"wide",parsePatterns:sk,defaultParseWidth:"any"}),dayPeriod:ra({matchPatterns:rk,defaultMatchWidth:"any",parsePatterns:ik,defaultParseWidth:"any"})},sx={code:"en-US",formatDistance:SC,formatLong:MC,formatRelative:FC,localize:qC,match:ok,options:{weekStartsOn:0,firstWeekContainsDate:1}};function ak(n){const e=It(n);return IC(e,CC(e))+1}function rx(n){const e=It(n),t=co(e).getTime()-DC(e).getTime();return Math.round(t/tx)+1}function tm(n,e){var l,d,f,m;const t=It(n),s=t.getFullYear(),r=Mo(),i=(e==null?void 0:e.firstWeekContainsDate)??((d=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:d.firstWeekContainsDate)??r.firstWeekContainsDate??((m=(f=r.locale)==null?void 0:f.options)==null?void 0:m.firstWeekContainsDate)??1,o=et(n,0);o.setFullYear(s+1,0,i),o.setHours(0,0,0,0);const a=_r(o,e),c=et(n,0);c.setFullYear(s,0,i),c.setHours(0,0,0,0);const u=_r(c,e);return t.getTime()>=a.getTime()?s+1:t.getTime()>=u.getTime()?s:s-1}function ck(n,e){var a,c,u,l;const t=Mo(),s=(e==null?void 0:e.firstWeekContainsDate)??((c=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:c.firstWeekContainsDate)??t.firstWeekContainsDate??((l=(u=t.locale)==null?void 0:u.options)==null?void 0:l.firstWeekContainsDate)??1,r=tm(n,e),i=et(n,0);return i.setFullYear(r,0,s),i.setHours(0,0,0,0),_r(i,e)}function ix(n,e){const t=It(n),s=_r(t,e).getTime()-ck(t,e).getTime();return Math.round(s/tx)+1}function Pe(n,e){const t=n<0?"-":"",s=Math.abs(n).toString().padStart(e,"0");return t+s}const Zs={y(n,e){const t=n.getFullYear(),s=t>0?t:1-t;return Pe(e==="yy"?s%100:s,e.length)},M(n,e){const t=n.getMonth();return e==="M"?String(t+1):Pe(t+1,2)},d(n,e){return Pe(n.getDate(),e.length)},a(n,e){const t=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(n,e){return Pe(n.getHours()%12||12,e.length)},H(n,e){return Pe(n.getHours(),e.length)},m(n,e){return Pe(n.getMinutes(),e.length)},s(n,e){return Pe(n.getSeconds(),e.length)},S(n,e){const t=e.length,s=n.getMilliseconds(),r=Math.floor(s*Math.pow(10,t-3));return Pe(r,e.length)}},Ci={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},uk={G:function(n,e,t){const s=n.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(s,{width:"abbreviated"});case"GGGGG":return t.era(s,{width:"narrow"});case"GGGG":default:return t.era(s,{width:"wide"})}},y:function(n,e,t){if(e==="yo"){const s=n.getFullYear(),r=s>0?s:1-s;return t.ordinalNumber(r,{unit:"year"})}return Zs.y(n,e)},Y:function(n,e,t,s){const r=tm(n,s),i=r>0?r:1-r;if(e==="YY"){const o=i%100;return Pe(o,2)}return e==="Yo"?t.ordinalNumber(i,{unit:"year"}):Pe(i,e.length)},R:function(n,e){const t=nx(n);return Pe(t,e.length)},u:function(n,e){const t=n.getFullYear();return Pe(t,e.length)},Q:function(n,e,t){const s=Math.ceil((n.getMonth()+1)/3);switch(e){case"Q":return String(s);case"QQ":return Pe(s,2);case"Qo":return t.ordinalNumber(s,{unit:"quarter"});case"QQQ":return t.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(s,{width:"wide",context:"formatting"})}},q:function(n,e,t){const s=Math.ceil((n.getMonth()+1)/3);switch(e){case"q":return String(s);case"qq":return Pe(s,2);case"qo":return t.ordinalNumber(s,{unit:"quarter"});case"qqq":return t.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(s,{width:"wide",context:"standalone"})}},M:function(n,e,t){const s=n.getMonth();switch(e){case"M":case"MM":return Zs.M(n,e);case"Mo":return t.ordinalNumber(s+1,{unit:"month"});case"MMM":return t.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(s,{width:"wide",context:"formatting"})}},L:function(n,e,t){const s=n.getMonth();switch(e){case"L":return String(s+1);case"LL":return Pe(s+1,2);case"Lo":return t.ordinalNumber(s+1,{unit:"month"});case"LLL":return t.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(s,{width:"wide",context:"standalone"})}},w:function(n,e,t,s){const r=ix(n,s);return e==="wo"?t.ordinalNumber(r,{unit:"week"}):Pe(r,e.length)},I:function(n,e,t){const s=rx(n);return e==="Io"?t.ordinalNumber(s,{unit:"week"}):Pe(s,e.length)},d:function(n,e,t){return e==="do"?t.ordinalNumber(n.getDate(),{unit:"date"}):Zs.d(n,e)},D:function(n,e,t){const s=ak(n);return e==="Do"?t.ordinalNumber(s,{unit:"dayOfYear"}):Pe(s,e.length)},E:function(n,e,t){const s=n.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(s,{width:"short",context:"formatting"});case"EEEE":default:return t.day(s,{width:"wide",context:"formatting"})}},e:function(n,e,t,s){const r=n.getDay(),i=(r-s.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return Pe(i,2);case"eo":return t.ordinalNumber(i,{unit:"day"});case"eee":return t.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(r,{width:"short",context:"formatting"});case"eeee":default:return t.day(r,{width:"wide",context:"formatting"})}},c:function(n,e,t,s){const r=n.getDay(),i=(r-s.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return Pe(i,e.length);case"co":return t.ordinalNumber(i,{unit:"day"});case"ccc":return t.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(r,{width:"narrow",context:"standalone"});case"cccccc":return t.day(r,{width:"short",context:"standalone"});case"cccc":default:return t.day(r,{width:"wide",context:"standalone"})}},i:function(n,e,t){const s=n.getDay(),r=s===0?7:s;switch(e){case"i":return String(r);case"ii":return Pe(r,e.length);case"io":return t.ordinalNumber(r,{unit:"day"});case"iii":return t.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(s,{width:"short",context:"formatting"});case"iiii":default:return t.day(s,{width:"wide",context:"formatting"})}},a:function(n,e,t){const r=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(n,e,t){const s=n.getHours();let r;switch(s===12?r=Ci.noon:s===0?r=Ci.midnight:r=s/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(n,e,t){const s=n.getHours();let r;switch(s>=17?r=Ci.evening:s>=12?r=Ci.afternoon:s>=4?r=Ci.morning:r=Ci.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(n,e,t){if(e==="ho"){let s=n.getHours()%12;return s===0&&(s=12),t.ordinalNumber(s,{unit:"hour"})}return Zs.h(n,e)},H:function(n,e,t){return e==="Ho"?t.ordinalNumber(n.getHours(),{unit:"hour"}):Zs.H(n,e)},K:function(n,e,t){const s=n.getHours()%12;return e==="Ko"?t.ordinalNumber(s,{unit:"hour"}):Pe(s,e.length)},k:function(n,e,t){let s=n.getHours();return s===0&&(s=24),e==="ko"?t.ordinalNumber(s,{unit:"hour"}):Pe(s,e.length)},m:function(n,e,t){return e==="mo"?t.ordinalNumber(n.getMinutes(),{unit:"minute"}):Zs.m(n,e)},s:function(n,e,t){return e==="so"?t.ordinalNumber(n.getSeconds(),{unit:"second"}):Zs.s(n,e)},S:function(n,e){return Zs.S(n,e)},X:function(n,e,t,s){const i=(s._originalDate||n).getTimezoneOffset();if(i===0)return"Z";switch(e){case"X":return yy(i);case"XXXX":case"XX":return Or(i);case"XXXXX":case"XXX":default:return Or(i,":")}},x:function(n,e,t,s){const i=(s._originalDate||n).getTimezoneOffset();switch(e){case"x":return yy(i);case"xxxx":case"xx":return Or(i);case"xxxxx":case"xxx":default:return Or(i,":")}},O:function(n,e,t,s){const i=(s._originalDate||n).getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+gy(i,":");case"OOOO":default:return"GMT"+Or(i,":")}},z:function(n,e,t,s){const i=(s._originalDate||n).getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+gy(i,":");case"zzzz":default:return"GMT"+Or(i,":")}},t:function(n,e,t,s){const r=s._originalDate||n,i=Math.floor(r.getTime()/1e3);return Pe(i,e.length)},T:function(n,e,t,s){const i=(s._originalDate||n).getTime();return Pe(i,e.length)}};function gy(n,e=""){const t=n>0?"-":"+",s=Math.abs(n),r=Math.floor(s/60),i=s%60;return i===0?t+String(r):t+String(r)+e+Pe(i,2)}function yy(n,e){return n%60===0?(n>0?"-":"+")+Pe(Math.abs(n)/60,2):Or(n,e)}function Or(n,e=""){const t=n>0?"-":"+",s=Math.abs(n),r=Pe(Math.floor(s/60),2),i=Pe(s%60,2);return t+r+e+i}const _y=(n,e)=>{switch(n){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},ox=(n,e)=>{switch(n){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},lk=(n,e)=>{const t=n.match(/(P+)(p+)?/)||[],s=t[1],r=t[2];if(!r)return _y(n,e);let i;switch(s){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",_y(s,e)).replace("{{time}}",ox(r,e))},qf={p:ox,P:lk},hk=/^D+$/,dk=/^Y+$/,fk=["D","DD","YY","YYYY"];function ax(n){return hk.test(n)}function cx(n){return dk.test(n)}function Hu(n,e,t){const s=mk(n,e,t);if(console.warn(s),fk.includes(n))throw new RangeError(s)}function mk(n,e,t){const s=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${e}\`) for formatting ${s} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const pk=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,gk=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,yk=/^'([^]*?)'?$/,_k=/''/g,vk=/[a-zA-Z]/;function Nt(n,e,t){var l,d,f,m,p,y,g,x;const s=Mo(),r=(t==null?void 0:t.locale)??s.locale??sx,i=(t==null?void 0:t.firstWeekContainsDate)??((d=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:d.firstWeekContainsDate)??s.firstWeekContainsDate??((m=(f=s.locale)==null?void 0:f.options)==null?void 0:m.firstWeekContainsDate)??1,o=(t==null?void 0:t.weekStartsOn)??((y=(p=t==null?void 0:t.locale)==null?void 0:p.options)==null?void 0:y.weekStartsOn)??s.weekStartsOn??((x=(g=s.locale)==null?void 0:g.options)==null?void 0:x.weekStartsOn)??0,a=It(n);if(!bC(a))throw new RangeError("Invalid time value");const c={firstWeekContainsDate:i,weekStartsOn:o,locale:r,_originalDate:a};return e.match(gk).map(function(_){const v=_[0];if(v==="p"||v==="P"){const w=qf[v];return w(_,r.formatLong)}return _}).join("").match(pk).map(function(_){if(_==="''")return"'";const v=_[0];if(v==="'")return wk(_);const w=uk[v];if(w)return!(t!=null&&t.useAdditionalWeekYearTokens)&&cx(_)&&Hu(_,e,String(n)),!(t!=null&&t.useAdditionalDayOfYearTokens)&&ax(_)&&Hu(_,e,String(n)),w(a,_,r.localize,c);if(v.match(vk))throw new RangeError("Format string contains an unescaped latin alphabet character `"+v+"`");return _}).join("")}function wk(n){const e=n.match(yk);return e?e[1].replace(_k,"'"):n}function xk(){return Object.assign({},Mo())}function Ek(n){let t=It(n).getDay();return t===0&&(t=7),t}function Tk(n,e){const t=e instanceof Date?et(e,0):new e(0);return t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),t.setHours(n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()),t}const Ik=10;class ux{constructor(){h(this,"subPriority",0)}validate(e,t){return!0}}class Dk extends ux{constructor(e,t,s,r,i){super(),this.value=e,this.validateValue=t,this.setValue=s,this.priority=r,i&&(this.subPriority=i)}validate(e,t){return this.validateValue(e,this.value,t)}set(e,t,s){return this.setValue(e,t,this.value,s)}}class Ak extends ux{constructor(){super(...arguments);h(this,"priority",Ik);h(this,"subPriority",-1)}set(t,s){return s.timestampIsSet?t:et(t,Tk(t,Date))}}class Ce{run(e,t,s,r){const i=this.parse(e,t,s,r);return i?{setter:new Dk(i.value,this.validate,this.set,this.priority,this.subPriority),rest:i.rest}:null}validate(e,t,s){return!0}}class bk extends Ce{constructor(){super(...arguments);h(this,"priority",140);h(this,"incompatibleTokens",["R","u","t","T"])}parse(t,s,r){switch(s){case"G":case"GG":case"GGG":return r.era(t,{width:"abbreviated"})||r.era(t,{width:"narrow"});case"GGGGG":return r.era(t,{width:"narrow"});case"GGGG":default:return r.era(t,{width:"wide"})||r.era(t,{width:"abbreviated"})||r.era(t,{width:"narrow"})}}set(t,s,r){return s.era=r,t.setFullYear(r,0,1),t.setHours(0,0,0,0),t}}const ot={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},Gn={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function at(n,e){return n&&{value:e(n.value),rest:n.rest}}function Xe(n,e){const t=e.match(n);return t?{value:parseInt(t[0],10),rest:e.slice(t[0].length)}:null}function Jn(n,e){const t=e.match(n);if(!t)return null;if(t[0]==="Z")return{value:0,rest:e.slice(1)};const s=t[1]==="+"?1:-1,r=t[2]?parseInt(t[2],10):0,i=t[3]?parseInt(t[3],10):0,o=t[5]?parseInt(t[5],10):0;return{value:s*(r*xC+i*wC+o*EC),rest:e.slice(t[0].length)}}function lx(n){return Xe(ot.anyDigitsSigned,n)}function st(n,e){switch(n){case 1:return Xe(ot.singleDigit,e);case 2:return Xe(ot.twoDigits,e);case 3:return Xe(ot.threeDigits,e);case 4:return Xe(ot.fourDigits,e);default:return Xe(new RegExp("^\\d{1,"+n+"}"),e)}}function $u(n,e){switch(n){case 1:return Xe(ot.singleDigitSigned,e);case 2:return Xe(ot.twoDigitsSigned,e);case 3:return Xe(ot.threeDigitsSigned,e);case 4:return Xe(ot.fourDigitsSigned,e);default:return Xe(new RegExp("^-?\\d{1,"+n+"}"),e)}}function nm(n){switch(n){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function hx(n,e){const t=e>0,s=t?e:1-e;let r;if(s<=50)r=n||100;else{const i=s+50,o=Math.floor(i/100)*100,a=n>=i%100;r=n+o-(a?100:0)}return t?r:1-r}function dx(n){return n%400===0||n%4===0&&n%100!==0}class Ck extends Ce{constructor(){super(...arguments);h(this,"priority",130);h(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(t,s,r){const i=o=>({year:o,isTwoDigitYear:s==="yy"});switch(s){case"y":return at(st(4,t),i);case"yo":return at(r.ordinalNumber(t,{unit:"year"}),i);default:return at(st(s.length,t),i)}}validate(t,s){return s.isTwoDigitYear||s.year>0}set(t,s,r){const i=t.getFullYear();if(r.isTwoDigitYear){const a=hx(r.year,i);return t.setFullYear(a,0,1),t.setHours(0,0,0,0),t}const o=!("era"in s)||s.era===1?r.year:1-r.year;return t.setFullYear(o,0,1),t.setHours(0,0,0,0),t}}class kk extends Ce{constructor(){super(...arguments);h(this,"priority",130);h(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(t,s,r){const i=o=>({year:o,isTwoDigitYear:s==="YY"});switch(s){case"Y":return at(st(4,t),i);case"Yo":return at(r.ordinalNumber(t,{unit:"year"}),i);default:return at(st(s.length,t),i)}}validate(t,s){return s.isTwoDigitYear||s.year>0}set(t,s,r,i){const o=tm(t,i);if(r.isTwoDigitYear){const c=hx(r.year,o);return t.setFullYear(c,0,i.firstWeekContainsDate),t.setHours(0,0,0,0),_r(t,i)}const a=!("era"in s)||s.era===1?r.year:1-r.year;return t.setFullYear(a,0,i.firstWeekContainsDate),t.setHours(0,0,0,0),_r(t,i)}}class Sk extends Ce{constructor(){super(...arguments);h(this,"priority",130);h(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(t,s){return $u(s==="R"?4:s.length,t)}set(t,s,r){const i=et(t,0);return i.setFullYear(r,0,4),i.setHours(0,0,0,0),co(i)}}class Pk extends Ce{constructor(){super(...arguments);h(this,"priority",130);h(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(t,s){return $u(s==="u"?4:s.length,t)}set(t,s,r){return t.setFullYear(r,0,1),t.setHours(0,0,0,0),t}}class Rk extends Ce{constructor(){super(...arguments);h(this,"priority",120);h(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(t,s,r){switch(s){case"Q":case"QQ":return st(s.length,t);case"Qo":return r.ordinalNumber(t,{unit:"quarter"});case"QQQ":return r.quarter(t,{width:"abbreviated",context:"formatting"})||r.quarter(t,{width:"narrow",context:"formatting"});case"QQQQQ":return r.quarter(t,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(t,{width:"wide",context:"formatting"})||r.quarter(t,{width:"abbreviated",context:"formatting"})||r.quarter(t,{width:"narrow",context:"formatting"})}}validate(t,s){return s>=1&&s<=4}set(t,s,r){return t.setMonth((r-1)*3,1),t.setHours(0,0,0,0),t}}class Nk extends Ce{constructor(){super(...arguments);h(this,"priority",120);h(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(t,s,r){switch(s){case"q":case"qq":return st(s.length,t);case"qo":return r.ordinalNumber(t,{unit:"quarter"});case"qqq":return r.quarter(t,{width:"abbreviated",context:"standalone"})||r.quarter(t,{width:"narrow",context:"standalone"});case"qqqqq":return r.quarter(t,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(t,{width:"wide",context:"standalone"})||r.quarter(t,{width:"abbreviated",context:"standalone"})||r.quarter(t,{width:"narrow",context:"standalone"})}}validate(t,s){return s>=1&&s<=4}set(t,s,r){return t.setMonth((r-1)*3,1),t.setHours(0,0,0,0),t}}class Mk extends Ce{constructor(){super(...arguments);h(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);h(this,"priority",110)}parse(t,s,r){const i=o=>o-1;switch(s){case"M":return at(Xe(ot.month,t),i);case"MM":return at(st(2,t),i);case"Mo":return at(r.ordinalNumber(t,{unit:"month"}),i);case"MMM":return r.month(t,{width:"abbreviated",context:"formatting"})||r.month(t,{width:"narrow",context:"formatting"});case"MMMMM":return r.month(t,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(t,{width:"wide",context:"formatting"})||r.month(t,{width:"abbreviated",context:"formatting"})||r.month(t,{width:"narrow",context:"formatting"})}}validate(t,s){return s>=0&&s<=11}set(t,s,r){return t.setMonth(r,1),t.setHours(0,0,0,0),t}}class Ok extends Ce{constructor(){super(...arguments);h(this,"priority",110);h(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(t,s,r){const i=o=>o-1;switch(s){case"L":return at(Xe(ot.month,t),i);case"LL":return at(st(2,t),i);case"Lo":return at(r.ordinalNumber(t,{unit:"month"}),i);case"LLL":return r.month(t,{width:"abbreviated",context:"standalone"})||r.month(t,{width:"narrow",context:"standalone"});case"LLLLL":return r.month(t,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(t,{width:"wide",context:"standalone"})||r.month(t,{width:"abbreviated",context:"standalone"})||r.month(t,{width:"narrow",context:"standalone"})}}validate(t,s){return s>=0&&s<=11}set(t,s,r){return t.setMonth(r,1),t.setHours(0,0,0,0),t}}function Fk(n,e,t){const s=It(n),r=ix(s,t)-e;return s.setDate(s.getDate()-r*7),s}class Bk extends Ce{constructor(){super(...arguments);h(this,"priority",100);h(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(t,s,r){switch(s){case"w":return Xe(ot.week,t);case"wo":return r.ordinalNumber(t,{unit:"week"});default:return st(s.length,t)}}validate(t,s){return s>=1&&s<=53}set(t,s,r,i){return _r(Fk(t,r,i),i)}}function Lk(n,e){const t=It(n),s=rx(t)-e;return t.setDate(t.getDate()-s*7),t}class Vk extends Ce{constructor(){super(...arguments);h(this,"priority",100);h(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(t,s,r){switch(s){case"I":return Xe(ot.week,t);case"Io":return r.ordinalNumber(t,{unit:"week"});default:return st(s.length,t)}}validate(t,s){return s>=1&&s<=53}set(t,s,r){return co(Lk(t,r))}}const Uk=[31,28,31,30,31,30,31,31,30,31,30,31],Wk=[31,29,31,30,31,30,31,31,30,31,30,31];class Hk extends Ce{constructor(){super(...arguments);h(this,"priority",90);h(this,"subPriority",1);h(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(t,s,r){switch(s){case"d":return Xe(ot.date,t);case"do":return r.ordinalNumber(t,{unit:"date"});default:return st(s.length,t)}}validate(t,s){const r=t.getFullYear(),i=dx(r),o=t.getMonth();return i?s>=1&&s<=Wk[o]:s>=1&&s<=Uk[o]}set(t,s,r){return t.setDate(r),t.setHours(0,0,0,0),t}}class $k extends Ce{constructor(){super(...arguments);h(this,"priority",90);h(this,"subpriority",1);h(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(t,s,r){switch(s){case"D":case"DD":return Xe(ot.dayOfYear,t);case"Do":return r.ordinalNumber(t,{unit:"date"});default:return st(s.length,t)}}validate(t,s){const r=t.getFullYear();return dx(r)?s>=1&&s<=366:s>=1&&s<=365}set(t,s,r){return t.setMonth(0,r),t.setHours(0,0,0,0),t}}function sm(n,e,t){var d,f,m,p;const s=Mo(),r=(t==null?void 0:t.weekStartsOn)??((f=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:f.weekStartsOn)??s.weekStartsOn??((p=(m=s.locale)==null?void 0:m.options)==null?void 0:p.weekStartsOn)??0,i=It(n),o=i.getDay(),c=(e%7+7)%7,u=7-r,l=e<0||e>6?e-(o+u)%7:(c+u)%7-(o+u)%7;return em(i,l)}class qk extends Ce{constructor(){super(...arguments);h(this,"priority",90);h(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(t,s,r){switch(s){case"E":case"EE":case"EEE":return r.day(t,{width:"abbreviated",context:"formatting"})||r.day(t,{width:"short",context:"formatting"})||r.day(t,{width:"narrow",context:"formatting"});case"EEEEE":return r.day(t,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(t,{width:"short",context:"formatting"})||r.day(t,{width:"narrow",context:"formatting"});case"EEEE":default:return r.day(t,{width:"wide",context:"formatting"})||r.day(t,{width:"abbreviated",context:"formatting"})||r.day(t,{width:"short",context:"formatting"})||r.day(t,{width:"narrow",context:"formatting"})}}validate(t,s){return s>=0&&s<=6}set(t,s,r,i){return t=sm(t,r,i),t.setHours(0,0,0,0),t}}class Yk extends Ce{constructor(){super(...arguments);h(this,"priority",90);h(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(t,s,r,i){const o=a=>{const c=Math.floor((a-1)/7)*7;return(a+i.weekStartsOn+6)%7+c};switch(s){case"e":case"ee":return at(st(s.length,t),o);case"eo":return at(r.ordinalNumber(t,{unit:"day"}),o);case"eee":return r.day(t,{width:"abbreviated",context:"formatting"})||r.day(t,{width:"short",context:"formatting"})||r.day(t,{width:"narrow",context:"formatting"});case"eeeee":return r.day(t,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(t,{width:"short",context:"formatting"})||r.day(t,{width:"narrow",context:"formatting"});case"eeee":default:return r.day(t,{width:"wide",context:"formatting"})||r.day(t,{width:"abbreviated",context:"formatting"})||r.day(t,{width:"short",context:"formatting"})||r.day(t,{width:"narrow",context:"formatting"})}}validate(t,s){return s>=0&&s<=6}set(t,s,r,i){return t=sm(t,r,i),t.setHours(0,0,0,0),t}}class zk extends Ce{constructor(){super(...arguments);h(this,"priority",90);h(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(t,s,r,i){const o=a=>{const c=Math.floor((a-1)/7)*7;return(a+i.weekStartsOn+6)%7+c};switch(s){case"c":case"cc":return at(st(s.length,t),o);case"co":return at(r.ordinalNumber(t,{unit:"day"}),o);case"ccc":return r.day(t,{width:"abbreviated",context:"standalone"})||r.day(t,{width:"short",context:"standalone"})||r.day(t,{width:"narrow",context:"standalone"});case"ccccc":return r.day(t,{width:"narrow",context:"standalone"});case"cccccc":return r.day(t,{width:"short",context:"standalone"})||r.day(t,{width:"narrow",context:"standalone"});case"cccc":default:return r.day(t,{width:"wide",context:"standalone"})||r.day(t,{width:"abbreviated",context:"standalone"})||r.day(t,{width:"short",context:"standalone"})||r.day(t,{width:"narrow",context:"standalone"})}}validate(t,s){return s>=0&&s<=6}set(t,s,r,i){return t=sm(t,r,i),t.setHours(0,0,0,0),t}}function Gk(n,e){const t=It(n),s=Ek(t),r=e-s;return em(t,r)}class Jk extends Ce{constructor(){super(...arguments);h(this,"priority",90);h(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(t,s,r){const i=o=>o===0?7:o;switch(s){case"i":case"ii":return st(s.length,t);case"io":return r.ordinalNumber(t,{unit:"day"});case"iii":return at(r.day(t,{width:"abbreviated",context:"formatting"})||r.day(t,{width:"short",context:"formatting"})||r.day(t,{width:"narrow",context:"formatting"}),i);case"iiiii":return at(r.day(t,{width:"narrow",context:"formatting"}),i);case"iiiiii":return at(r.day(t,{width:"short",context:"formatting"})||r.day(t,{width:"narrow",context:"formatting"}),i);case"iiii":default:return at(r.day(t,{width:"wide",context:"formatting"})||r.day(t,{width:"abbreviated",context:"formatting"})||r.day(t,{width:"short",context:"formatting"})||r.day(t,{width:"narrow",context:"formatting"}),i)}}validate(t,s){return s>=1&&s<=7}set(t,s,r){return t=Gk(t,r),t.setHours(0,0,0,0),t}}class Qk extends Ce{constructor(){super(...arguments);h(this,"priority",80);h(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(t,s,r){switch(s){case"a":case"aa":case"aaa":return r.dayPeriod(t,{width:"abbreviated",context:"formatting"})||r.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaaa":return r.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(t,{width:"wide",context:"formatting"})||r.dayPeriod(t,{width:"abbreviated",context:"formatting"})||r.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,s,r){return t.setHours(nm(r),0,0,0),t}}class Kk extends Ce{constructor(){super(...arguments);h(this,"priority",80);h(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(t,s,r){switch(s){case"b":case"bb":case"bbb":return r.dayPeriod(t,{width:"abbreviated",context:"formatting"})||r.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbbb":return r.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(t,{width:"wide",context:"formatting"})||r.dayPeriod(t,{width:"abbreviated",context:"formatting"})||r.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,s,r){return t.setHours(nm(r),0,0,0),t}}class jk extends Ce{constructor(){super(...arguments);h(this,"priority",80);h(this,"incompatibleTokens",["a","b","t","T"])}parse(t,s,r){switch(s){case"B":case"BB":case"BBB":return r.dayPeriod(t,{width:"abbreviated",context:"formatting"})||r.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBBB":return r.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(t,{width:"wide",context:"formatting"})||r.dayPeriod(t,{width:"abbreviated",context:"formatting"})||r.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,s,r){return t.setHours(nm(r),0,0,0),t}}class Xk extends Ce{constructor(){super(...arguments);h(this,"priority",70);h(this,"incompatibleTokens",["H","K","k","t","T"])}parse(t,s,r){switch(s){case"h":return Xe(ot.hour12h,t);case"ho":return r.ordinalNumber(t,{unit:"hour"});default:return st(s.length,t)}}validate(t,s){return s>=1&&s<=12}set(t,s,r){const i=t.getHours()>=12;return i&&r<12?t.setHours(r+12,0,0,0):!i&&r===12?t.setHours(0,0,0,0):t.setHours(r,0,0,0),t}}class Zk extends Ce{constructor(){super(...arguments);h(this,"priority",70);h(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(t,s,r){switch(s){case"H":return Xe(ot.hour23h,t);case"Ho":return r.ordinalNumber(t,{unit:"hour"});default:return st(s.length,t)}}validate(t,s){return s>=0&&s<=23}set(t,s,r){return t.setHours(r,0,0,0),t}}class eS extends Ce{constructor(){super(...arguments);h(this,"priority",70);h(this,"incompatibleTokens",["h","H","k","t","T"])}parse(t,s,r){switch(s){case"K":return Xe(ot.hour11h,t);case"Ko":return r.ordinalNumber(t,{unit:"hour"});default:return st(s.length,t)}}validate(t,s){return s>=0&&s<=11}set(t,s,r){return t.getHours()>=12&&r<12?t.setHours(r+12,0,0,0):t.setHours(r,0,0,0),t}}class tS extends Ce{constructor(){super(...arguments);h(this,"priority",70);h(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(t,s,r){switch(s){case"k":return Xe(ot.hour24h,t);case"ko":return r.ordinalNumber(t,{unit:"hour"});default:return st(s.length,t)}}validate(t,s){return s>=1&&s<=24}set(t,s,r){const i=r<=24?r%24:r;return t.setHours(i,0,0,0),t}}class nS extends Ce{constructor(){super(...arguments);h(this,"priority",60);h(this,"incompatibleTokens",["t","T"])}parse(t,s,r){switch(s){case"m":return Xe(ot.minute,t);case"mo":return r.ordinalNumber(t,{unit:"minute"});default:return st(s.length,t)}}validate(t,s){return s>=0&&s<=59}set(t,s,r){return t.setMinutes(r,0,0),t}}class sS extends Ce{constructor(){super(...arguments);h(this,"priority",50);h(this,"incompatibleTokens",["t","T"])}parse(t,s,r){switch(s){case"s":return Xe(ot.second,t);case"so":return r.ordinalNumber(t,{unit:"second"});default:return st(s.length,t)}}validate(t,s){return s>=0&&s<=59}set(t,s,r){return t.setSeconds(r,0),t}}class rS extends Ce{constructor(){super(...arguments);h(this,"priority",30);h(this,"incompatibleTokens",["t","T"])}parse(t,s){const r=i=>Math.floor(i*Math.pow(10,-s.length+3));return at(st(s.length,t),r)}set(t,s,r){return t.setMilliseconds(r),t}}class iS extends Ce{constructor(){super(...arguments);h(this,"priority",10);h(this,"incompatibleTokens",["t","T","x"])}parse(t,s){switch(s){case"X":return Jn(Gn.basicOptionalMinutes,t);case"XX":return Jn(Gn.basic,t);case"XXXX":return Jn(Gn.basicOptionalSeconds,t);case"XXXXX":return Jn(Gn.extendedOptionalSeconds,t);case"XXX":default:return Jn(Gn.extended,t)}}set(t,s,r){return s.timestampIsSet?t:et(t,t.getTime()-Wu(t)-r)}}class oS extends Ce{constructor(){super(...arguments);h(this,"priority",10);h(this,"incompatibleTokens",["t","T","X"])}parse(t,s){switch(s){case"x":return Jn(Gn.basicOptionalMinutes,t);case"xx":return Jn(Gn.basic,t);case"xxxx":return Jn(Gn.basicOptionalSeconds,t);case"xxxxx":return Jn(Gn.extendedOptionalSeconds,t);case"xxx":default:return Jn(Gn.extended,t)}}set(t,s,r){return s.timestampIsSet?t:et(t,t.getTime()-Wu(t)-r)}}class aS extends Ce{constructor(){super(...arguments);h(this,"priority",40);h(this,"incompatibleTokens","*")}parse(t){return lx(t)}set(t,s,r){return[et(t,r*1e3),{timestampIsSet:!0}]}}class cS extends Ce{constructor(){super(...arguments);h(this,"priority",20);h(this,"incompatibleTokens","*")}parse(t){return lx(t)}set(t,s,r){return[et(t,r),{timestampIsSet:!0}]}}const uS={G:new bk,y:new Ck,Y:new kk,R:new Sk,u:new Pk,Q:new Rk,q:new Nk,M:new Mk,L:new Ok,w:new Bk,I:new Vk,d:new Hk,D:new $k,E:new qk,e:new Yk,c:new zk,i:new Jk,a:new Qk,b:new Kk,B:new jk,h:new Xk,H:new Zk,K:new eS,k:new tS,m:new nS,s:new sS,S:new rS,X:new iS,x:new oS,t:new aS,T:new cS},lS=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,hS=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,dS=/^'([^]*?)'?$/,fS=/''/g,mS=/\S/,pS=/[a-zA-Z]/;function gS(n,e,t,s){var y,g,x,_,v,w,I,D;const r=xk(),i=(s==null?void 0:s.locale)??r.locale??sx,o=(s==null?void 0:s.firstWeekContainsDate)??((g=(y=s==null?void 0:s.locale)==null?void 0:y.options)==null?void 0:g.firstWeekContainsDate)??r.firstWeekContainsDate??((_=(x=r.locale)==null?void 0:x.options)==null?void 0:_.firstWeekContainsDate)??1,a=(s==null?void 0:s.weekStartsOn)??((w=(v=s==null?void 0:s.locale)==null?void 0:v.options)==null?void 0:w.weekStartsOn)??r.weekStartsOn??((D=(I=r.locale)==null?void 0:I.options)==null?void 0:D.weekStartsOn)??0;if(e==="")return n===""?It(t):et(t,NaN);const c={firstWeekContainsDate:o,weekStartsOn:a,locale:i},u=[new Ak],l=e.match(hS).map(E=>{const A=E[0];if(A in qf){const C=qf[A];return C(E,i.formatLong)}return E}).join("").match(lS),d=[];for(let E of l){!(s!=null&&s.useAdditionalWeekYearTokens)&&cx(E)&&Hu(E,e,n),!(s!=null&&s.useAdditionalDayOfYearTokens)&&ax(E)&&Hu(E,e,n);const A=E[0],C=uS[A];if(C){const{incompatibleTokens:T}=C;if(Array.isArray(T)){const k=d.find(P=>T.includes(P.token)||P.token===A);if(k)throw new RangeError(`The format string mustn't contain \`${k.fullToken}\` and \`${E}\` at the same time`)}else if(C.incompatibleTokens==="*"&&d.length>0)throw new RangeError(`The format string mustn't contain \`${E}\` and any other token at the same time`);d.push({token:A,fullToken:E});const b=C.run(n,E,i.match,c);if(!b)return et(t,NaN);u.push(b.setter),n=b.rest}else{if(A.match(pS))throw new RangeError("Format string contains an unescaped latin alphabet character `"+A+"`");if(E==="''"?E="'":A==="'"&&(E=yS(E)),n.indexOf(E)===0)n=n.slice(E.length);else return et(t,NaN)}}if(n.length>0&&mS.test(n))return et(t,NaN);const f=u.map(E=>E.priority).sort((E,A)=>A-E).filter((E,A,C)=>C.indexOf(E)===A).map(E=>u.filter(A=>A.priority===E).sort((A,C)=>C.subPriority-A.subPriority)).map(E=>E[0]);let m=It(t);if(isNaN(m.getTime()))return et(t,NaN);const p={};for(const E of f){if(!E.validate(m,c))return et(t,NaN);const A=E.set(m,p,c);Array.isArray(A)?(m=A[0],Object.assign(p,A[1])):m=A}return et(t,m)}function yS(n){return n.match(dS)[1].replace(fS,"'")}function Ac(n,e,t,s){const r=t<n&&!(s>n),i=!(t<e)&&s>e;return r?"BEFORE":i?"AFTER":"STRIKE"}function Z(n,e){return new Date(n.getTime()+e.inMilliseconds)}function Fn(n,e){return new Date(n.getTime()-e.inMilliseconds)}function Gr(n,e){return new V({milliseconds:new Date(n.getTime()-e.getTime()).getTime()})}//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var fx;function W(){return fx.apply(null,arguments)}function _S(n){fx=n}function Hn(n){return n instanceof Array||Object.prototype.toString.call(n)==="[object Array]"}function Jr(n){return n!=null&&Object.prototype.toString.call(n)==="[object Object]"}function De(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function rm(n){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(n).length===0;var e;for(e in n)if(De(n,e))return!1;return!0}function rn(n){return n===void 0}function Ls(n){return typeof n=="number"||Object.prototype.toString.call(n)==="[object Number]"}function bc(n){return n instanceof Date||Object.prototype.toString.call(n)==="[object Date]"}function mx(n,e){var t=[],s,r=n.length;for(s=0;s<r;++s)t.push(e(n[s],s));return t}function ir(n,e){for(var t in e)De(e,t)&&(n[t]=e[t]);return De(e,"toString")&&(n.toString=e.toString),De(e,"valueOf")&&(n.valueOf=e.valueOf),n}function hs(n,e,t,s){return Bx(n,e,t,s,!0).utc()}function vS(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function ae(n){return n._pf==null&&(n._pf=vS()),n._pf}var Yf;Array.prototype.some?Yf=Array.prototype.some:Yf=function(n){var e=Object(this),t=e.length>>>0,s;for(s=0;s<t;s++)if(s in e&&n.call(this,e[s],s,e))return!0;return!1};function im(n){var e=null,t=!1,s=n._d&&!isNaN(n._d.getTime());if(s&&(e=ae(n),t=Yf.call(e.parsedDateParts,function(r){return r!=null}),s=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&t),n._strict&&(s=s&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(n))n._isValid=s;else return s;return n._isValid}function Yl(n){var e=hs(NaN);return n!=null?ir(ae(e),n):ae(e).userInvalidated=!0,e}var vy=W.momentProperties=[],fd=!1;function om(n,e){var t,s,r,i=vy.length;if(rn(e._isAMomentObject)||(n._isAMomentObject=e._isAMomentObject),rn(e._i)||(n._i=e._i),rn(e._f)||(n._f=e._f),rn(e._l)||(n._l=e._l),rn(e._strict)||(n._strict=e._strict),rn(e._tzm)||(n._tzm=e._tzm),rn(e._isUTC)||(n._isUTC=e._isUTC),rn(e._offset)||(n._offset=e._offset),rn(e._pf)||(n._pf=ae(e)),rn(e._locale)||(n._locale=e._locale),i>0)for(t=0;t<i;t++)s=vy[t],r=e[s],rn(r)||(n[s]=r);return n}function Cc(n){om(this,n),this._d=new Date(n._d!=null?n._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),fd===!1&&(fd=!0,W.updateOffset(this),fd=!1)}function $n(n){return n instanceof Cc||n!=null&&n._isAMomentObject!=null}function px(n){W.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+n)}function Sn(n,e){var t=!0;return ir(function(){if(W.deprecationHandler!=null&&W.deprecationHandler(null,n),t){var s=[],r,i,o,a=arguments.length;for(i=0;i<a;i++){if(r="",typeof arguments[i]=="object"){r+=`
[`+i+"] ";for(o in arguments[0])De(arguments[0],o)&&(r+=o+": "+arguments[0][o]+", ");r=r.slice(0,-2)}else r=arguments[i];s.push(r)}px(n+`
Arguments: `+Array.prototype.slice.call(s).join("")+`
`+new Error().stack),t=!1}return e.apply(this,arguments)},e)}var wy={};function gx(n,e){W.deprecationHandler!=null&&W.deprecationHandler(n,e),wy[n]||(px(e),wy[n]=!0)}W.suppressDeprecationWarnings=!1;W.deprecationHandler=null;function ds(n){return typeof Function<"u"&&n instanceof Function||Object.prototype.toString.call(n)==="[object Function]"}function wS(n){var e,t;for(t in n)De(n,t)&&(e=n[t],ds(e)?this[t]=e:this["_"+t]=e);this._config=n,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function zf(n,e){var t=ir({},n),s;for(s in e)De(e,s)&&(Jr(n[s])&&Jr(e[s])?(t[s]={},ir(t[s],n[s]),ir(t[s],e[s])):e[s]!=null?t[s]=e[s]:delete t[s]);for(s in n)De(n,s)&&!De(e,s)&&Jr(n[s])&&(t[s]=ir({},t[s]));return t}function am(n){n!=null&&this.set(n)}var Gf;Object.keys?Gf=Object.keys:Gf=function(n){var e,t=[];for(e in n)De(n,e)&&t.push(e);return t};var xS={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function ES(n,e,t){var s=this._calendar[n]||this._calendar.sameElse;return ds(s)?s.call(e,t):s}function os(n,e,t){var s=""+Math.abs(n),r=e-s.length,i=n>=0;return(i?t?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+s}var cm=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,uu=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,md={},$i={};function Q(n,e,t,s){var r=s;typeof s=="string"&&(r=function(){return this[s]()}),n&&($i[n]=r),e&&($i[e[0]]=function(){return os(r.apply(this,arguments),e[1],e[2])}),t&&($i[t]=function(){return this.localeData().ordinal(r.apply(this,arguments),n)})}function TS(n){return n.match(/\[[\s\S]/)?n.replace(/^\[|\]$/g,""):n.replace(/\\/g,"")}function IS(n){var e=n.match(cm),t,s;for(t=0,s=e.length;t<s;t++)$i[e[t]]?e[t]=$i[e[t]]:e[t]=TS(e[t]);return function(r){var i="",o;for(o=0;o<s;o++)i+=ds(e[o])?e[o].call(r,n):e[o];return i}}function Du(n,e){return n.isValid()?(e=yx(e,n.localeData()),md[e]=md[e]||IS(e),md[e](n)):n.localeData().invalidDate()}function yx(n,e){var t=5;function s(r){return e.longDateFormat(r)||r}for(uu.lastIndex=0;t>=0&&uu.test(n);)n=n.replace(uu,s),uu.lastIndex=0,t-=1;return n}var DS={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function AS(n){var e=this._longDateFormat[n],t=this._longDateFormat[n.toUpperCase()];return e||!t?e:(this._longDateFormat[n]=t.match(cm).map(function(s){return s==="MMMM"||s==="MM"||s==="DD"||s==="dddd"?s.slice(1):s}).join(""),this._longDateFormat[n])}var bS="Invalid date";function CS(){return this._invalidDate}var kS="%d",SS=/\d{1,2}/;function PS(n){return this._ordinal.replace("%d",n)}var RS={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function NS(n,e,t,s){var r=this._relativeTime[t];return ds(r)?r(n,e,t,s):r.replace(/%d/i,n)}function MS(n,e){var t=this._relativeTime[n>0?"future":"past"];return ds(t)?t(e):t.replace(/%s/i,e)}var xy={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Pn(n){return typeof n=="string"?xy[n]||xy[n.toLowerCase()]:void 0}function um(n){var e={},t,s;for(s in n)De(n,s)&&(t=Pn(s),t&&(e[t]=n[s]));return e}var OS={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function FS(n){var e=[],t;for(t in n)De(n,t)&&e.push({unit:t,priority:OS[t]});return e.sort(function(s,r){return s.priority-r.priority}),e}var _x=/\d/,wn=/\d\d/,vx=/\d{3}/,lm=/\d{4}/,zl=/[+-]?\d{6}/,ze=/\d\d?/,wx=/\d\d\d\d?/,xx=/\d\d\d\d\d\d?/,Gl=/\d{1,3}/,hm=/\d{1,4}/,Jl=/[+-]?\d{1,6}/,Oo=/\d+/,Ql=/[+-]?\d+/,BS=/Z|[+-]\d\d:?\d\d/gi,Kl=/Z|[+-]\d\d(?::?\d\d)?/gi,LS=/[+-]?\d+(\.\d{1,3})?/,kc=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Fo=/^[1-9]\d?/,dm=/^([1-9]\d|\d)/,qu;qu={};function H(n,e,t){qu[n]=ds(e)?e:function(s,r){return s&&t?t:e}}function VS(n,e){return De(qu,n)?qu[n](e._strict,e._locale):new RegExp(US(n))}function US(n){return Ns(n.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,s,r,i){return t||s||r||i}))}function Ns(n){return n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Dn(n){return n<0?Math.ceil(n)||0:Math.floor(n)}function ye(n){var e=+n,t=0;return e!==0&&isFinite(e)&&(t=Dn(e)),t}var Jf={};function Oe(n,e){var t,s=e,r;for(typeof n=="string"&&(n=[n]),Ls(e)&&(s=function(i,o){o[e]=ye(i)}),r=n.length,t=0;t<r;t++)Jf[n[t]]=s}function Sc(n,e){Oe(n,function(t,s,r,i){r._w=r._w||{},e(t,r._w,r,i)})}function WS(n,e,t){e!=null&&De(Jf,n)&&Jf[n](e,t._a,t,n)}function jl(n){return n%4===0&&n%100!==0||n%400===0}var Yt=0,Es=1,Qn=2,gt=3,Bn=4,Ts=5,Wr=6,HS=7,$S=8;Q("Y",0,0,function(){var n=this.year();return n<=9999?os(n,4):"+"+n});Q(0,["YY",2],0,function(){return this.year()%100});Q(0,["YYYY",4],0,"year");Q(0,["YYYYY",5],0,"year");Q(0,["YYYYYY",6,!0],0,"year");H("Y",Ql);H("YY",ze,wn);H("YYYY",hm,lm);H("YYYYY",Jl,zl);H("YYYYYY",Jl,zl);Oe(["YYYYY","YYYYYY"],Yt);Oe("YYYY",function(n,e){e[Yt]=n.length===2?W.parseTwoDigitYear(n):ye(n)});Oe("YY",function(n,e){e[Yt]=W.parseTwoDigitYear(n)});Oe("Y",function(n,e){e[Yt]=parseInt(n,10)});function Ta(n){return jl(n)?366:365}W.parseTwoDigitYear=function(n){return ye(n)+(ye(n)>68?1900:2e3)};var Ex=Bo("FullYear",!0);function qS(){return jl(this.year())}function Bo(n,e){return function(t){return t!=null?(Tx(this,n,t),W.updateOffset(this,e),this):za(this,n)}}function za(n,e){if(!n.isValid())return NaN;var t=n._d,s=n._isUTC;switch(e){case"Milliseconds":return s?t.getUTCMilliseconds():t.getMilliseconds();case"Seconds":return s?t.getUTCSeconds():t.getSeconds();case"Minutes":return s?t.getUTCMinutes():t.getMinutes();case"Hours":return s?t.getUTCHours():t.getHours();case"Date":return s?t.getUTCDate():t.getDate();case"Day":return s?t.getUTCDay():t.getDay();case"Month":return s?t.getUTCMonth():t.getMonth();case"FullYear":return s?t.getUTCFullYear():t.getFullYear();default:return NaN}}function Tx(n,e,t){var s,r,i,o,a;if(!(!n.isValid()||isNaN(t))){switch(s=n._d,r=n._isUTC,e){case"Milliseconds":return void(r?s.setUTCMilliseconds(t):s.setMilliseconds(t));case"Seconds":return void(r?s.setUTCSeconds(t):s.setSeconds(t));case"Minutes":return void(r?s.setUTCMinutes(t):s.setMinutes(t));case"Hours":return void(r?s.setUTCHours(t):s.setHours(t));case"Date":return void(r?s.setUTCDate(t):s.setDate(t));case"FullYear":break;default:return}i=t,o=n.month(),a=n.date(),a=a===29&&o===1&&!jl(i)?28:a,r?s.setUTCFullYear(i,o,a):s.setFullYear(i,o,a)}}function YS(n){return n=Pn(n),ds(this[n])?this[n]():this}function zS(n,e){if(typeof n=="object"){n=um(n);var t=FS(n),s,r=t.length;for(s=0;s<r;s++)this[t[s].unit](n[t[s].unit])}else if(n=Pn(n),ds(this[n]))return this[n](e);return this}function GS(n,e){return(n%e+e)%e}var it;Array.prototype.indexOf?it=Array.prototype.indexOf:it=function(n){var e;for(e=0;e<this.length;++e)if(this[e]===n)return e;return-1};function fm(n,e){if(isNaN(n)||isNaN(e))return NaN;var t=GS(e,12);return n+=(e-t)/12,t===1?jl(n)?29:28:31-t%7%2}Q("M",["MM",2],"Mo",function(){return this.month()+1});Q("MMM",0,0,function(n){return this.localeData().monthsShort(this,n)});Q("MMMM",0,0,function(n){return this.localeData().months(this,n)});H("M",ze,Fo);H("MM",ze,wn);H("MMM",function(n,e){return e.monthsShortRegex(n)});H("MMMM",function(n,e){return e.monthsRegex(n)});Oe(["M","MM"],function(n,e){e[Es]=ye(n)-1});Oe(["MMM","MMMM"],function(n,e,t,s){var r=t._locale.monthsParse(n,s,t._strict);r!=null?e[Es]=r:ae(t).invalidMonth=n});var JS="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Ix="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Dx=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,QS=kc,KS=kc;function jS(n,e){return n?Hn(this._months)?this._months[n.month()]:this._months[(this._months.isFormat||Dx).test(e)?"format":"standalone"][n.month()]:Hn(this._months)?this._months:this._months.standalone}function XS(n,e){return n?Hn(this._monthsShort)?this._monthsShort[n.month()]:this._monthsShort[Dx.test(e)?"format":"standalone"][n.month()]:Hn(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function ZS(n,e,t){var s,r,i,o=n.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],s=0;s<12;++s)i=hs([2e3,s]),this._shortMonthsParse[s]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[s]=this.months(i,"").toLocaleLowerCase();return t?e==="MMM"?(r=it.call(this._shortMonthsParse,o),r!==-1?r:null):(r=it.call(this._longMonthsParse,o),r!==-1?r:null):e==="MMM"?(r=it.call(this._shortMonthsParse,o),r!==-1?r:(r=it.call(this._longMonthsParse,o),r!==-1?r:null)):(r=it.call(this._longMonthsParse,o),r!==-1?r:(r=it.call(this._shortMonthsParse,o),r!==-1?r:null))}function eP(n,e,t){var s,r,i;if(this._monthsParseExact)return ZS.call(this,n,e,t);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),s=0;s<12;s++){if(r=hs([2e3,s]),t&&!this._longMonthsParse[s]&&(this._longMonthsParse[s]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[s]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),!t&&!this._monthsParse[s]&&(i="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[s]=new RegExp(i.replace(".",""),"i")),t&&e==="MMMM"&&this._longMonthsParse[s].test(n))return s;if(t&&e==="MMM"&&this._shortMonthsParse[s].test(n))return s;if(!t&&this._monthsParse[s].test(n))return s}}function Ax(n,e){if(!n.isValid())return n;if(typeof e=="string"){if(/^\d+$/.test(e))e=ye(e);else if(e=n.localeData().monthsParse(e),!Ls(e))return n}var t=e,s=n.date();return s=s<29?s:Math.min(s,fm(n.year(),t)),n._isUTC?n._d.setUTCMonth(t,s):n._d.setMonth(t,s),n}function bx(n){return n!=null?(Ax(this,n),W.updateOffset(this,!0),this):za(this,"Month")}function tP(){return fm(this.year(),this.month())}function nP(n){return this._monthsParseExact?(De(this,"_monthsRegex")||Cx.call(this),n?this._monthsShortStrictRegex:this._monthsShortRegex):(De(this,"_monthsShortRegex")||(this._monthsShortRegex=QS),this._monthsShortStrictRegex&&n?this._monthsShortStrictRegex:this._monthsShortRegex)}function sP(n){return this._monthsParseExact?(De(this,"_monthsRegex")||Cx.call(this),n?this._monthsStrictRegex:this._monthsRegex):(De(this,"_monthsRegex")||(this._monthsRegex=KS),this._monthsStrictRegex&&n?this._monthsStrictRegex:this._monthsRegex)}function Cx(){function n(c,u){return u.length-c.length}var e=[],t=[],s=[],r,i,o,a;for(r=0;r<12;r++)i=hs([2e3,r]),o=Ns(this.monthsShort(i,"")),a=Ns(this.months(i,"")),e.push(o),t.push(a),s.push(a),s.push(o);e.sort(n),t.sort(n),s.sort(n),this._monthsRegex=new RegExp("^("+s.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function rP(n,e,t,s,r,i,o){var a;return n<100&&n>=0?(a=new Date(n+400,e,t,s,r,i,o),isFinite(a.getFullYear())&&a.setFullYear(n)):a=new Date(n,e,t,s,r,i,o),a}function Ga(n){var e,t;return n<100&&n>=0?(t=Array.prototype.slice.call(arguments),t[0]=n+400,e=new Date(Date.UTC.apply(null,t)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(n)):e=new Date(Date.UTC.apply(null,arguments)),e}function Yu(n,e,t){var s=7+e-t,r=(7+Ga(n,0,s).getUTCDay()-e)%7;return-r+s-1}function kx(n,e,t,s,r){var i=(7+t-s)%7,o=Yu(n,s,r),a=1+7*(e-1)+i+o,c,u;return a<=0?(c=n-1,u=Ta(c)+a):a>Ta(n)?(c=n+1,u=a-Ta(n)):(c=n,u=a),{year:c,dayOfYear:u}}function Ja(n,e,t){var s=Yu(n.year(),e,t),r=Math.floor((n.dayOfYear()-s-1)/7)+1,i,o;return r<1?(o=n.year()-1,i=r+Ms(o,e,t)):r>Ms(n.year(),e,t)?(i=r-Ms(n.year(),e,t),o=n.year()+1):(o=n.year(),i=r),{week:i,year:o}}function Ms(n,e,t){var s=Yu(n,e,t),r=Yu(n+1,e,t);return(Ta(n)-s+r)/7}Q("w",["ww",2],"wo","week");Q("W",["WW",2],"Wo","isoWeek");H("w",ze,Fo);H("ww",ze,wn);H("W",ze,Fo);H("WW",ze,wn);Sc(["w","ww","W","WW"],function(n,e,t,s){e[s.substr(0,1)]=ye(n)});function iP(n){return Ja(n,this._week.dow,this._week.doy).week}var oP={dow:0,doy:6};function aP(){return this._week.dow}function cP(){return this._week.doy}function uP(n){var e=this.localeData().week(this);return n==null?e:this.add((n-e)*7,"d")}function lP(n){var e=Ja(this,1,4).week;return n==null?e:this.add((n-e)*7,"d")}Q("d",0,"do","day");Q("dd",0,0,function(n){return this.localeData().weekdaysMin(this,n)});Q("ddd",0,0,function(n){return this.localeData().weekdaysShort(this,n)});Q("dddd",0,0,function(n){return this.localeData().weekdays(this,n)});Q("e",0,0,"weekday");Q("E",0,0,"isoWeekday");H("d",ze);H("e",ze);H("E",ze);H("dd",function(n,e){return e.weekdaysMinRegex(n)});H("ddd",function(n,e){return e.weekdaysShortRegex(n)});H("dddd",function(n,e){return e.weekdaysRegex(n)});Sc(["dd","ddd","dddd"],function(n,e,t,s){var r=t._locale.weekdaysParse(n,s,t._strict);r!=null?e.d=r:ae(t).invalidWeekday=n});Sc(["d","e","E"],function(n,e,t,s){e[s]=ye(n)});function hP(n,e){return typeof n!="string"?n:isNaN(n)?(n=e.weekdaysParse(n),typeof n=="number"?n:null):parseInt(n,10)}function dP(n,e){return typeof n=="string"?e.weekdaysParse(n)%7||7:isNaN(n)?null:n}function mm(n,e){return n.slice(e,7).concat(n.slice(0,e))}var fP="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Sx="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),mP="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),pP=kc,gP=kc,yP=kc;function _P(n,e){var t=Hn(this._weekdays)?this._weekdays:this._weekdays[n&&n!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return n===!0?mm(t,this._week.dow):n?t[n.day()]:t}function vP(n){return n===!0?mm(this._weekdaysShort,this._week.dow):n?this._weekdaysShort[n.day()]:this._weekdaysShort}function wP(n){return n===!0?mm(this._weekdaysMin,this._week.dow):n?this._weekdaysMin[n.day()]:this._weekdaysMin}function xP(n,e,t){var s,r,i,o=n.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],s=0;s<7;++s)i=hs([2e3,1]).day(s),this._minWeekdaysParse[s]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[s]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[s]=this.weekdays(i,"").toLocaleLowerCase();return t?e==="dddd"?(r=it.call(this._weekdaysParse,o),r!==-1?r:null):e==="ddd"?(r=it.call(this._shortWeekdaysParse,o),r!==-1?r:null):(r=it.call(this._minWeekdaysParse,o),r!==-1?r:null):e==="dddd"?(r=it.call(this._weekdaysParse,o),r!==-1||(r=it.call(this._shortWeekdaysParse,o),r!==-1)?r:(r=it.call(this._minWeekdaysParse,o),r!==-1?r:null)):e==="ddd"?(r=it.call(this._shortWeekdaysParse,o),r!==-1||(r=it.call(this._weekdaysParse,o),r!==-1)?r:(r=it.call(this._minWeekdaysParse,o),r!==-1?r:null)):(r=it.call(this._minWeekdaysParse,o),r!==-1||(r=it.call(this._weekdaysParse,o),r!==-1)?r:(r=it.call(this._shortWeekdaysParse,o),r!==-1?r:null))}function EP(n,e,t){var s,r,i;if(this._weekdaysParseExact)return xP.call(this,n,e,t);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),s=0;s<7;s++){if(r=hs([2e3,1]).day(s),t&&!this._fullWeekdaysParse[s]&&(this._fullWeekdaysParse[s]=new RegExp("^"+this.weekdays(r,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[s]=new RegExp("^"+this.weekdaysShort(r,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[s]=new RegExp("^"+this.weekdaysMin(r,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[s]||(i="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[s]=new RegExp(i.replace(".",""),"i")),t&&e==="dddd"&&this._fullWeekdaysParse[s].test(n))return s;if(t&&e==="ddd"&&this._shortWeekdaysParse[s].test(n))return s;if(t&&e==="dd"&&this._minWeekdaysParse[s].test(n))return s;if(!t&&this._weekdaysParse[s].test(n))return s}}function TP(n){if(!this.isValid())return n!=null?this:NaN;var e=za(this,"Day");return n!=null?(n=hP(n,this.localeData()),this.add(n-e,"d")):e}function IP(n){if(!this.isValid())return n!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return n==null?e:this.add(n-e,"d")}function DP(n){if(!this.isValid())return n!=null?this:NaN;if(n!=null){var e=dP(n,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function AP(n){return this._weekdaysParseExact?(De(this,"_weekdaysRegex")||pm.call(this),n?this._weekdaysStrictRegex:this._weekdaysRegex):(De(this,"_weekdaysRegex")||(this._weekdaysRegex=pP),this._weekdaysStrictRegex&&n?this._weekdaysStrictRegex:this._weekdaysRegex)}function bP(n){return this._weekdaysParseExact?(De(this,"_weekdaysRegex")||pm.call(this),n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(De(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=gP),this._weekdaysShortStrictRegex&&n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function CP(n){return this._weekdaysParseExact?(De(this,"_weekdaysRegex")||pm.call(this),n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(De(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=yP),this._weekdaysMinStrictRegex&&n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function pm(){function n(l,d){return d.length-l.length}var e=[],t=[],s=[],r=[],i,o,a,c,u;for(i=0;i<7;i++)o=hs([2e3,1]).day(i),a=Ns(this.weekdaysMin(o,"")),c=Ns(this.weekdaysShort(o,"")),u=Ns(this.weekdays(o,"")),e.push(a),t.push(c),s.push(u),r.push(a),r.push(c),r.push(u);e.sort(n),t.sort(n),s.sort(n),r.sort(n),this._weekdaysRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function gm(){return this.hours()%12||12}function kP(){return this.hours()||24}Q("H",["HH",2],0,"hour");Q("h",["hh",2],0,gm);Q("k",["kk",2],0,kP);Q("hmm",0,0,function(){return""+gm.apply(this)+os(this.minutes(),2)});Q("hmmss",0,0,function(){return""+gm.apply(this)+os(this.minutes(),2)+os(this.seconds(),2)});Q("Hmm",0,0,function(){return""+this.hours()+os(this.minutes(),2)});Q("Hmmss",0,0,function(){return""+this.hours()+os(this.minutes(),2)+os(this.seconds(),2)});function Px(n,e){Q(n,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}Px("a",!0);Px("A",!1);function Rx(n,e){return e._meridiemParse}H("a",Rx);H("A",Rx);H("H",ze,dm);H("h",ze,Fo);H("k",ze,Fo);H("HH",ze,wn);H("hh",ze,wn);H("kk",ze,wn);H("hmm",wx);H("hmmss",xx);H("Hmm",wx);H("Hmmss",xx);Oe(["H","HH"],gt);Oe(["k","kk"],function(n,e,t){var s=ye(n);e[gt]=s===24?0:s});Oe(["a","A"],function(n,e,t){t._isPm=t._locale.isPM(n),t._meridiem=n});Oe(["h","hh"],function(n,e,t){e[gt]=ye(n),ae(t).bigHour=!0});Oe("hmm",function(n,e,t){var s=n.length-2;e[gt]=ye(n.substr(0,s)),e[Bn]=ye(n.substr(s)),ae(t).bigHour=!0});Oe("hmmss",function(n,e,t){var s=n.length-4,r=n.length-2;e[gt]=ye(n.substr(0,s)),e[Bn]=ye(n.substr(s,2)),e[Ts]=ye(n.substr(r)),ae(t).bigHour=!0});Oe("Hmm",function(n,e,t){var s=n.length-2;e[gt]=ye(n.substr(0,s)),e[Bn]=ye(n.substr(s))});Oe("Hmmss",function(n,e,t){var s=n.length-4,r=n.length-2;e[gt]=ye(n.substr(0,s)),e[Bn]=ye(n.substr(s,2)),e[Ts]=ye(n.substr(r))});function SP(n){return(n+"").toLowerCase().charAt(0)==="p"}var PP=/[ap]\.?m?\.?/i,RP=Bo("Hours",!0);function NP(n,e,t){return n>11?t?"pm":"PM":t?"am":"AM"}var Nx={calendar:xS,longDateFormat:DS,invalidDate:bS,ordinal:kS,dayOfMonthOrdinalParse:SS,relativeTime:RS,months:JS,monthsShort:Ix,week:oP,weekdays:fP,weekdaysMin:mP,weekdaysShort:Sx,meridiemParse:PP},Je={},ia={},Qa;function MP(n,e){var t,s=Math.min(n.length,e.length);for(t=0;t<s;t+=1)if(n[t]!==e[t])return t;return s}function Ey(n){return n&&n.toLowerCase().replace("_","-")}function OP(n){for(var e=0,t,s,r,i;e<n.length;){for(i=Ey(n[e]).split("-"),t=i.length,s=Ey(n[e+1]),s=s?s.split("-"):null;t>0;){if(r=Xl(i.slice(0,t).join("-")),r)return r;if(s&&s.length>=t&&MP(i,s)>=t-1)break;t--}e++}return Qa}function FP(n){return!!(n&&n.match("^[^/\\\\]*$"))}function Xl(n){var e=null,t;if(Je[n]===void 0&&typeof module<"u"&&module&&module.exports&&FP(n))try{e=Qa._abbr,t=require,t("./locale/"+n),hr(e)}catch{Je[n]=null}return Je[n]}function hr(n,e){var t;return n&&(rn(e)?t=Gs(n):t=ym(n,e),t?Qa=t:typeof console<"u"&&console.warn&&console.warn("Locale "+n+" not found. Did you forget to load it?")),Qa._abbr}function ym(n,e){if(e!==null){var t,s=Nx;if(e.abbr=n,Je[n]!=null)gx("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),s=Je[n]._config;else if(e.parentLocale!=null)if(Je[e.parentLocale]!=null)s=Je[e.parentLocale]._config;else if(t=Xl(e.parentLocale),t!=null)s=t._config;else return ia[e.parentLocale]||(ia[e.parentLocale]=[]),ia[e.parentLocale].push({name:n,config:e}),null;return Je[n]=new am(zf(s,e)),ia[n]&&ia[n].forEach(function(r){ym(r.name,r.config)}),hr(n),Je[n]}else return delete Je[n],null}function BP(n,e){if(e!=null){var t,s,r=Nx;Je[n]!=null&&Je[n].parentLocale!=null?Je[n].set(zf(Je[n]._config,e)):(s=Xl(n),s!=null&&(r=s._config),e=zf(r,e),s==null&&(e.abbr=n),t=new am(e),t.parentLocale=Je[n],Je[n]=t),hr(n)}else Je[n]!=null&&(Je[n].parentLocale!=null?(Je[n]=Je[n].parentLocale,n===hr()&&hr(n)):Je[n]!=null&&delete Je[n]);return Je[n]}function Gs(n){var e;if(n&&n._locale&&n._locale._abbr&&(n=n._locale._abbr),!n)return Qa;if(!Hn(n)){if(e=Xl(n),e)return e;n=[n]}return OP(n)}function LP(){return Gf(Je)}function _m(n){var e,t=n._a;return t&&ae(n).overflow===-2&&(e=t[Es]<0||t[Es]>11?Es:t[Qn]<1||t[Qn]>fm(t[Yt],t[Es])?Qn:t[gt]<0||t[gt]>24||t[gt]===24&&(t[Bn]!==0||t[Ts]!==0||t[Wr]!==0)?gt:t[Bn]<0||t[Bn]>59?Bn:t[Ts]<0||t[Ts]>59?Ts:t[Wr]<0||t[Wr]>999?Wr:-1,ae(n)._overflowDayOfYear&&(e<Yt||e>Qn)&&(e=Qn),ae(n)._overflowWeeks&&e===-1&&(e=HS),ae(n)._overflowWeekday&&e===-1&&(e=$S),ae(n).overflow=e),n}var VP=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,UP=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,WP=/Z|[+-]\d\d(?::?\d\d)?/,lu=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],pd=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],HP=/^\/?Date\((-?\d+)/i,$P=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,qP={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Mx(n){var e,t,s=n._i,r=VP.exec(s)||UP.exec(s),i,o,a,c,u=lu.length,l=pd.length;if(r){for(ae(n).iso=!0,e=0,t=u;e<t;e++)if(lu[e][1].exec(r[1])){o=lu[e][0],i=lu[e][2]!==!1;break}if(o==null){n._isValid=!1;return}if(r[3]){for(e=0,t=l;e<t;e++)if(pd[e][1].exec(r[3])){a=(r[2]||" ")+pd[e][0];break}if(a==null){n._isValid=!1;return}}if(!i&&a!=null){n._isValid=!1;return}if(r[4])if(WP.exec(r[4]))c="Z";else{n._isValid=!1;return}n._f=o+(a||"")+(c||""),wm(n)}else n._isValid=!1}function YP(n,e,t,s,r,i){var o=[zP(n),Ix.indexOf(e),parseInt(t,10),parseInt(s,10),parseInt(r,10)];return i&&o.push(parseInt(i,10)),o}function zP(n){var e=parseInt(n,10);return e<=49?2e3+e:e<=999?1900+e:e}function GP(n){return n.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function JP(n,e,t){if(n){var s=Sx.indexOf(n),r=new Date(e[0],e[1],e[2]).getDay();if(s!==r)return ae(t).weekdayMismatch=!0,t._isValid=!1,!1}return!0}function QP(n,e,t){if(n)return qP[n];if(e)return 0;var s=parseInt(t,10),r=s%100,i=(s-r)/100;return i*60+r}function Ox(n){var e=$P.exec(GP(n._i)),t;if(e){if(t=YP(e[4],e[3],e[2],e[5],e[6],e[7]),!JP(e[1],t,n))return;n._a=t,n._tzm=QP(e[8],e[9],e[10]),n._d=Ga.apply(null,n._a),n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm),ae(n).rfc2822=!0}else n._isValid=!1}function KP(n){var e=HP.exec(n._i);if(e!==null){n._d=new Date(+e[1]);return}if(Mx(n),n._isValid===!1)delete n._isValid;else return;if(Ox(n),n._isValid===!1)delete n._isValid;else return;n._strict?n._isValid=!1:W.createFromInputFallback(n)}W.createFromInputFallback=Sn("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(n){n._d=new Date(n._i+(n._useUTC?" UTC":""))});function Ni(n,e,t){return n??e??t}function jP(n){var e=new Date(W.now());return n._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function vm(n){var e,t,s=[],r,i,o;if(!n._d){for(r=jP(n),n._w&&n._a[Qn]==null&&n._a[Es]==null&&XP(n),n._dayOfYear!=null&&(o=Ni(n._a[Yt],r[Yt]),(n._dayOfYear>Ta(o)||n._dayOfYear===0)&&(ae(n)._overflowDayOfYear=!0),t=Ga(o,0,n._dayOfYear),n._a[Es]=t.getUTCMonth(),n._a[Qn]=t.getUTCDate()),e=0;e<3&&n._a[e]==null;++e)n._a[e]=s[e]=r[e];for(;e<7;e++)n._a[e]=s[e]=n._a[e]==null?e===2?1:0:n._a[e];n._a[gt]===24&&n._a[Bn]===0&&n._a[Ts]===0&&n._a[Wr]===0&&(n._nextDay=!0,n._a[gt]=0),n._d=(n._useUTC?Ga:rP).apply(null,s),i=n._useUTC?n._d.getUTCDay():n._d.getDay(),n._tzm!=null&&n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm),n._nextDay&&(n._a[gt]=24),n._w&&typeof n._w.d<"u"&&n._w.d!==i&&(ae(n).weekdayMismatch=!0)}}function XP(n){var e,t,s,r,i,o,a,c,u;e=n._w,e.GG!=null||e.W!=null||e.E!=null?(i=1,o=4,t=Ni(e.GG,n._a[Yt],Ja(Ye(),1,4).year),s=Ni(e.W,1),r=Ni(e.E,1),(r<1||r>7)&&(c=!0)):(i=n._locale._week.dow,o=n._locale._week.doy,u=Ja(Ye(),i,o),t=Ni(e.gg,n._a[Yt],u.year),s=Ni(e.w,u.week),e.d!=null?(r=e.d,(r<0||r>6)&&(c=!0)):e.e!=null?(r=e.e+i,(e.e<0||e.e>6)&&(c=!0)):r=i),s<1||s>Ms(t,i,o)?ae(n)._overflowWeeks=!0:c!=null?ae(n)._overflowWeekday=!0:(a=kx(t,s,r,i,o),n._a[Yt]=a.year,n._dayOfYear=a.dayOfYear)}W.ISO_8601=function(){};W.RFC_2822=function(){};function wm(n){if(n._f===W.ISO_8601){Mx(n);return}if(n._f===W.RFC_2822){Ox(n);return}n._a=[],ae(n).empty=!0;var e=""+n._i,t,s,r,i,o,a=e.length,c=0,u,l;for(r=yx(n._f,n._locale).match(cm)||[],l=r.length,t=0;t<l;t++)i=r[t],s=(e.match(VS(i,n))||[])[0],s&&(o=e.substr(0,e.indexOf(s)),o.length>0&&ae(n).unusedInput.push(o),e=e.slice(e.indexOf(s)+s.length),c+=s.length),$i[i]?(s?ae(n).empty=!1:ae(n).unusedTokens.push(i),WS(i,s,n)):n._strict&&!s&&ae(n).unusedTokens.push(i);ae(n).charsLeftOver=a-c,e.length>0&&ae(n).unusedInput.push(e),n._a[gt]<=12&&ae(n).bigHour===!0&&n._a[gt]>0&&(ae(n).bigHour=void 0),ae(n).parsedDateParts=n._a.slice(0),ae(n).meridiem=n._meridiem,n._a[gt]=ZP(n._locale,n._a[gt],n._meridiem),u=ae(n).era,u!==null&&(n._a[Yt]=n._locale.erasConvertYear(u,n._a[Yt])),vm(n),_m(n)}function ZP(n,e,t){var s;return t==null?e:n.meridiemHour!=null?n.meridiemHour(e,t):(n.isPM!=null&&(s=n.isPM(t),s&&e<12&&(e+=12),!s&&e===12&&(e=0)),e)}function eR(n){var e,t,s,r,i,o,a=!1,c=n._f.length;if(c===0){ae(n).invalidFormat=!0,n._d=new Date(NaN);return}for(r=0;r<c;r++)i=0,o=!1,e=om({},n),n._useUTC!=null&&(e._useUTC=n._useUTC),e._f=n._f[r],wm(e),im(e)&&(o=!0),i+=ae(e).charsLeftOver,i+=ae(e).unusedTokens.length*10,ae(e).score=i,a?i<s&&(s=i,t=e):(s==null||i<s||o)&&(s=i,t=e,o&&(a=!0));ir(n,t||e)}function tR(n){if(!n._d){var e=um(n._i),t=e.day===void 0?e.date:e.day;n._a=mx([e.year,e.month,t,e.hour,e.minute,e.second,e.millisecond],function(s){return s&&parseInt(s,10)}),vm(n)}}function nR(n){var e=new Cc(_m(Fx(n)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function Fx(n){var e=n._i,t=n._f;return n._locale=n._locale||Gs(n._l),e===null||t===void 0&&e===""?Yl({nullInput:!0}):(typeof e=="string"&&(n._i=e=n._locale.preparse(e)),$n(e)?new Cc(_m(e)):(bc(e)?n._d=e:Hn(t)?eR(n):t?wm(n):sR(n),im(n)||(n._d=null),n))}function sR(n){var e=n._i;rn(e)?n._d=new Date(W.now()):bc(e)?n._d=new Date(e.valueOf()):typeof e=="string"?KP(n):Hn(e)?(n._a=mx(e.slice(0),function(t){return parseInt(t,10)}),vm(n)):Jr(e)?tR(n):Ls(e)?n._d=new Date(e):W.createFromInputFallback(n)}function Bx(n,e,t,s,r){var i={};return(e===!0||e===!1)&&(s=e,e=void 0),(t===!0||t===!1)&&(s=t,t=void 0),(Jr(n)&&rm(n)||Hn(n)&&n.length===0)&&(n=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=r,i._l=t,i._i=n,i._f=e,i._strict=s,nR(i)}function Ye(n,e,t,s){return Bx(n,e,t,s,!1)}var rR=Sn("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=Ye.apply(null,arguments);return this.isValid()&&n.isValid()?n<this?this:n:Yl()}),iR=Sn("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=Ye.apply(null,arguments);return this.isValid()&&n.isValid()?n>this?this:n:Yl()});function Lx(n,e){var t,s;if(e.length===1&&Hn(e[0])&&(e=e[0]),!e.length)return Ye();for(t=e[0],s=1;s<e.length;++s)(!e[s].isValid()||e[s][n](t))&&(t=e[s]);return t}function oR(){var n=[].slice.call(arguments,0);return Lx("isBefore",n)}function aR(){var n=[].slice.call(arguments,0);return Lx("isAfter",n)}var cR=function(){return Date.now?Date.now():+new Date},oa=["year","quarter","month","week","day","hour","minute","second","millisecond"];function uR(n){var e,t=!1,s,r=oa.length;for(e in n)if(De(n,e)&&!(it.call(oa,e)!==-1&&(n[e]==null||!isNaN(n[e]))))return!1;for(s=0;s<r;++s)if(n[oa[s]]){if(t)return!1;parseFloat(n[oa[s]])!==ye(n[oa[s]])&&(t=!0)}return!0}function lR(){return this._isValid}function hR(){return Yn(NaN)}function Zl(n){var e=um(n),t=e.year||0,s=e.quarter||0,r=e.month||0,i=e.week||e.isoWeek||0,o=e.day||0,a=e.hour||0,c=e.minute||0,u=e.second||0,l=e.millisecond||0;this._isValid=uR(e),this._milliseconds=+l+u*1e3+c*6e4+a*1e3*60*60,this._days=+o+i*7,this._months=+r+s*3+t*12,this._data={},this._locale=Gs(),this._bubble()}function Au(n){return n instanceof Zl}function Qf(n){return n<0?Math.round(-1*n)*-1:Math.round(n)}function dR(n,e,t){var s=Math.min(n.length,e.length),r=Math.abs(n.length-e.length),i=0,o;for(o=0;o<s;o++)(t&&n[o]!==e[o]||!t&&ye(n[o])!==ye(e[o]))&&i++;return i+r}function Vx(n,e){Q(n,0,0,function(){var t=this.utcOffset(),s="+";return t<0&&(t=-t,s="-"),s+os(~~(t/60),2)+e+os(~~t%60,2)})}Vx("Z",":");Vx("ZZ","");H("Z",Kl);H("ZZ",Kl);Oe(["Z","ZZ"],function(n,e,t){t._useUTC=!0,t._tzm=xm(Kl,n)});var fR=/([\+\-]|\d\d)/gi;function xm(n,e){var t=(e||"").match(n),s,r,i;return t===null?null:(s=t[t.length-1]||[],r=(s+"").match(fR)||["-",0,0],i=+(r[1]*60)+ye(r[2]),i===0?0:r[0]==="+"?i:-i)}function Em(n,e){var t,s;return e._isUTC?(t=e.clone(),s=($n(n)||bc(n)?n.valueOf():Ye(n).valueOf())-t.valueOf(),t._d.setTime(t._d.valueOf()+s),W.updateOffset(t,!1),t):Ye(n).local()}function Kf(n){return-Math.round(n._d.getTimezoneOffset())}W.updateOffset=function(){};function mR(n,e,t){var s=this._offset||0,r;if(!this.isValid())return n!=null?this:NaN;if(n!=null){if(typeof n=="string"){if(n=xm(Kl,n),n===null)return this}else Math.abs(n)<16&&!t&&(n=n*60);return!this._isUTC&&e&&(r=Kf(this)),this._offset=n,this._isUTC=!0,r!=null&&this.add(r,"m"),s!==n&&(!e||this._changeInProgress?Hx(this,Yn(n-s,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,W.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?s:Kf(this)}function pR(n,e){return n!=null?(typeof n!="string"&&(n=-n),this.utcOffset(n,e),this):-this.utcOffset()}function gR(n){return this.utcOffset(0,n)}function yR(n){return this._isUTC&&(this.utcOffset(0,n),this._isUTC=!1,n&&this.subtract(Kf(this),"m")),this}function _R(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var n=xm(BS,this._i);n!=null?this.utcOffset(n):this.utcOffset(0,!0)}return this}function vR(n){return this.isValid()?(n=n?Ye(n).utcOffset():0,(this.utcOffset()-n)%60===0):!1}function wR(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function xR(){if(!rn(this._isDSTShifted))return this._isDSTShifted;var n={},e;return om(n,this),n=Fx(n),n._a?(e=n._isUTC?hs(n._a):Ye(n._a),this._isDSTShifted=this.isValid()&&dR(n._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function ER(){return this.isValid()?!this._isUTC:!1}function TR(){return this.isValid()?this._isUTC:!1}function Ux(){return this.isValid()?this._isUTC&&this._offset===0:!1}var IR=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,DR=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Yn(n,e){var t=n,s=null,r,i,o;return Au(n)?t={ms:n._milliseconds,d:n._days,M:n._months}:Ls(n)||!isNaN(+n)?(t={},e?t[e]=+n:t.milliseconds=+n):(s=IR.exec(n))?(r=s[1]==="-"?-1:1,t={y:0,d:ye(s[Qn])*r,h:ye(s[gt])*r,m:ye(s[Bn])*r,s:ye(s[Ts])*r,ms:ye(Qf(s[Wr]*1e3))*r}):(s=DR.exec(n))?(r=s[1]==="-"?-1:1,t={y:Pr(s[2],r),M:Pr(s[3],r),w:Pr(s[4],r),d:Pr(s[5],r),h:Pr(s[6],r),m:Pr(s[7],r),s:Pr(s[8],r)}):t==null?t={}:typeof t=="object"&&("from"in t||"to"in t)&&(o=AR(Ye(t.from),Ye(t.to)),t={},t.ms=o.milliseconds,t.M=o.months),i=new Zl(t),Au(n)&&De(n,"_locale")&&(i._locale=n._locale),Au(n)&&De(n,"_isValid")&&(i._isValid=n._isValid),i}Yn.fn=Zl.prototype;Yn.invalid=hR;function Pr(n,e){var t=n&&parseFloat(n.replace(",","."));return(isNaN(t)?0:t)*e}function Ty(n,e){var t={};return t.months=e.month()-n.month()+(e.year()-n.year())*12,n.clone().add(t.months,"M").isAfter(e)&&--t.months,t.milliseconds=+e-+n.clone().add(t.months,"M"),t}function AR(n,e){var t;return n.isValid()&&e.isValid()?(e=Em(e,n),n.isBefore(e)?t=Ty(n,e):(t=Ty(e,n),t.milliseconds=-t.milliseconds,t.months=-t.months),t):{milliseconds:0,months:0}}function Wx(n,e){return function(t,s){var r,i;return s!==null&&!isNaN(+s)&&(gx(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=t,t=s,s=i),r=Yn(t,s),Hx(this,r,n),this}}function Hx(n,e,t,s){var r=e._milliseconds,i=Qf(e._days),o=Qf(e._months);n.isValid()&&(s=s??!0,o&&Ax(n,za(n,"Month")+o*t),i&&Tx(n,"Date",za(n,"Date")+i*t),r&&n._d.setTime(n._d.valueOf()+r*t),s&&W.updateOffset(n,i||o))}var bR=Wx(1,"add"),CR=Wx(-1,"subtract");function $x(n){return typeof n=="string"||n instanceof String}function kR(n){return $n(n)||bc(n)||$x(n)||Ls(n)||PR(n)||SR(n)||n===null||n===void 0}function SR(n){var e=Jr(n)&&!rm(n),t=!1,s=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],r,i,o=s.length;for(r=0;r<o;r+=1)i=s[r],t=t||De(n,i);return e&&t}function PR(n){var e=Hn(n),t=!1;return e&&(t=n.filter(function(s){return!Ls(s)&&$x(n)}).length===0),e&&t}function RR(n){var e=Jr(n)&&!rm(n),t=!1,s=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],r,i;for(r=0;r<s.length;r+=1)i=s[r],t=t||De(n,i);return e&&t}function NR(n,e){var t=n.diff(e,"days",!0);return t<-6?"sameElse":t<-1?"lastWeek":t<0?"lastDay":t<1?"sameDay":t<2?"nextDay":t<7?"nextWeek":"sameElse"}function MR(n,e){arguments.length===1&&(arguments[0]?kR(arguments[0])?(n=arguments[0],e=void 0):RR(arguments[0])&&(e=arguments[0],n=void 0):(n=void 0,e=void 0));var t=n||Ye(),s=Em(t,this).startOf("day"),r=W.calendarFormat(this,s)||"sameElse",i=e&&(ds(e[r])?e[r].call(this,t):e[r]);return this.format(i||this.localeData().calendar(r,this,Ye(t)))}function OR(){return new Cc(this)}function FR(n,e){var t=$n(n)?n:Ye(n);return this.isValid()&&t.isValid()?(e=Pn(e)||"millisecond",e==="millisecond"?this.valueOf()>t.valueOf():t.valueOf()<this.clone().startOf(e).valueOf()):!1}function BR(n,e){var t=$n(n)?n:Ye(n);return this.isValid()&&t.isValid()?(e=Pn(e)||"millisecond",e==="millisecond"?this.valueOf()<t.valueOf():this.clone().endOf(e).valueOf()<t.valueOf()):!1}function LR(n,e,t,s){var r=$n(n)?n:Ye(n),i=$n(e)?e:Ye(e);return this.isValid()&&r.isValid()&&i.isValid()?(s=s||"()",(s[0]==="("?this.isAfter(r,t):!this.isBefore(r,t))&&(s[1]===")"?this.isBefore(i,t):!this.isAfter(i,t))):!1}function VR(n,e){var t=$n(n)?n:Ye(n),s;return this.isValid()&&t.isValid()?(e=Pn(e)||"millisecond",e==="millisecond"?this.valueOf()===t.valueOf():(s=t.valueOf(),this.clone().startOf(e).valueOf()<=s&&s<=this.clone().endOf(e).valueOf())):!1}function UR(n,e){return this.isSame(n,e)||this.isAfter(n,e)}function WR(n,e){return this.isSame(n,e)||this.isBefore(n,e)}function HR(n,e,t){var s,r,i;if(!this.isValid())return NaN;if(s=Em(n,this),!s.isValid())return NaN;switch(r=(s.utcOffset()-this.utcOffset())*6e4,e=Pn(e),e){case"year":i=bu(this,s)/12;break;case"month":i=bu(this,s);break;case"quarter":i=bu(this,s)/3;break;case"second":i=(this-s)/1e3;break;case"minute":i=(this-s)/6e4;break;case"hour":i=(this-s)/36e5;break;case"day":i=(this-s-r)/864e5;break;case"week":i=(this-s-r)/6048e5;break;default:i=this-s}return t?i:Dn(i)}function bu(n,e){if(n.date()<e.date())return-bu(e,n);var t=(e.year()-n.year())*12+(e.month()-n.month()),s=n.clone().add(t,"months"),r,i;return e-s<0?(r=n.clone().add(t-1,"months"),i=(e-s)/(s-r)):(r=n.clone().add(t+1,"months"),i=(e-s)/(r-s)),-(t+i)||0}W.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";W.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function $R(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function qR(n){if(!this.isValid())return null;var e=n!==!0,t=e?this.clone().utc():this;return t.year()<0||t.year()>9999?Du(t,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):ds(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Du(t,"Z")):Du(t,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function YR(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var n="moment",e="",t,s,r,i;return this.isLocal()||(n=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),t="["+n+'("]',s=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",r="-MM-DD[T]HH:mm:ss.SSS",i=e+'[")]',this.format(t+s+r+i)}function zR(n){n||(n=this.isUtc()?W.defaultFormatUtc:W.defaultFormat);var e=Du(this,n);return this.localeData().postformat(e)}function GR(n,e){return this.isValid()&&($n(n)&&n.isValid()||Ye(n).isValid())?Yn({to:this,from:n}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function JR(n){return this.from(Ye(),n)}function QR(n,e){return this.isValid()&&($n(n)&&n.isValid()||Ye(n).isValid())?Yn({from:this,to:n}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function KR(n){return this.to(Ye(),n)}function qx(n){var e;return n===void 0?this._locale._abbr:(e=Gs(n),e!=null&&(this._locale=e),this)}var Yx=Sn("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(n){return n===void 0?this.localeData():this.locale(n)});function zx(){return this._locale}var zu=1e3,qi=60*zu,Gu=60*qi,Gx=(365*400+97)*24*Gu;function Yi(n,e){return(n%e+e)%e}function Jx(n,e,t){return n<100&&n>=0?new Date(n+400,e,t)-Gx:new Date(n,e,t).valueOf()}function Qx(n,e,t){return n<100&&n>=0?Date.UTC(n+400,e,t)-Gx:Date.UTC(n,e,t)}function jR(n){var e,t;if(n=Pn(n),n===void 0||n==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?Qx:Jx,n){case"year":e=t(this.year(),0,1);break;case"quarter":e=t(this.year(),this.month()-this.month()%3,1);break;case"month":e=t(this.year(),this.month(),1);break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=t(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Yi(e+(this._isUTC?0:this.utcOffset()*qi),Gu);break;case"minute":e=this._d.valueOf(),e-=Yi(e,qi);break;case"second":e=this._d.valueOf(),e-=Yi(e,zu);break}return this._d.setTime(e),W.updateOffset(this,!0),this}function XR(n){var e,t;if(n=Pn(n),n===void 0||n==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?Qx:Jx,n){case"year":e=t(this.year()+1,0,1)-1;break;case"quarter":e=t(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=t(this.year(),this.month()+1,1)-1;break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=t(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Gu-Yi(e+(this._isUTC?0:this.utcOffset()*qi),Gu)-1;break;case"minute":e=this._d.valueOf(),e+=qi-Yi(e,qi)-1;break;case"second":e=this._d.valueOf(),e+=zu-Yi(e,zu)-1;break}return this._d.setTime(e),W.updateOffset(this,!0),this}function ZR(){return this._d.valueOf()-(this._offset||0)*6e4}function eN(){return Math.floor(this.valueOf()/1e3)}function tN(){return new Date(this.valueOf())}function nN(){var n=this;return[n.year(),n.month(),n.date(),n.hour(),n.minute(),n.second(),n.millisecond()]}function sN(){var n=this;return{years:n.year(),months:n.month(),date:n.date(),hours:n.hours(),minutes:n.minutes(),seconds:n.seconds(),milliseconds:n.milliseconds()}}function rN(){return this.isValid()?this.toISOString():null}function iN(){return im(this)}function oN(){return ir({},ae(this))}function aN(){return ae(this).overflow}function cN(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Q("N",0,0,"eraAbbr");Q("NN",0,0,"eraAbbr");Q("NNN",0,0,"eraAbbr");Q("NNNN",0,0,"eraName");Q("NNNNN",0,0,"eraNarrow");Q("y",["y",1],"yo","eraYear");Q("y",["yy",2],0,"eraYear");Q("y",["yyy",3],0,"eraYear");Q("y",["yyyy",4],0,"eraYear");H("N",Tm);H("NN",Tm);H("NNN",Tm);H("NNNN",vN);H("NNNNN",wN);Oe(["N","NN","NNN","NNNN","NNNNN"],function(n,e,t,s){var r=t._locale.erasParse(n,s,t._strict);r?ae(t).era=r:ae(t).invalidEra=n});H("y",Oo);H("yy",Oo);H("yyy",Oo);H("yyyy",Oo);H("yo",xN);Oe(["y","yy","yyy","yyyy"],Yt);Oe(["yo"],function(n,e,t,s){var r;t._locale._eraYearOrdinalRegex&&(r=n.match(t._locale._eraYearOrdinalRegex)),t._locale.eraYearOrdinalParse?e[Yt]=t._locale.eraYearOrdinalParse(n,r):e[Yt]=parseInt(n,10)});function uN(n,e){var t,s,r,i=this._eras||Gs("en")._eras;for(t=0,s=i.length;t<s;++t){switch(typeof i[t].since){case"string":r=W(i[t].since).startOf("day"),i[t].since=r.valueOf();break}switch(typeof i[t].until){case"undefined":i[t].until=1/0;break;case"string":r=W(i[t].until).startOf("day").valueOf(),i[t].until=r.valueOf();break}}return i}function lN(n,e,t){var s,r,i=this.eras(),o,a,c;for(n=n.toUpperCase(),s=0,r=i.length;s<r;++s)if(o=i[s].name.toUpperCase(),a=i[s].abbr.toUpperCase(),c=i[s].narrow.toUpperCase(),t)switch(e){case"N":case"NN":case"NNN":if(a===n)return i[s];break;case"NNNN":if(o===n)return i[s];break;case"NNNNN":if(c===n)return i[s];break}else if([o,a,c].indexOf(n)>=0)return i[s]}function hN(n,e){var t=n.since<=n.until?1:-1;return e===void 0?W(n.since).year():W(n.since).year()+(e-n.offset)*t}function dN(){var n,e,t,s=this.localeData().eras();for(n=0,e=s.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),s[n].since<=t&&t<=s[n].until||s[n].until<=t&&t<=s[n].since)return s[n].name;return""}function fN(){var n,e,t,s=this.localeData().eras();for(n=0,e=s.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),s[n].since<=t&&t<=s[n].until||s[n].until<=t&&t<=s[n].since)return s[n].narrow;return""}function mN(){var n,e,t,s=this.localeData().eras();for(n=0,e=s.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),s[n].since<=t&&t<=s[n].until||s[n].until<=t&&t<=s[n].since)return s[n].abbr;return""}function pN(){var n,e,t,s,r=this.localeData().eras();for(n=0,e=r.length;n<e;++n)if(t=r[n].since<=r[n].until?1:-1,s=this.clone().startOf("day").valueOf(),r[n].since<=s&&s<=r[n].until||r[n].until<=s&&s<=r[n].since)return(this.year()-W(r[n].since).year())*t+r[n].offset;return this.year()}function gN(n){return De(this,"_erasNameRegex")||Im.call(this),n?this._erasNameRegex:this._erasRegex}function yN(n){return De(this,"_erasAbbrRegex")||Im.call(this),n?this._erasAbbrRegex:this._erasRegex}function _N(n){return De(this,"_erasNarrowRegex")||Im.call(this),n?this._erasNarrowRegex:this._erasRegex}function Tm(n,e){return e.erasAbbrRegex(n)}function vN(n,e){return e.erasNameRegex(n)}function wN(n,e){return e.erasNarrowRegex(n)}function xN(n,e){return e._eraYearOrdinalRegex||Oo}function Im(){var n=[],e=[],t=[],s=[],r,i,o,a,c,u=this.eras();for(r=0,i=u.length;r<i;++r)o=Ns(u[r].name),a=Ns(u[r].abbr),c=Ns(u[r].narrow),e.push(o),n.push(a),t.push(c),s.push(o),s.push(a),s.push(c);this._erasRegex=new RegExp("^("+s.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+t.join("|")+")","i")}Q(0,["gg",2],0,function(){return this.weekYear()%100});Q(0,["GG",2],0,function(){return this.isoWeekYear()%100});function eh(n,e){Q(0,[n,n.length],0,e)}eh("gggg","weekYear");eh("ggggg","weekYear");eh("GGGG","isoWeekYear");eh("GGGGG","isoWeekYear");H("G",Ql);H("g",Ql);H("GG",ze,wn);H("gg",ze,wn);H("GGGG",hm,lm);H("gggg",hm,lm);H("GGGGG",Jl,zl);H("ggggg",Jl,zl);Sc(["gggg","ggggg","GGGG","GGGGG"],function(n,e,t,s){e[s.substr(0,2)]=ye(n)});Sc(["gg","GG"],function(n,e,t,s){e[s]=W.parseTwoDigitYear(n)});function EN(n){return Kx.call(this,n,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function TN(n){return Kx.call(this,n,this.isoWeek(),this.isoWeekday(),1,4)}function IN(){return Ms(this.year(),1,4)}function DN(){return Ms(this.isoWeekYear(),1,4)}function AN(){var n=this.localeData()._week;return Ms(this.year(),n.dow,n.doy)}function bN(){var n=this.localeData()._week;return Ms(this.weekYear(),n.dow,n.doy)}function Kx(n,e,t,s,r){var i;return n==null?Ja(this,s,r).year:(i=Ms(n,s,r),e>i&&(e=i),CN.call(this,n,e,t,s,r))}function CN(n,e,t,s,r){var i=kx(n,e,t,s,r),o=Ga(i.year,0,i.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}Q("Q",0,"Qo","quarter");H("Q",_x);Oe("Q",function(n,e){e[Es]=(ye(n)-1)*3});function kN(n){return n==null?Math.ceil((this.month()+1)/3):this.month((n-1)*3+this.month()%3)}Q("D",["DD",2],"Do","date");H("D",ze,Fo);H("DD",ze,wn);H("Do",function(n,e){return n?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});Oe(["D","DD"],Qn);Oe("Do",function(n,e){e[Qn]=ye(n.match(ze)[0])});var jx=Bo("Date",!0);Q("DDD",["DDDD",3],"DDDo","dayOfYear");H("DDD",Gl);H("DDDD",vx);Oe(["DDD","DDDD"],function(n,e,t){t._dayOfYear=ye(n)});function SN(n){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return n==null?e:this.add(n-e,"d")}Q("m",["mm",2],0,"minute");H("m",ze,dm);H("mm",ze,wn);Oe(["m","mm"],Bn);var PN=Bo("Minutes",!1);Q("s",["ss",2],0,"second");H("s",ze,dm);H("ss",ze,wn);Oe(["s","ss"],Ts);var RN=Bo("Seconds",!1);Q("S",0,0,function(){return~~(this.millisecond()/100)});Q(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Q(0,["SSS",3],0,"millisecond");Q(0,["SSSS",4],0,function(){return this.millisecond()*10});Q(0,["SSSSS",5],0,function(){return this.millisecond()*100});Q(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Q(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Q(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Q(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});H("S",Gl,_x);H("SS",Gl,wn);H("SSS",Gl,vx);var or,Xx;for(or="SSSS";or.length<=9;or+="S")H(or,Oo);function NN(n,e){e[Wr]=ye(("0."+n)*1e3)}for(or="S";or.length<=9;or+="S")Oe(or,NN);Xx=Bo("Milliseconds",!1);Q("z",0,0,"zoneAbbr");Q("zz",0,0,"zoneName");function MN(){return this._isUTC?"UTC":""}function ON(){return this._isUTC?"Coordinated Universal Time":""}var B=Cc.prototype;B.add=bR;B.calendar=MR;B.clone=OR;B.diff=HR;B.endOf=XR;B.format=zR;B.from=GR;B.fromNow=JR;B.to=QR;B.toNow=KR;B.get=YS;B.invalidAt=aN;B.isAfter=FR;B.isBefore=BR;B.isBetween=LR;B.isSame=VR;B.isSameOrAfter=UR;B.isSameOrBefore=WR;B.isValid=iN;B.lang=Yx;B.locale=qx;B.localeData=zx;B.max=iR;B.min=rR;B.parsingFlags=oN;B.set=zS;B.startOf=jR;B.subtract=CR;B.toArray=nN;B.toObject=sN;B.toDate=tN;B.toISOString=qR;B.inspect=YR;typeof Symbol<"u"&&Symbol.for!=null&&(B[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});B.toJSON=rN;B.toString=$R;B.unix=eN;B.valueOf=ZR;B.creationData=cN;B.eraName=dN;B.eraNarrow=fN;B.eraAbbr=mN;B.eraYear=pN;B.year=Ex;B.isLeapYear=qS;B.weekYear=EN;B.isoWeekYear=TN;B.quarter=B.quarters=kN;B.month=bx;B.daysInMonth=tP;B.week=B.weeks=uP;B.isoWeek=B.isoWeeks=lP;B.weeksInYear=AN;B.weeksInWeekYear=bN;B.isoWeeksInYear=IN;B.isoWeeksInISOWeekYear=DN;B.date=jx;B.day=B.days=TP;B.weekday=IP;B.isoWeekday=DP;B.dayOfYear=SN;B.hour=B.hours=RP;B.minute=B.minutes=PN;B.second=B.seconds=RN;B.millisecond=B.milliseconds=Xx;B.utcOffset=mR;B.utc=gR;B.local=yR;B.parseZone=_R;B.hasAlignedHourOffset=vR;B.isDST=wR;B.isLocal=ER;B.isUtcOffset=TR;B.isUtc=Ux;B.isUTC=Ux;B.zoneAbbr=MN;B.zoneName=ON;B.dates=Sn("dates accessor is deprecated. Use date instead.",jx);B.months=Sn("months accessor is deprecated. Use month instead",bx);B.years=Sn("years accessor is deprecated. Use year instead",Ex);B.zone=Sn("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",pR);B.isDSTShifted=Sn("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",xR);function FN(n){return Ye(n*1e3)}function BN(){return Ye.apply(null,arguments).parseZone()}function Zx(n){return n}var Ae=am.prototype;Ae.calendar=ES;Ae.longDateFormat=AS;Ae.invalidDate=CS;Ae.ordinal=PS;Ae.preparse=Zx;Ae.postformat=Zx;Ae.relativeTime=NS;Ae.pastFuture=MS;Ae.set=wS;Ae.eras=uN;Ae.erasParse=lN;Ae.erasConvertYear=hN;Ae.erasAbbrRegex=yN;Ae.erasNameRegex=gN;Ae.erasNarrowRegex=_N;Ae.months=jS;Ae.monthsShort=XS;Ae.monthsParse=eP;Ae.monthsRegex=sP;Ae.monthsShortRegex=nP;Ae.week=iP;Ae.firstDayOfYear=cP;Ae.firstDayOfWeek=aP;Ae.weekdays=_P;Ae.weekdaysMin=wP;Ae.weekdaysShort=vP;Ae.weekdaysParse=EP;Ae.weekdaysRegex=AP;Ae.weekdaysShortRegex=bP;Ae.weekdaysMinRegex=CP;Ae.isPM=SP;Ae.meridiem=NP;function Ju(n,e,t,s){var r=Gs(),i=hs().set(s,e);return r[t](i,n)}function eE(n,e,t){if(Ls(n)&&(e=n,n=void 0),n=n||"",e!=null)return Ju(n,e,t,"month");var s,r=[];for(s=0;s<12;s++)r[s]=Ju(n,s,t,"month");return r}function Dm(n,e,t,s){typeof n=="boolean"?(Ls(e)&&(t=e,e=void 0),e=e||""):(e=n,t=e,n=!1,Ls(e)&&(t=e,e=void 0),e=e||"");var r=Gs(),i=n?r._week.dow:0,o,a=[];if(t!=null)return Ju(e,(t+i)%7,s,"day");for(o=0;o<7;o++)a[o]=Ju(e,(o+i)%7,s,"day");return a}function LN(n,e){return eE(n,e,"months")}function VN(n,e){return eE(n,e,"monthsShort")}function UN(n,e,t){return Dm(n,e,t,"weekdays")}function WN(n,e,t){return Dm(n,e,t,"weekdaysShort")}function HN(n,e,t){return Dm(n,e,t,"weekdaysMin")}hr("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(n){var e=n%10,t=ye(n%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return n+t}});W.lang=Sn("moment.lang is deprecated. Use moment.locale instead.",hr);W.langData=Sn("moment.langData is deprecated. Use moment.localeData instead.",Gs);var ms=Math.abs;function $N(){var n=this._data;return this._milliseconds=ms(this._milliseconds),this._days=ms(this._days),this._months=ms(this._months),n.milliseconds=ms(n.milliseconds),n.seconds=ms(n.seconds),n.minutes=ms(n.minutes),n.hours=ms(n.hours),n.months=ms(n.months),n.years=ms(n.years),this}function tE(n,e,t,s){var r=Yn(e,t);return n._milliseconds+=s*r._milliseconds,n._days+=s*r._days,n._months+=s*r._months,n._bubble()}function qN(n,e){return tE(this,n,e,1)}function YN(n,e){return tE(this,n,e,-1)}function Iy(n){return n<0?Math.floor(n):Math.ceil(n)}function zN(){var n=this._milliseconds,e=this._days,t=this._months,s=this._data,r,i,o,a,c;return n>=0&&e>=0&&t>=0||n<=0&&e<=0&&t<=0||(n+=Iy(jf(t)+e)*864e5,e=0,t=0),s.milliseconds=n%1e3,r=Dn(n/1e3),s.seconds=r%60,i=Dn(r/60),s.minutes=i%60,o=Dn(i/60),s.hours=o%24,e+=Dn(o/24),c=Dn(nE(e)),t+=c,e-=Iy(jf(c)),a=Dn(t/12),t%=12,s.days=e,s.months=t,s.years=a,this}function nE(n){return n*4800/146097}function jf(n){return n*146097/4800}function GN(n){if(!this.isValid())return NaN;var e,t,s=this._milliseconds;if(n=Pn(n),n==="month"||n==="quarter"||n==="year")switch(e=this._days+s/864e5,t=this._months+nE(e),n){case"month":return t;case"quarter":return t/3;case"year":return t/12}else switch(e=this._days+Math.round(jf(this._months)),n){case"week":return e/7+s/6048e5;case"day":return e+s/864e5;case"hour":return e*24+s/36e5;case"minute":return e*1440+s/6e4;case"second":return e*86400+s/1e3;case"millisecond":return Math.floor(e*864e5)+s;default:throw new Error("Unknown unit "+n)}}function Js(n){return function(){return this.as(n)}}var sE=Js("ms"),JN=Js("s"),QN=Js("m"),KN=Js("h"),jN=Js("d"),XN=Js("w"),ZN=Js("M"),eM=Js("Q"),tM=Js("y"),nM=sE;function sM(){return Yn(this)}function rM(n){return n=Pn(n),this.isValid()?this[n+"s"]():NaN}function pi(n){return function(){return this.isValid()?this._data[n]:NaN}}var iM=pi("milliseconds"),oM=pi("seconds"),aM=pi("minutes"),cM=pi("hours"),uM=pi("days"),lM=pi("months"),hM=pi("years");function dM(){return Dn(this.days()/7)}var ys=Math.round,Li={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function fM(n,e,t,s,r){return r.relativeTime(e||1,!!t,n,s)}function mM(n,e,t,s){var r=Yn(n).abs(),i=ys(r.as("s")),o=ys(r.as("m")),a=ys(r.as("h")),c=ys(r.as("d")),u=ys(r.as("M")),l=ys(r.as("w")),d=ys(r.as("y")),f=i<=t.ss&&["s",i]||i<t.s&&["ss",i]||o<=1&&["m"]||o<t.m&&["mm",o]||a<=1&&["h"]||a<t.h&&["hh",a]||c<=1&&["d"]||c<t.d&&["dd",c];return t.w!=null&&(f=f||l<=1&&["w"]||l<t.w&&["ww",l]),f=f||u<=1&&["M"]||u<t.M&&["MM",u]||d<=1&&["y"]||["yy",d],f[2]=e,f[3]=+n>0,f[4]=s,fM.apply(null,f)}function pM(n){return n===void 0?ys:typeof n=="function"?(ys=n,!0):!1}function gM(n,e){return Li[n]===void 0?!1:e===void 0?Li[n]:(Li[n]=e,n==="s"&&(Li.ss=e-1),!0)}function yM(n,e){if(!this.isValid())return this.localeData().invalidDate();var t=!1,s=Li,r,i;return typeof n=="object"&&(e=n,n=!1),typeof n=="boolean"&&(t=n),typeof e=="object"&&(s=Object.assign({},Li,e),e.s!=null&&e.ss==null&&(s.ss=e.s-1)),r=this.localeData(),i=mM(this,!t,s,r),t&&(i=r.pastFuture(+this,i)),r.postformat(i)}var gd=Math.abs;function ki(n){return(n>0)-(n<0)||+n}function th(){if(!this.isValid())return this.localeData().invalidDate();var n=gd(this._milliseconds)/1e3,e=gd(this._days),t=gd(this._months),s,r,i,o,a=this.asSeconds(),c,u,l,d;return a?(s=Dn(n/60),r=Dn(s/60),n%=60,s%=60,i=Dn(t/12),t%=12,o=n?n.toFixed(3).replace(/\.?0+$/,""):"",c=a<0?"-":"",u=ki(this._months)!==ki(a)?"-":"",l=ki(this._days)!==ki(a)?"-":"",d=ki(this._milliseconds)!==ki(a)?"-":"",c+"P"+(i?u+i+"Y":"")+(t?u+t+"M":"")+(e?l+e+"D":"")+(r||s||n?"T":"")+(r?d+r+"H":"")+(s?d+s+"M":"")+(n?d+o+"S":"")):"P0D"}var xe=Zl.prototype;xe.isValid=lR;xe.abs=$N;xe.add=qN;xe.subtract=YN;xe.as=GN;xe.asMilliseconds=sE;xe.asSeconds=JN;xe.asMinutes=QN;xe.asHours=KN;xe.asDays=jN;xe.asWeeks=XN;xe.asMonths=ZN;xe.asQuarters=eM;xe.asYears=tM;xe.valueOf=nM;xe._bubble=zN;xe.clone=sM;xe.get=rM;xe.milliseconds=iM;xe.seconds=oM;xe.minutes=aM;xe.hours=cM;xe.days=uM;xe.weeks=dM;xe.months=lM;xe.years=hM;xe.humanize=yM;xe.toISOString=th;xe.toString=th;xe.toJSON=th;xe.locale=qx;xe.localeData=zx;xe.toIsoString=Sn("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",th);xe.lang=Yx;Q("X",0,0,"unix");Q("x",0,0,"valueOf");H("x",Ql);H("X",LS);Oe("X",function(n,e,t){t._d=new Date(parseFloat(n)*1e3)});Oe("x",function(n,e,t){t._d=new Date(ye(n))});//! moment.js
W.version="2.30.1";_S(Ye);W.fn=B;W.min=oR;W.max=aR;W.now=cR;W.utc=hs;W.unix=FN;W.months=LN;W.isDate=bc;W.locale=hr;W.invalid=Yl;W.duration=Yn;W.isMoment=$n;W.weekdays=UN;W.parseZone=BN;W.localeData=Gs;W.isDuration=Au;W.monthsShort=VN;W.weekdaysMin=HN;W.defineLocale=ym;W.updateLocale=BP;W.locales=LP;W.weekdaysShort=WN;W.normalizeUnits=Pn;W.relativeTimeRounding=pM;W.relativeTimeThreshold=gM;W.calendarFormat=NR;W.prototype=B;W.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const _M="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSBzdmcgIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4nICAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz48c3ZnIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDU2LjY5MyA1Ni42OTMiIGhlaWdodD0iNTYuNjkzcHgiIGlkPSJMYXllcl8xIiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1Ni42OTMgNTYuNjkzIiB3aWR0aD0iNTYuNjkzcHgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxnPjxwYXRoIGQ9Ik00MS43NzcsMzAuNTE3Yy0wLjA2Mi02LjIzMiw1LjA4Mi05LjIyMSw1LjMxMi05LjM3MmMtMi44OTEtNC4yMjctNy4zOTUtNC44MDctOC45OTgtNC44NzMgICBjLTMuODMtMC4zODktNy40NzcsMi4yNTYtOS40MiwyLjI1NmMtMS45MzksMC00Ljk0MS0yLjE5OS04LjExNy0yLjE0M2MtNC4xNzgsMC4wNjItOC4wMjksMi40My0xMC4xNzksNi4xNyAgIGMtNC4zMzksNy41MjctMS4xMSwxOC42ODIsMy4xMTgsMjQuNzkxYzIuMDY3LDIuOTg2LDQuNTMyLDYuMzQ2LDcuNzY2LDYuMjIzYzMuMTE3LTAuMTIzLDQuMjkzLTIuMDE2LDguMDYxLTIuMDE2ICAgczQuODI2LDIuMDE2LDguMTIzLDEuOTUzYzMuMzUyLTAuMDYxLDUuNDc3LTMuMDQzLDcuNTI3LTYuMDQxYzIuMzczLTMuNDY5LDMuMzUtNi44MjgsMy40MDgtNi45OTggICBDNDguMzA1LDQwLjQzMyw0MS44NDQsMzcuOTU4LDQxLjc3NywzMC41MTd6Ii8+PHBhdGggZD0iTTM1LjU4MiwxMi4yMjljMS43MTUtMi4wODIsMi44NzctNC45NzUsMi41NjEtNy44NTVjLTIuNDc1LDAuMS01LjQ3MSwxLjY0NS03LjI0OCwzLjcyNSAgIGMtMS41OTIsMS44NDYtMi45ODQsNC43ODUtMi42MTEsNy42MTNDMzEuMDQ1LDE1LjkyNiwzMy44NjEsMTQuMzA3LDM1LjU4MiwxMi4yMjl6Ii8+PC9nPjwvc3ZnPg==",vM="data:image/svg+xml,%3c?xml%20version='1.0'%20?%3e%3csvg%20id='Layer_1'%20style='enable-background:new%200%200%201000%201000;'%20version='1.1'%20viewBox='0%200%201000%201000'%20xml:space='preserve'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cstyle%20type='text/css'%3e%20.st0{fill:%233B579D;}%20.st1{fill:%23FFFFFF;}%20%3c/style%3e%3ctitle/%3e%3cg%3e%3cpath%20class='st0'%20d='M500,1000L500,1000C223.9,1000,0,776.1,0,500v0C0,223.9,223.9,0,500,0h0c276.1,0,500,223.9,500,500v0%20C1000,776.1,776.1,1000,500,1000z'/%3e%3cpath%20class='st1'%20d='M630,1000V612.7h130l19.5-150.9H630v-96.4c0-43.7,12.1-73.5,74.8-73.5l79.9,0V157%20c-13.8-1.8-61.3-5.9-116.5-5.9c-115.2,0-194.1,70.3-194.1,199.5v111.3H343.8v150.9h130.3V1000H630z'%20id='f'/%3e%3c/g%3e%3c/svg%3e",wM="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSBzdmcgIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4nICAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz48c3ZnIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDEyOCAxMjgiIGlkPSJTb2NpYWxfSWNvbnMiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDEyOCAxMjgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxnIGlkPSJfeDMxX19zdHJva2UiPjxnIGlkPSJHb29nbGUiPjxyZWN0IGNsaXAtcnVsZT0iZXZlbm9kZCIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBoZWlnaHQ9IjEyOCIgd2lkdGg9IjEyOCIvPjxwYXRoIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTI3LjU4NSw2NGMwLTQuMTU3LDAuNjktOC4xNDMsMS45MjMtMTEuODgxTDcuOTM4LDM1LjY0OCAgICBDMy43MzQsNDQuMTgzLDEuMzY2LDUzLjgwMSwxLjM2Niw2NGMwLDEwLjE5MSwyLjM2NiwxOS44MDIsNi41NjMsMjguMzMybDIxLjU1OC0xNi41MDNDMjguMjY2LDcyLjEwOCwyNy41ODUsNjguMTM3LDI3LjU4NSw2NCIgZmlsbD0iI0ZCQkMwNSIgZmlsbC1ydWxlPSJldmVub2RkIi8+PHBhdGggY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNNjUuNDU3LDI2LjE4MmM5LjAzMSwwLDE3LjE4OCwzLjIsMjMuNTk3LDguNDM2TDEwNy42OTgsMTYgICAgQzk2LjMzNyw2LjEwOSw4MS43NzEsMCw2NS40NTcsMEM0MC4xMjksMCwxOC4zNjEsMTQuNDg0LDcuOTM4LDM1LjY0OGwyMS41NjksMTYuNDcxQzM0LjQ3NywzNy4wMzMsNDguNjQ0LDI2LjE4Miw2NS40NTcsMjYuMTgyIiBmaWxsPSIjRUE0MzM1IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiLz48cGF0aCBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik02NS40NTcsMTAxLjgxOGMtMTYuODEyLDAtMzAuOTc5LTEwLjg1MS0zNS45NDktMjUuOTM3ICAgIEw3LjkzOCw5Mi4zNDlDMTguMzYxLDExMy41MTYsNDAuMTI5LDEyOCw2NS40NTcsMTI4YzE1LjYzMiwwLDMwLjU1Ny01LjU1MSw0MS43NTgtMTUuOTUxTDg2Ljc0MSw5Ni4yMjEgICAgQzgwLjk2NCw5OS44Niw3My42ODksMTAxLjgxOCw2NS40NTcsMTAxLjgxOCIgZmlsbD0iIzM0QTg1MyIgZmlsbC1ydWxlPSJldmVub2RkIi8+PHBhdGggY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTI2LjYzNCw2NGMwLTMuNzgyLTAuNTgzLTcuODU1LTEuNDU3LTExLjYzNkg2NS40NTd2MjQuNzI3ICAgIGgzNC4zNzZjLTEuNzE5LDguNDMxLTYuMzk3LDE0LjkxMi0xMy4wOTIsMTkuMTNsMjAuNDc0LDE1LjgyOEMxMTguOTgxLDEwMS4xMjksMTI2LjYzNCw4NC44NjEsMTI2LjYzNCw2NCIgZmlsbD0iIzQyODVGNCIgZmlsbC1ydWxlPSJldmVub2RkIi8+PC9nPjwvZz48L3N2Zz4=";var rE=(n=>(n[n.Apple=0]="Apple",n[n.Google=1]="Google",n[n.Facebook=2]="Facebook",n[n.Phone=3]="Phone",n))(rE||{});const kV={0:"Apple",1:"Google",2:"Facebook",3:"Phone"},SV=[1,2,0,3],Dy={Apple:0,Google:1,Facebook:2,Phone:3},PV={0:_M,1:wM,2:vM,3:"Phone"},RV={0:"apple.com",1:"google.com",2:"facebook.com",3:"phone"};var xM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},U,Am=Am||{},re=xM||self;function nh(n){var e=typeof n;return e=e!="object"?e:n?Array.isArray(n)?"array":e:"null",e=="array"||e=="object"&&typeof n.length=="number"}function Pc(n){var e=typeof n;return e=="object"&&n!=null||e=="function"}function EM(n){return Object.prototype.hasOwnProperty.call(n,yd)&&n[yd]||(n[yd]=++TM)}var yd="closure_uid_"+(1e9*Math.random()>>>0),TM=0;function IM(n,e,t){return n.call.apply(n.bind,arguments)}function DM(n,e,t){if(!n)throw Error();if(2<arguments.length){var s=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,s),n.apply(e,r)}}return function(){return n.apply(e,arguments)}}function zt(n,e,t){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?zt=IM:zt=DM,zt.apply(null,arguments)}function hu(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var s=t.slice();return s.push.apply(s,arguments),n.apply(this,s)}}function At(n,e){function t(){}t.prototype=e.prototype,n.$=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.ac=function(s,r,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[r].apply(s,o)}}function Ar(){this.s=this.s,this.o=this.o}var AM=0;Ar.prototype.s=!1;Ar.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),AM!=0)&&EM(this)};Ar.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const iE=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if(typeof n=="string")return typeof e!="string"||e.length!=1?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function bm(n){const e=n.length;if(0<e){const t=Array(e);for(let s=0;s<e;s++)t[s]=n[s];return t}return[]}function Ay(n,e){for(let t=1;t<arguments.length;t++){const s=arguments[t];if(nh(s)){const r=n.length||0,i=s.length||0;n.length=r+i;for(let o=0;o<i;o++)n[r+o]=s[o]}else n.push(s)}}function Gt(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}Gt.prototype.h=function(){this.defaultPrevented=!0};var bM=function(){if(!re.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{const t=()=>{};re.addEventListener("test",t,e),re.removeEventListener("test",t,e)}catch{}return n}();function Ka(n){return/^[\s\xa0]*$/.test(n)}function sh(){var n=re.navigator;return n&&(n=n.userAgent)?n:""}function Kn(n){return sh().indexOf(n)!=-1}function Cm(n){return Cm[" "](n),n}Cm[" "]=function(){};function CM(n,e){var t=wO;return Object.prototype.hasOwnProperty.call(t,n)?t[n]:t[n]=e(n)}var kM=Kn("Opera"),uo=Kn("Trident")||Kn("MSIE"),oE=Kn("Edge"),Xf=oE||uo,aE=Kn("Gecko")&&!(sh().toLowerCase().indexOf("webkit")!=-1&&!Kn("Edge"))&&!(Kn("Trident")||Kn("MSIE"))&&!Kn("Edge"),SM=sh().toLowerCase().indexOf("webkit")!=-1&&!Kn("Edge");function cE(){var n=re.document;return n?n.documentMode:void 0}var Zf;e:{var _d="",vd=function(){var n=sh();if(aE)return/rv:([^\);]+)(\)|;)/.exec(n);if(oE)return/Edge\/([\d\.]+)/.exec(n);if(uo)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n);if(SM)return/WebKit\/(\S+)/.exec(n);if(kM)return/(?:Version)[ \/]?(\S+)/.exec(n)}();if(vd&&(_d=vd?vd[1]:""),uo){var wd=cE();if(wd!=null&&wd>parseFloat(_d)){Zf=String(wd);break e}}Zf=_d}var e0;if(re.document&&uo){var by=cE();e0=by||parseInt(Zf,10)||void 0}else e0=void 0;var PM=e0;function ja(n,e){if(Gt.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,s=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(aE){e:{try{Cm(e.nodeName);var r=!0;break e}catch{}r=!1}r||(e=null)}}else t=="mouseover"?e=n.fromElement:t=="mouseout"&&(e=n.toElement);this.relatedTarget=e,s?(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0):(this.clientX=n.clientX!==void 0?n.clientX:n.pageX,this.clientY=n.clientY!==void 0?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType=typeof n.pointerType=="string"?n.pointerType:RM[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&ja.$.h.call(this)}}At(ja,Gt);var RM={2:"touch",3:"pen",4:"mouse"};ja.prototype.h=function(){ja.$.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Rc="closure_listenable_"+(1e6*Math.random()|0),NM=0;function MM(n,e,t,s,r){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!s,this.la=r,this.key=++NM,this.fa=this.ia=!1}function rh(n){n.fa=!0,n.listener=null,n.proxy=null,n.src=null,n.la=null}function km(n,e,t){for(const s in n)e.call(t,n[s],s,n)}function OM(n,e){for(const t in n)e.call(void 0,n[t],t,n)}function uE(n){const e={};for(const t in n)e[t]=n[t];return e}const Cy="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function lE(n,e){let t,s;for(let r=1;r<arguments.length;r++){s=arguments[r];for(t in s)n[t]=s[t];for(let i=0;i<Cy.length;i++)t=Cy[i],Object.prototype.hasOwnProperty.call(s,t)&&(n[t]=s[t])}}function ih(n){this.src=n,this.g={},this.h=0}ih.prototype.add=function(n,e,t,s,r){var i=n.toString();n=this.g[i],n||(n=this.g[i]=[],this.h++);var o=n0(n,e,s,r);return-1<o?(e=n[o],t||(e.ia=!1)):(e=new MM(e,this.src,i,!!s,r),e.ia=t,n.push(e)),e};function t0(n,e){var t=e.type;if(t in n.g){var s=n.g[t],r=iE(s,e),i;(i=0<=r)&&Array.prototype.splice.call(s,r,1),i&&(rh(e),n.g[t].length==0&&(delete n.g[t],n.h--))}}function n0(n,e,t,s){for(var r=0;r<n.length;++r){var i=n[r];if(!i.fa&&i.listener==e&&i.capture==!!t&&i.la==s)return r}return-1}var Sm="closure_lm_"+(1e6*Math.random()|0),xd={};function hE(n,e,t,s,r){if(s&&s.once)return fE(n,e,t,s,r);if(Array.isArray(e)){for(var i=0;i<e.length;i++)hE(n,e[i],t,s,r);return null}return t=Nm(t),n&&n[Rc]?n.O(e,t,Pc(s)?!!s.capture:!!s,r):dE(n,e,t,!1,s,r)}function dE(n,e,t,s,r,i){if(!e)throw Error("Invalid event type");var o=Pc(r)?!!r.capture:!!r,a=Rm(n);if(a||(n[Sm]=a=new ih(n)),t=a.add(e,t,s,o,i),t.proxy)return t;if(s=FM(),t.proxy=s,s.src=n,s.listener=t,n.addEventListener)bM||(r=o),r===void 0&&(r=!1),n.addEventListener(e.toString(),s,r);else if(n.attachEvent)n.attachEvent(pE(e.toString()),s);else if(n.addListener&&n.removeListener)n.addListener(s);else throw Error("addEventListener and attachEvent are unavailable.");return t}function FM(){function n(t){return e.call(n.src,n.listener,t)}const e=BM;return n}function fE(n,e,t,s,r){if(Array.isArray(e)){for(var i=0;i<e.length;i++)fE(n,e[i],t,s,r);return null}return t=Nm(t),n&&n[Rc]?n.P(e,t,Pc(s)?!!s.capture:!!s,r):dE(n,e,t,!0,s,r)}function mE(n,e,t,s,r){if(Array.isArray(e))for(var i=0;i<e.length;i++)mE(n,e[i],t,s,r);else s=Pc(s)?!!s.capture:!!s,t=Nm(t),n&&n[Rc]?(n=n.i,e=String(e).toString(),e in n.g&&(i=n.g[e],t=n0(i,t,s,r),-1<t&&(rh(i[t]),Array.prototype.splice.call(i,t,1),i.length==0&&(delete n.g[e],n.h--)))):n&&(n=Rm(n))&&(e=n.g[e.toString()],n=-1,e&&(n=n0(e,t,s,r)),(t=-1<n?e[n]:null)&&Pm(t))}function Pm(n){if(typeof n!="number"&&n&&!n.fa){var e=n.src;if(e&&e[Rc])t0(e.i,n);else{var t=n.type,s=n.proxy;e.removeEventListener?e.removeEventListener(t,s,n.capture):e.detachEvent?e.detachEvent(pE(t),s):e.addListener&&e.removeListener&&e.removeListener(s),(t=Rm(e))?(t0(t,n),t.h==0&&(t.src=null,e[Sm]=null)):rh(n)}}}function pE(n){return n in xd?xd[n]:xd[n]="on"+n}function BM(n,e){if(n.fa)n=!0;else{e=new ja(e,this);var t=n.listener,s=n.la||n.src;n.ia&&Pm(n),n=t.call(s,e)}return n}function Rm(n){return n=n[Sm],n instanceof ih?n:null}var Ed="__closure_events_fn_"+(1e9*Math.random()>>>0);function Nm(n){return typeof n=="function"?n:(n[Ed]||(n[Ed]=function(e){return n.handleEvent(e)}),n[Ed])}function Dt(){Ar.call(this),this.i=new ih(this),this.S=this,this.J=null}At(Dt,Ar);Dt.prototype[Rc]=!0;Dt.prototype.removeEventListener=function(n,e,t,s){mE(this,n,e,t,s)};function Ot(n,e){var t,s=n.J;if(s)for(t=[];s;s=s.J)t.push(s);if(n=n.S,s=e.type||e,typeof e=="string")e=new Gt(e,n);else if(e instanceof Gt)e.target=e.target||n;else{var r=e;e=new Gt(s,n),lE(e,r)}if(r=!0,t)for(var i=t.length-1;0<=i;i--){var o=e.g=t[i];r=du(o,s,!0,e)&&r}if(o=e.g=n,r=du(o,s,!0,e)&&r,r=du(o,s,!1,e)&&r,t)for(i=0;i<t.length;i++)o=e.g=t[i],r=du(o,s,!1,e)&&r}Dt.prototype.N=function(){if(Dt.$.N.call(this),this.i){var n=this.i,e;for(e in n.g){for(var t=n.g[e],s=0;s<t.length;s++)rh(t[s]);delete n.g[e],n.h--}}this.J=null};Dt.prototype.O=function(n,e,t,s){return this.i.add(String(n),e,!1,t,s)};Dt.prototype.P=function(n,e,t,s){return this.i.add(String(n),e,!0,t,s)};function du(n,e,t,s){if(e=n.i.g[String(e)],!e)return!0;e=e.concat();for(var r=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.fa&&o.capture==t){var a=o.listener,c=o.la||o.src;o.ia&&t0(n.i,o),r=a.call(c,s)!==!1&&r}}return r&&!s.defaultPrevented}var Mm=re.JSON.stringify;class LM{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function VM(){var n=Om;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}class UM{constructor(){this.h=this.g=null}add(e,t){const s=gE.get();s.set(e,t),this.h?this.h.next=s:this.g=s,this.h=s}}var gE=new LM(()=>new WM,n=>n.reset());class WM{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function HM(n){var e=1;n=n.split(":");const t=[];for(;0<e&&n.length;)t.push(n.shift()),e--;return n.length&&t.push(n.join(":")),t}function $M(n){re.setTimeout(()=>{throw n},0)}let Xa,Za=!1,Om=new UM,yE=()=>{const n=re.Promise.resolve(void 0);Xa=()=>{n.then(qM)}};var qM=()=>{for(var n;n=VM();){try{n.h.call(n.g)}catch(t){$M(t)}var e=gE;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}Za=!1};function oh(n,e){Dt.call(this),this.h=n||1,this.g=e||re,this.j=zt(this.qb,this),this.l=Date.now()}At(oh,Dt);U=oh.prototype;U.ga=!1;U.T=null;U.qb=function(){if(this.ga){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-n):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Ot(this,"tick"),this.ga&&(Fm(this),this.start()))}};U.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Fm(n){n.ga=!1,n.T&&(n.g.clearTimeout(n.T),n.T=null)}U.N=function(){oh.$.N.call(this),Fm(this),delete this.g};function Bm(n,e,t){if(typeof n=="function")t&&(n=zt(n,t));else if(n&&typeof n.handleEvent=="function")n=zt(n.handleEvent,n);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:re.setTimeout(n,e||0)}function _E(n){n.g=Bm(()=>{n.g=null,n.i&&(n.i=!1,_E(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}class YM extends Ar{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:_E(this)}N(){super.N(),this.g&&(re.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ec(n){Ar.call(this),this.h=n,this.g={}}At(ec,Ar);var ky=[];function vE(n,e,t,s){Array.isArray(t)||(t&&(ky[0]=t.toString()),t=ky);for(var r=0;r<t.length;r++){var i=hE(e,t[r],s||n.handleEvent,!1,n.h||n);if(!i)break;n.g[i.key]=i}}function wE(n){km(n.g,function(e,t){this.g.hasOwnProperty(t)&&Pm(e)},n),n.g={}}ec.prototype.N=function(){ec.$.N.call(this),wE(this)};ec.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function ah(){this.g=!0}ah.prototype.Ea=function(){this.g=!1};function zM(n,e,t,s,r,i){n.info(function(){if(n.g)if(i)for(var o="",a=i.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var d=l.split("_");o=2<=d.length&&d[1]=="type"?o+(l+"="+u+"&"):o+(l+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+s+") [attempt "+r+"]: "+e+`
`+t+`
`+o})}function GM(n,e,t,s,r,i,o){n.info(function(){return"XMLHTTP RESP ("+s+") [ attempt "+r+"]: "+e+`
`+t+`
`+i+" "+o})}function Vi(n,e,t,s){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+QM(n,t)+(s?" "+s:"")})}function JM(n,e){n.info(function(){return"TIMEOUT: "+e})}ah.prototype.info=function(){};function QM(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t){for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var s=t[n];if(!(2>s.length)){var r=s[1];if(Array.isArray(r)&&!(1>r.length)){var i=r[0];if(i!="noop"&&i!="stop"&&i!="close")for(var o=1;o<r.length;o++)r[o]=""}}}}return Mm(t)}catch{return e}}var gi={},Sy=null;function ch(){return Sy=Sy||new Dt}gi.Ta="serverreachability";function xE(n){Gt.call(this,gi.Ta,n)}At(xE,Gt);function tc(n){const e=ch();Ot(e,new xE(e))}gi.STAT_EVENT="statevent";function EE(n,e){Gt.call(this,gi.STAT_EVENT,n),this.stat=e}At(EE,Gt);function Zt(n){const e=ch();Ot(e,new EE(e,n))}gi.Ua="timingevent";function TE(n,e){Gt.call(this,gi.Ua,n),this.size=e}At(TE,Gt);function Nc(n,e){if(typeof n!="function")throw Error("Fn must not be null and must be a function");return re.setTimeout(function(){n()},e)}var uh={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},IE={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Lm(){}Lm.prototype.h=null;function Py(n){return n.h||(n.h=n.i())}function DE(){}var Mc={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Vm(){Gt.call(this,"d")}At(Vm,Gt);function Um(){Gt.call(this,"c")}At(Um,Gt);var s0;function lh(){}At(lh,Lm);lh.prototype.g=function(){return new XMLHttpRequest};lh.prototype.i=function(){return{}};s0=new lh;function Oc(n,e,t,s){this.l=n,this.j=e,this.m=t,this.W=s||1,this.U=new ec(this),this.P=KM,n=Xf?125:void 0,this.V=new oh(n),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new AE}function AE(){this.i=null,this.g="",this.h=!1}var KM=45e3,bE={},r0={};U=Oc.prototype;U.setTimeout=function(n){this.P=n};function i0(n,e,t){n.L=1,n.A=dh(Vs(e)),n.u=t,n.S=!0,CE(n,null)}function CE(n,e){n.G=Date.now(),Fc(n),n.B=Vs(n.A);var t=n.B,s=n.W;Array.isArray(s)||(s=[String(s)]),FE(t.i,"t",s),n.o=0,t=n.l.J,n.h=new AE,n.g=sT(n.l,t?e:null,!n.u),0<n.O&&(n.M=new YM(zt(n.Pa,n,n.g),n.O)),vE(n.U,n.g,"readystatechange",n.nb),e=n.I?uE(n.I):{},n.u?(n.v||(n.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ha(n.B,n.v,n.u,e)):(n.v="GET",n.g.ha(n.B,n.v,null,e)),tc(),zM(n.j,n.v,n.B,n.m,n.W,n.u)}U.nb=function(n){n=n.target;const e=this.M;e&&Zn(n)==3?e.l():this.Pa(n)};U.Pa=function(n){try{if(n==this.g)e:{const l=Zn(this.g);var e=this.g.Ia();const d=this.g.da();if(!(3>l)&&(l!=3||Xf||this.g&&(this.h.h||this.g.ja()||Oy(this.g)))){this.J||l!=4||e==7||(e==8||0>=d?tc(3):tc(2)),hh(this);var t=this.g.da();this.ca=t;t:if(kE(this)){var s=Oy(this.g);n="";var r=s.length,i=Zn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Hr(this),Ia(this);var o="";break t}this.h.i=new re.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,n+=this.h.i.decode(s[e],{stream:i&&e==r-1});s.length=0,this.h.g+=n,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=t==200,GM(this.j,this.v,this.B,this.m,this.W,l,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Ka(a)){var u=a;break t}}u=null}if(t=u)Vi(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,o0(this,t);else{this.i=!1,this.s=3,Zt(12),Hr(this),Ia(this);break e}}this.S?(SE(this,l,o),Xf&&this.i&&l==3&&(vE(this.U,this.V,"tick",this.mb),this.V.start())):(Vi(this.j,this.m,o,null),o0(this,o)),l==4&&Hr(this),this.i&&!this.J&&(l==4?ZE(this.l,this):(this.i=!1,Fc(this)))}else yO(this.g),t==400&&0<o.indexOf("Unknown SID")?(this.s=3,Zt(12)):(this.s=0,Zt(13)),Hr(this),Ia(this)}}}catch{}finally{}};function kE(n){return n.g?n.v=="GET"&&n.L!=2&&n.l.Ha:!1}function SE(n,e,t){let s=!0,r;for(;!n.J&&n.o<t.length;)if(r=jM(n,t),r==r0){e==4&&(n.s=4,Zt(14),s=!1),Vi(n.j,n.m,null,"[Incomplete Response]");break}else if(r==bE){n.s=4,Zt(15),Vi(n.j,n.m,t,"[Invalid Chunk]"),s=!1;break}else Vi(n.j,n.m,r,null),o0(n,r);kE(n)&&n.o!=0&&(n.h.g=n.h.g.slice(n.o),n.o=0),e!=4||t.length!=0||n.h.h||(n.s=1,Zt(16),s=!1),n.i=n.i&&s,s?0<t.length&&!n.ba&&(n.ba=!0,e=n.l,e.g==n&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),zm(e),e.M=!0,Zt(11))):(Vi(n.j,n.m,t,"[Invalid Chunked Response]"),Hr(n),Ia(n))}U.mb=function(){if(this.g){var n=Zn(this.g),e=this.g.ja();this.o<e.length&&(hh(this),SE(this,n,e),this.i&&n!=4&&Fc(this))}};function jM(n,e){var t=n.o,s=e.indexOf(`
`,t);return s==-1?r0:(t=Number(e.substring(t,s)),isNaN(t)?bE:(s+=1,s+t>e.length?r0:(e=e.slice(s,s+t),n.o=s+t,e)))}U.cancel=function(){this.J=!0,Hr(this)};function Fc(n){n.Y=Date.now()+n.P,PE(n,n.P)}function PE(n,e){if(n.C!=null)throw Error("WatchDog timer not null");n.C=Nc(zt(n.lb,n),e)}function hh(n){n.C&&(re.clearTimeout(n.C),n.C=null)}U.lb=function(){this.C=null;const n=Date.now();0<=n-this.Y?(JM(this.j,this.B),this.L!=2&&(tc(),Zt(17)),Hr(this),this.s=2,Ia(this)):PE(this,this.Y-n)};function Ia(n){n.l.H==0||n.J||ZE(n.l,n)}function Hr(n){hh(n);var e=n.M;e&&typeof e.sa=="function"&&e.sa(),n.M=null,Fm(n.V),wE(n.U),n.g&&(e=n.g,n.g=null,e.abort(),e.sa())}function o0(n,e){try{var t=n.l;if(t.H!=0&&(t.g==n||a0(t.i,n))){if(!n.K&&a0(t.i,n)&&t.H==3){try{var s=t.Ja.g.parse(e)}catch{s=null}if(Array.isArray(s)&&s.length==3){var r=s;if(r[0]==0){e:if(!t.u){if(t.g)if(t.g.G+3e3<n.G)ju(t),gh(t);else break e;Ym(t),Zt(18)}}else t.Fa=r[1],0<t.Fa-t.V&&37500>r[2]&&t.G&&t.A==0&&!t.v&&(t.v=Nc(zt(t.ib,t),6e3));if(1>=VE(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else $r(t,11)}else if((n.K||t.g==n)&&ju(t),!Ka(e))for(r=t.Ja.g.parse(e),e=0;e<r.length;e++){let u=r[e];if(t.V=u[0],u=u[1],t.H==2)if(u[0]=="c"){t.K=u[1],t.pa=u[2];const l=u[3];l!=null&&(t.ra=l,t.l.info("VER="+t.ra));const d=u[4];d!=null&&(t.Ga=d,t.l.info("SVER="+t.Ga));const f=u[5];f!=null&&typeof f=="number"&&0<f&&(s=1.5*f,t.L=s,t.l.info("backChannelRequestTimeoutMs_="+s)),s=t;const m=n.g;if(m){const p=m.g?m.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var i=s.i;i.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(i.j=i.l,i.g=new Set,i.h&&(Wm(i,i.h),i.h=null))}if(s.F){const y=m.g?m.g.getResponseHeader("X-HTTP-Session-Id"):null;y&&(s.Da=y,qe(s.I,s.F,y))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-n.G,t.l.info("Handshake RTT: "+t.S+"ms")),s=t;var o=n;if(s.wa=nT(s,s.J?s.pa:null,s.Y),o.K){UE(s.i,o);var a=o,c=s.L;c&&a.setTimeout(c),a.C&&(hh(a),Fc(a)),s.g=o}else jE(s);0<t.j.length&&yh(t)}else u[0]!="stop"&&u[0]!="close"||$r(t,7);else t.H==3&&(u[0]=="stop"||u[0]=="close"?u[0]=="stop"?$r(t,7):qm(t):u[0]!="noop"&&t.h&&t.h.Aa(u),t.A=0)}}tc(4)}catch{}}function XM(n){if(n.Z&&typeof n.Z=="function")return n.Z();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if(typeof n=="string")return n.split("");if(nh(n)){for(var e=[],t=n.length,s=0;s<t;s++)e.push(n[s]);return e}e=[],t=0;for(s in n)e[t++]=n[s];return e}function ZM(n){if(n.ta&&typeof n.ta=="function")return n.ta();if(!n.Z||typeof n.Z!="function"){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(nh(n)||typeof n=="string"){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const s in n)e[t++]=s;return e}}}function RE(n,e){if(n.forEach&&typeof n.forEach=="function")n.forEach(e,void 0);else if(nh(n)||typeof n=="string")Array.prototype.forEach.call(n,e,void 0);else for(var t=ZM(n),s=XM(n),r=s.length,i=0;i<r;i++)e.call(void 0,s[i],t&&t[i],n)}var NE=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function eO(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var s=n[t].indexOf("="),r=null;if(0<=s){var i=n[t].substring(0,s);r=n[t].substring(s+1)}else i=n[t];e(i,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}function Qr(n){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof Qr){this.h=n.h,Qu(this,n.j),this.s=n.s,this.g=n.g,Ku(this,n.m),this.l=n.l;var e=n.i,t=new nc;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),Ry(this,t),this.o=n.o}else n&&(e=String(n).match(NE))?(this.h=!1,Qu(this,e[1]||"",!0),this.s=ma(e[2]||""),this.g=ma(e[3]||"",!0),Ku(this,e[4]),this.l=ma(e[5]||"",!0),Ry(this,e[6]||"",!0),this.o=ma(e[7]||"")):(this.h=!1,this.i=new nc(null,this.h))}Qr.prototype.toString=function(){var n=[],e=this.j;e&&n.push(pa(e,Ny,!0),":");var t=this.g;return(t||e=="file")&&(n.push("//"),(e=this.s)&&n.push(pa(e,Ny,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t=this.m,t!=null&&n.push(":",String(t))),(t=this.l)&&(this.g&&t.charAt(0)!="/"&&n.push("/"),n.push(pa(t,t.charAt(0)=="/"?sO:nO,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",pa(t,iO)),n.join("")};function Vs(n){return new Qr(n)}function Qu(n,e,t){n.j=t?ma(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function Ku(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function Ry(n,e,t){e instanceof nc?(n.i=e,oO(n.i,n.h)):(t||(e=pa(e,rO)),n.i=new nc(e,n.h))}function qe(n,e,t){n.i.set(e,t)}function dh(n){return qe(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function ma(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function pa(n,e,t){return typeof n=="string"?(n=encodeURI(n).replace(e,tO),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function tO(n){return n=n.charCodeAt(0),"%"+(n>>4&15).toString(16)+(n&15).toString(16)}var Ny=/[#\/\?@]/g,nO=/[#\?:]/g,sO=/[#\?]/g,rO=/[#\?@]/g,iO=/#/g;function nc(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function br(n){n.g||(n.g=new Map,n.h=0,n.i&&eO(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}U=nc.prototype;U.add=function(n,e){br(this),this.i=null,n=Lo(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this};function ME(n,e){br(n),e=Lo(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function OE(n,e){return br(n),e=Lo(n,e),n.g.has(e)}U.forEach=function(n,e){br(this),this.g.forEach(function(t,s){t.forEach(function(r){n.call(e,r,s,this)},this)},this)};U.ta=function(){br(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let s=0;s<e.length;s++){const r=n[s];for(let i=0;i<r.length;i++)t.push(e[s])}return t};U.Z=function(n){br(this);let e=[];if(typeof n=="string")OE(this,n)&&(e=e.concat(this.g.get(Lo(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e};U.set=function(n,e){return br(this),this.i=null,n=Lo(this,n),OE(this,n)&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this};U.get=function(n,e){return n?(n=this.Z(n),0<n.length?String(n[0]):e):e};function FE(n,e,t){ME(n,e),0<t.length&&(n.i=null,n.g.set(Lo(n,e),bm(t)),n.h+=t.length)}U.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var s=e[t];const i=encodeURIComponent(String(s)),o=this.Z(s);for(s=0;s<o.length;s++){var r=i;o[s]!==""&&(r+="="+encodeURIComponent(String(o[s]))),n.push(r)}}return this.i=n.join("&")};function Lo(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function oO(n,e){e&&!n.j&&(br(n),n.i=null,n.g.forEach(function(t,s){var r=s.toLowerCase();s!=r&&(ME(this,s),FE(this,r,t))},n)),n.j=e}var aO=class{constructor(n,e){this.g=n,this.map=e}};function BE(n){this.l=n||cO,re.PerformanceNavigationTiming?(n=re.performance.getEntriesByType("navigation"),n=0<n.length&&(n[0].nextHopProtocol=="hq"||n[0].nextHopProtocol=="h2")):n=!!(re.g&&re.g.Ka&&re.g.Ka()&&re.g.Ka().dc),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var cO=10;function LE(n){return n.h?!0:n.g?n.g.size>=n.j:!1}function VE(n){return n.h?1:n.g?n.g.size:0}function a0(n,e){return n.h?n.h==e:n.g?n.g.has(e):!1}function Wm(n,e){n.g?n.g.add(e):n.h=e}function UE(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}BE.prototype.cancel=function(){if(this.i=WE(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const n of this.g.values())n.cancel();this.g.clear()}};function WE(n){if(n.h!=null)return n.i.concat(n.h.F);if(n.g!=null&&n.g.size!==0){let e=n.i;for(const t of n.g.values())e=e.concat(t.F);return e}return bm(n.i)}var uO=class{stringify(n){return re.JSON.stringify(n,void 0)}parse(n){return re.JSON.parse(n,void 0)}};function lO(){this.g=new uO}function hO(n,e,t){const s=t||"";try{RE(n,function(r,i){let o=r;Pc(r)&&(o=Mm(r)),e.push(s+i+"="+encodeURIComponent(o))})}catch(r){throw e.push(s+"type="+encodeURIComponent("_badmap")),r}}function dO(n,e){const t=new ah;if(re.Image){const s=new Image;s.onload=hu(fu,t,s,"TestLoadImage: loaded",!0,e),s.onerror=hu(fu,t,s,"TestLoadImage: error",!1,e),s.onabort=hu(fu,t,s,"TestLoadImage: abort",!1,e),s.ontimeout=hu(fu,t,s,"TestLoadImage: timeout",!1,e),re.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=n}else e(!1)}function fu(n,e,t,s,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(s)}catch{}}function fh(n){this.l=n.ec||null,this.j=n.ob||!1}At(fh,Lm);fh.prototype.g=function(){return new mh(this.l,this.j)};fh.prototype.i=function(n){return function(){return n}}({});function mh(n,e){Dt.call(this),this.F=n,this.u=e,this.m=void 0,this.readyState=Hm,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}At(mh,Dt);var Hm=0;U=mh.prototype;U.open=function(n,e){if(this.readyState!=Hm)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,sc(this)};U.send=function(n){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.F||re).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};U.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Bc(this)),this.readyState=Hm};U.$a=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,sc(this)),this.g&&(this.readyState=3,sc(this),this.g)))if(this.responseType==="arraybuffer")n.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof re.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;HE(this)}else n.text().then(this.Za.bind(this),this.ka.bind(this))};function HE(n){n.j.read().then(n.Xa.bind(n)).catch(n.ka.bind(n))}U.Xa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?Bc(this):sc(this),this.readyState==3&&HE(this)}};U.Za=function(n){this.g&&(this.response=this.responseText=n,Bc(this))};U.Ya=function(n){this.g&&(this.response=n,Bc(this))};U.ka=function(){this.g&&Bc(this)};function Bc(n){n.readyState=4,n.l=null,n.j=null,n.A=null,sc(n)}U.setRequestHeader=function(n,e){this.v.append(n,e)};U.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""};U.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)t=t.value,n.push(t[0]+": "+t[1]),t=e.next();return n.join(`\r
`)};function sc(n){n.onreadystatechange&&n.onreadystatechange.call(n)}Object.defineProperty(mh.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(n){this.m=n?"include":"same-origin"}});var fO=re.JSON.parse;function rt(n){Dt.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=$E,this.L=this.M=!1}At(rt,Dt);var $E="",mO=/^https?$/i,pO=["POST","PUT"];U=rt.prototype;U.Oa=function(n){this.M=n};U.ha=function(n,e,t,s){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+n);e=e?e.toUpperCase():"GET",this.I=n,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():s0.g(),this.C=this.u?Py(this.u):Py(s0),this.g.onreadystatechange=zt(this.La,this);try{this.G=!0,this.g.open(e,String(n),!0),this.G=!1}catch(i){My(this,i);return}if(n=t||"",t=new Map(this.headers),s)if(Object.getPrototypeOf(s)===Object.prototype)for(var r in s)t.set(r,s[r]);else if(typeof s.keys=="function"&&typeof s.get=="function")for(const i of s.keys())t.set(i,s.get(i));else throw Error("Unknown input type for opt_headers: "+String(s));s=Array.from(t.keys()).find(i=>i.toLowerCase()=="content-type"),r=re.FormData&&n instanceof re.FormData,!(0<=iE(pO,e))||s||r||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of t)this.g.setRequestHeader(i,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{zE(this),0<this.B&&((this.L=gO(this.g))?(this.g.timeout=this.B,this.g.ontimeout=zt(this.ua,this)):this.A=Bm(this.ua,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(i){My(this,i)}};function gO(n){return uo&&typeof n.timeout=="number"&&n.ontimeout!==void 0}U.ua=function(){typeof Am<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ot(this,"timeout"),this.abort(8))};function My(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,qE(n),ph(n)}function qE(n){n.F||(n.F=!0,Ot(n,"complete"),Ot(n,"error"))}U.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,Ot(this,"complete"),Ot(this,"abort"),ph(this))};U.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),ph(this,!0)),rt.$.N.call(this)};U.La=function(){this.s||(this.G||this.v||this.l?YE(this):this.kb())};U.kb=function(){YE(this)};function YE(n){if(n.h&&typeof Am<"u"&&(!n.C[1]||Zn(n)!=4||n.da()!=2)){if(n.v&&Zn(n)==4)Bm(n.La,0,n);else if(Ot(n,"readystatechange"),Zn(n)==4){n.h=!1;try{const o=n.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var s;if(s=o===0){var r=String(n.I).match(NE)[1]||null;!r&&re.self&&re.self.location&&(r=re.self.location.protocol.slice(0,-1)),s=!mO.test(r?r.toLowerCase():"")}t=s}if(t)Ot(n,"complete"),Ot(n,"success");else{n.m=6;try{var i=2<Zn(n)?n.g.statusText:""}catch{i=""}n.j=i+" ["+n.da()+"]",qE(n)}}finally{ph(n)}}}}function ph(n,e){if(n.g){zE(n);const t=n.g,s=n.C[0]?()=>{}:null;n.g=null,n.C=null,e||Ot(n,"ready");try{t.onreadystatechange=s}catch{}}}function zE(n){n.g&&n.L&&(n.g.ontimeout=null),n.A&&(re.clearTimeout(n.A),n.A=null)}U.isActive=function(){return!!this.g};function Zn(n){return n.g?n.g.readyState:0}U.da=function(){try{return 2<Zn(this)?this.g.status:-1}catch{return-1}};U.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};U.Wa=function(n){if(this.g){var e=this.g.responseText;return n&&e.indexOf(n)==0&&(e=e.substring(n.length)),fO(e)}};function Oy(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.K){case $E:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function yO(n){const e={};n=(n.g&&2<=Zn(n)&&n.g.getAllResponseHeaders()||"").split(`\r
`);for(let s=0;s<n.length;s++){if(Ka(n[s]))continue;var t=HM(n[s]);const r=t[0];if(t=t[1],typeof t!="string")continue;t=t.trim();const i=e[r]||[];e[r]=i,i.push(t)}OM(e,function(s){return s.join(", ")})}U.Ia=function(){return this.m};U.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function GE(n){let e="";return km(n,function(t,s){e+=s,e+=":",e+=t,e+=`\r
`}),e}function $m(n,e,t){e:{for(s in t){var s=!1;break e}s=!0}s||(t=GE(t),typeof n=="string"?t!=null&&encodeURIComponent(String(t)):qe(n,e,t))}function aa(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function JE(n){this.Ga=0,this.j=[],this.l=new ah,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=aa("failFast",!1,n),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=aa("baseRetryDelayMs",5e3,n),this.hb=aa("retryDelaySeedMs",1e4,n),this.eb=aa("forwardChannelMaxRetries",2,n),this.xa=aa("forwardChannelRequestTimeoutMs",2e4,n),this.va=n&&n.xmlHttpFactory||void 0,this.Ha=n&&n.useFetchStreams||!1,this.L=void 0,this.J=n&&n.supportsCrossDomainXhr||!1,this.K="",this.i=new BE(n&&n.concurrentRequestLimit),this.Ja=new lO,this.P=n&&n.fastHandshake||!1,this.O=n&&n.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=n&&n.bc||!1,n&&n.Ea&&this.l.Ea(),n&&n.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&n&&n.detectBufferingProxy||!1,this.qa=void 0,n&&n.longPollingTimeout&&0<n.longPollingTimeout&&(this.qa=n.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}U=JE.prototype;U.ra=8;U.H=1;function qm(n){if(QE(n),n.H==3){var e=n.W++,t=Vs(n.I);if(qe(t,"SID",n.K),qe(t,"RID",e),qe(t,"TYPE","terminate"),Lc(n,t),e=new Oc(n,n.l,e),e.L=2,e.A=dh(Vs(t)),t=!1,re.navigator&&re.navigator.sendBeacon)try{t=re.navigator.sendBeacon(e.A.toString(),"")}catch{}!t&&re.Image&&(new Image().src=e.A,t=!0),t||(e.g=sT(e.l,null),e.g.ha(e.A)),e.G=Date.now(),Fc(e)}tT(n)}function gh(n){n.g&&(zm(n),n.g.cancel(),n.g=null)}function QE(n){gh(n),n.u&&(re.clearTimeout(n.u),n.u=null),ju(n),n.i.cancel(),n.m&&(typeof n.m=="number"&&re.clearTimeout(n.m),n.m=null)}function yh(n){if(!LE(n.i)&&!n.m){n.m=!0;var e=n.Na;Xa||yE(),Za||(Xa(),Za=!0),Om.add(e,n),n.C=0}}function _O(n,e){return VE(n.i)>=n.i.j-(n.m?1:0)?!1:n.m?(n.j=e.F.concat(n.j),!0):n.H==1||n.H==2||n.C>=(n.cb?0:n.eb)?!1:(n.m=Nc(zt(n.Na,n,e),eT(n,n.C)),n.C++,!0)}U.Na=function(n){if(this.m)if(this.m=null,this.H==1){if(!n){this.W=Math.floor(1e5*Math.random()),n=this.W++;const r=new Oc(this,this.l,n);let i=this.s;if(this.U&&(i?(i=uE(i),lE(i,this.U)):i=this.U),this.o!==null||this.O||(r.I=i,i=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){t:{var s=this.j[t];if("__data__"in s.map&&(s=s.map.__data__,typeof s=="string")){s=s.length;break t}s=void 0}if(s===void 0)break;if(e+=s,4096<e){e=t;break e}if(e===4096||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=KE(this,r,e),t=Vs(this.I),qe(t,"RID",n),qe(t,"CVER",22),this.F&&qe(t,"X-HTTP-Session-Id",this.F),Lc(this,t),i&&(this.O?e="headers="+encodeURIComponent(String(GE(i)))+"&"+e:this.o&&$m(t,this.o,i)),Wm(this.i,r),this.bb&&qe(t,"TYPE","init"),this.P?(qe(t,"$req",e),qe(t,"SID","null"),r.aa=!0,i0(r,t,null)):i0(r,t,e),this.H=2}}else this.H==3&&(n?Fy(this,n):this.j.length==0||LE(this.i)||Fy(this))};function Fy(n,e){var t;e?t=e.m:t=n.W++;const s=Vs(n.I);qe(s,"SID",n.K),qe(s,"RID",t),qe(s,"AID",n.V),Lc(n,s),n.o&&n.s&&$m(s,n.o,n.s),t=new Oc(n,n.l,t,n.C+1),n.o===null&&(t.I=n.s),e&&(n.j=e.F.concat(n.j)),e=KE(n,t,1e3),t.setTimeout(Math.round(.5*n.xa)+Math.round(.5*n.xa*Math.random())),Wm(n.i,t),i0(t,s,e)}function Lc(n,e){n.na&&km(n.na,function(t,s){qe(e,s,t)}),n.h&&RE({},function(t,s){qe(e,s,t)})}function KE(n,e,t){t=Math.min(n.j.length,t);var s=n.h?zt(n.h.Va,n.h,n):null;e:{var r=n.j;let i=-1;for(;;){const o=["count="+t];i==-1?0<t?(i=r[0].g,o.push("ofs="+i)):i=0:o.push("ofs="+i);let a=!0;for(let c=0;c<t;c++){let u=r[c].g;const l=r[c].map;if(u-=i,0>u)i=Math.max(0,r[c].g-100),a=!1;else try{hO(l,o,"req"+u+"_")}catch{s&&s(l)}}if(a){s=o.join("&");break e}}}return n=n.j.splice(0,t),e.F=n,s}function jE(n){if(!n.g&&!n.u){n.ba=1;var e=n.Ma;Xa||yE(),Za||(Xa(),Za=!0),Om.add(e,n),n.A=0}}function Ym(n){return n.g||n.u||3<=n.A?!1:(n.ba++,n.u=Nc(zt(n.Ma,n),eT(n,n.A)),n.A++,!0)}U.Ma=function(){if(this.u=null,XE(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var n=2*this.S;this.l.info("BP detection timer enabled: "+n),this.B=Nc(zt(this.jb,this),n)}};U.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Zt(10),gh(this),XE(this))};function zm(n){n.B!=null&&(re.clearTimeout(n.B),n.B=null)}function XE(n){n.g=new Oc(n,n.l,"rpc",n.ba),n.o===null&&(n.g.I=n.s),n.g.O=0;var e=Vs(n.wa);qe(e,"RID","rpc"),qe(e,"SID",n.K),qe(e,"AID",n.V),qe(e,"CI",n.G?"0":"1"),!n.G&&n.qa&&qe(e,"TO",n.qa),qe(e,"TYPE","xmlhttp"),Lc(n,e),n.o&&n.s&&$m(e,n.o,n.s),n.L&&n.g.setTimeout(n.L);var t=n.g;n=n.pa,t.L=1,t.A=dh(Vs(e)),t.u=null,t.S=!0,CE(t,n)}U.ib=function(){this.v!=null&&(this.v=null,gh(this),Ym(this),Zt(19))};function ju(n){n.v!=null&&(re.clearTimeout(n.v),n.v=null)}function ZE(n,e){var t=null;if(n.g==e){ju(n),zm(n),n.g=null;var s=2}else if(a0(n.i,e))t=e.F,UE(n.i,e),s=1;else return;if(n.H!=0){if(e.i)if(s==1){t=e.u?e.u.length:0,e=Date.now()-e.G;var r=n.C;s=ch(),Ot(s,new TE(s,t)),yh(n)}else jE(n);else if(r=e.s,r==3||r==0&&0<e.ca||!(s==1&&_O(n,e)||s==2&&Ym(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),r){case 1:$r(n,5);break;case 4:$r(n,10);break;case 3:$r(n,6);break;default:$r(n,2)}}}function eT(n,e){let t=n.ab+Math.floor(Math.random()*n.hb);return n.isActive()||(t*=2),t*e}function $r(n,e){if(n.l.info("Error code "+e),e==2){var t=null;n.h&&(t=null);var s=zt(n.pb,n);t||(t=new Qr("//www.google.com/images/cleardot.gif"),re.location&&re.location.protocol=="http"||Qu(t,"https"),dh(t)),dO(t.toString(),s)}else Zt(2);n.H=0,n.h&&n.h.za(e),tT(n),QE(n)}U.pb=function(n){n?(this.l.info("Successfully pinged google.com"),Zt(2)):(this.l.info("Failed to ping google.com"),Zt(1))};function tT(n){if(n.H=0,n.ma=[],n.h){const e=WE(n.i);(e.length!=0||n.j.length!=0)&&(Ay(n.ma,e),Ay(n.ma,n.j),n.i.i.length=0,bm(n.j),n.j.length=0),n.h.ya()}}function nT(n,e,t){var s=t instanceof Qr?Vs(t):new Qr(t);if(s.g!="")e&&(s.g=e+"."+s.g),Ku(s,s.m);else{var r=re.location;s=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var i=new Qr(null);s&&Qu(i,s),e&&(i.g=e),r&&Ku(i,r),t&&(i.l=t),s=i}return t=n.F,e=n.Da,t&&e&&qe(s,t,e),qe(s,"VER",n.ra),Lc(n,s),s}function sT(n,e,t){if(e&&!n.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=n.Ha&&!n.va?new rt(new fh({ob:t})):new rt(n.va),e.Oa(n.J),e}U.isActive=function(){return!!this.h&&this.h.isActive(this)};function rT(){}U=rT.prototype;U.Ba=function(){};U.Aa=function(){};U.za=function(){};U.ya=function(){};U.isActive=function(){return!0};U.Va=function(){};function Xu(){if(uo&&!(10<=Number(PM)))throw Error("Environmental error: no available transport.")}Xu.prototype.g=function(n,e){return new vn(n,e)};function vn(n,e){Dt.call(this),this.g=new JE(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(n?n["X-WebChannel-Client-Profile"]=e.Ca:n={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=n,(n=e&&e.cc)&&!Ka(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Ka(e)&&(this.g.F=e,n=this.h,n!==null&&e in n&&(n=this.h,e in n&&delete n[e])),this.j=new Vo(this)}At(vn,Dt);vn.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var n=this.g,e=this.l,t=this.h||void 0;Zt(0),n.Y=e,n.na=t||{},n.G=n.aa,n.I=nT(n,null,n.Y),yh(n)};vn.prototype.close=function(){qm(this.g)};vn.prototype.u=function(n){var e=this.g;if(typeof n=="string"){var t={};t.__data__=n,n=t}else this.v&&(t={},t.__data__=Mm(n),n=t);e.j.push(new aO(e.fb++,n)),e.H==3&&yh(e)};vn.prototype.N=function(){this.g.h=null,delete this.j,qm(this.g),delete this.g,vn.$.N.call(this)};function iT(n){Vm.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=e!==null&&n in e?e[n]:void 0),this.data=e}else this.data=n}At(iT,Vm);function oT(){Um.call(this),this.status=1}At(oT,Um);function Vo(n){this.g=n}At(Vo,rT);Vo.prototype.Ba=function(){Ot(this.g,"a")};Vo.prototype.Aa=function(n){Ot(this.g,new iT(n))};Vo.prototype.za=function(n){Ot(this.g,new oT)};Vo.prototype.ya=function(){Ot(this.g,"b")};function vO(){this.blockSize=-1}function qn(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}At(qn,vO);qn.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function Td(n,e,t){t||(t=0);var s=Array(16);if(typeof e=="string")for(var r=0;16>r;++r)s[r]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(r=0;16>r;++r)s[r]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;e=n.g[0],t=n.g[1],r=n.g[2];var i=n.g[3],o=e+(i^t&(r^i))+s[0]+3614090360&4294967295;e=t+(o<<7&4294967295|o>>>25),o=i+(r^e&(t^r))+s[1]+3905402710&4294967295,i=e+(o<<12&4294967295|o>>>20),o=r+(t^i&(e^t))+s[2]+606105819&4294967295,r=i+(o<<17&4294967295|o>>>15),o=t+(e^r&(i^e))+s[3]+3250441966&4294967295,t=r+(o<<22&4294967295|o>>>10),o=e+(i^t&(r^i))+s[4]+4118548399&4294967295,e=t+(o<<7&4294967295|o>>>25),o=i+(r^e&(t^r))+s[5]+1200080426&4294967295,i=e+(o<<12&4294967295|o>>>20),o=r+(t^i&(e^t))+s[6]+2821735955&4294967295,r=i+(o<<17&4294967295|o>>>15),o=t+(e^r&(i^e))+s[7]+4249261313&4294967295,t=r+(o<<22&4294967295|o>>>10),o=e+(i^t&(r^i))+s[8]+1770035416&4294967295,e=t+(o<<7&4294967295|o>>>25),o=i+(r^e&(t^r))+s[9]+2336552879&4294967295,i=e+(o<<12&4294967295|o>>>20),o=r+(t^i&(e^t))+s[10]+4294925233&4294967295,r=i+(o<<17&4294967295|o>>>15),o=t+(e^r&(i^e))+s[11]+2304563134&4294967295,t=r+(o<<22&4294967295|o>>>10),o=e+(i^t&(r^i))+s[12]+1804603682&4294967295,e=t+(o<<7&4294967295|o>>>25),o=i+(r^e&(t^r))+s[13]+4254626195&4294967295,i=e+(o<<12&4294967295|o>>>20),o=r+(t^i&(e^t))+s[14]+2792965006&4294967295,r=i+(o<<17&4294967295|o>>>15),o=t+(e^r&(i^e))+s[15]+1236535329&4294967295,t=r+(o<<22&4294967295|o>>>10),o=e+(r^i&(t^r))+s[1]+4129170786&4294967295,e=t+(o<<5&4294967295|o>>>27),o=i+(t^r&(e^t))+s[6]+3225465664&4294967295,i=e+(o<<9&4294967295|o>>>23),o=r+(e^t&(i^e))+s[11]+643717713&4294967295,r=i+(o<<14&4294967295|o>>>18),o=t+(i^e&(r^i))+s[0]+3921069994&4294967295,t=r+(o<<20&4294967295|o>>>12),o=e+(r^i&(t^r))+s[5]+3593408605&4294967295,e=t+(o<<5&4294967295|o>>>27),o=i+(t^r&(e^t))+s[10]+38016083&4294967295,i=e+(o<<9&4294967295|o>>>23),o=r+(e^t&(i^e))+s[15]+3634488961&4294967295,r=i+(o<<14&4294967295|o>>>18),o=t+(i^e&(r^i))+s[4]+3889429448&4294967295,t=r+(o<<20&4294967295|o>>>12),o=e+(r^i&(t^r))+s[9]+568446438&4294967295,e=t+(o<<5&4294967295|o>>>27),o=i+(t^r&(e^t))+s[14]+3275163606&4294967295,i=e+(o<<9&4294967295|o>>>23),o=r+(e^t&(i^e))+s[3]+4107603335&4294967295,r=i+(o<<14&4294967295|o>>>18),o=t+(i^e&(r^i))+s[8]+1163531501&4294967295,t=r+(o<<20&4294967295|o>>>12),o=e+(r^i&(t^r))+s[13]+2850285829&4294967295,e=t+(o<<5&4294967295|o>>>27),o=i+(t^r&(e^t))+s[2]+4243563512&4294967295,i=e+(o<<9&4294967295|o>>>23),o=r+(e^t&(i^e))+s[7]+1735328473&4294967295,r=i+(o<<14&4294967295|o>>>18),o=t+(i^e&(r^i))+s[12]+2368359562&4294967295,t=r+(o<<20&4294967295|o>>>12),o=e+(t^r^i)+s[5]+4294588738&4294967295,e=t+(o<<4&4294967295|o>>>28),o=i+(e^t^r)+s[8]+2272392833&4294967295,i=e+(o<<11&4294967295|o>>>21),o=r+(i^e^t)+s[11]+1839030562&4294967295,r=i+(o<<16&4294967295|o>>>16),o=t+(r^i^e)+s[14]+4259657740&4294967295,t=r+(o<<23&4294967295|o>>>9),o=e+(t^r^i)+s[1]+2763975236&4294967295,e=t+(o<<4&4294967295|o>>>28),o=i+(e^t^r)+s[4]+1272893353&4294967295,i=e+(o<<11&4294967295|o>>>21),o=r+(i^e^t)+s[7]+4139469664&4294967295,r=i+(o<<16&4294967295|o>>>16),o=t+(r^i^e)+s[10]+3200236656&4294967295,t=r+(o<<23&4294967295|o>>>9),o=e+(t^r^i)+s[13]+681279174&4294967295,e=t+(o<<4&4294967295|o>>>28),o=i+(e^t^r)+s[0]+3936430074&4294967295,i=e+(o<<11&4294967295|o>>>21),o=r+(i^e^t)+s[3]+3572445317&4294967295,r=i+(o<<16&4294967295|o>>>16),o=t+(r^i^e)+s[6]+76029189&4294967295,t=r+(o<<23&4294967295|o>>>9),o=e+(t^r^i)+s[9]+3654602809&4294967295,e=t+(o<<4&4294967295|o>>>28),o=i+(e^t^r)+s[12]+3873151461&4294967295,i=e+(o<<11&4294967295|o>>>21),o=r+(i^e^t)+s[15]+530742520&4294967295,r=i+(o<<16&4294967295|o>>>16),o=t+(r^i^e)+s[2]+3299628645&4294967295,t=r+(o<<23&4294967295|o>>>9),o=e+(r^(t|~i))+s[0]+4096336452&4294967295,e=t+(o<<6&4294967295|o>>>26),o=i+(t^(e|~r))+s[7]+1126891415&4294967295,i=e+(o<<10&4294967295|o>>>22),o=r+(e^(i|~t))+s[14]+2878612391&4294967295,r=i+(o<<15&4294967295|o>>>17),o=t+(i^(r|~e))+s[5]+4237533241&4294967295,t=r+(o<<21&4294967295|o>>>11),o=e+(r^(t|~i))+s[12]+1700485571&4294967295,e=t+(o<<6&4294967295|o>>>26),o=i+(t^(e|~r))+s[3]+2399980690&4294967295,i=e+(o<<10&4294967295|o>>>22),o=r+(e^(i|~t))+s[10]+4293915773&4294967295,r=i+(o<<15&4294967295|o>>>17),o=t+(i^(r|~e))+s[1]+2240044497&4294967295,t=r+(o<<21&4294967295|o>>>11),o=e+(r^(t|~i))+s[8]+1873313359&4294967295,e=t+(o<<6&4294967295|o>>>26),o=i+(t^(e|~r))+s[15]+4264355552&4294967295,i=e+(o<<10&4294967295|o>>>22),o=r+(e^(i|~t))+s[6]+2734768916&4294967295,r=i+(o<<15&4294967295|o>>>17),o=t+(i^(r|~e))+s[13]+1309151649&4294967295,t=r+(o<<21&4294967295|o>>>11),o=e+(r^(t|~i))+s[4]+4149444226&4294967295,e=t+(o<<6&4294967295|o>>>26),o=i+(t^(e|~r))+s[11]+3174756917&4294967295,i=e+(o<<10&4294967295|o>>>22),o=r+(e^(i|~t))+s[2]+718787259&4294967295,r=i+(o<<15&4294967295|o>>>17),o=t+(i^(r|~e))+s[9]+3951481745&4294967295,n.g[0]=n.g[0]+e&4294967295,n.g[1]=n.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,n.g[2]=n.g[2]+r&4294967295,n.g[3]=n.g[3]+i&4294967295}qn.prototype.j=function(n,e){e===void 0&&(e=n.length);for(var t=e-this.blockSize,s=this.m,r=this.h,i=0;i<e;){if(r==0)for(;i<=t;)Td(this,n,i),i+=this.blockSize;if(typeof n=="string"){for(;i<e;)if(s[r++]=n.charCodeAt(i++),r==this.blockSize){Td(this,s),r=0;break}}else for(;i<e;)if(s[r++]=n[i++],r==this.blockSize){Td(this,s),r=0;break}}this.h=r,this.i+=e};qn.prototype.l=function(){var n=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);n[0]=128;for(var e=1;e<n.length-8;++e)n[e]=0;var t=8*this.i;for(e=n.length-8;e<n.length;++e)n[e]=t&255,t/=256;for(this.j(n),n=Array(16),e=t=0;4>e;++e)for(var s=0;32>s;s+=8)n[t++]=this.g[e]>>>s&255;return n};function Re(n,e){this.h=e;for(var t=[],s=!0,r=n.length-1;0<=r;r--){var i=n[r]|0;s&&i==e||(t[r]=i,s=!1)}this.g=t}var wO={};function Gm(n){return-128<=n&&128>n?CM(n,function(e){return new Re([e|0],0>e?-1:0)}):new Re([n|0],0>n?-1:0)}function es(n){if(isNaN(n)||!isFinite(n))return zi;if(0>n)return St(es(-n));for(var e=[],t=1,s=0;n>=t;s++)e[s]=n/t|0,t*=c0;return new Re(e,0)}function aT(n,e){if(n.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(n.charAt(0)=="-")return St(aT(n.substring(1),e));if(0<=n.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=es(Math.pow(e,8)),s=zi,r=0;r<n.length;r+=8){var i=Math.min(8,n.length-r),o=parseInt(n.substring(r,r+i),e);8>i?(i=es(Math.pow(e,i)),s=s.R(i).add(es(o))):(s=s.R(t),s=s.add(es(o)))}return s}var c0=4294967296,zi=Gm(0),u0=Gm(1),By=Gm(16777216);U=Re.prototype;U.ea=function(){if(An(this))return-St(this).ea();for(var n=0,e=1,t=0;t<this.g.length;t++){var s=this.D(t);n+=(0<=s?s:c0+s)*e,e*=c0}return n};U.toString=function(n){if(n=n||10,2>n||36<n)throw Error("radix out of range: "+n);if(Is(this))return"0";if(An(this))return"-"+St(this).toString(n);for(var e=es(Math.pow(n,6)),t=this,s="";;){var r=el(t,e).g;t=Zu(t,r.R(e));var i=((0<t.g.length?t.g[0]:t.h)>>>0).toString(n);if(t=r,Is(t))return i+s;for(;6>i.length;)i="0"+i;s=i+s}};U.D=function(n){return 0>n?0:n<this.g.length?this.g[n]:this.h};function Is(n){if(n.h!=0)return!1;for(var e=0;e<n.g.length;e++)if(n.g[e]!=0)return!1;return!0}function An(n){return n.h==-1}U.X=function(n){return n=Zu(this,n),An(n)?-1:Is(n)?0:1};function St(n){for(var e=n.g.length,t=[],s=0;s<e;s++)t[s]=~n.g[s];return new Re(t,~n.h).add(u0)}U.abs=function(){return An(this)?St(this):this};U.add=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],s=0,r=0;r<=e;r++){var i=s+(this.D(r)&65535)+(n.D(r)&65535),o=(i>>>16)+(this.D(r)>>>16)+(n.D(r)>>>16);s=o>>>16,i&=65535,o&=65535,t[r]=o<<16|i}return new Re(t,t[t.length-1]&-2147483648?-1:0)};function Zu(n,e){return n.add(St(e))}U.R=function(n){if(Is(this)||Is(n))return zi;if(An(this))return An(n)?St(this).R(St(n)):St(St(this).R(n));if(An(n))return St(this.R(St(n)));if(0>this.X(By)&&0>n.X(By))return es(this.ea()*n.ea());for(var e=this.g.length+n.g.length,t=[],s=0;s<2*e;s++)t[s]=0;for(s=0;s<this.g.length;s++)for(var r=0;r<n.g.length;r++){var i=this.D(s)>>>16,o=this.D(s)&65535,a=n.D(r)>>>16,c=n.D(r)&65535;t[2*s+2*r]+=o*c,mu(t,2*s+2*r),t[2*s+2*r+1]+=i*c,mu(t,2*s+2*r+1),t[2*s+2*r+1]+=o*a,mu(t,2*s+2*r+1),t[2*s+2*r+2]+=i*a,mu(t,2*s+2*r+2)}for(s=0;s<e;s++)t[s]=t[2*s+1]<<16|t[2*s];for(s=e;s<2*e;s++)t[s]=0;return new Re(t,0)};function mu(n,e){for(;(n[e]&65535)!=n[e];)n[e+1]+=n[e]>>>16,n[e]&=65535,e++}function ca(n,e){this.g=n,this.h=e}function el(n,e){if(Is(e))throw Error("division by zero");if(Is(n))return new ca(zi,zi);if(An(n))return e=el(St(n),e),new ca(St(e.g),St(e.h));if(An(e))return e=el(n,St(e)),new ca(St(e.g),e.h);if(30<n.g.length){if(An(n)||An(e))throw Error("slowDivide_ only works with positive integers.");for(var t=u0,s=e;0>=s.X(n);)t=Ly(t),s=Ly(s);var r=Si(t,1),i=Si(s,1);for(s=Si(s,2),t=Si(t,2);!Is(s);){var o=i.add(s);0>=o.X(n)&&(r=r.add(t),i=o),s=Si(s,1),t=Si(t,1)}return e=Zu(n,r.R(e)),new ca(r,e)}for(r=zi;0<=n.X(e);){for(t=Math.max(1,Math.floor(n.ea()/e.ea())),s=Math.ceil(Math.log(t)/Math.LN2),s=48>=s?1:Math.pow(2,s-48),i=es(t),o=i.R(e);An(o)||0<o.X(n);)t-=s,i=es(t),o=i.R(e);Is(i)&&(i=u0),r=r.add(i),n=Zu(n,o)}return new ca(r,n)}U.gb=function(n){return el(this,n).h};U.and=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],s=0;s<e;s++)t[s]=this.D(s)&n.D(s);return new Re(t,this.h&n.h)};U.or=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],s=0;s<e;s++)t[s]=this.D(s)|n.D(s);return new Re(t,this.h|n.h)};U.xor=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],s=0;s<e;s++)t[s]=this.D(s)^n.D(s);return new Re(t,this.h^n.h)};function Ly(n){for(var e=n.g.length+1,t=[],s=0;s<e;s++)t[s]=n.D(s)<<1|n.D(s-1)>>>31;return new Re(t,n.h)}function Si(n,e){var t=e>>5;e%=32;for(var s=n.g.length-t,r=[],i=0;i<s;i++)r[i]=0<e?n.D(i+t)>>>e|n.D(i+t+1)<<32-e:n.D(i+t);return new Re(r,n.h)}Xu.prototype.createWebChannel=Xu.prototype.g;vn.prototype.send=vn.prototype.u;vn.prototype.open=vn.prototype.m;vn.prototype.close=vn.prototype.close;uh.NO_ERROR=0;uh.TIMEOUT=8;uh.HTTP_ERROR=6;IE.COMPLETE="complete";DE.EventType=Mc;Mc.OPEN="a";Mc.CLOSE="b";Mc.ERROR="c";Mc.MESSAGE="d";Dt.prototype.listen=Dt.prototype.O;rt.prototype.listenOnce=rt.prototype.P;rt.prototype.getLastError=rt.prototype.Sa;rt.prototype.getLastErrorCode=rt.prototype.Ia;rt.prototype.getStatus=rt.prototype.da;rt.prototype.getResponseJson=rt.prototype.Wa;rt.prototype.getResponseText=rt.prototype.ja;rt.prototype.send=rt.prototype.ha;rt.prototype.setWithCredentials=rt.prototype.Oa;qn.prototype.digest=qn.prototype.l;qn.prototype.reset=qn.prototype.reset;qn.prototype.update=qn.prototype.j;Re.prototype.add=Re.prototype.add;Re.prototype.multiply=Re.prototype.R;Re.prototype.modulo=Re.prototype.gb;Re.prototype.compare=Re.prototype.X;Re.prototype.toNumber=Re.prototype.ea;Re.prototype.toString=Re.prototype.toString;Re.prototype.getBits=Re.prototype.D;Re.fromNumber=es;Re.fromString=aT;var xO=function(){return new Xu},EO=function(){return ch()},Id=uh,TO=IE,IO=gi,Vy={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},pu=DE,DO=rt,AO=qn,Gi=Re;const Uy="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Wt.UNAUTHENTICATED=new Wt(null),Wt.GOOGLE_CREDENTIALS=new Wt("google-credentials-uid"),Wt.FIRST_PARTY=new Wt("first-party-uid"),Wt.MOCK_USER=new Wt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Uo="10.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const si=new Ul("@firebase/firestore");function ua(){return si.logLevel}function q(n,...e){if(si.logLevel<=pe.DEBUG){const t=e.map(Jm);si.debug(`Firestore (${Uo}): ${n}`,...t)}}function Us(n,...e){if(si.logLevel<=pe.ERROR){const t=e.map(Jm);si.error(`Firestore (${Uo}): ${n}`,...t)}}function lo(n,...e){if(si.logLevel<=pe.WARN){const t=e.map(Jm);si.warn(`Firestore (${Uo}): ${n}`,...t)}}function Jm(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ee(n="Unexpected state"){const e=`FIRESTORE (${Uo}) INTERNAL ASSERTION FAILED: `+n;throw Us(e),new Error(e)}function ke(n,e){n||ee()}function ie(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Y extends zs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cT{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class bO{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Wt.UNAUTHENTICATED))}shutdown(){}}class CO{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class kO{constructor(e){this.t=e,this.currentUser=Wt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let s=this.i;const r=c=>this.i!==s?(s=this.i,t(c)):Promise.resolve();let i=new ns;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ns,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await r(this.currentUser)})},a=c=>{q("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(q("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ns)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(s=>this.i!==e?(q("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(ke(typeof s.accessToken=="string"),new cT(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return ke(e===null||typeof e=="string"),new Wt(e)}}class SO{constructor(e,t,s){this.l=e,this.h=t,this.P=s,this.type="FirstParty",this.user=Wt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class PO{constructor(e,t,s){this.l=e,this.h=t,this.P=s}getToken(){return Promise.resolve(new SO(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Wt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class RO{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class NO{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const s=i=>{i.error!=null&&q("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,q("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>s(i))};const r=i=>{q("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?r(i):q("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ke(typeof t.token=="string"),this.R=t.token,new RO(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MO(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uT{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let s="";for(;s.length<20;){const r=MO(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<t&&(s+=e.charAt(r[i]%e.length))}return s}}function be(n,e){return n<e?-1:n>e?1:0}function ho(n,e,t){return n.length===e.length&&n.every((s,r)=>t(s,e[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Be{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Y(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Y(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Y(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Y(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Be.fromMillis(Date.now())}static fromDate(e){return Be.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor(1e6*(e-1e3*t));return new Be(t,s)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?be(this.nanoseconds,e.nanoseconds):be(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ne{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ne(e)}static min(){return new ne(new Be(0,0))}static max(){return new ne(new Be(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rc{constructor(e,t,s){t===void 0?t=0:t>e.length&&ee(),s===void 0?s=e.length-t:s>e.length-t&&ee(),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return rc.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof rc?e.forEach(s=>{t.push(s)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let r=0;r<s;r++){const i=e.get(r),o=t.get(r);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Qe extends rc{construct(e,t,s){return new Qe(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new Y(R.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter(r=>r.length>0))}return new Qe(t)}static emptyPath(){return new Qe([])}}const OO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Rt extends rc{construct(e,t,s){return new Rt(e,t,s)}static isValidIdentifier(e){return OO.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Rt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Rt(["__name__"])}static fromServerFormat(e){const t=[];let s="",r=0;const i=()=>{if(s.length===0)throw new Y(R.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new Y(R.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[r+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Y(R.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=c,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(s+=a,r++):(i(),r++)}if(i(),o)throw new Y(R.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Rt(t)}static emptyPath(){return new Rt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j{constructor(e){this.path=e}static fromPath(e){return new j(Qe.fromString(e))}static fromName(e){return new j(Qe.fromString(e).popFirst(5))}static empty(){return new j(Qe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Qe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Qe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new j(new Qe(e.slice()))}}function FO(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,r=ne.fromTimestamp(s===1e9?new Be(t+1,0):new Be(t,s));return new vr(r,j.empty(),e)}function BO(n){return new vr(n.readTime,n.key,-1)}class vr{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new vr(ne.min(),j.empty(),-1)}static max(){return new vr(ne.max(),j.empty(),-1)}}function LO(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=j.comparator(n.documentKey,e.documentKey),t!==0?t:be(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VO="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class UO{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vc(n){if(n.code!==R.FAILED_PRECONDITION||n.message!==VO)throw n;q("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ee(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new M((s,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,r)},this.catchCallback=i=>{this.wrapFailure(t,i).next(s,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof M?t:M.resolve(t)}catch(t){return M.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):M.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):M.reject(t)}static resolve(e){return new M((t,s)=>{t(e)})}static reject(e){return new M((t,s)=>{s(e)})}static waitFor(e){return new M((t,s)=>{let r=0,i=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++i,o&&i===r&&t()},c=>s(c))}),o=!0,i===r&&t()})}static or(e){let t=M.resolve(!1);for(const s of e)t=t.next(r=>r?M.resolve(r):s());return t}static forEach(e,t){const s=[];return e.forEach((r,i)=>{s.push(t.call(this,r,i))}),this.waitFor(s)}static mapArray(e,t){return new M((s,r)=>{const i=e.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const u=c;t(e[u]).next(l=>{o[u]=l,++a,a===i&&s(o)},l=>r(l))}})}static doWhile(e,t){return new M((s,r)=>{const i=()=>{e()===!0?t().next(()=>{i()},r):s()};i()})}}function Uc(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qm{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this.se(s),this.oe=s=>t.writeSequenceNumber(s))}se(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.oe&&this.oe(e),e}}Qm._e=-1;function Wc(n){return n==null}function tl(n){return n===0&&1/n==-1/0}function WO(n){return typeof n=="number"&&Number.isInteger(n)&&!tl(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wy(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function yi(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function lT(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ht=class l0{constructor(e,t){this.comparator=e,this.root=t||dr.EMPTY}insert(e,t){return new l0(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,dr.BLACK,null,null))}remove(e){return new l0(this.comparator,this.root.remove(e,this.comparator).copy(null,null,dr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return t+s.left.size;r<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,s)=>(e(t,s),!1))}toString(){const e=[];return this.inorderTraversal((t,s)=>(e.push(`${t}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new gu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new gu(this.root,e,this.comparator,!1)}getReverseIterator(){return new gu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new gu(this.root,e,this.comparator,!0)}},gu=class{constructor(e,t,s,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?s(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},dr=class ps{constructor(e,t,s,r,i){this.key=e,this.value=t,this.color=s??ps.RED,this.left=r??ps.EMPTY,this.right=i??ps.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,r,i){return new ps(e??this.key,t??this.value,s??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let r=this;const i=s(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,s),null):i===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return ps.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return ps.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ps.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ps.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ee();const e=this.left.check();if(e!==this.right.check())throw ee();return e+(this.isRed()?0:1)}};dr.EMPTY=null,dr.RED=!0,dr.BLACK=!1;dr.EMPTY=new class{constructor(){this.size=0}get key(){throw ee()}get value(){throw ee()}get color(){throw ee()}get left(){throw ee()}get right(){throw ee()}copy(e,t,s,r,i){return this}insert(e,t,s){return new dr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e){this.comparator=e,this.data=new ht(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,s)=>(e(t),!1))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Hy(this.data.getIterator())}getIteratorFrom(e){return new Hy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(s=>{t=t.add(s)}),t}isEqual(e){if(!(e instanceof Ft)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=s.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Ft(this.comparator);return t.data=e,t}}class Hy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e){this.fields=e,e.sort(Rt.comparator)}static empty(){return new gn([])}unionWith(e){let t=new Ft(Rt.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new gn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ho(this.fields,e.fields,(t,s)=>t.isEqual(s))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new hT("Invalid base64 string: "+i):i}}(e);return new Qt(t)}static fromUint8Array(e){const t=function(r){let i="";for(let o=0;o<r.length;++o)i+=String.fromCharCode(r[o]);return i}(e);return new Qt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const s=new Uint8Array(t.length);for(let r=0;r<t.length;r++)s[r]=t.charCodeAt(r);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return be(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Qt.EMPTY_BYTE_STRING=new Qt("");const HO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function wr(n){if(ke(!!n),typeof n=="string"){let e=0;const t=HO.exec(n);if(ke(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:lt(n.seconds),nanos:lt(n.nanos)}}function lt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ri(n){return typeof n=="string"?Qt.fromBase64String(n):Qt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Km(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function jm(n){const e=n.mapValue.fields.__previous_value__;return Km(e)?jm(e):e}function ic(n){const e=wr(n.mapValue.fields.__local_write_time__.timestampValue);return new Be(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $O{constructor(e,t,s,r,i,o,a,c,u){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u}}class oc{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new oc("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof oc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yu={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function ii(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Km(n)?4:qO(n)?9007199254740991:10:ee()}function as(n,e){if(n===e)return!0;const t=ii(n);if(t!==ii(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return ic(n).isEqual(ic(e));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const o=wr(r.timestampValue),a=wr(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(r,i){return ri(r.bytesValue).isEqual(ri(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,i){return lt(r.geoPointValue.latitude)===lt(i.geoPointValue.latitude)&&lt(r.geoPointValue.longitude)===lt(i.geoPointValue.longitude)}(n,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return lt(r.integerValue)===lt(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const o=lt(r.doubleValue),a=lt(i.doubleValue);return o===a?tl(o)===tl(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return ho(n.arrayValue.values||[],e.arrayValue.values||[],as);case 10:return function(r,i){const o=r.mapValue.fields||{},a=i.mapValue.fields||{};if(Wy(o)!==Wy(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!as(o[c],a[c])))return!1;return!0}(n,e);default:return ee()}}function ac(n,e){return(n.values||[]).find(t=>as(t,e))!==void 0}function fo(n,e){if(n===e)return 0;const t=ii(n),s=ii(e);if(t!==s)return be(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return be(n.booleanValue,e.booleanValue);case 2:return function(i,o){const a=lt(i.integerValue||i.doubleValue),c=lt(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return $y(n.timestampValue,e.timestampValue);case 4:return $y(ic(n),ic(e));case 5:return be(n.stringValue,e.stringValue);case 6:return function(i,o){const a=ri(i),c=ri(o);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),c=o.split("/");for(let u=0;u<a.length&&u<c.length;u++){const l=be(a[u],c[u]);if(l!==0)return l}return be(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,o){const a=be(lt(i.latitude),lt(o.latitude));return a!==0?a:be(lt(i.longitude),lt(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(i,o){const a=i.values||[],c=o.values||[];for(let u=0;u<a.length&&u<c.length;++u){const l=fo(a[u],c[u]);if(l)return l}return be(a.length,c.length)}(n.arrayValue,e.arrayValue);case 10:return function(i,o){if(i===yu.mapValue&&o===yu.mapValue)return 0;if(i===yu.mapValue)return 1;if(o===yu.mapValue)return-1;const a=i.fields||{},c=Object.keys(a),u=o.fields||{},l=Object.keys(u);c.sort(),l.sort();for(let d=0;d<c.length&&d<l.length;++d){const f=be(c[d],l[d]);if(f!==0)return f;const m=fo(a[c[d]],u[l[d]]);if(m!==0)return m}return be(c.length,l.length)}(n.mapValue,e.mapValue);default:throw ee()}}function $y(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return be(n,e);const t=wr(n),s=wr(e),r=be(t.seconds,s.seconds);return r!==0?r:be(t.nanos,s.nanos)}function mo(n){return h0(n)}function h0(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const s=wr(t);return`time(${s.seconds},${s.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return ri(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return j.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let s="[",r=!0;for(const i of t.values||[])r?r=!1:s+=",",s+=h0(i);return s+"]"}(n.arrayValue):"mapValue"in n?function(t){const s=Object.keys(t.fields||{}).sort();let r="{",i=!0;for(const o of s)i?i=!1:r+=",",r+=`${o}:${h0(t.fields[o])}`;return r+"}"}(n.mapValue):ee()}function d0(n){return!!n&&"integerValue"in n}function Xm(n){return!!n&&"arrayValue"in n}function qy(n){return!!n&&"nullValue"in n}function Yy(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Cu(n){return!!n&&"mapValue"in n}function Da(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return yi(n.mapValue.fields,(t,s)=>e.mapValue.fields[t]=Da(s)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Da(n.arrayValue.values[t]);return e}return Object.assign({},n)}function qO(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e){this.value=e}static empty(){return new Xt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!Cu(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Da(t)}setAll(e){let t=Rt.emptyPath(),s={},r=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const c=this.getFieldsMap(t);this.applyChanges(c,s,r),s={},r=[],t=a.popLast()}o?s[a.lastSegment()]=Da(o):r.push(a.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,s,r)}delete(e){const t=this.field(e.popLast());Cu(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return as(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=t.mapValue.fields[e.get(s)];Cu(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,s){yi(t,(r,i)=>e[r]=i);for(const r of s)delete e[r]}clone(){return new Xt(Da(this.value))}}function dT(n){const e=[];return yi(n.fields,(t,s)=>{const r=new Rt([t]);if(Cu(s)){const i=dT(s.mapValue).fields;if(i.length===0)e.push(r);else for(const o of i)e.push(r.child(o))}else e.push(r)}),new gn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e,t,s,r,i,o,a){this.key=e,this.documentType=t,this.version=s,this.readTime=r,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Et(e,0,ne.min(),ne.min(),ne.min(),Xt.empty(),0)}static newFoundDocument(e,t,s,r){return new Et(e,1,t,ne.min(),s,r,0)}static newNoDocument(e,t){return new Et(e,2,t,ne.min(),ne.min(),Xt.empty(),0)}static newUnknownDocument(e,t){return new Et(e,3,t,ne.min(),ne.min(),Xt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ne.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Xt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Xt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ne.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Et&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Et(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(e,t){this.position=e,this.inclusive=t}}function zy(n,e,t){let s=0;for(let r=0;r<n.position.length;r++){const i=e[r],o=n.position[r];if(i.field.isKeyField()?s=j.comparator(j.fromName(o.referenceValue),t.key):s=fo(o,t.data.field(i.field)),i.dir==="desc"&&(s*=-1),s!==0)break}return s}function Gy(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!as(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sl{constructor(e,t="asc"){this.field=e,this.dir=t}}function YO(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fT{}class pt extends fT{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new GO(e,t,s):t==="array-contains"?new KO(e,s):t==="in"?new jO(e,s):t==="not-in"?new XO(e,s):t==="array-contains-any"?new ZO(e,s):new pt(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new JO(e,s):new QO(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(fo(t,this.value)):t!==null&&ii(this.value)===ii(t)&&this.matchesComparison(fo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ee()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class cs extends fT{constructor(e,t){super(),this.filters=e,this.op=t,this.ue=null}static create(e,t){return new cs(e,t)}matches(e){return mT(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function mT(n){return n.op==="and"}function pT(n){return zO(n)&&mT(n)}function zO(n){for(const e of n.filters)if(e instanceof cs)return!1;return!0}function f0(n){if(n instanceof pt)return n.field.canonicalString()+n.op.toString()+mo(n.value);if(pT(n))return n.filters.map(e=>f0(e)).join(",");{const e=n.filters.map(t=>f0(t)).join(",");return`${n.op}(${e})`}}function gT(n,e){return n instanceof pt?function(s,r){return r instanceof pt&&s.op===r.op&&s.field.isEqual(r.field)&&as(s.value,r.value)}(n,e):n instanceof cs?function(s,r){return r instanceof cs&&s.op===r.op&&s.filters.length===r.filters.length?s.filters.reduce((i,o,a)=>i&&gT(o,r.filters[a]),!0):!1}(n,e):void ee()}function yT(n){return n instanceof pt?function(t){return`${t.field.canonicalString()} ${t.op} ${mo(t.value)}`}(n):n instanceof cs?function(t){return t.op.toString()+" {"+t.getFilters().map(yT).join(" ,")+"}"}(n):"Filter"}class GO extends pt{constructor(e,t,s){super(e,t,s),this.key=j.fromName(s.referenceValue)}matches(e){const t=j.comparator(e.key,this.key);return this.matchesComparison(t)}}class JO extends pt{constructor(e,t){super(e,"in",t),this.keys=_T("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class QO extends pt{constructor(e,t){super(e,"not-in",t),this.keys=_T("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function _T(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(s=>j.fromName(s.referenceValue))}class KO extends pt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Xm(t)&&ac(t.arrayValue,this.value)}}class jO extends pt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&ac(this.value.arrayValue,t)}}class XO extends pt{constructor(e,t){super(e,"not-in",t)}matches(e){if(ac(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!ac(this.value.arrayValue,t)}}class ZO extends pt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Xm(t)||!t.arrayValue.values)&&t.arrayValue.values.some(s=>ac(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e4{constructor(e,t=null,s=[],r=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.ce=null}}function Jy(n,e=null,t=[],s=[],r=null,i=null,o=null){return new e4(n,e,t,s,r,i,o)}function Zm(n){const e=ie(n);if(e.ce===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(s=>f0(s)).join(","),t+="|ob:",t+=e.orderBy.map(s=>function(i){return i.field.canonicalString()+i.dir}(s)).join(","),Wc(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(s=>mo(s)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(s=>mo(s)).join(",")),e.ce=t}return e.ce}function ep(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!YO(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!gT(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Gy(n.startAt,e.startAt)&&Gy(n.endAt,e.endAt)}function m0(n){return j.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _h{constructor(e,t=null,s=[],r=[],i=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function t4(n,e,t,s,r,i,o,a){return new _h(n,e,t,s,r,i,o,a)}function vh(n){return new _h(n)}function Qy(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function n4(n){return n.collectionGroup!==null}function Aa(n){const e=ie(n);if(e.le===null){e.le=[];const t=new Set;for(const i of e.explicitOrderBy)e.le.push(i),t.add(i.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ft(Rt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.le.push(new sl(i,s))}),t.has(Rt.keyField().canonicalString())||e.le.push(new sl(Rt.keyField(),s))}return e.le}function ss(n){const e=ie(n);return e.he||(e.he=s4(e,Aa(n))),e.he}function s4(n,e){if(n.limitType==="F")return Jy(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{const i=r.dir==="desc"?"asc":"desc";return new sl(r.field,i)});const t=n.endAt?new nl(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new nl(n.startAt.position,n.startAt.inclusive):null;return Jy(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function p0(n,e,t){return new _h(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function wh(n,e){return ep(ss(n),ss(e))&&n.limitType===e.limitType}function vT(n){return`${Zm(ss(n))}|lt:${n.limitType}`}function Mi(n){return`Query(target=${function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map(r=>yT(r)).join(", ")}]`),Wc(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map(r=>mo(r)).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map(r=>mo(r)).join(",")),`Target(${s})`}(ss(n))}; limitType=${n.limitType})`}function xh(n,e){return e.isFoundDocument()&&function(s,r){const i=r.key.path;return s.collectionGroup!==null?r.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(i):j.isDocumentKey(s.path)?s.path.isEqual(i):s.path.isImmediateParentOf(i)}(n,e)&&function(s,r){for(const i of Aa(s))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0}(n,e)&&function(s,r){for(const i of s.filters)if(!i.matches(r))return!1;return!0}(n,e)&&function(s,r){return!(s.startAt&&!function(o,a,c){const u=zy(o,a,c);return o.inclusive?u<=0:u<0}(s.startAt,Aa(s),r)||s.endAt&&!function(o,a,c){const u=zy(o,a,c);return o.inclusive?u>=0:u>0}(s.endAt,Aa(s),r))}(n,e)}function r4(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function wT(n){return(e,t)=>{let s=!1;for(const r of Aa(n)){const i=i4(r,e,t);if(i!==0)return i;s=s||r.field.isKeyField()}return 0}}function i4(n,e,t){const s=n.field.isKeyField()?j.comparator(e.key,t.key):function(i,o,a){const c=o.data.field(i),u=a.data.field(i);return c!==null&&u!==null?fo(c,u):ee()}(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return ee()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[r,i]of s)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[t]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){yi(this.inner,(t,s)=>{for(const[r,i]of s)e(r,i)})}isEmpty(){return lT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o4=new ht(j.comparator);function Ws(){return o4}const xT=new ht(j.comparator);function ga(...n){let e=xT;for(const t of n)e=e.insert(t.key,t);return e}function ET(n){let e=xT;return n.forEach((t,s)=>e=e.insert(t,s.overlayedDocument)),e}function qr(){return ba()}function TT(){return ba()}function ba(){return new Wo(n=>n.toString(),(n,e)=>n.isEqual(e))}const a4=new ht(j.comparator),c4=new Ft(j.comparator);function ge(...n){let e=c4;for(const t of n)e=e.add(t);return e}const u4=new Ft(be);function l4(){return u4}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IT(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:tl(e)?"-0":e}}function DT(n){return{integerValue:""+n}}function AT(n,e){return WO(e)?DT(e):IT(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh{constructor(){this._=void 0}}function h4(n,e,t){return n instanceof rl?function(r,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&Km(i)&&(i=jm(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(t,e):n instanceof po?CT(n,e):n instanceof go?kT(n,e):function(r,i){const o=bT(r,i),a=Ky(o)+Ky(r.Ie);return d0(o)&&d0(r.Ie)?DT(a):IT(r.serializer,a)}(n,e)}function d4(n,e,t){return n instanceof po?CT(n,e):n instanceof go?kT(n,e):t}function bT(n,e){return n instanceof cc?function(s){return d0(s)||function(i){return!!i&&"doubleValue"in i}(s)}(e)?e:{integerValue:0}:null}class rl extends Eh{}class po extends Eh{constructor(e){super(),this.elements=e}}function CT(n,e){const t=ST(e);for(const s of n.elements)t.some(r=>as(r,s))||t.push(s);return{arrayValue:{values:t}}}class go extends Eh{constructor(e){super(),this.elements=e}}function kT(n,e){let t=ST(e);for(const s of n.elements)t=t.filter(r=>!as(r,s));return{arrayValue:{values:t}}}class cc extends Eh{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function Ky(n){return lt(n.integerValue||n.doubleValue)}function ST(n){return Xm(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp{constructor(e,t){this.field=e,this.transform=t}}function f4(n,e){return n.field.isEqual(e.field)&&function(s,r){return s instanceof po&&r instanceof po||s instanceof go&&r instanceof go?ho(s.elements,r.elements,as):s instanceof cc&&r instanceof cc?as(s.Ie,r.Ie):s instanceof rl&&r instanceof rl}(n.transform,e.transform)}class m4{constructor(e,t){this.version=e,this.transformResults=t}}class $t{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new $t}static exists(e){return new $t(void 0,e)}static updateTime(e){return new $t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ku(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Th{}function PT(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Ih(n.key,$t.none()):new Hc(n.key,n.data,$t.none());{const t=n.data,s=Xt.empty();let r=new Ft(Rt.comparator);for(let i of e.fields)if(!r.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?s.delete(i):s.set(i,o),r=r.add(i)}return new Cr(n.key,s,new gn(r.toArray()),$t.none())}}function p4(n,e,t){n instanceof Hc?function(r,i,o){const a=r.value.clone(),c=Xy(r.fieldTransforms,i,o.transformResults);a.setAll(c),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Cr?function(r,i,o){if(!ku(r.precondition,i))return void i.convertToUnknownDocument(o.version);const a=Xy(r.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(RT(r)),c.setAll(a),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):function(r,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Ca(n,e,t,s){return n instanceof Hc?function(i,o,a,c){if(!ku(i.precondition,o))return a;const u=i.value.clone(),l=Zy(i.fieldTransforms,c,o);return u.setAll(l),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(n,e,t,s):n instanceof Cr?function(i,o,a,c){if(!ku(i.precondition,o))return a;const u=Zy(i.fieldTransforms,c,o),l=o.data;return l.setAll(RT(i)),l.setAll(u),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(d=>d.field))}(n,e,t,s):function(i,o,a){return ku(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function g4(n,e){let t=null;for(const s of n.fieldTransforms){const r=e.data.field(s.field),i=bT(s.transform,r||null);i!=null&&(t===null&&(t=Xt.empty()),t.set(s.field,i))}return t||null}function jy(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(s,r){return s===void 0&&r===void 0||!(!s||!r)&&ho(s,r,(i,o)=>f4(i,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Hc extends Th{constructor(e,t,s,r=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Cr extends Th{constructor(e,t,s,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function RT(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}}),e}function Xy(n,e,t){const s=new Map;ke(n.length===t.length);for(let r=0;r<t.length;r++){const i=n[r],o=i.transform,a=e.data.field(i.field);s.set(i.field,d4(o,a,t[r]))}return s}function Zy(n,e,t){const s=new Map;for(const r of n){const i=r.transform,o=t.data.field(r.field);s.set(r.field,h4(i,o,e))}return s}class Ih extends Th{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class NT extends Th{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y4{constructor(e,t,s,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&p4(i,e,s[r])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=Ca(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=Ca(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=TT();return this.mutations.forEach(r=>{const i=e.get(r.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(r.key)?null:a;const c=PT(o,a);c!==null&&s.set(r.key,c),o.isValidDocument()||o.convertToNoDocument(ne.min())}),s}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ge())}isEqual(e){return this.batchId===e.batchId&&ho(this.mutations,e.mutations,(t,s)=>jy(t,s))&&ho(this.baseMutations,e.baseMutations,(t,s)=>jy(t,s))}}class np{constructor(e,t,s,r){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=r}static from(e,t,s){ke(e.mutations.length===s.length);let r=function(){return a4}();const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,s[o].version);return new np(e,t,s,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _4{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v4{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ct,we;function MT(n){switch(n){default:return ee();case R.CANCELLED:case R.UNKNOWN:case R.DEADLINE_EXCEEDED:case R.RESOURCE_EXHAUSTED:case R.INTERNAL:case R.UNAVAILABLE:case R.UNAUTHENTICATED:return!1;case R.INVALID_ARGUMENT:case R.NOT_FOUND:case R.ALREADY_EXISTS:case R.PERMISSION_DENIED:case R.FAILED_PRECONDITION:case R.ABORTED:case R.OUT_OF_RANGE:case R.UNIMPLEMENTED:case R.DATA_LOSS:return!0}}function OT(n){if(n===void 0)return Us("GRPC error has no .code"),R.UNKNOWN;switch(n){case ct.OK:return R.OK;case ct.CANCELLED:return R.CANCELLED;case ct.UNKNOWN:return R.UNKNOWN;case ct.DEADLINE_EXCEEDED:return R.DEADLINE_EXCEEDED;case ct.RESOURCE_EXHAUSTED:return R.RESOURCE_EXHAUSTED;case ct.INTERNAL:return R.INTERNAL;case ct.UNAVAILABLE:return R.UNAVAILABLE;case ct.UNAUTHENTICATED:return R.UNAUTHENTICATED;case ct.INVALID_ARGUMENT:return R.INVALID_ARGUMENT;case ct.NOT_FOUND:return R.NOT_FOUND;case ct.ALREADY_EXISTS:return R.ALREADY_EXISTS;case ct.PERMISSION_DENIED:return R.PERMISSION_DENIED;case ct.FAILED_PRECONDITION:return R.FAILED_PRECONDITION;case ct.ABORTED:return R.ABORTED;case ct.OUT_OF_RANGE:return R.OUT_OF_RANGE;case ct.UNIMPLEMENTED:return R.UNIMPLEMENTED;case ct.DATA_LOSS:return R.DATA_LOSS;default:return ee()}}(we=ct||(ct={}))[we.OK=0]="OK",we[we.CANCELLED=1]="CANCELLED",we[we.UNKNOWN=2]="UNKNOWN",we[we.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",we[we.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",we[we.NOT_FOUND=5]="NOT_FOUND",we[we.ALREADY_EXISTS=6]="ALREADY_EXISTS",we[we.PERMISSION_DENIED=7]="PERMISSION_DENIED",we[we.UNAUTHENTICATED=16]="UNAUTHENTICATED",we[we.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",we[we.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",we[we.ABORTED=10]="ABORTED",we[we.OUT_OF_RANGE=11]="OUT_OF_RANGE",we[we.UNIMPLEMENTED=12]="UNIMPLEMENTED",we[we.INTERNAL=13]="INTERNAL",we[we.UNAVAILABLE=14]="UNAVAILABLE",we[we.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w4(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x4=new Gi([4294967295,4294967295],0);function e_(n){const e=w4().encode(n),t=new AO;return t.update(e),new Uint8Array(t.digest())}function t_(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),r=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Gi([t,s],0),new Gi([r,i],0)]}class sp{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new ya(`Invalid padding: ${t}`);if(s<0)throw new ya(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new ya(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new ya(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ee=Gi.fromNumber(this.Te)}de(e,t,s){let r=e.add(t.multiply(Gi.fromNumber(s)));return r.compare(x4)===1&&(r=new Gi([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;const t=e_(e),[s,r]=t_(t);for(let i=0;i<this.hashCount;i++){const o=this.de(s,r,i);if(!this.Ae(o))return!1}return!0}static create(e,t,s){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new sp(i,r,t);return s.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;const t=e_(e),[s,r]=t_(t);for(let i=0;i<this.hashCount;i++){const o=this.de(s,r,i);this.Re(o)}}Re(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class ya extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dh{constructor(e,t,s,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const r=new Map;return r.set(e,$c.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new Dh(ne.min(),r,new ht(be),Ws(),ge())}}class $c{constructor(e,t,s,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new $c(s,t,ge(),ge(),ge())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Su{constructor(e,t,s,r){this.Ve=e,this.removedTargetIds=t,this.key=s,this.me=r}}class FT{constructor(e,t){this.targetId=e,this.fe=t}}class BT{constructor(e,t,s=Qt.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=r}}class n_{constructor(){this.ge=0,this.pe=r_(),this.ye=Qt.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=ge(),t=ge(),s=ge();return this.pe.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:s=s.add(r);break;default:ee()}}),new $c(this.ye,this.we,e,t,s)}Fe(){this.Se=!1,this.pe=r_()}Me(e,t){this.Se=!0,this.pe=this.pe.insert(e,t)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,ke(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class E4{constructor(e){this.Le=e,this.ke=new Map,this.qe=Ws(),this.Qe=s_(),this.Ke=new ht(be)}$e(e){for(const t of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(t,e.me):this.We(t,e.key,e.me);for(const t of e.removedTargetIds)this.We(t,e.key,e.me)}Ge(e){this.forEachTarget(e,t=>{const s=this.ze(t);switch(e.state){case 0:this.je(t)&&s.Ce(e.resumeToken);break;case 1:s.Ne(),s.be||s.Fe(),s.Ce(e.resumeToken);break;case 2:s.Ne(),s.be||this.removeTarget(t);break;case 3:this.je(t)&&(s.Be(),s.Ce(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),s.Ce(e.resumeToken));break;default:ee()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ke.forEach((s,r)=>{this.je(r)&&t(r)})}Je(e){const t=e.targetId,s=e.fe.count,r=this.Ye(t);if(r){const i=r.target;if(m0(i))if(s===0){const o=new j(i.path);this.We(t,o,Et.newNoDocument(o,ne.min()))}else ke(s===1);else{const o=this.Ze(t);if(o!==s){const a=this.Xe(e),c=a?this.et(a,e,o):1;if(c!==0){this.He(t);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,u)}}}}}Xe(e){const t=e.fe.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:r=0},hashCount:i=0}=t;let o,a;try{o=ri(s).toUint8Array()}catch(c){if(c instanceof hT)return lo("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new sp(o,r,i)}catch(c){return lo(c instanceof ya?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Te===0?null:a}et(e,t,s){return t.fe.count===s-this.rt(e,t.targetId)?0:2}rt(e,t){const s=this.Le.getRemoteKeysForTarget(t);let r=0;return s.forEach(i=>{const o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.We(t,i,null),r++)}),r}it(e){const t=new Map;this.ke.forEach((i,o)=>{const a=this.Ye(o);if(a){if(i.current&&m0(a.target)){const c=new j(a.target.path);this.qe.get(c)!==null||this.st(o,c)||this.We(o,c,Et.newNoDocument(c,e))}i.De&&(t.set(o,i.ve()),i.Fe())}});let s=ge();this.Qe.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const u=this.Ye(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(s=s.add(i))}),this.qe.forEach((i,o)=>o.setReadTime(e));const r=new Dh(e,t,this.Ke,this.qe,s);return this.qe=Ws(),this.Qe=s_(),this.Ke=new ht(be),r}Ue(e,t){if(!this.je(e))return;const s=this.st(e,t.key)?2:0;this.ze(e).Me(t.key,s),this.qe=this.qe.insert(t.key,t),this.Qe=this.Qe.insert(t.key,this.ot(t.key).add(e))}We(e,t,s){if(!this.je(e))return;const r=this.ze(e);this.st(e,t)?r.Me(t,1):r.xe(t),this.Qe=this.Qe.insert(t,this.ot(t).delete(e)),s&&(this.qe=this.qe.insert(t,s))}removeTarget(e){this.ke.delete(e)}Ze(e){const t=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let t=this.ke.get(e);return t||(t=new n_,this.ke.set(e,t)),t}ot(e){let t=this.Qe.get(e);return t||(t=new Ft(be),this.Qe=this.Qe.insert(e,t)),t}je(e){const t=this.Ye(e)!==null;return t||q("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){const t=this.ke.get(e);return t&&t.be?null:this.Le._t(e)}He(e){this.ke.set(e,new n_),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.We(e,t,null)})}st(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function s_(){return new ht(j.comparator)}function r_(){return new ht(j.comparator)}const T4={asc:"ASCENDING",desc:"DESCENDING"},I4={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},D4={and:"AND",or:"OR"};class A4{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function g0(n,e){return n.useProto3Json||Wc(e)?e:{value:e}}function il(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function LT(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function b4(n,e){return il(n,e.toTimestamp())}function yn(n){return ke(!!n),ne.fromTimestamp(function(t){const s=wr(t);return new Be(s.seconds,s.nanos)}(n))}function rp(n,e){return function(s){return new Qe(["projects",s.projectId,"databases",s.database])}(n).child("documents").child(e).canonicalString()}function VT(n){const e=Qe.fromString(n);return ke(qT(e)),e}function ol(n,e){return rp(n.databaseId,e.path)}function ka(n,e){const t=VT(e);if(t.get(1)!==n.databaseId.projectId)throw new Y(R.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Y(R.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new j(UT(t))}function y0(n,e){return rp(n.databaseId,e)}function C4(n){const e=VT(n);return e.length===4?Qe.emptyPath():UT(e)}function uc(n){return new Qe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function UT(n){return ke(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function i_(n,e,t){return{name:ol(n,e),fields:t.value.mapValue.fields}}function k4(n,e){return"found"in e?function(s,r){ke(!!r.found),r.found.name,r.found.updateTime;const i=ka(s,r.found.name),o=yn(r.found.updateTime),a=r.found.createTime?yn(r.found.createTime):ne.min(),c=new Xt({mapValue:{fields:r.found.fields}});return Et.newFoundDocument(i,o,a,c)}(n,e):"missing"in e?function(s,r){ke(!!r.missing),ke(!!r.readTime);const i=ka(s,r.missing),o=yn(r.readTime);return Et.newNoDocument(i,o)}(n,e):ee()}function S4(n,e){let t;if("targetChange"in e){e.targetChange;const s=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:ee()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(u,l){return u.useProto3Json?(ke(l===void 0||typeof l=="string"),Qt.fromBase64String(l||"")):(ke(l===void 0||l instanceof Uint8Array),Qt.fromUint8Array(l||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const l=u.code===void 0?R.UNKNOWN:OT(u.code);return new Y(l,u.message||"")}(o);t=new BT(s,r,i,a||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=ka(n,s.document.name),i=yn(s.document.updateTime),o=s.document.createTime?yn(s.document.createTime):ne.min(),a=new Xt({mapValue:{fields:s.document.fields}}),c=Et.newFoundDocument(r,i,o,a),u=s.targetIds||[],l=s.removedTargetIds||[];t=new Su(u,l,c.key,c)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=ka(n,s.document),i=s.readTime?yn(s.readTime):ne.min(),o=Et.newNoDocument(r,i),a=s.removedTargetIds||[];t=new Su([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=ka(n,s.document),i=s.removedTargetIds||[];t=new Su([],i,r,null)}else{if(!("filter"in e))return ee();{e.filter;const s=e.filter;s.targetId;const{count:r=0,unchangedNames:i}=s,o=new v4(r,i),a=s.targetId;t=new FT(a,o)}}return t}function WT(n,e){let t;if(e instanceof Hc)t={update:i_(n,e.key,e.value)};else if(e instanceof Ih)t={delete:ol(n,e.key)};else if(e instanceof Cr)t={update:i_(n,e.key,e.data),updateMask:V4(e.fieldMask)};else{if(!(e instanceof NT))return ee();t={verify:ol(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(s=>function(i,o){const a=o.transform;if(a instanceof rl)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof po)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof go)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof cc)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw ee()}(0,s))),e.precondition.isNone||(t.currentDocument=function(r,i){return i.updateTime!==void 0?{updateTime:b4(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ee()}(n,e.precondition)),t}function P4(n,e){return n&&n.length>0?(ke(e!==void 0),n.map(t=>function(r,i){let o=r.updateTime?yn(r.updateTime):yn(i);return o.isEqual(ne.min())&&(o=yn(i)),new m4(o,r.transformResults||[])}(t,e))):[]}function R4(n,e){return{documents:[y0(n,e.path)]}}function N4(n,e){const t={structuredQuery:{}},s=e.path;e.collectionGroup!==null?(t.parent=y0(n,s),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=y0(n,s.popLast()),t.structuredQuery.from=[{collectionId:s.lastSegment()}]);const r=function(c){if(c.length!==0)return $T(cs.create(c,"and"))}(e.filters);r&&(t.structuredQuery.where=r);const i=function(c){if(c.length!==0)return c.map(u=>function(d){return{field:Oi(d.field),direction:F4(d.dir)}}(u))}(e.orderBy);i&&(t.structuredQuery.orderBy=i);const o=g0(n,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),t}function M4(n){let e=C4(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let r=null;if(s>0){ke(s===1);const l=t.from[0];l.allDescendants?r=l.collectionId:e=e.child(l.collectionId)}let i=[];t.where&&(i=function(d){const f=HT(d);return f instanceof cs&&pT(f)?f.getFilters():[f]}(t.where));let o=[];t.orderBy&&(o=function(d){return d.map(f=>function(p){return new sl(Fi(p.field),function(g){switch(g){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(f))}(t.orderBy));let a=null;t.limit&&(a=function(d){let f;return f=typeof d=="object"?d.value:d,Wc(f)?null:f}(t.limit));let c=null;t.startAt&&(c=function(d){const f=!!d.before,m=d.values||[];return new nl(m,f)}(t.startAt));let u=null;return t.endAt&&(u=function(d){const f=!d.before,m=d.values||[];return new nl(m,f)}(t.endAt)),t4(e,r,o,i,a,"F",c,u)}function O4(n,e){const t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ee()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function HT(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=Fi(t.unaryFilter.field);return pt.create(s,"==",{doubleValue:NaN});case"IS_NULL":const r=Fi(t.unaryFilter.field);return pt.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Fi(t.unaryFilter.field);return pt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Fi(t.unaryFilter.field);return pt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ee()}}(n):n.fieldFilter!==void 0?function(t){return pt.create(Fi(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ee()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return cs.create(t.compositeFilter.filters.map(s=>HT(s)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return ee()}}(t.compositeFilter.op))}(n):ee()}function F4(n){return T4[n]}function B4(n){return I4[n]}function L4(n){return D4[n]}function Oi(n){return{fieldPath:n.canonicalString()}}function Fi(n){return Rt.fromServerFormat(n.fieldPath)}function $T(n){return n instanceof pt?function(t){if(t.op==="=="){if(Yy(t.value))return{unaryFilter:{field:Oi(t.field),op:"IS_NAN"}};if(qy(t.value))return{unaryFilter:{field:Oi(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Yy(t.value))return{unaryFilter:{field:Oi(t.field),op:"IS_NOT_NAN"}};if(qy(t.value))return{unaryFilter:{field:Oi(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Oi(t.field),op:B4(t.op),value:t.value}}}(n):n instanceof cs?function(t){const s=t.getFilters().map(r=>$T(r));return s.length===1?s[0]:{compositeFilter:{op:L4(t.op),filters:s}}}(n):ee()}function V4(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function qT(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(e,t,s,r,i=ne.min(),o=ne.min(),a=Qt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new ar(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ar(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ar(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ar(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U4{constructor(e){this.ut=e}}function W4(n){const e=M4({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?p0(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H4{constructor(){this.on=new $4}addToCollectionParentIndex(e,t){return this.on.add(t),M.resolve()}getCollectionParents(e,t){return M.resolve(this.on.getEntries(t))}addFieldIndex(e,t){return M.resolve()}deleteFieldIndex(e,t){return M.resolve()}deleteAllFieldIndexes(e){return M.resolve()}createTargetIndexes(e,t){return M.resolve()}getDocumentsMatchingTarget(e,t){return M.resolve(null)}getIndexType(e,t){return M.resolve(0)}getFieldIndexes(e,t){return M.resolve([])}getNextCollectionGroupToUpdate(e){return M.resolve(null)}getMinOffset(e,t){return M.resolve(vr.min())}getMinOffsetFromCollectionGroup(e,t){return M.resolve(vr.min())}updateCollectionGroup(e,t,s){return M.resolve()}updateIndexEntries(e,t){return M.resolve()}}class $4{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t]||new Ft(Qe.comparator),i=!r.has(s);return this.index[t]=r.add(s),i}has(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t];return r&&r.has(s)}getEntries(e){return(this.index[e]||new Ft(Qe.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new yo(0)}static Nn(){return new yo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q4{constructor(){this.changes=new Wo(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Et.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?M.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y4{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z4{constructor(e,t,s,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(s=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(s!==null&&Ca(s.mutation,r,gn.empty(),Be.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.getLocalViewOfDocuments(e,s,ge()).next(()=>s))}getLocalViewOfDocuments(e,t,s=ge()){const r=qr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,s).next(i=>{let o=ga();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const s=qr();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,ge()))}populateOverlays(e,t,s){const r=[];return s.forEach(i=>{t.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,s,r){let i=Ws();const o=ba(),a=function(){return ba()}();return t.forEach((c,u)=>{const l=s.get(u.key);r.has(u.key)&&(l===void 0||l.mutation instanceof Cr)?i=i.insert(u.key,u):l!==void 0?(o.set(u.key,l.mutation.getFieldMask()),Ca(l.mutation,u,l.mutation.getFieldMask(),Be.now())):o.set(u.key,gn.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,l)=>o.set(u,l)),t.forEach((u,l)=>{var d;return a.set(u,new Y4(l,(d=o.get(u))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,t){const s=ba();let r=new ht((o,a)=>o-a),i=ge();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(c=>{const u=t.get(c);if(u===null)return;let l=s.get(c)||gn.empty();l=a.applyToLocalView(u,l),s.set(c,l);const d=(r.get(a.batchId)||ge()).add(c);r=r.insert(a.batchId,d)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),u=c.key,l=c.value,d=TT();l.forEach(f=>{if(!i.has(f)){const m=PT(t.get(f),s.get(f));m!==null&&d.set(f,m),i=i.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,d))}return M.waitFor(o)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,t,s,r){return function(o){return j.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):n4(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,r):this.getDocumentsMatchingCollectionQuery(e,t,s,r)}getNextDocuments(e,t,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,r).next(i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,r-i.size):M.resolve(qr());let a=-1,c=i;return o.next(u=>M.forEach(u,(l,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),i.get(l)?M.resolve():this.remoteDocumentCache.getEntry(e,l).next(f=>{c=c.insert(l,f)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,ge())).next(l=>({batchId:a,changes:ET(l)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new j(t)).next(s=>{let r=ga();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,s,r){const i=t.collectionGroup;let o=ga();return this.indexManager.getCollectionParents(e,i).next(a=>M.forEach(a,c=>{const u=function(d,f){return new _h(f,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(t,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,s,r).next(l=>{l.forEach((d,f)=>{o=o.insert(d,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,s,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,i,r))).next(o=>{i.forEach((c,u)=>{const l=u.getKey();o.get(l)===null&&(o=o.insert(l,Et.newInvalidDocument(l)))});let a=ga();return o.forEach((c,u)=>{const l=i.get(c);l!==void 0&&Ca(l.mutation,u,gn.empty(),Be.now()),xh(t,u)&&(a=a.insert(c,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G4{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,t){return M.resolve(this.ur.get(t))}saveBundleMetadata(e,t){return this.ur.set(t.id,function(r){return{id:r.id,version:r.version,createTime:yn(r.createTime)}}(t)),M.resolve()}getNamedQuery(e,t){return M.resolve(this.cr.get(t))}saveNamedQuery(e,t){return this.cr.set(t.name,function(r){return{name:r.name,query:W4(r.bundledQuery),readTime:yn(r.readTime)}}(t)),M.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J4{constructor(){this.overlays=new ht(j.comparator),this.lr=new Map}getOverlay(e,t){return M.resolve(this.overlays.get(t))}getOverlays(e,t){const s=qr();return M.forEach(t,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,t,s){return s.forEach((r,i)=>{this.lt(e,t,i)}),M.resolve()}removeOverlaysForBatchId(e,t,s){const r=this.lr.get(s);return r!==void 0&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.lr.delete(s)),M.resolve()}getOverlaysForCollection(e,t,s){const r=qr(),i=t.length+1,o=new j(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,u=c.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>s&&r.set(c.getKey(),c)}return M.resolve(r)}getOverlaysForCollectionGroup(e,t,s,r){let i=new ht((u,l)=>u-l);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>s){let l=i.get(u.largestBatchId);l===null&&(l=qr(),i=i.insert(u.largestBatchId,l)),l.set(u.getKey(),u)}}const a=qr(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,l)=>a.set(u,l)),!(a.size()>=r)););return M.resolve(a)}lt(e,t,s){const r=this.overlays.get(s.key);if(r!==null){const o=this.lr.get(r.largestBatchId).delete(s.key);this.lr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new _4(t,s));let i=this.lr.get(t);i===void 0&&(i=ge(),this.lr.set(t,i)),this.lr.set(t,i.add(s.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ip{constructor(){this.hr=new Ft(vt.Pr),this.Ir=new Ft(vt.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,t){const s=new vt(e,t);this.hr=this.hr.add(s),this.Ir=this.Ir.add(s)}Er(e,t){e.forEach(s=>this.addReference(s,t))}removeReference(e,t){this.dr(new vt(e,t))}Ar(e,t){e.forEach(s=>this.removeReference(s,t))}Rr(e){const t=new j(new Qe([])),s=new vt(t,e),r=new vt(t,e+1),i=[];return this.Ir.forEachInRange([s,r],o=>{this.dr(o),i.push(o.key)}),i}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const t=new j(new Qe([])),s=new vt(t,e),r=new vt(t,e+1);let i=ge();return this.Ir.forEachInRange([s,r],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new vt(e,0),s=this.hr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class vt{constructor(e,t){this.key=e,this.gr=t}static Pr(e,t){return j.comparator(e.key,t.key)||be(e.gr,t.gr)}static Tr(e,t){return be(e.gr,t.gr)||j.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q4{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.pr=1,this.yr=new Ft(vt.Pr)}checkEmpty(e){return M.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,r){const i=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new y4(i,t,s,r);this.mutationQueue.push(o);for(const a of r)this.yr=this.yr.add(new vt(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return M.resolve(o)}lookupMutationBatch(e,t){return M.resolve(this.wr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,r=this.Sr(s),i=r<0?0:r;return M.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return M.resolve(this.mutationQueue.length===0?-1:this.pr-1)}getAllMutationBatches(e){return M.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new vt(t,0),r=new vt(t,Number.POSITIVE_INFINITY),i=[];return this.yr.forEachInRange([s,r],o=>{const a=this.wr(o.gr);i.push(a)}),M.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Ft(be);return t.forEach(r=>{const i=new vt(r,0),o=new vt(r,Number.POSITIVE_INFINITY);this.yr.forEachInRange([i,o],a=>{s=s.add(a.gr)})}),M.resolve(this.br(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,r=s.length+1;let i=s;j.isDocumentKey(i)||(i=i.child(""));const o=new vt(new j(i),0);let a=new Ft(be);return this.yr.forEachWhile(c=>{const u=c.key.path;return!!s.isPrefixOf(u)&&(u.length===r&&(a=a.add(c.gr)),!0)},o),M.resolve(this.br(a))}br(e){const t=[];return e.forEach(s=>{const r=this.wr(s);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){ke(this.Dr(t.batchId,"removed")===0),this.mutationQueue.shift();let s=this.yr;return M.forEach(t.mutations,r=>{const i=new vt(r.key,t.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.yr=s})}Fn(e){}containsKey(e,t){const s=new vt(t,0),r=this.yr.firstAfterOrEqual(s);return M.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,M.resolve()}Dr(e,t){return this.Sr(e)}Sr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}wr(e){const t=this.Sr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K4{constructor(e){this.Cr=e,this.docs=function(){return new ht(j.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,r=this.docs.get(s),i=r?r.size:0,o=this.Cr(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return M.resolve(s?s.document.mutableCopy():Et.newInvalidDocument(t))}getEntries(e,t){let s=Ws();return t.forEach(r=>{const i=this.docs.get(r);s=s.insert(r,i?i.document.mutableCopy():Et.newInvalidDocument(r))}),M.resolve(s)}getDocumentsMatchingQuery(e,t,s,r){let i=Ws();const o=t.path,a=new j(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:u,value:{document:l}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||LO(BO(l),s)<=0||(r.has(l.key)||xh(t,l))&&(i=i.insert(l.key,l.mutableCopy()))}return M.resolve(i)}getAllFromCollectionGroup(e,t,s,r){ee()}vr(e,t){return M.forEach(this.docs,s=>t(s))}newChangeBuffer(e){return new j4(this)}getSize(e){return M.resolve(this.size)}}class j4 extends q4{constructor(e){super(),this._r=e}applyChanges(e){const t=[];return this.changes.forEach((s,r)=>{r.isValidDocument()?t.push(this._r.addEntry(e,r)):this._r.removeEntry(s)}),M.waitFor(t)}getFromCache(e,t){return this._r.getEntry(e,t)}getAllFromCache(e,t){return this._r.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X4{constructor(e){this.persistence=e,this.Fr=new Wo(t=>Zm(t),ep),this.lastRemoteSnapshotVersion=ne.min(),this.highestTargetId=0,this.Mr=0,this.Or=new ip,this.targetCount=0,this.Nr=yo.On()}forEachTarget(e,t){return this.Fr.forEach((s,r)=>t(r)),M.resolve()}getLastRemoteSnapshotVersion(e){return M.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return M.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),M.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.Mr&&(this.Mr=t),M.resolve()}kn(e){this.Fr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Nr=new yo(t),this.highestTargetId=t),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,t){return this.kn(t),this.targetCount+=1,M.resolve()}updateTargetData(e,t){return this.kn(t),M.resolve()}removeTargetData(e,t){return this.Fr.delete(t.target),this.Or.Rr(t.targetId),this.targetCount-=1,M.resolve()}removeTargets(e,t,s){let r=0;const i=[];return this.Fr.forEach((o,a)=>{a.sequenceNumber<=t&&s.get(a.targetId)===null&&(this.Fr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),M.waitFor(i).next(()=>r)}getTargetCount(e){return M.resolve(this.targetCount)}getTargetData(e,t){const s=this.Fr.get(t)||null;return M.resolve(s)}addMatchingKeys(e,t,s){return this.Or.Er(t,s),M.resolve()}removeMatchingKeys(e,t,s){this.Or.Ar(t,s);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(o=>{i.push(r.markPotentiallyOrphaned(e,o))}),M.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Or.Rr(t),M.resolve()}getMatchingKeysForTargetId(e,t){const s=this.Or.mr(t);return M.resolve(s)}containsKey(e,t){return M.resolve(this.Or.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z4{constructor(e,t){this.Br={},this.overlays={},this.Lr=new Qm(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new X4(this),this.indexManager=new H4,this.remoteDocumentCache=function(r){return new K4(r)}(s=>this.referenceDelegate.Qr(s)),this.serializer=new U4(t),this.Kr=new G4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new J4,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.Br[e.toKey()];return s||(s=new Q4(t,this.referenceDelegate),this.Br[e.toKey()]=s),s}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,t,s){q("MemoryPersistence","Starting transaction:",e);const r=new e2(this.Lr.next());return this.referenceDelegate.$r(),s(r).next(i=>this.referenceDelegate.Ur(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}Wr(e,t){return M.or(Object.values(this.Br).map(s=>()=>s.containsKey(e,t)))}}class e2 extends UO{constructor(e){super(),this.currentSequenceNumber=e}}class op{constructor(e){this.persistence=e,this.Gr=new ip,this.zr=null}static jr(e){return new op(e)}get Hr(){if(this.zr)return this.zr;throw ee()}addReference(e,t,s){return this.Gr.addReference(s,t),this.Hr.delete(s.toString()),M.resolve()}removeReference(e,t,s){return this.Gr.removeReference(s,t),this.Hr.add(s.toString()),M.resolve()}markPotentiallyOrphaned(e,t){return this.Hr.add(t.toString()),M.resolve()}removeTarget(e,t){this.Gr.Rr(t.targetId).forEach(r=>this.Hr.add(r.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(i=>this.Hr.add(i.toString()))}).next(()=>s.removeTargetData(e,t))}$r(){this.zr=new Set}Ur(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return M.forEach(this.Hr,s=>{const r=j.fromPath(s);return this.Jr(e,r).next(i=>{i||t.removeEntry(r,ne.min())})}).next(()=>(this.zr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Jr(e,t).next(s=>{s?this.Hr.delete(t.toString()):this.Hr.add(t.toString())})}Qr(e){return 0}Jr(e,t){return M.or([()=>M.resolve(this.Gr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Wr(e,t)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(e,t,s,r){this.targetId=e,this.fromCache=t,this.ki=s,this.qi=r}static Qi(e,t){let s=ge(),r=ge();for(const i of t.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new ap(e,t.fromCache,s,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t2{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(e,t){this.Gi=e,this.indexManager=t,this.Ki=!0}getDocumentsMatchingQuery(e,t,s,r){const i={result:null};return this.zi(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ji(e,t,r,s).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new t2;return this.Hi(e,t,o).next(a=>{if(i.result=a,this.$i)return this.Ji(e,t,o,a.size)})}).next(()=>i.result)}Ji(e,t,s,r){return s.documentReadCount<this.Ui?(ua()<=pe.DEBUG&&q("QueryEngine","SDK will not create cache indexes for query:",Mi(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),M.resolve()):(ua()<=pe.DEBUG&&q("QueryEngine","Query:",Mi(t),"scans",s.documentReadCount,"local documents and returns",r,"documents as results."),s.documentReadCount>this.Wi*r?(ua()<=pe.DEBUG&&q("QueryEngine","The SDK decides to create cache indexes for query:",Mi(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ss(t))):M.resolve())}zi(e,t){if(Qy(t))return M.resolve(null);let s=ss(t);return this.indexManager.getIndexType(e,s).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=p0(t,null,"F"),s=ss(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next(i=>{const o=ge(...i);return this.Gi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,s).next(c=>{const u=this.Yi(t,a);return this.Zi(t,u,o,c.readTime)?this.zi(e,p0(t,null,"F")):this.Xi(e,u,t,c)}))})))}ji(e,t,s,r){return Qy(t)||r.isEqual(ne.min())?M.resolve(null):this.Gi.getDocuments(e,s).next(i=>{const o=this.Yi(t,i);return this.Zi(t,o,s,r)?M.resolve(null):(ua()<=pe.DEBUG&&q("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Mi(t)),this.Xi(e,o,t,FO(r,-1)).next(a=>a))})}Yi(e,t){let s=new Ft(wT(e));return t.forEach((r,i)=>{xh(e,i)&&(s=s.add(i))}),s}Zi(e,t,s,r){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Hi(e,t,s){return ua()<=pe.DEBUG&&q("QueryEngine","Using full collection scan to execute query:",Mi(t)),this.Gi.getDocumentsMatchingQuery(e,t,vr.min(),s)}Xi(e,t,s,r){return this.Gi.getDocumentsMatchingQuery(e,s,r).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s2{constructor(e,t,s,r){this.persistence=e,this.es=t,this.serializer=r,this.ts=new ht(be),this.ns=new Wo(i=>Zm(i),ep),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(s)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new z4(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ts))}}function r2(n,e,t,s){return new s2(n,e,t,s)}async function YT(n,e){const t=ie(n);return await t.persistence.runTransaction("Handle user change","readonly",s=>{let r;return t.mutationQueue.getAllMutationBatches(s).next(i=>(r=i,t.os(e),t.mutationQueue.getAllMutationBatches(s))).next(i=>{const o=[],a=[];let c=ge();for(const u of r){o.push(u.batchId);for(const l of u.mutations)c=c.add(l.key)}for(const u of i){a.push(u.batchId);for(const l of u.mutations)c=c.add(l.key)}return t.localDocuments.getDocuments(s,c).next(u=>({_s:u,removedBatchIds:o,addedBatchIds:a}))})})}function i2(n,e){const t=ie(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const r=e.batch.keys(),i=t.ss.newChangeBuffer({trackRemovals:!0});return function(a,c,u,l){const d=u.batch,f=d.keys();let m=M.resolve();return f.forEach(p=>{m=m.next(()=>l.getEntry(c,p)).next(y=>{const g=u.docVersions.get(p);ke(g!==null),y.version.compareTo(g)<0&&(d.applyToRemoteDocument(y,u),y.isValidDocument()&&(y.setReadTime(u.commitVersion),l.addEntry(y)))})}),m.next(()=>a.mutationQueue.removeMutationBatch(c,d))}(t,s,e,i).next(()=>i.apply(s)).next(()=>t.mutationQueue.performConsistencyCheck(s)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(a){let c=ge();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c}(e))).next(()=>t.localDocuments.getDocuments(s,r))})}function zT(n){const e=ie(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.qr.getLastRemoteSnapshotVersion(t))}function o2(n,e){const t=ie(n),s=e.snapshotVersion;let r=t.ts;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.ss.newChangeBuffer({trackRemovals:!0});r=t.ts;const a=[];e.targetChanges.forEach((l,d)=>{const f=r.get(d);if(!f)return;a.push(t.qr.removeMatchingKeys(i,l.removedDocuments,d).next(()=>t.qr.addMatchingKeys(i,l.addedDocuments,d)));let m=f.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(d)!==null?m=m.withResumeToken(Qt.EMPTY_BYTE_STRING,ne.min()).withLastLimboFreeSnapshotVersion(ne.min()):l.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(l.resumeToken,s)),r=r.insert(d,m),function(y,g,x){return y.resumeToken.approximateByteSize()===0||g.snapshotVersion.toMicroseconds()-y.snapshotVersion.toMicroseconds()>=3e8?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(f,m,l)&&a.push(t.qr.updateTargetData(i,m))});let c=Ws(),u=ge();if(e.documentUpdates.forEach(l=>{e.resolvedLimboDocuments.has(l)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,l))}),a.push(a2(i,o,e.documentUpdates).next(l=>{c=l.us,u=l.cs})),!s.isEqual(ne.min())){const l=t.qr.getLastRemoteSnapshotVersion(i).next(d=>t.qr.setTargetsMetadata(i,i.currentSequenceNumber,s));a.push(l)}return M.waitFor(a).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(t.ts=r,i))}function a2(n,e,t){let s=ge(),r=ge();return t.forEach(i=>s=s.add(i)),e.getEntries(n,s).next(i=>{let o=Ws();return t.forEach((a,c)=>{const u=i.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(r=r.add(a)),c.isNoDocument()&&c.version.isEqual(ne.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):q("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{us:o,cs:r}})}function c2(n,e){const t=ie(n);return t.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function u2(n,e){const t=ie(n);return t.persistence.runTransaction("Allocate target","readwrite",s=>{let r;return t.qr.getTargetData(s,e).next(i=>i?(r=i,M.resolve(r)):t.qr.allocateTargetId(s).next(o=>(r=new ar(e,o,"TargetPurposeListen",s.currentSequenceNumber),t.qr.addTargetData(s,r).next(()=>r))))}).then(s=>{const r=t.ts.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.ts=t.ts.insert(s.targetId,s),t.ns.set(e,s.targetId)),s})}async function _0(n,e,t){const s=ie(n),r=s.ts.get(e),i=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",i,o=>s.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!Uc(o))throw o;q("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}s.ts=s.ts.remove(e),s.ns.delete(r.target)}function o_(n,e,t){const s=ie(n);let r=ne.min(),i=ge();return s.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,l){const d=ie(c),f=d.ns.get(l);return f!==void 0?M.resolve(d.ts.get(f)):d.qr.getTargetData(u,l)}(s,o,ss(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,s.qr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>s.es.getDocumentsMatchingQuery(o,e,t?r:ne.min(),t?i:ge())).next(a=>(l2(s,r4(e),a),{documents:a,ls:i})))}function l2(n,e,t){let s=n.rs.get(e)||ne.min();t.forEach((r,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)}),n.rs.set(e,s)}class a_{constructor(){this.activeTargetIds=l4()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class h2{constructor(){this.eo=new a_,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,t,s){this.no[e]=t}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new a_,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d2{ro(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){q("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){q("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _u=null;function Dd(){return _u===null?_u=function(){return 268435456+Math.round(2147483648*Math.random())}():_u++,"0x"+_u.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f2={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m2{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}onMessage(e){this.Eo=e}close(){this.lo()}send(e){this.co(e)}Ao(){this.Po()}Ro(e){this.To(e)}Vo(e){this.Eo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lt="WebChannelConnection";class p2 extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const s=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.mo=s+"://"+t.host,this.fo=`projects/${r}/databases/${i}`,this.po=this.databaseId.database==="(default)"?`project_id=${r}`:`project_id=${r}&database_id=${i}`}get yo(){return!1}wo(t,s,r,i,o){const a=Dd(),c=this.So(t,s);q("RestConnection",`Sending RPC '${t}' ${a}:`,c,r);const u={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(u,i,o),this.Do(t,c,u,r).then(l=>(q("RestConnection",`Received RPC '${t}' ${a}: `,l),l),l=>{throw lo("RestConnection",`RPC '${t}' ${a} failed with error: `,l,"url: ",c,"request:",r),l})}Co(t,s,r,i,o,a){return this.wo(t,s,r,i,o)}bo(t,s,r){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Uo}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),s&&s.headers.forEach((i,o)=>t[o]=i),r&&r.headers.forEach((i,o)=>t[o]=i)}So(t,s){const r=f2[t];return`${this.mo}/v1/${s}:${r}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Do(e,t,s,r){const i=Dd();return new Promise((o,a)=>{const c=new DO;c.setWithCredentials(!0),c.listenOnce(TO.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Id.NO_ERROR:const l=c.getResponseJson();q(Lt,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(l)),o(l);break;case Id.TIMEOUT:q(Lt,`RPC '${e}' ${i} timed out`),a(new Y(R.DEADLINE_EXCEEDED,"Request time out"));break;case Id.HTTP_ERROR:const d=c.getStatus();if(q(Lt,`RPC '${e}' ${i} failed with status:`,d,"response text:",c.getResponseText()),d>0){let f=c.getResponseJson();Array.isArray(f)&&(f=f[0]);const m=f==null?void 0:f.error;if(m&&m.status&&m.message){const p=function(g){const x=g.toLowerCase().replace(/_/g,"-");return Object.values(R).indexOf(x)>=0?x:R.UNKNOWN}(m.status);a(new Y(p,m.message))}else a(new Y(R.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new Y(R.UNAVAILABLE,"Connection failed."));break;default:ee()}}finally{q(Lt,`RPC '${e}' ${i} completed.`)}});const u=JSON.stringify(r);q(Lt,`RPC '${e}' ${i} sending request:`,r),c.send(t,"POST",u,s,15)})}vo(e,t,s){const r=Dd(),i=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=xO(),a=EO(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.bo(c.initMessageHeaders,t,s),c.encodeInitMessageHeaders=!0;const l=i.join("");q(Lt,`Creating RPC '${e}' stream ${r}: ${l}`,c);const d=o.createWebChannel(l,c);let f=!1,m=!1;const p=new m2({co:g=>{m?q(Lt,`Not sending because RPC '${e}' stream ${r} is closed:`,g):(f||(q(Lt,`Opening RPC '${e}' stream ${r} transport.`),d.open(),f=!0),q(Lt,`RPC '${e}' stream ${r} sending:`,g),d.send(g))},lo:()=>d.close()}),y=(g,x,_)=>{g.listen(x,v=>{try{_(v)}catch(w){setTimeout(()=>{throw w},0)}})};return y(d,pu.EventType.OPEN,()=>{m||q(Lt,`RPC '${e}' stream ${r} transport opened.`)}),y(d,pu.EventType.CLOSE,()=>{m||(m=!0,q(Lt,`RPC '${e}' stream ${r} transport closed`),p.Ro())}),y(d,pu.EventType.ERROR,g=>{m||(m=!0,lo(Lt,`RPC '${e}' stream ${r} transport errored:`,g),p.Ro(new Y(R.UNAVAILABLE,"The operation could not be completed")))}),y(d,pu.EventType.MESSAGE,g=>{var x;if(!m){const _=g.data[0];ke(!!_);const v=_,w=v.error||((x=v[0])===null||x===void 0?void 0:x.error);if(w){q(Lt,`RPC '${e}' stream ${r} received error:`,w);const I=w.status;let D=function(C){const T=ct[C];if(T!==void 0)return OT(T)}(I),E=w.message;D===void 0&&(D=R.INTERNAL,E="Unknown error status: "+I+" with message "+w.message),m=!0,p.Ro(new Y(D,E)),d.close()}else q(Lt,`RPC '${e}' stream ${r} received:`,_),p.Vo(_)}}),y(a,IO.STAT_EVENT,g=>{g.stat===Vy.PROXY?q(Lt,`RPC '${e}' stream ${r} detected buffering proxy`):g.stat===Vy.NOPROXY&&q(Lt,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{p.Ao()},0),p}}function Ad(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ah(n){return new A4(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cp{constructor(e,t,s=1e3,r=1.5,i=6e4){this.si=e,this.timerId=t,this.Fo=s,this.Mo=r,this.xo=i,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(e){this.cancel();const t=Math.floor(this.Oo+this.qo()),s=Math.max(0,Date.now()-this.Bo),r=Math.max(0,t-s);r>0&&q("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Oo} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,r,()=>(this.Bo=Date.now(),e())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){this.No!==null&&(this.No.skipDelay(),this.No=null)}cancel(){this.No!==null&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GT{constructor(e,t,s,r,i,o,a,c){this.si=e,this.Ko=s,this.$o=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new cp(e,t)}jo(){return this.state===1||this.state===5||this.Ho()}Ho(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Jo()}async stop(){this.jo()&&await this.close(0)}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&this.Wo===null&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(e){this.t_(),this.stream.send(e)}async Xo(){if(this.Ho())return this.close(0)}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}async close(e,t){this.t_(),this.n_(),this.zo.cancel(),this.Uo++,e!==4?this.zo.reset():t&&t.code===R.RESOURCE_EXHAUSTED?(Us(t.toString()),Us("Using maximum backoff delay to prevent overloading the backend."),this.zo.Lo()):t&&t.code===R.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.r_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Io(t)}r_(){}auth(){this.state=1;const e=this.i_(this.Uo),t=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,r])=>{this.Uo===t&&this.s_(s,r)},s=>{e(()=>{const r=new Y(R.UNKNOWN,"Fetching auth token failed: "+s.message);return this.o_(r)})})}s_(e,t){const s=this.i_(this.Uo);this.stream=this.__(e,t),this.stream.ho(()=>{s(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(r=>{s(()=>this.o_(r))}),this.stream.onMessage(r=>{s(()=>this.onMessage(r))})}Jo(){this.state=5,this.zo.ko(async()=>{this.state=0,this.start()})}o_(e){return q("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}i_(e){return t=>{this.si.enqueueAndForget(()=>this.Uo===e?t():(q("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class g2 extends GT{constructor(e,t,s,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,r,o),this.serializer=i}__(e,t){return this.connection.vo("Listen",e,t)}onMessage(e){this.zo.reset();const t=S4(this.serializer,e),s=function(i){if(!("targetChange"in i))return ne.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ne.min():o.readTime?yn(o.readTime):ne.min()}(e);return this.listener.a_(t,s)}u_(e){const t={};t.database=uc(this.serializer),t.addTarget=function(i,o){let a;const c=o.target;if(a=m0(c)?{documents:R4(i,c)}:{query:N4(i,c)},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=LT(i,o.resumeToken);const u=g0(i,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(ne.min())>0){a.readTime=il(i,o.snapshotVersion.toTimestamp());const u=g0(i,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const s=O4(this.serializer,e);s&&(t.labels=s),this.e_(t)}c_(e){const t={};t.database=uc(this.serializer),t.removeTarget=e,this.e_(t)}}class y2 extends GT{constructor(e,t,s,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,r,o),this.serializer=i,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(e,t){return this.connection.vo("Write",e,t)}onMessage(e){if(ke(!!e.streamToken),this.lastStreamToken=e.streamToken,this.l_){this.zo.reset();const t=P4(e.writeResults,e.commitTime),s=yn(e.commitTime);return this.listener.I_(s,t)}return ke(!e.writeResults||e.writeResults.length===0),this.l_=!0,this.listener.T_()}E_(){const e={};e.database=uc(this.serializer),this.e_(e)}P_(e){const t={streamToken:this.lastStreamToken,writes:e.map(s=>WT(this.serializer,s))};this.e_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _2 extends class{}{constructor(e,t,s,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=r,this.d_=!1}A_(){if(this.d_)throw new Y(R.FAILED_PRECONDITION,"The client has already been terminated.")}wo(e,t,s){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,i])=>this.connection.wo(e,t,s,r,i)).catch(r=>{throw r.name==="FirebaseError"?(r.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new Y(R.UNKNOWN,r.toString())})}Co(e,t,s,r){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Co(e,t,s,i,o,r)).catch(i=>{throw i.name==="FirebaseError"?(i.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Y(R.UNKNOWN,i.toString())})}terminate(){this.d_=!0}}class v2{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){this.V_===0&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(e){this.state==="Online"?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.p_("Offline")))}set(e){this.S_(),this.V_=0,e==="Online"&&(this.f_=!1),this.p_(e)}p_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}y_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(Us(t),this.f_=!1):q("OnlineStateTracker",t)}S_(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w2{constructor(e,t,s,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=i,this.F_.ro(o=>{s.enqueueAndForget(async()=>{_i(this)&&(q("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=ie(c);u.C_.add(4),await qc(u),u.M_.set("Unknown"),u.C_.delete(4),await bh(u)}(this))})}),this.M_=new v2(s,r)}}async function bh(n){if(_i(n))for(const e of n.v_)await e(!0)}async function qc(n){for(const e of n.v_)await e(!1)}function JT(n,e){const t=ie(n);t.D_.has(e.targetId)||(t.D_.set(e.targetId,e),hp(t)?lp(t):Ho(t).Ho()&&up(t,e))}function QT(n,e){const t=ie(n),s=Ho(t);t.D_.delete(e),s.Ho()&&KT(t,e),t.D_.size===0&&(s.Ho()?s.Zo():_i(t)&&t.M_.set("Unknown"))}function up(n,e){if(n.x_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ne.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ho(n).u_(e)}function KT(n,e){n.x_.Oe(e),Ho(n).c_(e)}function lp(n){n.x_=new E4({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>n.D_.get(e)||null,nt:()=>n.datastore.serializer.databaseId}),Ho(n).start(),n.M_.g_()}function hp(n){return _i(n)&&!Ho(n).jo()&&n.D_.size>0}function _i(n){return ie(n).C_.size===0}function jT(n){n.x_=void 0}async function x2(n){n.D_.forEach((e,t)=>{up(n,e)})}async function E2(n,e){jT(n),hp(n)?(n.M_.w_(e),lp(n)):n.M_.set("Unknown")}async function T2(n,e,t){if(n.M_.set("Online"),e instanceof BT&&e.state===2&&e.cause)try{await async function(r,i){const o=i.cause;for(const a of i.targetIds)r.D_.has(a)&&(await r.remoteSyncer.rejectListen(a,o),r.D_.delete(a),r.x_.removeTarget(a))}(n,e)}catch(s){q("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),s),await al(n,s)}else if(e instanceof Su?n.x_.$e(e):e instanceof FT?n.x_.Je(e):n.x_.Ge(e),!t.isEqual(ne.min()))try{const s=await zT(n.localStore);t.compareTo(s)>=0&&await function(i,o){const a=i.x_.it(o);return a.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const l=i.D_.get(u);l&&i.D_.set(u,l.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,u)=>{const l=i.D_.get(c);if(!l)return;i.D_.set(c,l.withResumeToken(Qt.EMPTY_BYTE_STRING,l.snapshotVersion)),KT(i,c);const d=new ar(l.target,c,u,l.sequenceNumber);up(i,d)}),i.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(s){q("RemoteStore","Failed to raise snapshot:",s),await al(n,s)}}async function al(n,e,t){if(!Uc(e))throw e;n.C_.add(1),await qc(n),n.M_.set("Offline"),t||(t=()=>zT(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{q("RemoteStore","Retrying IndexedDB access"),await t(),n.C_.delete(1),await bh(n)})}function XT(n,e){return e().catch(t=>al(n,t,e))}async function Ch(n){const e=ie(n),t=xr(e);let s=e.b_.length>0?e.b_[e.b_.length-1].batchId:-1;for(;I2(e);)try{const r=await c2(e.localStore,s);if(r===null){e.b_.length===0&&t.Zo();break}s=r.batchId,D2(e,r)}catch(r){await al(e,r)}ZT(e)&&eI(e)}function I2(n){return _i(n)&&n.b_.length<10}function D2(n,e){n.b_.push(e);const t=xr(n);t.Ho()&&t.h_&&t.P_(e.mutations)}function ZT(n){return _i(n)&&!xr(n).jo()&&n.b_.length>0}function eI(n){xr(n).start()}async function A2(n){xr(n).E_()}async function b2(n){const e=xr(n);for(const t of n.b_)e.P_(t.mutations)}async function C2(n,e,t){const s=n.b_.shift(),r=np.from(s,e,t);await XT(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),await Ch(n)}async function k2(n,e){e&&xr(n).h_&&await async function(s,r){if(function(o){return MT(o)&&o!==R.ABORTED}(r.code)){const i=s.b_.shift();xr(s).Yo(),await XT(s,()=>s.remoteSyncer.rejectFailedWrite(i.batchId,r)),await Ch(s)}}(n,e),ZT(n)&&eI(n)}async function u_(n,e){const t=ie(n);t.asyncQueue.verifyOperationInProgress(),q("RemoteStore","RemoteStore received new credentials");const s=_i(t);t.C_.add(3),await qc(t),s&&t.M_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.C_.delete(3),await bh(t)}async function S2(n,e){const t=ie(n);e?(t.C_.delete(2),await bh(t)):e||(t.C_.add(2),await qc(t),t.M_.set("Unknown"))}function Ho(n){return n.O_||(n.O_=function(t,s,r){const i=ie(t);return i.A_(),new g2(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(n.datastore,n.asyncQueue,{ho:x2.bind(null,n),Io:E2.bind(null,n),a_:T2.bind(null,n)}),n.v_.push(async e=>{e?(n.O_.Yo(),hp(n)?lp(n):n.M_.set("Unknown")):(await n.O_.stop(),jT(n))})),n.O_}function xr(n){return n.N_||(n.N_=function(t,s,r){const i=ie(t);return i.A_(),new y2(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(n.datastore,n.asyncQueue,{ho:A2.bind(null,n),Io:k2.bind(null,n),T_:b2.bind(null,n),I_:C2.bind(null,n)}),n.v_.push(async e=>{e?(n.N_.Yo(),await Ch(n)):(await n.N_.stop(),n.b_.length>0&&(q("RemoteStore",`Stopping write stream with ${n.b_.length} pending writes`),n.b_=[]))})),n.N_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dp{constructor(e,t,s,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new ns,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,r,i){const o=Date.now()+s,a=new dp(e,t,o,r,i);return a.start(s),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Y(R.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function fp(n,e){if(Us("AsyncQueue",`${e}: ${n}`),Uc(n))return new Y(R.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(e){this.comparator=e?(t,s)=>e(t,s)||j.comparator(t.key,s.key):(t,s)=>j.comparator(t.key,s.key),this.keyedMap=ga(),this.sortedSet=new ht(this.comparator)}static emptySet(e){return new Ji(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,s)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ji)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=s.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new Ji;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l_{constructor(){this.B_=new ht(j.comparator)}track(e){const t=e.doc.key,s=this.B_.get(t);s?e.type!==0&&s.type===3?this.B_=this.B_.insert(t,e):e.type===3&&s.type!==1?this.B_=this.B_.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.B_=this.B_.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.B_=this.B_.remove(t):e.type===1&&s.type===2?this.B_=this.B_.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):ee():this.B_=this.B_.insert(t,e)}L_(){const e=[];return this.B_.inorderTraversal((t,s)=>{e.push(s)}),e}}class _o{constructor(e,t,s,r,i,o,a,c,u){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,t,s,r,i){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new _o(e,t,Ji.emptySet(t),o,s,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&wh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==s[r].type||!t[r].doc.isEqual(s[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P2{constructor(){this.k_=void 0,this.listeners=[]}}class R2{constructor(){this.queries=new Wo(e=>vT(e),wh),this.onlineState="Unknown",this.q_=new Set}}async function mp(n,e){const t=ie(n),s=e.query;let r=!1,i=t.queries.get(s);if(i||(r=!0,i=new P2),r)try{i.k_=await t.onListen(s)}catch(o){const a=fp(o,`Initialization of query '${Mi(e.query)}' failed`);return void e.onError(a)}t.queries.set(s,i),i.listeners.push(e),e.Q_(t.onlineState),i.k_&&e.K_(i.k_)&&gp(t)}async function pp(n,e){const t=ie(n),s=e.query;let r=!1;const i=t.queries.get(s);if(i){const o=i.listeners.indexOf(e);o>=0&&(i.listeners.splice(o,1),r=i.listeners.length===0)}if(r)return t.queries.delete(s),t.onUnlisten(s)}function N2(n,e){const t=ie(n);let s=!1;for(const r of e){const i=r.query,o=t.queries.get(i);if(o){for(const a of o.listeners)a.K_(r)&&(s=!0);o.k_=r}}s&&gp(t)}function M2(n,e,t){const s=ie(n),r=s.queries.get(e);if(r)for(const i of r.listeners)i.onError(t);s.queries.delete(e)}function gp(n){n.q_.forEach(e=>{e.next()})}class yp{constructor(e,t,s){this.query=e,this.U_=t,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=s||{}}K_(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new _o(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.W_?this.z_(e)&&(this.U_.next(e),t=!0):this.j_(e,this.onlineState)&&(this.H_(e),t=!0),this.G_=e,t}onError(e){this.U_.error(e)}Q_(e){this.onlineState=e;let t=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),t=!0),t}j_(e,t){if(!e.fromCache)return!0;const s=t!=="Offline";return(!this.options.J_||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}z_(e){if(e.docChanges.length>0)return!0;const t=this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}H_(e){e=_o.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tI{constructor(e){this.key=e}}class nI{constructor(e){this.key=e}}class O2{constructor(e,t){this.query=e,this.ia=t,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=ge(),this.mutatedKeys=ge(),this._a=wT(e),this.aa=new Ji(this._a)}get ua(){return this.ia}ca(e,t){const s=t?t.la:new l_,r=t?t.aa:this.aa;let i=t?t.mutatedKeys:this.mutatedKeys,o=r,a=!1;const c=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,u=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((l,d)=>{const f=r.get(l),m=xh(this.query,d)?d:null,p=!!f&&this.mutatedKeys.has(f.key),y=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let g=!1;f&&m?f.data.isEqual(m.data)?p!==y&&(s.track({type:3,doc:m}),g=!0):this.ha(f,m)||(s.track({type:2,doc:m}),g=!0,(c&&this._a(m,c)>0||u&&this._a(m,u)<0)&&(a=!0)):!f&&m?(s.track({type:0,doc:m}),g=!0):f&&!m&&(s.track({type:1,doc:f}),g=!0,(c||u)&&(a=!0)),g&&(m?(o=o.add(m),i=y?i.add(l):i.delete(l)):(o=o.delete(l),i=i.delete(l)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const l=this.query.limitType==="F"?o.last():o.first();o=o.delete(l.key),i=i.delete(l.key),s.track({type:1,doc:l})}return{aa:o,la:s,Zi:a,mutatedKeys:i}}ha(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,r){const i=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;const o=e.la.L_();o.sort((l,d)=>function(m,p){const y=g=>{switch(g){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ee()}};return y(m)-y(p)}(l.type,d.type)||this._a(l.doc,d.doc)),this.Pa(s),r=r!=null&&r;const a=t&&!r?this.Ia():[],c=this.oa.size===0&&this.current&&!r?1:0,u=c!==this.sa;return this.sa=c,o.length!==0||u?{snapshot:new _o(this.query,e.aa,i,o,e.mutatedKeys,c===0,u,!1,!!s&&s.resumeToken.approximateByteSize()>0),Ta:a}:{Ta:a}}Q_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({aa:this.aa,la:new l_,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}Pa(e){e&&(e.addedDocuments.forEach(t=>this.ia=this.ia.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.ia=this.ia.delete(t)),this.current=e.current)}Ia(){if(!this.current)return[];const e=this.oa;this.oa=ge(),this.aa.forEach(s=>{this.Ea(s.key)&&(this.oa=this.oa.add(s.key))});const t=[];return e.forEach(s=>{this.oa.has(s)||t.push(new nI(s))}),this.oa.forEach(s=>{e.has(s)||t.push(new tI(s))}),t}da(e){this.ia=e.ls,this.oa=ge();const t=this.ca(e.documents);return this.applyChanges(t,!0)}Aa(){return _o.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,this.sa===0,this.hasCachedResults)}}class F2{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class B2{constructor(e){this.key=e,this.Ra=!1}}class L2{constructor(e,t,s,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Va={},this.ma=new Wo(a=>vT(a),wh),this.fa=new Map,this.ga=new Set,this.pa=new ht(j.comparator),this.ya=new Map,this.wa=new ip,this.Sa={},this.ba=new Map,this.Da=yo.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return this.Ca===!0}}async function V2(n,e){const t=Q2(n);let s,r;const i=t.ma.get(e);if(i)s=i.targetId,t.sharedClientState.addLocalQueryTarget(s),r=i.view.Aa();else{const o=await u2(t.localStore,ss(e)),a=t.sharedClientState.addLocalQueryTarget(o.targetId);s=o.targetId,r=await U2(t,e,s,a==="current",o.resumeToken),t.isPrimaryClient&&JT(t.remoteStore,o)}return r}async function U2(n,e,t,s,r){n.va=(d,f,m)=>async function(y,g,x,_){let v=g.view.ca(x);v.Zi&&(v=await o_(y.localStore,g.query,!1).then(({documents:E})=>g.view.ca(E,v)));const w=_&&_.targetChanges.get(g.targetId),I=_&&_.targetMismatches.get(g.targetId)!=null,D=g.view.applyChanges(v,y.isPrimaryClient,w,I);return d_(y,g.targetId,D.Ta),D.snapshot}(n,d,f,m);const i=await o_(n.localStore,e,!0),o=new O2(e,i.ls),a=o.ca(i.documents),c=$c.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",r),u=o.applyChanges(a,n.isPrimaryClient,c);d_(n,t,u.Ta);const l=new F2(e,t,o);return n.ma.set(e,l),n.fa.has(t)?n.fa.get(t).push(e):n.fa.set(t,[e]),u.snapshot}async function W2(n,e){const t=ie(n),s=t.ma.get(e),r=t.fa.get(s.targetId);if(r.length>1)return t.fa.set(s.targetId,r.filter(i=>!wh(i,e))),void t.ma.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(s.targetId),t.sharedClientState.isActiveQueryTarget(s.targetId)||await _0(t.localStore,s.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(s.targetId),QT(t.remoteStore,s.targetId),v0(t,s.targetId)}).catch(Vc)):(v0(t,s.targetId),await _0(t.localStore,s.targetId,!0))}async function H2(n,e,t){const s=K2(n);try{const r=await function(o,a){const c=ie(o),u=Be.now(),l=a.reduce((m,p)=>m.add(p.key),ge());let d,f;return c.persistence.runTransaction("Locally write mutations","readwrite",m=>{let p=Ws(),y=ge();return c.ss.getEntries(m,l).next(g=>{p=g,p.forEach((x,_)=>{_.isValidDocument()||(y=y.add(x))})}).next(()=>c.localDocuments.getOverlayedDocuments(m,p)).next(g=>{d=g;const x=[];for(const _ of a){const v=g4(_,d.get(_.key).overlayedDocument);v!=null&&x.push(new Cr(_.key,v,dT(v.value.mapValue),$t.exists(!0)))}return c.mutationQueue.addMutationBatch(m,u,x,a)}).next(g=>{f=g;const x=g.applyToLocalDocumentSet(d,y);return c.documentOverlayCache.saveOverlays(m,g.batchId,x)})}).then(()=>({batchId:f.batchId,changes:ET(d)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),function(o,a,c){let u=o.Sa[o.currentUser.toKey()];u||(u=new ht(be)),u=u.insert(a,c),o.Sa[o.currentUser.toKey()]=u}(s,r.batchId,t),await Yc(s,r.changes),await Ch(s.remoteStore)}catch(r){const i=fp(r,"Failed to persist write");t.reject(i)}}async function sI(n,e){const t=ie(n);try{const s=await o2(t.localStore,e);e.targetChanges.forEach((r,i)=>{const o=t.ya.get(i);o&&(ke(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.Ra=!0:r.modifiedDocuments.size>0?ke(o.Ra):r.removedDocuments.size>0&&(ke(o.Ra),o.Ra=!1))}),await Yc(t,s,e)}catch(s){await Vc(s)}}function h_(n,e,t){const s=ie(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const r=[];s.ma.forEach((i,o)=>{const a=o.view.Q_(e);a.snapshot&&r.push(a.snapshot)}),function(o,a){const c=ie(o);c.onlineState=a;let u=!1;c.queries.forEach((l,d)=>{for(const f of d.listeners)f.Q_(a)&&(u=!0)}),u&&gp(c)}(s.eventManager,e),r.length&&s.Va.a_(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function $2(n,e,t){const s=ie(n);s.sharedClientState.updateQueryState(e,"rejected",t);const r=s.ya.get(e),i=r&&r.key;if(i){let o=new ht(j.comparator);o=o.insert(i,Et.newNoDocument(i,ne.min()));const a=ge().add(i),c=new Dh(ne.min(),new Map,new ht(be),o,a);await sI(s,c),s.pa=s.pa.remove(i),s.ya.delete(e),_p(s)}else await _0(s.localStore,e,!1).then(()=>v0(s,e,t)).catch(Vc)}async function q2(n,e){const t=ie(n),s=e.batch.batchId;try{const r=await i2(t.localStore,e);iI(t,s,null),rI(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await Yc(t,r)}catch(r){await Vc(r)}}async function Y2(n,e,t){const s=ie(n);try{const r=await function(o,a){const c=ie(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let l;return c.mutationQueue.lookupMutationBatch(u,a).next(d=>(ke(d!==null),l=d.keys(),c.mutationQueue.removeMutationBatch(u,d))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,l,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,l)).next(()=>c.localDocuments.getDocuments(u,l))})}(s.localStore,e);iI(s,e,t),rI(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await Yc(s,r)}catch(r){await Vc(r)}}function rI(n,e){(n.ba.get(e)||[]).forEach(t=>{t.resolve()}),n.ba.delete(e)}function iI(n,e,t){const s=ie(n);let r=s.Sa[s.currentUser.toKey()];if(r){const i=r.get(e);i&&(t?i.reject(t):i.resolve(),r=r.remove(e)),s.Sa[s.currentUser.toKey()]=r}}function v0(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.fa.get(e))n.ma.delete(s),t&&n.Va.Fa(s,t);n.fa.delete(e),n.isPrimaryClient&&n.wa.Rr(e).forEach(s=>{n.wa.containsKey(s)||oI(n,s)})}function oI(n,e){n.ga.delete(e.path.canonicalString());const t=n.pa.get(e);t!==null&&(QT(n.remoteStore,t),n.pa=n.pa.remove(e),n.ya.delete(t),_p(n))}function d_(n,e,t){for(const s of t)s instanceof tI?(n.wa.addReference(s.key,e),z2(n,s)):s instanceof nI?(q("SyncEngine","Document no longer in limbo: "+s.key),n.wa.removeReference(s.key,e),n.wa.containsKey(s.key)||oI(n,s.key)):ee()}function z2(n,e){const t=e.key,s=t.path.canonicalString();n.pa.get(t)||n.ga.has(s)||(q("SyncEngine","New document in limbo: "+t),n.ga.add(s),_p(n))}function _p(n){for(;n.ga.size>0&&n.pa.size<n.maxConcurrentLimboResolutions;){const e=n.ga.values().next().value;n.ga.delete(e);const t=new j(Qe.fromString(e)),s=n.Da.next();n.ya.set(s,new B2(t)),n.pa=n.pa.insert(t,s),JT(n.remoteStore,new ar(ss(vh(t.path)),s,"TargetPurposeLimboResolution",Qm._e))}}async function Yc(n,e,t){const s=ie(n),r=[],i=[],o=[];s.ma.isEmpty()||(s.ma.forEach((a,c)=>{o.push(s.va(c,e,t).then(u=>{if((u||t)&&s.isPrimaryClient&&s.sharedClientState.updateQueryState(c.targetId,u!=null&&u.fromCache?"not-current":"current"),u){r.push(u);const l=ap.Qi(c.targetId,u);i.push(l)}}))}),await Promise.all(o),s.Va.a_(r),await async function(c,u){const l=ie(c);try{await l.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>M.forEach(u,f=>M.forEach(f.ki,m=>l.persistence.referenceDelegate.addReference(d,f.targetId,m)).next(()=>M.forEach(f.qi,m=>l.persistence.referenceDelegate.removeReference(d,f.targetId,m)))))}catch(d){if(!Uc(d))throw d;q("LocalStore","Failed to update sequence numbers: "+d)}for(const d of u){const f=d.targetId;if(!d.fromCache){const m=l.ts.get(f),p=m.snapshotVersion,y=m.withLastLimboFreeSnapshotVersion(p);l.ts=l.ts.insert(f,y)}}}(s.localStore,i))}async function G2(n,e){const t=ie(n);if(!t.currentUser.isEqual(e)){q("SyncEngine","User change. New user:",e.toKey());const s=await YT(t.localStore,e);t.currentUser=e,function(i,o){i.ba.forEach(a=>{a.forEach(c=>{c.reject(new Y(R.CANCELLED,o))})}),i.ba.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Yc(t,s._s)}}function J2(n,e){const t=ie(n),s=t.ya.get(e);if(s&&s.Ra)return ge().add(s.key);{let r=ge();const i=t.fa.get(e);if(!i)return r;for(const o of i){const a=t.ma.get(o);r=r.unionWith(a.view.ua)}return r}}function Q2(n){const e=ie(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=sI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=J2.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=$2.bind(null,e),e.Va.a_=N2.bind(null,e.eventManager),e.Va.Fa=M2.bind(null,e.eventManager),e}function K2(n){const e=ie(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=q2.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Y2.bind(null,e),e}class f_{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=Ah(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return r2(this.persistence,new n2,e.initialUser,this.serializer)}createPersistence(e){return new Z4(op.jr,this.serializer)}createSharedClientState(e){return new h2}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class j2{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>h_(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=G2.bind(null,this.syncEngine),await S2(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new R2}()}createDatastore(e){const t=Ah(e.databaseInfo.databaseId),s=function(i){return new p2(i)}(e.databaseInfo);return function(i,o,a,c){return new _2(i,o,a,c)}(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return function(s,r,i,o,a){return new w2(s,r,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>h_(this.syncEngine,t,0),function(){return c_.D()?new c_:new d2}())}createSyncEngine(e,t){return function(r,i,o,a,c,u,l){const d=new L2(r,i,o,a,c,u);return l&&(d.Ca=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(t){const s=ie(t);q("RemoteStore","RemoteStore shutting down."),s.C_.add(5),await qc(s),s.F_.shutdown(),s.M_.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vp{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Oa(this.observer.next,e)}error(e){this.observer.error?this.Oa(this.observer.error,e):Us("Uncaught Error in snapshot listener:",e.toString())}Na(){this.muted=!0}Oa(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X2{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new Y(R.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const t=await async function(r,i){const o=ie(r),a=uc(o.serializer)+"/documents",c={documents:i.map(f=>ol(o.serializer,f))},u=await o.Co("BatchGetDocuments",a,c,i.length),l=new Map;u.forEach(f=>{const m=k4(o.serializer,f);l.set(m.key.toString(),m)});const d=[];return i.forEach(f=>{const m=l.get(f.toString());ke(!!m),d.push(m)}),d}(this.datastore,e);return t.forEach(s=>this.recordVersion(s)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(s){this.lastWriteError=s}this.writtenDocs.add(e.toString())}delete(e){this.write(new Ih(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,s)=>{const r=j.fromPath(s);this.mutations.push(new NT(r,this.precondition(r)))}),await async function(s,r){const i=ie(s),o=uc(i.serializer)+"/documents",a={writes:r.map(c=>WT(i.serializer,c))};await i.wo("Commit",o,a)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw ee();t=ne.min()}const s=this.readVersions.get(e.key.toString());if(s){if(!t.isEqual(s))throw new Y(R.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(ne.min())?$t.exists(!1):$t.updateTime(t):$t.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(ne.min()))throw new Y(R.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return $t.updateTime(t)}return $t.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z2{constructor(e,t,s,r,i){this.asyncQueue=e,this.datastore=t,this.options=s,this.updateFunction=r,this.deferred=i,this.Wa=s.maxAttempts,this.zo=new cp(this.asyncQueue,"transaction_retry")}run(){this.Wa-=1,this.Ga()}Ga(){this.zo.ko(async()=>{const e=new X2(this.datastore),t=this.za(e);t&&t.then(s=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(s)}).catch(r=>{this.ja(r)}))}).catch(s=>{this.ja(s)})})}za(e){try{const t=this.updateFunction(e);return!Wc(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ja(e){this.Wa>0&&this.Ha(e)?(this.Wa-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ga(),Promise.resolve()))):this.deferred.reject(e)}Ha(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!MT(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eF{constructor(e,t,s,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=r,this.user=Wt.UNAUTHENTICATED,this.clientId=uT.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(s,async i=>{q("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(s,i=>(q("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Y(R.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ns;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=fp(t,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function bd(n,e){n.asyncQueue.verifyOperationInProgress(),q("FirestoreClient","Initializing OfflineComponentProvider");const t=await n.getConfiguration();await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener(async r=>{s.isEqual(r)||(await YT(e.localStore,r),s=r)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function m_(n,e){n.asyncQueue.verifyOperationInProgress();const t=await nF(n);q("FirestoreClient","Initializing OnlineComponentProvider");const s=await n.getConfiguration();await e.initialize(t,s),n.setCredentialChangeListener(r=>u_(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>u_(e.remoteStore,i)),n._onlineComponents=e}function tF(n){return n.name==="FirebaseError"?n.code===R.FAILED_PRECONDITION||n.code===R.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}async function nF(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){q("FirestoreClient","Using user provided OfflineComponentProvider");try{await bd(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!tF(t))throw t;lo("Error using user provided cache. Falling back to memory cache: "+t),await bd(n,new f_)}}else q("FirestoreClient","Using default OfflineComponentProvider"),await bd(n,new f_);return n._offlineComponents}async function wp(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(q("FirestoreClient","Using user provided OnlineComponentProvider"),await m_(n,n._uninitializedComponentsProvider._online)):(q("FirestoreClient","Using default OnlineComponentProvider"),await m_(n,new j2))),n._onlineComponents}function sF(n){return wp(n).then(e=>e.syncEngine)}function rF(n){return wp(n).then(e=>e.datastore)}async function cl(n){const e=await wp(n),t=e.eventManager;return t.onListen=V2.bind(null,e.syncEngine),t.onUnlisten=W2.bind(null,e.syncEngine),t}function iF(n,e,t={}){const s=new ns;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,c,u){const l=new vp({next:f=>{o.enqueueAndForget(()=>pp(i,d));const m=f.docs.has(a);!m&&f.fromCache?u.reject(new Y(R.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&f.fromCache&&c&&c.source==="server"?u.reject(new Y(R.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(f)},error:f=>u.reject(f)}),d=new yp(vh(a.path),l,{includeMetadataChanges:!0,J_:!0});return mp(i,d)}(await cl(n),n.asyncQueue,e,t,s)),s.promise}function oF(n,e,t={}){const s=new ns;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,c,u){const l=new vp({next:f=>{o.enqueueAndForget(()=>pp(i,d)),f.fromCache&&c.source==="server"?u.reject(new Y(R.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(f)},error:f=>u.reject(f)}),d=new yp(a,l,{includeMetadataChanges:!0,J_:!0});return mp(i,d)}(await cl(n),n.asyncQueue,e,t,s)),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aI(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cI(n,e,t){if(!t)throw new Y(R.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function aF(n,e,t,s){if(e===!0&&s===!0)throw new Y(R.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function g_(n){if(!j.isDocumentKey(n))throw new Y(R.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function y_(n){if(j.isDocumentKey(n))throw new Y(R.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function xp(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(s){return s.constructor?s.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ee()}function rs(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Y(R.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=xp(n);throw new Y(R.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __{constructor(e){var t,s;if(e.host===void 0){if(e.ssl!==void 0)throw new Y(R.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Y(R.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}aF("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=aI((s=e.experimentalLongPollingOptions)!==null&&s!==void 0?s:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Y(R.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Y(R.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Y(R.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(s,r){return s.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class kh{constructor(e,t,s,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new __({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Y(R.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new Y(R.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new __(e),e.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new bO;switch(s.type){case"firstParty":return new PO(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Y(R.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const s=p_.get(t);s&&(q("ComponentProvider","Removing Datastore"),p_.delete(t),s.terminate())}(this),Promise.resolve()}}function cF(n,e,t,s={}){var r;const i=(n=rs(n,kh))._getSettings(),o=`${e}:${t}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&lo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),s.mockUserToken){let a,c;if(typeof s.mockUserToken=="string")a=s.mockUserToken,c=Wt.MOCK_USER;else{a=bw(s.mockUserToken,(r=n._app)===null||r===void 0?void 0:r.options.projectId);const u=s.mockUserToken.sub||s.mockUserToken.user_id;if(!u)throw new Y(R.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Wt(u)}n._authCredentials=new CO(new cT(a,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zc{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new zc(this.firestore,e,this._query)}}class dn{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new fr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new dn(this.firestore,e,this._key)}}class fr extends zc{constructor(e,t,s){super(e,t,vh(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new dn(this.firestore,null,new j(e))}withConverter(e){return new fr(this.firestore,e,this._path)}}function Vt(n,e,...t){if(n=Te(n),cI("collection","path",e),n instanceof kh){const s=Qe.fromString(e,...t);return y_(s),new fr(n,null,s)}{if(!(n instanceof dn||n instanceof fr))throw new Y(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Qe.fromString(e,...t));return y_(s),new fr(n.firestore,null,s)}}function sn(n,e,...t){if(n=Te(n),arguments.length===1&&(e=uT.newId()),cI("doc","path",e),n instanceof kh){const s=Qe.fromString(e,...t);return g_(s),new dn(n,null,new j(s))}{if(!(n instanceof dn||n instanceof fr))throw new Y(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Qe.fromString(e,...t));return g_(s),new dn(n.firestore,n instanceof fr?n.converter:null,new j(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uF{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new cp(this,"async_queue_retry"),this.iu=()=>{const t=Ad();t&&q("AsyncQueue","Visibility state changed to "+t.visibilityState),this.zo.Qo()};const e=Ad();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.su(),this.ou(e)}enterRestrictedMode(e){if(!this.Za){this.Za=!0,this.nu=e||!1;const t=Ad();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.iu)}}enqueue(e){if(this.su(),this.Za)return new Promise(()=>{});const t=new ns;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ya.push(e),this._u()))}async _u(){if(this.Ya.length!==0){try{await this.Ya[0](),this.Ya.shift(),this.zo.reset()}catch(e){if(!Uc(e))throw e;q("AsyncQueue","Operation failed with retryable error: "+e)}this.Ya.length>0&&this.zo.ko(()=>this._u())}}ou(e){const t=this.Ja.then(()=>(this.tu=!0,e().catch(s=>{this.eu=s,this.tu=!1;const r=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(s);throw Us("INTERNAL UNHANDLED ERROR: ",r),s}).then(s=>(this.tu=!1,s))));return this.Ja=t,t}enqueueAfterDelay(e,t,s){this.su(),this.ru.indexOf(e)>-1&&(t=0);const r=dp.createAndSchedule(this,e,t,s,i=>this.au(i));return this.Xa.push(r),r}su(){this.eu&&ee()}verifyOperationInProgress(){}async uu(){let e;do e=this.Ja,await e;while(e!==this.Ja)}cu(e){for(const t of this.Xa)if(t.timerId===e)return!0;return!1}lu(e){return this.uu().then(()=>{this.Xa.sort((t,s)=>t.targetTimeMs-s.targetTimeMs);for(const t of this.Xa)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.uu()})}hu(e){this.ru.push(e)}au(e){const t=this.Xa.indexOf(e);this.Xa.splice(t,1)}}function v_(n){return function(t,s){if(typeof t!="object"||t===null)return!1;const r=t;for(const i of s)if(i in r&&typeof r[i]=="function")return!0;return!1}(n,["next","error","complete"])}class oi extends kh{constructor(e,t,s,r){super(e,t,s,r),this.type="firestore",this._queue=function(){return new uF}(),this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||uI(this),this._firestoreClient.terminate()}}function lF(n,e){const t=typeof n=="object"?n:No(),s=typeof n=="string"?n:e||"(default)",r=Wl(t,"firestore").getImmediate({identifier:s});if(!r._initialized){const i=Iw("firestore");i&&cF(r,...i)}return r}function $o(n){return n._firestoreClient||uI(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function uI(n){var e,t,s;const r=n._freezeSettings(),i=function(a,c,u,l){return new $O(a,c,u,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,aI(l.experimentalLongPollingOptions),l.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,r);n._firestoreClient=new eF(n._authCredentials,n._appCheckCredentials,n._queue,i),!((t=r.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((s=r.localCache)===null||s===void 0)&&s._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.localCache.kind,_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ai(Qt.fromBase64String(e))}catch(t){throw new Y(R.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ai(Qt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gc{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Y(R.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Rt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qo{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ep{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Y(R.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Y(R.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return be(this._lat,e._lat)||be(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hF=/^__.*__$/;class dF{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new Cr(e,this.data,this.fieldMask,t,this.fieldTransforms):new Hc(e,this.data,t,this.fieldTransforms)}}class lI{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new Cr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function hI(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ee()}}class Sh{constructor(e,t,s,r,i,o){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=r,i===void 0&&this.Pu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(e){return new Sh(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.Tu({path:s,du:!1});return r.Au(e),r}Ru(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.Tu({path:s,du:!1});return r.Pu(),r}Vu(e){return this.Tu({path:void 0,du:!0})}mu(e){return ul(e,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Au(this.path.get(e))}Au(e){if(e.length===0)throw this.mu("Document fields must not be empty");if(hI(this.Iu)&&hF.test(e))throw this.mu('Document fields cannot begin and end with "__"')}}class fF{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||Ah(e)}pu(e,t,s,r=!1){return new Sh({Iu:e,methodName:t,gu:s,path:Rt.emptyPath(),du:!1,fu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function dI(n){const e=n._freezeSettings(),t=Ah(n._databaseId);return new fF(n._databaseId,!!e.ignoreUndefinedProperties,t)}function fI(n,e,t,s,r,i={}){const o=n.pu(i.merge||i.mergeFields?2:0,e,t,r);Tp("Data must be an object, but it was:",o,s);const a=yI(s,o);let c,u;if(i.merge)c=new gn(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const l=[];for(const d of i.mergeFields){const f=w0(e,d,t);if(!o.contains(f))throw new Y(R.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);vI(l,f)||l.push(f)}c=new gn(l),u=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,u=o.fieldTransforms;return new dF(new Xt(a),c,u)}class Jc extends qo{_toFieldTransform(e){if(e.Iu!==2)throw e.Iu===1?e.mu(`${this._methodName}() can only appear at the top level of your update data`):e.mu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Jc}}function mI(n,e,t){return new Sh({Iu:3,gu:e.settings.gu,methodName:n._methodName,du:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class mF extends qo{constructor(e,t){super(e),this.yu=t}_toFieldTransform(e){const t=mI(this,e,!0),s=this.yu.map(i=>Yo(i,t)),r=new po(s);return new tp(e.path,r)}isEqual(e){return this===e}}class pF extends qo{constructor(e,t){super(e),this.yu=t}_toFieldTransform(e){const t=mI(this,e,!0),s=this.yu.map(i=>Yo(i,t)),r=new go(s);return new tp(e.path,r)}isEqual(e){return this===e}}class gF extends qo{constructor(e,t){super(e),this.wu=t}_toFieldTransform(e){const t=new cc(e.serializer,AT(e.serializer,this.wu));return new tp(e.path,t)}isEqual(e){return this===e}}function pI(n,e,t,s){const r=n.pu(1,e,t);Tp("Data must be an object, but it was:",r,s);const i=[],o=Xt.empty();yi(s,(c,u)=>{const l=Ip(e,c,t);u=Te(u);const d=r.Ru(l);if(u instanceof Jc)i.push(l);else{const f=Yo(u,d);f!=null&&(i.push(l),o.set(l,f))}});const a=new gn(i);return new lI(o,a,r.fieldTransforms)}function gI(n,e,t,s,r,i){const o=n.pu(1,e,t),a=[w0(e,s,t)],c=[r];if(i.length%2!=0)throw new Y(R.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<i.length;f+=2)a.push(w0(e,i[f])),c.push(i[f+1]);const u=[],l=Xt.empty();for(let f=a.length-1;f>=0;--f)if(!vI(u,a[f])){const m=a[f];let p=c[f];p=Te(p);const y=o.Ru(m);if(p instanceof Jc)u.push(m);else{const g=Yo(p,y);g!=null&&(u.push(m),l.set(m,g))}}const d=new gn(u);return new lI(l,d,o.fieldTransforms)}function Yo(n,e){if(_I(n=Te(n)))return Tp("Unsupported field value:",e,n),yI(n,e);if(n instanceof qo)return function(s,r){if(!hI(r.Iu))throw r.mu(`${s._methodName}() can only be used with update() and set()`);if(!r.path)throw r.mu(`${s._methodName}() is not currently supported inside arrays`);const i=s._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.du&&e.Iu!==4)throw e.mu("Nested arrays are not supported");return function(s,r){const i=[];let o=0;for(const a of s){let c=Yo(a,r.Vu(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(n,e)}return function(s,r){if((s=Te(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return AT(r.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const i=Be.fromDate(s);return{timestampValue:il(r.serializer,i)}}if(s instanceof Be){const i=new Be(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:il(r.serializer,i)}}if(s instanceof Ep)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof ai)return{bytesValue:LT(r.serializer,s._byteString)};if(s instanceof dn){const i=r.databaseId,o=s.firestore._databaseId;if(!o.isEqual(i))throw r.mu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:rp(s.firestore._databaseId||r.databaseId,s._key.path)}}throw r.mu(`Unsupported field value: ${xp(s)}`)}(n,e)}function yI(n,e){const t={};return lT(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):yi(n,(s,r)=>{const i=Yo(r,e.Eu(s));i!=null&&(t[s]=i)}),{mapValue:{fields:t}}}function _I(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Be||n instanceof Ep||n instanceof ai||n instanceof dn||n instanceof qo)}function Tp(n,e,t){if(!_I(t)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(t)){const s=xp(t);throw s==="an object"?e.mu(n+" a custom object"):e.mu(n+" "+s)}}function w0(n,e,t){if((e=Te(e))instanceof Gc)return e._internalPath;if(typeof e=="string")return Ip(n,e);throw ul("Field path arguments must be of type string or ",n,!1,void 0,t)}const yF=new RegExp("[~\\*/\\[\\]]");function Ip(n,e,t){if(e.search(yF)>=0)throw ul(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Gc(...e.split("."))._internalPath}catch{throw ul(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function ul(n,e,t,s,r){const i=s&&!s.isEmpty(),o=r!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${s}`),o&&(c+=` in document ${r}`),c+=")"),new Y(R.INVALID_ARGUMENT,a+n+c)}function vI(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{constructor(e,t,s,r,i){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new dn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new _F(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(wI("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class _F extends ll{data(){return super.data()}}function wI(n,e){return typeof e=="string"?Ip(n,e):e instanceof Gc?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xI(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Y(R.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class EI{convertValue(e,t="none"){switch(ii(e)){case 0:return null;case 1:return e.booleanValue;case 2:return lt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ri(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw ee()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return yi(e,(r,i)=>{s[r]=this.convertValue(i,t)}),s}convertGeoPoint(e){return new Ep(lt(e.latitude),lt(e.longitude))}convertArray(e,t){return(e.values||[]).map(s=>this.convertValue(s,t))}convertServerTimestamp(e,t){switch(t){case"previous":const s=jm(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(ic(e));default:return null}}convertTimestamp(e){const t=wr(e);return new Be(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=Qe.fromString(e);ke(qT(s));const r=new oc(s.get(1),s.get(3)),i=new j(s.popFirst(5));return r.isEqual(t)||Us(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TI(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class vF extends EI{constructor(e){super(),this.firestore=e}convertBytes(e){return new ai(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new dn(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Dp extends ll{constructor(e,t,s,r,i,o){super(e,t,s,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Pu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(wI("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}}class Pu extends Dp{data(e={}){return super.data(e)}}class II{constructor(e,t,s,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Ui(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(s=>{e.call(t,new Pu(this._firestore,this._userDataWriter,s.key,s,new Ui(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Y(R.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(a=>{const c=new Pu(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Ui(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const c=new Pu(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Ui(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);let u=-1,l=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),l=o.indexOf(a.doc.key)),{type:wF(a.type),doc:c,oldIndex:u,newIndex:l}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function wF(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ee()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w_(n){n=rs(n,dn);const e=rs(n.firestore,oi);return iF($o(e),n._key).then(t=>DI(e,n,t))}class Ph extends EI{constructor(e){super(),this.firestore=e}convertBytes(e){return new ai(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new dn(this.firestore,null,t)}}function x_(n){n=rs(n,zc);const e=rs(n.firestore,oi),t=$o(e),s=new Ph(e);return xI(n._query),oF(t,n._query).then(r=>new II(e,s,n,r))}function xF(n,...e){var t,s,r;n=Te(n);let i={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||v_(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges};if(v_(e[o])){const d=e[o];e[o]=(t=d.next)===null||t===void 0?void 0:t.bind(d),e[o+1]=(s=d.error)===null||s===void 0?void 0:s.bind(d),e[o+2]=(r=d.complete)===null||r===void 0?void 0:r.bind(d)}let c,u,l;if(n instanceof dn)u=rs(n.firestore,oi),l=vh(n._key.path),c={next:d=>{e[o]&&e[o](DI(u,n,d))},error:e[o+1],complete:e[o+2]};else{const d=rs(n,zc);u=rs(d.firestore,oi),l=d._query;const f=new Ph(u);c={next:m=>{e[o]&&e[o](new II(u,f,d,m))},error:e[o+1],complete:e[o+2]},xI(n._query)}return function(f,m,p,y){const g=new vp(y),x=new yp(m,g,p);return f.asyncQueue.enqueueAndForget(async()=>mp(await cl(f),x)),()=>{g.Na(),f.asyncQueue.enqueueAndForget(async()=>pp(await cl(f),x))}}($o(u),l,a,c)}function EF(n,e){return function(s,r){const i=new ns;return s.asyncQueue.enqueueAndForget(async()=>H2(await sF(s),r,i)),i.promise}($o(n),e)}function DI(n,e,t){const s=t.docs.get(e._key),r=new Ph(n);return new Dp(n,r,e._key,s,new Ui(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TF={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IF{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=dI(e)}set(e,t,s){this._verifyNotCommitted();const r=nr(e,this._firestore),i=TI(r.converter,t,s),o=fI(this._dataReader,"WriteBatch.set",r._key,i,r.converter!==null,s);return this._mutations.push(o.toMutation(r._key,$t.none())),this}update(e,t,s,...r){this._verifyNotCommitted();const i=nr(e,this._firestore);let o;return o=typeof(t=Te(t))=="string"||t instanceof Gc?gI(this._dataReader,"WriteBatch.update",i._key,t,s,r):pI(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(o.toMutation(i._key,$t.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=nr(e,this._firestore);return this._mutations=this._mutations.concat(new Ih(t._key,$t.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Y(R.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function nr(n,e){if((n=Te(n)).firestore!==e)throw new Y(R.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DF extends class{constructor(t,s){this._firestore=t,this._transaction=s,this._dataReader=dI(t)}get(t){const s=nr(t,this._firestore),r=new vF(this._firestore);return this._transaction.lookup([s._key]).then(i=>{if(!i||i.length!==1)return ee();const o=i[0];if(o.isFoundDocument())return new ll(this._firestore,r,o.key,o,s.converter);if(o.isNoDocument())return new ll(this._firestore,r,s._key,null,s.converter);throw ee()})}set(t,s,r){const i=nr(t,this._firestore),o=TI(i.converter,s,r),a=fI(this._dataReader,"Transaction.set",i._key,o,i.converter!==null,r);return this._transaction.set(i._key,a),this}update(t,s,r,...i){const o=nr(t,this._firestore);let a;return a=typeof(s=Te(s))=="string"||s instanceof Gc?gI(this._dataReader,"Transaction.update",o._key,s,r,i):pI(this._dataReader,"Transaction.update",o._key,s),this._transaction.update(o._key,a),this}delete(t){const s=nr(t,this._firestore);return this._transaction.delete(s._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=nr(e,this._firestore),s=new Ph(this._firestore);return super.get(e).then(r=>new Dp(this._firestore,s,t._key,r._document,new Ui(!1,!1),t.converter))}}function AF(n,e,t){n=rs(n,oi);const s=Object.assign(Object.assign({},TF),t);return function(i){if(i.maxAttempts<1)throw new Y(R.INVALID_ARGUMENT,"Max attempts must be at least 1")}(s),function(i,o,a){const c=new ns;return i.asyncQueue.enqueueAndForget(async()=>{const u=await rF(i);new Z2(i.asyncQueue,u,a,o,c).run()}),c.promise}($o(n),r=>e(new DF(n,r)),s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cd(){return new Jc("deleteField")}function bF(...n){return new mF("arrayUnion",n)}function CF(...n){return new pF("arrayRemove",n)}function vu(n){return new gF("increment",n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kF(n){return $o(n=rs(n,oi)),new IF(n,e=>EF(n,e))}(function(e,t=!0){(function(r){Uo=r})(mi),ni(new yr("firestore",(s,{instanceIdentifier:r,options:i})=>{const o=s.getProvider("app").getImmediate(),a=new oi(new kO(s.getProvider("auth-internal")),new NO(s.getProvider("app-check-internal")),function(u,l){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Y(R.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new oc(u.options.projectId,l)}(o,r),o);return i=Object.assign({useFetchStreams:t},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),ts(Uy,"4.4.0",e),ts(Uy,"4.4.0","esm2017")})();var Qi=(n=>(n[n.Barber=0]="Barber",n[n.Polish=1]="Polish",n[n.Beautician=2]="Beautician",n[n.ManicurePedicure=3]="ManicurePedicure",n[n.Eyelashes=4]="Eyelashes",n[n.Eyebrows=5]="Eyebrows",n[n.Braids=6]="Braids",n[n.MakeUpArtist=7]="MakeUpArtist",n[n.TattooArtist=8]="TattooArtist",n[n.HairRemoval=9]="HairRemoval",n[n.Masseur=10]="Masseur",n[n.Physiotherapy=11]="Physiotherapy",n[n.Cobblers=12]="Cobblers",n[n.Clown=13]="Clown",n[n.SocialWorker=14]="SocialWorker",n[n.Magician=15]="Magician",n[n.Doctor=16]="Doctor",n[n.Veterinarian=17]="Veterinarian",n[n.CommunicationTherapist=18]="CommunicationTherapist",n[n.DogGroomer=19]="DogGroomer",n[n.DJ=20]="DJ",n[n.Psychologist=21]="Psychologist",n[n.Tutor=22]="Tutor",n[n.WeddingDresses=23]="WeddingDresses",n[n.DanceTeacher=24]="DanceTeacher",n[n.Babysitter=25]="Babysitter",n[n.Reflexologist=26]="Reflexologist",n[n.Dietitian=27]="Dietitian",n[n.CarWash=28]="CarWash",n[n.Photographer=29]="Photographer",n[n.SwimmingTeacher=30]="SwimmingTeacher",n[n.Counselor=31]="Counselor",n[n.Mentor=32]="Mentor",n[n.TennisCoach=33]="TennisCoach",n[n.PrivateChef=34]="PrivateChef",n[n.PersonalTrainer=35]="PersonalTrainer",n[n.Lawyer=36]="Lawyer",n[n.Sales=37]="Sales",n[n.RealEstate=38]="RealEstate",n[n.DrivingTeacher=39]="DrivingTeacher",n[n.InvestmentAdvice=40]="InvestmentAdvice",n[n.Library=41]="Library",n[n.Tailor=42]="Tailor",n[n.Restaurant=43]="Restaurant",n[n.NailConstruction=44]="NailConstruction",n[n.Dentist=45]="Dentist",n[n.BeautysSalon=46]="BeautysSalon",n[n.Washer=47]="Washer",n[n.CleaningSofas=48]="CleaningSofas",n[n.Other=49]="Other",n))(Qi||{});const SF={0:"barber",1:"polish",48:"cleaningSofas",2:"beautician",3:"manicurePedicure",4:"eyelashes",5:"eyebrows",25:"babysitter",6:"braids",7:"makeUpArtist",8:"tattooArtist",9:"hairRemoval",10:"masseur",12:"cobblers",13:"clown",14:"socialWorker",15:"magician",16:"doctor",20:"dj",17:"veterinarian",18:"communicationTherapist",19:"dogGroomer",21:"psychologist",11:"physiotherapy",22:"Tutor",23:"weddingDresses",24:"danceTeacher",26:"reflexologist",27:"dietitian",28:"carWash",29:"photographer",30:"swimmingTeacher",31:"counselor",32:"mentor",33:"tennisCoach",34:"privateChef",35:"personalTrainer",36:"lawyer",37:"sales",38:"realEstate",39:"drivingTeacher",40:"investmentAdvice",41:"library",49:"other",42:"tailor",43:"restaurant",44:"nailConstruction",45:"dentist",46:"beautysSalon",47:"washer"},AI={barber:0,cleaningSofas:48,polish:1,beautician:2,manicurePedicure:3,eyelashes:4,eyebrows:5,babysitter:25,braids:6,makeUpArtist:7,tattooArtist:8,hairRemoval:9,masseur:10,cobblers:12,clown:13,socialWorker:14,magician:15,doctor:16,veterinarian:17,communicationTherapist:18,dogGroomer:19,psychologist:21,physiotherapy:11,Tutor:22,weddingDresses:23,danceTeacher:24,reflexologist:26,dietitian:27,carWash:28,photographer:29,swimmingTeacher:30,counselor:31,mentor:32,dj:20,tennisCoach:33,privateChef:34,personalTrainer:35,lawyer:36,sales:37,realEstate:38,drivingTeacher:39,investmentAdvice:40,library:41,other:49,restaurant:43,tailor:42,nailConstruction:44,dentist:45,beautysSalon:46,washer:47};function LV(n){return n.length<20?xt.currentBusinesssId.startsWith(n.substring(1)):xt.currentBusinesssId.startsWith(n)}function VV(n){function e(u){return u<=.03928?u/12.92:Math.pow((u+.055)/1.055,2.4)}let t=n.toString(16),s=parseInt(t.slice(2,4),16),r=parseInt(t.slice(4,6),16),i=parseInt(t.slice(6,8),16);const o=e(s/255),a=e(r/255),c=e(i/255);return .2126*o+.7152*a+.0722*c}function PF(n,e=155){console.log(n);const t=n.toString(16),s=parseInt(t.slice(2,4),16),r=parseInt(t.slice(4,6),16),i=parseInt(t.slice(6,8),16),o=(s*299+r*587+i*114)/1e3;return console.log(o),o>e}function E_(n,e){if(n===null)return e===null;if(e===null||n.size!==e.size)return!1;if(n===e)return!0;for(const t of n)if(!e.has(t))return!1;return!0}async function UV(){return!0}var x0=(n=>(n[n.light=0]="light",n[n.dark=1]="dark",n))(x0||{});class Ds{constructor({background:e=0,primary:t=0,surface:s=0,inverseSurface:r=0,tertiary:i=0,id:o,fontName:a="",themeName:c=""}){h(this,"background",0);h(this,"primary",0);h(this,"surface",0);h(this,"inverseSurface",0);h(this,"tertiary",0);h(this,"id","");h(this,"fontName","");h(this,"themeName","");this.background=e,this.primary=t,this.surface=s,this.inverseSurface=r,this.tertiary=i,this.id=o,this.fontName=a,this.themeName=c}static fromJson(e,t){return new Ds({background:e.background||0,primary:e.primary||0,id:t,themeName:e.themeName||"",surface:e.surface||0,tertiary:e.tertiary||0,inverseSurface:e.inverseSurface||0,fontName:e.fontName||""})}static fromBusinessTheme(e){return new Ds({themeName:e.themeName,background:e.background,primary:e.primary,tertiary:e.tertiary,id:e.id,surface:e.surface,inverseSurface:e.inverseSurface,fontName:e.fontName})}isEqual(e,t=!0){const s=e.toJson();t&&(s.id=e.id);const r=this.toJson();return t&&(r.id=this.id),JSON.stringify(s)===JSON.stringify(r)}get brightness(){return PF(this.background)?1:0}toJson(){const e={};return this.fontName!==""&&(e.fontName=this.fontName),this.surface!==0&&(e.surface=this.surface),this.inverseSurface!==0&&(e.inverseSurface=this.inverseSurface),e.tertiary=this.tertiary,e.themeName=this.themeName,this.background!==0&&(e.background=this.background),this.primary!==0&&(e.primary=this.primary),e}}var gs=(n=>(n[n.Grid=0]="Grid",n[n.Carousel=1]="Carousel",n[n.EndlessCarousel=2]="EndlessCarousel",n))(gs||{});const T_={0:"grid",1:"carousel",2:"endlessCarousel"},I_={grid:0,carousel:1,endlessCarousel:2},bI={dark:new Ds({fontName:"Varela Round",themeName:"Original",id:"dark",inverseSurface:4279637532,background:4280229673,surface:4280690225,tertiary:4279834916,primary:4294940672}),darkIos:new Ds({fontName:"Varela Round",themeName:"Dark",id:"darkIos",inverseSurface:4281084974,background:4279637528,surface:4280361252,tertiary:4278190080,primary:4278225100}),light:new Ds({fontName:"Varela Round",themeName:"Pink",id:"light",inverseSurface:4294831859,background:4294375158,surface:4294967295,tertiary:4294243315,primary:4294936498}),lightIos:new Ds({fontName:"Varela Round",themeName:"Light",id:"lightIos",inverseSurface:4292664541,background:4294111991,surface:4294967295,tertiary:4293322471,primary:4278221567})};class Fe{constructor(e){h(this,"id","");h(this,"token","");e&&(this.id=e.I||"",this.token=e.T||"")}static fromShopIconUrl(e){const t=new Fe;try{const s=e.split("SHOPICON");t.id=s[1].split("?alt")[0];const r=e.split("&token=");return t.token=r[1],t}catch{return new Fe}}static fromJson(e){const t=new Fe;return t.id=e.I||"",t.token=e.T||"",t}static fromJsonStr(e){const t=JSON.parse(e),s=new Fe;return s.id=t.I||"",s.token=t.T||"",s}get isEmpty(){return this.token===""||this.id===""}get isNotEmpty(){return this.token!==""&&this.id!==""}isEqual(e){return e.id==this.id&&e.token==this.token}getShopIconPath(e){return this.token===""||this.id===""?"":`https://firebasestorage.googleapis.com/v0/b/managementsystemapp-c1fda.appspot.com/o/enviroments%2F${Ke.replace("enviroments/","")}%2F${e}%2Fimages%2Flogos%2FSHOPICON${this.id}?alt=media&token=${this.token}`}toJsonStr(){const e={I:this.id,T:this.token};return JSON.stringify(e)}toJson(){return{I:this.id,T:this.token}}}class qt{constructor({amount:e,currency:t}){h(this,"amount",0);h(this,"currency",Rs);const s=parseFloat(e)||0;this.amount=parseFloat(s.toFixed(2)),this.currency=t}static fromJson(e){const t=new qt({amount:"0.0",currency:xs.fromJson(e.currency)});return e.amount!=null&&(t.amount=typeof e.amount=="number"?e.amount:parseFloat(e.amount)),t}add(e){e.currency.code===this.currency.code&&(this.amount+=e.amount)}isEqual(e){return this.amount===e.amount&&this.currency.code===e.currency.code}toString(){return new Intl.NumberFormat("en-US",{style:"currency",currency:this.currency.code}).format(this.amount).slice(0,-1)}toJson(){return{amount:this.amount,currency:this.currency.toJson()}}}let D_=class E0{constructor({name:e="",description:t="",id:s="",price:r,imageUrl:i=""}={}){h(this,"description","");h(this,"price");h(this,"imageUrl","");h(this,"id","");h(this,"name","");h(this,"createdAt",new Date);this.name=e||"",this.description=t||"",this.id=s||"",this.price=r,this.imageUrl=i||""}static fromProduct(e){const t=new E0({id:e.id,description:e.description,price:e.price,imageUrl:e.imageUrl,name:e.name});return t.createdAt=e.createdAt,t}static fromJson(e,t){const s=new E0({id:t,description:e.description,price:qt.fromJson(e.price),imageUrl:e.imageUrl,name:e.name});return s.createdAt=e.createdAt,s}toJson(){return{description:this.description,price:this.price?this.price.toJson():null,imageUrl:this.imageUrl,name:this.name,createdAt:this.createdAt}}toString(){return JSON.stringify(this.toJson())}};class vo{constructor(e,t,s,r,i,o=!1){h(this,"title","");h(this,"content","");h(this,"lastModified","");h(this,"index","");h(this,"id","");h(this,"popOnEnter",!1);this.title=e,this.content=t,this.id=s,this.lastModified=r,this.index=i,this.popOnEnter=o}static fromJson(e,t){return new vo(e.title??"",e.content??"",e.id??"",e.lastModified??"",t,e.popOnEnter??!1)}static fromUpdate(e){return new vo(e.title,e.content,e.id,e.lastModified,e.index,e.popOnEnter)}toJson(){const e={};return e.title=this.title,e.id=this.id,e.content=this.content,this.lastModified!==""&&(e.lastModified=this.lastModified),this.popOnEnter&&(e.popOnEnter=this.popOnEnter),e}isValid(){return this.title!==""&&this.content!==""}toString(){return JSON.stringify(this,null,2)}}class As{constructor({storyView:e=gs.Grid,productView:t=gs.Grid,changingImagesSwapSeconds:s=6,shopIconUrl:r="",pickedThemeKey:i="darkIos"}={}){h(this,"storyView",gs.Grid);h(this,"productView",gs.Grid);h(this,"changingImages",[]);h(this,"products",new Map);h(this,"updates",new Map);h(this,"storyTitle","");h(this,"shopIconUrl","");h(this,"productsTitle","");h(this,"bottomIcons",!1);h(this,"changingImagesSwapSeconds",6);h(this,"pickedThemeKey","darkIos");h(this,"lastTimeToUpdateTerm",new Date(0));h(this,"businessThemes",new Map);h(this,"term","");h(this,"mustConfirmTerm",!1);h(this,"popTermOnFirstEneter",!1);h(this,"isPrivateTheme",!1);this.changingImagesSwapSeconds=s,this.shopIconUrl=r,this.pickedThemeKey=i}static fromJson(e){const t=new As;return Object.entries(e.products).forEach(([s,r])=>{t.products.set(s,D_.fromJson(r,s))}),e.changingImages&&(t.changingImages=e.changingImages.map(s=>s)),e.updates&&Object.entries(e.updates).forEach(([s,r])=>{t.updates.set(s,vo.fromJson(r,s))}),e.storyView&&(t.storyView=I_[e.storyView]||gs.EndlessCarousel),e.productView&&(t.productView=I_[e.productView]||gs.Grid),e.businessThemes&&Object.entries(e.businessThemes).forEach(([s,r])=>{t.businessThemes.set(s,Ds.fromJson(r,s))}),e.lastTimeToUpdateTerm&&(t.lastTimeToUpdateTerm=new Date(e.lastTimeToUpdateTerm)||new Date(0)),t.pickedThemeKey=e.pickedThemeKey||"darkIoss",t.term=e.term||"",t.bottomIcons=e.bottomIcons||!1,t.changingImagesSwapSeconds=e.changingImagesSwapSeconds||6,t.productsTitle=e.productsTitle||"",t.storyTitle=e.storyTitle||"",t.shopIconUrl=e.shopIcon||"",t.mustConfirmTerm=e.mustConfirmTerm||!1,t.popTermOnFirstEneter=e.popTermOnFirstEneter||!1,t.isPrivateTheme=e.isPrivateTheme||!1,t}get shopIconData(){return Fe.fromShopIconUrl(this.shopIconUrl)}static fromBusinessDesign(e){const t=new As;return e.products.forEach((s,r)=>{t.products.set(r,D_.fromProduct(s))}),t.changingImages=[...e.changingImages],e.updates.forEach((s,r)=>{t.updates.set(r,vo.fromUpdate(s))}),t.storyView=e.storyView,e.businessThemes.forEach((s,r)=>{t.businessThemes.set(r,Ds.fromBusinessTheme(s))}),t.shopIconUrl=e.shopIconUrl,t.pickedThemeKey=e.pickedThemeKey,t.lastTimeToUpdateTerm=e.lastTimeToUpdateTerm,t.changingImagesSwapSeconds=e.changingImagesSwapSeconds,t.term=e.term,t.bottomIcons=e.bottomIcons,t.productsTitle=e.productsTitle,t.productView=e.productView,t.storyTitle=e.storyTitle,t.mustConfirmTerm=e.mustConfirmTerm,t.popTermOnFirstEneter=e.popTermOnFirstEneter,t.isPrivateTheme=e.isPrivateTheme,t}toJson(){const e={};return this.storyView!==gs.EndlessCarousel&&(e.storyView=T_[this.storyView]),this.productView!==gs.Grid&&(e.productView=T_[this.storyView]),e.changingImages=this.changingImages,e.products={},this.products.forEach((t,s)=>{e.products[s]=t.toJson()}),e.updates={},this.updates.forEach((t,s)=>{e.updates[s]=t.toJson()}),this.mustConfirmTerm&&(e.mustConfirmTerm=this.mustConfirmTerm),this.popTermOnFirstEneter&&(e.popTermOnFirstEneter=this.popTermOnFirstEneter),this.term!==""&&(e.term=this.term),this.lastTimeToUpdateTerm!==new Date(0)&&(e.lastTimeToUpdateTerm=oe(this.lastTimeToUpdateTerm)),e.bottomIcons=this.bottomIcons,e.changingImagesSwapSeconds=this.changingImagesSwapSeconds,e.storyTitle=this.storyTitle,e.productsTitle=this.productsTitle,e.businessThemes={},this.businessThemes.forEach((t,s)=>{bI.hasOwnProperty(s)||(e.businessThemes[s]=t.toJson())}),e.pickedThemeKey=this.pickedThemeKey,e.shopIcon=this.shopIconUrl,e.isPrivateTheme=this.isPrivateTheme,e}}class wo{constructor({businessId:e="",businessName:t="",shopIcon:s=new Fe}={}){h(this,"businessId","");h(this,"shopIcon",new Fe);h(this,"businessName","");this.businessId=e,this.shopIcon=s,this.businessName=t}static empty(){return new wo}static fromJsonStr(e){const t=JSON.parse(e),s=wo.empty();return s.businessId=t.businessId,s.businessName=t.businessName,t.shopIcon&&(s.shopIcon=Fe.fromJsonStr(t.shopIcon)),s}toJsonStr(){const e={businessId:this.businessId,shopIcon:this.shopIcon.toJsonStr(),businessName:this.businessName};return JSON.stringify(e)}}const RF={noPayNoPayment:0,noPayNoPaymentWithReceipts:1,pay100For30WithReceipts:2,pay70For700Actiions:3},WV=60,NF=15,MF=20;var A_={};const b_="@firebase/database",C_="1.0.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let CI="";function OF(n){CI=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FF{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),mt(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:Ha(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BF{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return ls(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kI=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new FF(e)}}catch{}return new BF},Yr=kI("localStorage"),T0=kI("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ki=new Ul("@firebase/database"),LF=function(){let n=1;return function(){return n++}}(),SI=function(n){const e=SA(n),t=new AA;t.update(e);const s=t.digest();return J0.encodeByteArray(s)},Qc=function(...n){let e="";for(let t=0;t<n.length;t++){const s=n[t];Array.isArray(s)||s&&typeof s=="object"&&typeof s.length=="number"?e+=Qc.apply(null,s):typeof s=="object"?e+=mt(s):e+=s,e+=" "}return e};let Kr=null,k_=!0;const VF=function(n,e){L(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(Ki.logLevel=pe.VERBOSE,Kr=Ki.log.bind(Ki),e&&T0.set("logging_enabled",!0)):typeof n=="function"?Kr=n:(Kr=null,T0.remove("logging_enabled"))},Pt=function(...n){if(k_===!0&&(k_=!1,Kr===null&&T0.get("logging_enabled")===!0&&VF(!0)),Kr){const e=Qc.apply(null,n);Kr(e)}},Kc=function(n){return function(...e){Pt(n,...e)}},I0=function(...n){const e="FIREBASE INTERNAL ERROR: "+Qc(...n);Ki.error(e)},Hs=function(...n){const e=`FIREBASE FATAL ERROR: ${Qc(...n)}`;throw Ki.error(e),new Error(e)},tn=function(...n){const e="FIREBASE WARNING: "+Qc(...n);Ki.warn(e)},UF=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&tn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Ap=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},WF=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},xo="[MIN_NAME]",ci="[MAX_NAME]",vi=function(n,e){if(n===e)return 0;if(n===xo||e===ci)return-1;if(e===xo||n===ci)return 1;{const t=S_(n),s=S_(e);return t!==null?s!==null?t-s===0?n.length-e.length:t-s:-1:s!==null?1:n<e?-1:1}},HF=function(n,e){return n===e?0:n<e?-1:1},la=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+mt(e))},bp=function(n){if(typeof n!="object"||n===null)return mt(n);const e=[];for(const s in n)e.push(s);e.sort();let t="{";for(let s=0;s<e.length;s++)s!==0&&(t+=","),t+=mt(e[s]),t+=":",t+=bp(n[e[s]]);return t+="}",t},PI=function(n,e){const t=n.length;if(t<=e)return[n];const s=[];for(let r=0;r<t;r+=e)r+e>t?s.push(n.substring(r,t)):s.push(n.substring(r,r+e));return s};function Bt(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const RI=function(n){L(!Ap(n),"Invalid JSON number");const e=11,t=52,s=(1<<e-1)-1;let r,i,o,a,c;n===0?(i=0,o=0,r=1/n===-1/0?1:0):(r=n<0,n=Math.abs(n),n>=Math.pow(2,1-s)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),s),i=a+s,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(i=0,o=Math.round(n/Math.pow(2,1-s-t))));const u=[];for(c=t;c;c-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)u.push(i%2?1:0),i=Math.floor(i/2);u.push(r?1:0),u.reverse();const l=u.join("");let d="";for(c=0;c<64;c+=8){let f=parseInt(l.substr(c,8),2).toString(16);f.length===1&&(f="0"+f),d=d+f}return d.toLowerCase()},$F=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},qF=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function YF(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const s=new Error(n+" at "+e._path.toString()+": "+t);return s.code=n.toUpperCase(),s}const zF=new RegExp("^-?(0*)\\d{1,10}$"),GF=-2147483648,JF=2147483647,S_=function(n){if(zF.test(n)){const e=Number(n);if(e>=GF&&e<=JF)return e}return null},zo=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw tn("Exception was thrown by user callback.",t),e},Math.floor(0))}},QF=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Sa=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KF{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(s=>this.appCheck=s)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,s)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,s):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(s=>s.addTokenListener(e))}notifyForInvalidToken(){tn(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jF{constructor(e,t,s){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Pt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,s)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,s):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',tn(e)}}class ji{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}ji.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cp="5",NI="v",MI="s",OI="r",FI="f",BI=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,LI="ls",VI="p",D0="ac",UI="websocket",WI="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HI{constructor(e,t,s,r,i=!1,o="",a=!1,c=!1){this.secure=t,this.namespace=s,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Yr.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Yr.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function XF(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function $I(n,e,t){L(typeof e=="string","typeof type must == string"),L(typeof t=="object","typeof params must == object");let s;if(e===UI)s=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===WI)s=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);XF(n)&&(t.ns=n.namespace);const r=[];return Bt(t,(i,o)=>{r.push(i+"="+o)}),s+r.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZF{constructor(){this.counters_={}}incrementCounter(e,t=1){ls(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return hA(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kd={},Sd={};function kp(n){const e=n.toString();return kd[e]||(kd[e]=new ZF),kd[e]}function eB(n,e){const t=n.toString();return Sd[t]||(Sd[t]=e()),Sd[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tB{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const s=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<s.length;++r)s[r]&&zo(()=>{this.onMessage_(s[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P_="start",nB="close",sB="pLPCommand",rB="pRTLPCB",qI="id",YI="pw",zI="ser",iB="cb",oB="seg",aB="ts",cB="d",uB="dframe",GI=1870,JI=30,lB=GI-JI,hB=25e3,dB=3e4;class Wi{constructor(e,t,s,r,i,o,a){this.connId=e,this.repoInfo=t,this.applicationId=s,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Kc(e),this.stats_=kp(t),this.urlFn=c=>(this.appCheckToken&&(c[D0]=this.appCheckToken),$I(t,WI,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new tB(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(dB)),WF(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Sp((...i)=>{const[o,a,c,u,l]=i;if(this.incrementIncomingBytes_(i),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===P_)this.id=a,this.password=c;else if(o===nB)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...i)=>{const[o,a]=i;this.incrementIncomingBytes_(i),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const s={};s[P_]="t",s[zI]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(s[iB]=this.scriptTagHolder.uniqueCallbackIdentifier),s[NI]=Cp,this.transportSessionId&&(s[MI]=this.transportSessionId),this.lastSessionId&&(s[LI]=this.lastSessionId),this.applicationId&&(s[VI]=this.applicationId),this.appCheckToken&&(s[D0]=this.appCheckToken),typeof location<"u"&&location.hostname&&BI.test(location.hostname)&&(s[OI]=FI);const r=this.urlFn(s);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Wi.forceAllow_=!0}static forceDisallow(){Wi.forceDisallow_=!0}static isAvailable(){return Wi.forceAllow_?!0:!Wi.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!$F()&&!qF()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=mt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const s=xw(t),r=PI(s,lB);for(let i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const s={};s[uB]="t",s[qI]=e,s[YI]=t,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=mt(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class Sp{constructor(e,t,s,r){this.onDisconnect=s,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=LF(),window[sB+this.uniqueCallbackIdentifier]=e,window[rB+this.uniqueCallbackIdentifier]=t,this.myIFrame=Sp.createIFrame_();let i="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(i='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Pt("frame writing exception"),a.stack&&Pt(a.stack),Pt(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Pt("No IE domain setting required")}catch{const s=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[qI]=this.myID,e[YI]=this.myPW,e[zI]=this.currentSerial;let t=this.urlFn(e),s="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+JI+s.length<=GI;){const o=this.pendingSegs.shift();s=s+"&"+oB+r+"="+o.seg+"&"+aB+r+"="+o.ts+"&"+cB+r+"="+o.d,r++}return t=t+s,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,s){this.pendingSegs.push({seg:e,ts:t,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const s=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(s,Math.floor(hB)),i=()=>{clearTimeout(r),s()};this.addTag(e,i)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){const r=s.readyState;(!r||r==="loaded"||r==="complete")&&(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),t())},s.onerror=()=>{Pt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fB=16384,mB=45e3;let hl=null;typeof MozWebSocket<"u"?hl=MozWebSocket:typeof WebSocket<"u"&&(hl=WebSocket);class On{constructor(e,t,s,r,i,o,a){this.connId=e,this.applicationId=s,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Kc(this.connId),this.stats_=kp(t),this.connURL=On.connectionURL_(t,o,a,r,s),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,s,r,i){const o={};return o[NI]=Cp,typeof location<"u"&&location.hostname&&BI.test(location.hostname)&&(o[OI]=FI),t&&(o[MI]=t),s&&(o[LI]=s),r&&(o[D0]=r),i&&(o[VI]=i),$I(e,UI,o)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Yr.set("previous_websocket_failure",!0);try{let s;kw(),this.mySock=new hl(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");const r=s.message||s.data;r&&this.log_(r),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");const r=s.message||s.data;r&&this.log_(r),this.onClosed_()}}start(){}static forceDisallow(){On.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(t);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&hl!==null&&!On.forceDisallow_}static previouslyFailed(){return Yr.isInMemoryStorage||Yr.get("previous_websocket_failure")===!0}markConnectionHealthy(){Yr.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const s=Ha(t);this.onMessage(s)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(L(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const s=this.extractFrameCount_(t);s!==null&&this.appendFrame_(s)}}send(e){this.resetKeepAlive();const t=mt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const s=PI(t,fB);s.length>1&&this.sendString_(String(s.length));for(let r=0;r<s.length;r++)this.sendString_(s[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(mB))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}On.responsesRequiredToBeHealthy=2;On.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lc{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Wi,On]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=On&&On.isAvailable();let s=t&&!On.previouslyFailed();if(e.webSocketOnly&&(t||tn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[On];else{const r=this.transports_=[];for(const i of lc.ALL_TRANSPORTS)i&&i.isAvailable()&&r.push(i);lc.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}lc.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pB=6e4,gB=5e3,yB=10*1024,_B=100*1024,Pd="t",R_="d",vB="s",N_="r",wB="e",M_="o",O_="a",F_="n",B_="p",xB="h";class EB{constructor(e,t,s,r,i,o,a,c,u,l){this.id=e,this.repoInfo_=t,this.applicationId_=s,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=u,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Kc("c:"+this.id+":"),this.transportManager_=new lc(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,s)},Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=Sa(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>_B?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>yB?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Pd in e){const t=e[Pd];t===O_?this.upgradeIfSecondaryHealthy_():t===N_?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===M_&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=la("t",e),s=la("d",e);if(t==="c")this.onSecondaryControl_(s);else if(t==="d")this.pendingDataMessages.push(s);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:B_,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:O_,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:F_,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=la("t",e),s=la("d",e);t==="c"?this.onControl_(s):t==="d"&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=la(Pd,e);if(R_ in e){const s=e[R_];if(t===xB){const r=Object.assign({},s);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if(t===F_){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===vB?this.onConnectionShutdown_(s):t===N_?this.onReset_(s):t===wB?I0("Server Error: "+s):t===M_?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):I0("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,s=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Cp!==s&&tn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,s),Sa(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(pB))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Sa(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(gB))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:B_,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Yr.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QI{put(e,t,s,r){}merge(e,t,s,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,s){}onDisconnectMerge(e,t,s){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KI{constructor(e){this.allowedEvents_=e,this.listeners_={},L(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(let r=0;r<s.length;r++)s[r].callback.apply(s[r].context,t)}}on(e,t,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:s});const r=this.getInitialEvent(e);r&&t.apply(s,r)}off(e,t,s){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let i=0;i<r.length;i++)if(r[i].callback===t&&(!s||s===r[i].context)){r.splice(i,1);return}}validateEventType_(e){L(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl extends KI{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!K0()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new dl}getInitialEvent(e){return L(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L_=32,V_=768;class Me{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let s=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[s]=this.pieces_[r],s++);this.pieces_.length=s,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function Ie(){return new Me("")}function de(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Er(n){return n.pieces_.length-n.pieceNum_}function We(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Me(n.pieces_,e)}function Pp(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function TB(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function hc(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function jI(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Me(e,0)}function tt(n,e){const t=[];for(let s=n.pieceNum_;s<n.pieces_.length;s++)t.push(n.pieces_[s]);if(e instanceof Me)for(let s=e.pieceNum_;s<e.pieces_.length;s++)t.push(e.pieces_[s]);else{const s=e.split("/");for(let r=0;r<s.length;r++)s[r].length>0&&t.push(s[r])}return new Me(t,0)}function me(n){return n.pieceNum_>=n.pieces_.length}function en(n,e){const t=de(n),s=de(e);if(t===null)return e;if(t===s)return en(We(n),We(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function IB(n,e){const t=hc(n,0),s=hc(e,0);for(let r=0;r<t.length&&r<s.length;r++){const i=vi(t[r],s[r]);if(i!==0)return i}return t.length===s.length?0:t.length<s.length?-1:1}function Rp(n,e){if(Er(n)!==Er(e))return!1;for(let t=n.pieceNum_,s=e.pieceNum_;t<=n.pieces_.length;t++,s++)if(n.pieces_[t]!==e.pieces_[s])return!1;return!0}function Cn(n,e){let t=n.pieceNum_,s=e.pieceNum_;if(Er(n)>Er(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[s])return!1;++t,++s}return!0}class DB{constructor(e,t){this.errorPrefix_=t,this.parts_=hc(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let s=0;s<this.parts_.length;s++)this.byteLength_+=Vl(this.parts_[s]);XI(this)}}function AB(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Vl(e),XI(n)}function bB(n){const e=n.parts_.pop();n.byteLength_-=Vl(e),n.parts_.length>0&&(n.byteLength_-=1)}function XI(n){if(n.byteLength_>V_)throw new Error(n.errorPrefix_+"has a key path longer than "+V_+" bytes ("+n.byteLength_+").");if(n.parts_.length>L_)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+L_+") or object contains a cycle "+Fr(n))}function Fr(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Np extends KI{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const s=!document[e];s!==this.visible_&&(this.visible_=s,this.trigger("visible",s))},!1)}static getInstance(){return new Np}getInitialEvent(e){return L(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ha=1e3,CB=60*5*1e3,U_=30*1e3,kB=1.3,SB=3e4,PB="server_kill",W_=3;class Os extends QI{constructor(e,t,s,r,i,o,a,c){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=s,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=c,this.id=Os.nextPersistentConnectionId_++,this.log_=Kc("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=ha,this.maxReconnectDelay_=CB,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!kw())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Np.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&dl.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,s){const r=++this.requestNumber_,i={r,a:e,b:t};this.log_(mt(i)),L(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),s&&(this.requestCBHash_[r]=s)}get(e){this.initConnection_();const t=new Ic,r={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?t.resolve(a):t.reject(a)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),t.promise}listen(e,t,s,r){this.initConnection_();const i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),L(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),L(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const a={onComplete:r,hashFn:t,query:e,tag:s};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(s)})}sendListen_(e){const t=e.query,s=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+s+" for "+r);const i={p:s},o="q";e.tag&&(i.q=t._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest(o,i,a=>{const c=a.d,u=a.s;Os.warnOnListenWarnings_(c,t),(this.listens.get(s)&&this.listens.get(s).get(r))===e&&(this.log_("listen response",a),u!=="ok"&&this.removeListen_(s,r),e.onComplete&&e.onComplete(u,c))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&ls(e,"w")){const s=oo(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const r='".indexOn": "'+t._queryParams.getIndex().toString()+'"',i=t._path.toString();tn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${r} at ${i} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||DA(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=U_)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=IA(e)?"auth":"gauth",s={cred:e};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(t,s,r=>{const i=r.s,o=r.d||"error";this.authToken_===e&&(i==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(i,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,s=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,s)})}unlisten(e,t){const s=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+r),L(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,r)&&this.connected_&&this.sendUnlisten_(s,r,e._queryObject,t)}sendUnlisten_(e,t,s,r){this.log_("Unlisten on "+e+" for "+t);const i={p:e},o="n";r&&(i.q=s,i.t=r),this.sendRequest(o,i)}onDisconnectPut(e,t,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:s})}onDisconnectMerge(e,t,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:s})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,s,r){const i={p:t,d:s};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,o=>{r&&setTimeout(()=>{r(o.s,o.d)},Math.floor(0))})}put(e,t,s,r){this.putInternal("p",e,t,s,r)}merge(e,t,s,r){this.putInternal("m",e,t,s,r)}putInternal(e,t,s,r,i){this.initConnection_();const o={p:t,d:s};i!==void 0&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,s,i=>{this.log_(t+" response",i),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),r&&r(i.s,i.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,s=>{if(s.s!=="ok"){const i=s.d;this.log_("reportStats","Error sending stats: "+i)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+mt(e));const t=e.r,s=this.requestCBHash_[t];s&&(delete this.requestCBHash_[t],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):I0("Unrecognized action received from server: "+mt(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){L(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ha,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=ha,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>SB&&(this.reconnectDelay_=ha),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*kB)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+Os.nextConnectionId_++,i=this.lastSessionId;let o=!1,a=null;const c=function(){a?a.close():(o=!0,s())},u=function(d){L(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(d)};this.realtime_={close:c,sendRequest:u};const l=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[d,f]=await Promise.all([this.authTokenProvider_.getToken(l),this.appCheckTokenProvider_.getToken(l)]);o?Pt("getToken() completed but was canceled"):(Pt("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=f&&f.token,a=new EB(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,s,m=>{tn(m+" ("+this.repoInfo_.toString()+")"),this.interrupt(PB)},i))}catch(d){this.log_("Failed to get token: "+d),o||(this.repoInfo_.nodeAdmin&&tn(d),c())}}}interrupt(e){Pt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Pt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Nf(this.interruptReasons_)&&(this.reconnectDelay_=ha,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let s;t?s=t.map(i=>bp(i)).join("$"):s="default";const r=this.removeListen_(e,s);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const s=new Me(e).toString();let r;if(this.listens.has(s)){const i=this.listens.get(s);r=i.get(t),i.delete(t),i.size===0&&this.listens.delete(s)}else r=void 0;return r}onAuthRevoked_(e,t){Pt("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=W_&&(this.reconnectDelay_=U_,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Pt("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=W_&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+CI.replace(/\./g,"-")]=1,K0()?e["framework.cordova"]=1:Cw()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=dl.getInstance().currentlyOnline();return Nf(this.interruptReasons_)&&e}}Os.nextPersistentConnectionId_=0;Os.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new fe(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const s=new fe(xo,e),r=new fe(xo,t);return this.compare(s,r)!==0}minPost(){return fe.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wu;class ZI extends Rh{static get __EMPTY_NODE(){return wu}static set __EMPTY_NODE(e){wu=e}compare(e,t){return vi(e.name,t.name)}isDefinedOn(e){throw Ro("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return fe.MIN}maxPost(){return new fe(ci,wu)}makePost(e,t){return L(typeof e=="string","KeyIndex indexValue must always be a string."),new fe(e,wu)}toString(){return".key"}}const Xi=new ZI;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xu{constructor(e,t,s,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?s(e.key,t):1,r&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class wt{constructor(e,t,s,r,i){this.key=e,this.value=t,this.color=s??wt.RED,this.left=r??ln.EMPTY_NODE,this.right=i??ln.EMPTY_NODE}copy(e,t,s,r,i){return new wt(e??this.key,t??this.value,s??this.color,r??this.left,i??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let r=this;const i=s(e,r.key);return i<0?r=r.copy(null,null,null,r.left.insert(e,t,s),null):i===0?r=r.copy(null,t,null,null,null):r=r.copy(null,null,null,null,r.right.insert(e,t,s)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return ln.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let s,r;if(s=this,t(e,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),t(e,s.key)===0){if(s.right.isEmpty())return ln.EMPTY_NODE;r=s.right.min_(),s=s.copy(r.key,r.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,wt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,wt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}wt.RED=!0;wt.BLACK=!1;class RB{copy(e,t,s,r,i){return this}insert(e,t,s){return new wt(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class ln{constructor(e,t=ln.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new ln(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,wt.BLACK,null,null))}remove(e){return new ln(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,wt.BLACK,null,null))}get(e){let t,s=this.root_;for(;!s.isEmpty();){if(t=this.comparator_(e,s.key),t===0)return s.value;t<0?s=s.left:t>0&&(s=s.right)}return null}getPredecessorKey(e){let t,s=this.root_,r=null;for(;!s.isEmpty();)if(t=this.comparator_(e,s.key),t===0){if(s.left.isEmpty())return r?r.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}else t<0?s=s.left:t>0&&(r=s,s=s.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new xu(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new xu(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new xu(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new xu(this.root_,null,this.comparator_,!0,e)}}ln.EMPTY_NODE=new RB;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NB(n,e){return vi(n.name,e.name)}function Mp(n,e){return vi(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let A0;function MB(n){A0=n}const e1=function(n){return typeof n=="number"?"number:"+RI(n):"string:"+n},t1=function(n){if(n.isLeafNode()){const e=n.val();L(typeof e=="string"||typeof e=="number"||typeof e=="object"&&ls(e,".sv"),"Priority must be a string or number.")}else L(n===A0||n.isEmpty(),"priority of unexpected type.");L(n===A0||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let H_;class _t{constructor(e,t=_t.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,L(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),t1(this.priorityNode_)}static set __childrenNodeConstructor(e){H_=e}static get __childrenNodeConstructor(){return H_}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new _t(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:_t.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return me(e)?this:de(e)===".priority"?this.priorityNode_:_t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:_t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const s=de(e);return s===null?t:t.isEmpty()&&s!==".priority"?this:(L(s!==".priority"||Er(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,_t.__childrenNodeConstructor.EMPTY_NODE.updateChild(We(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+e1(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=RI(this.value_):e+=this.value_,this.lazyHash_=SI(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===_t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof _t.__childrenNodeConstructor?-1:(L(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,s=typeof this.value_,r=_t.VALUE_TYPE_ORDER.indexOf(t),i=_t.VALUE_TYPE_ORDER.indexOf(s);return L(r>=0,"Unknown leaf type: "+t),L(i>=0,"Unknown leaf type: "+s),r===i?s==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}_t.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let n1,s1;function OB(n){n1=n}function FB(n){s1=n}class BB extends Rh{compare(e,t){const s=e.node.getPriority(),r=t.node.getPriority(),i=s.compareTo(r);return i===0?vi(e.name,t.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return fe.MIN}maxPost(){return new fe(ci,new _t("[PRIORITY-POST]",s1))}makePost(e,t){const s=n1(e);return new fe(t,new _t("[PRIORITY-POST]",s))}toString(){return".priority"}}const nt=new BB;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LB=Math.log(2);class VB{constructor(e){const t=i=>parseInt(Math.log(i)/LB,10),s=i=>parseInt(Array(i+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const r=s(this.count);this.bits_=e+1&r}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const fl=function(n,e,t,s){n.sort(e);const r=function(c,u){const l=u-c;let d,f;if(l===0)return null;if(l===1)return d=n[c],f=t?t(d):d,new wt(f,d.node,wt.BLACK,null,null);{const m=parseInt(l/2,10)+c,p=r(c,m),y=r(m+1,u);return d=n[m],f=t?t(d):d,new wt(f,d.node,wt.BLACK,p,y)}},i=function(c){let u=null,l=null,d=n.length;const f=function(p,y){const g=d-p,x=d;d-=p;const _=r(g+1,x),v=n[g],w=t?t(v):v;m(new wt(w,v.node,y,null,_))},m=function(p){u?(u.left=p,u=p):(l=p,u=p)};for(let p=0;p<c.count;++p){const y=c.nextBitIsOne(),g=Math.pow(2,c.count-(p+1));y?f(g,wt.BLACK):(f(g,wt.BLACK),f(g,wt.RED))}return l},o=new VB(n.length),a=i(o);return new ln(s||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rd;const Pi={};class bs{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return L(Pi&&nt,"ChildrenNode.ts has not been loaded"),Rd=Rd||new bs({".priority":Pi},{".priority":nt}),Rd}get(e){const t=oo(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof ln?t:null}hasIndex(e){return ls(this.indexSet_,e.toString())}addIndex(e,t){L(e!==Xi,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let r=!1;const i=t.getIterator(fe.Wrap);let o=i.getNext();for(;o;)r=r||e.isDefinedOn(o.node),s.push(o),o=i.getNext();let a;r?a=fl(s,e.getCompare()):a=Pi;const c=e.toString(),u=Object.assign({},this.indexSet_);u[c]=e;const l=Object.assign({},this.indexes_);return l[c]=a,new bs(l,u)}addToIndexes(e,t){const s=Lu(this.indexes_,(r,i)=>{const o=oo(this.indexSet_,i);if(L(o,"Missing index implementation for "+i),r===Pi)if(o.isDefinedOn(e.node)){const a=[],c=t.getIterator(fe.Wrap);let u=c.getNext();for(;u;)u.name!==e.name&&a.push(u),u=c.getNext();return a.push(e),fl(a,o.getCompare())}else return Pi;else{const a=t.get(e.name);let c=r;return a&&(c=c.remove(new fe(e.name,a))),c.insert(e,e.node)}});return new bs(s,this.indexSet_)}removeFromIndexes(e,t){const s=Lu(this.indexes_,r=>{if(r===Pi)return r;{const i=t.get(e.name);return i?r.remove(new fe(e.name,i)):r}});return new bs(s,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let da;class te{constructor(e,t,s){this.children_=e,this.priorityNode_=t,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&t1(this.priorityNode_),this.children_.isEmpty()&&L(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return da||(da=new te(new ln(Mp),null,bs.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||da}updatePriority(e){return this.children_.isEmpty()?this:new te(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?da:t}}getChild(e){const t=de(e);return t===null?this:this.getImmediateChild(t).getChild(We(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(L(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const s=new fe(e,t);let r,i;t.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(s,this.children_)):(r=this.children_.insert(e,t),i=this.indexMap_.addToIndexes(s,this.children_));const o=r.isEmpty()?da:this.priorityNode_;return new te(r,o,i)}}updateChild(e,t){const s=de(e);if(s===null)return t;{L(de(e)!==".priority"||Er(e)===1,".priority must be the last token in a path");const r=this.getImmediateChild(s).updateChild(We(e),t);return this.updateImmediateChild(s,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let s=0,r=0,i=!0;if(this.forEachChild(nt,(o,a)=>{t[o]=a.val(e),s++,i&&te.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):i=!1}),!e&&i&&r<2*s){const o=[];for(const a in t)o[a]=t[a];return o}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+e1(this.getPriority().val())+":"),this.forEachChild(nt,(t,s)=>{const r=s.hash();r!==""&&(e+=":"+t+":"+r)}),this.lazyHash_=e===""?"":SI(e)}return this.lazyHash_}getPredecessorChildName(e,t,s){const r=this.resolveIndex_(s);if(r){const i=r.getPredecessorKey(new fe(e,t));return i?i.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const s=t.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new fe(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const s=t.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new fe(t,this.children_.get(t)):null}forEachChild(e,t){const s=this.resolveIndex_(e);return s?s.inorderTraversal(r=>t(r.name,r.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const s=this.resolveIndex_(t);if(s)return s.getIteratorFrom(e,r=>r);{const r=this.children_.getIteratorFrom(e.name,fe.Wrap);let i=r.peek();for(;i!=null&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const s=this.resolveIndex_(t);if(s)return s.getReverseIteratorFrom(e,r=>r);{const r=this.children_.getReverseIteratorFrom(e.name,fe.Wrap);let i=r.peek();for(;i!=null&&t.compare(i,e)>0;)r.getNext(),i=r.peek();return r}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===jc?-1:0}withIndex(e){if(e===Xi||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new te(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Xi||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const s=this.getIterator(nt),r=t.getIterator(nt);let i=s.getNext(),o=r.getNext();for(;i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=s.getNext(),o=r.getNext()}return i===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===Xi?null:this.indexMap_.get(e.toString())}}te.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class UB extends te{constructor(){super(new ln(Mp),te.EMPTY_NODE,bs.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return te.EMPTY_NODE}isEmpty(){return!1}}const jc=new UB;Object.defineProperties(fe,{MIN:{value:new fe(xo,te.EMPTY_NODE)},MAX:{value:new fe(ci,jc)}});ZI.__EMPTY_NODE=te.EMPTY_NODE;_t.__childrenNodeConstructor=te;MB(jc);FB(jc);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WB=!0;function ft(n,e=null){if(n===null)return te.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),L(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new _t(t,ft(e))}if(!(n instanceof Array)&&WB){const t=[];let s=!1;if(Bt(n,(o,a)=>{if(o.substring(0,1)!=="."){const c=ft(a);c.isEmpty()||(s=s||!c.getPriority().isEmpty(),t.push(new fe(o,c)))}}),t.length===0)return te.EMPTY_NODE;const i=fl(t,NB,o=>o.name,Mp);if(s){const o=fl(t,nt.getCompare());return new te(i,ft(e),new bs({".priority":o},{".priority":nt}))}else return new te(i,ft(e),bs.Default)}else{let t=te.EMPTY_NODE;return Bt(n,(s,r)=>{if(ls(n,s)&&s.substring(0,1)!=="."){const i=ft(r);(i.isLeafNode()||!i.isEmpty())&&(t=t.updateImmediateChild(s,i))}}),t.updatePriority(ft(e))}}OB(ft);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HB extends Rh{constructor(e){super(),this.indexPath_=e,L(!me(e)&&de(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const s=this.extractChild(e.node),r=this.extractChild(t.node),i=s.compareTo(r);return i===0?vi(e.name,t.name):i}makePost(e,t){const s=ft(e),r=te.EMPTY_NODE.updateChild(this.indexPath_,s);return new fe(t,r)}maxPost(){const e=te.EMPTY_NODE.updateChild(this.indexPath_,jc);return new fe(ci,e)}toString(){return hc(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $B extends Rh{compare(e,t){const s=e.node.compareTo(t.node);return s===0?vi(e.name,t.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return fe.MIN}maxPost(){return fe.MAX}makePost(e,t){const s=ft(e);return new fe(t,s)}toString(){return".value"}}const qB=new $B;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r1(n){return{type:"value",snapshotNode:n}}function Eo(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function dc(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function fc(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function YB(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Op{constructor(e){this.index_=e}updateChild(e,t,s,r,i,o){L(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(t);return a.getChild(r).equals(s.getChild(r))&&a.isEmpty()===s.isEmpty()||(o!=null&&(s.isEmpty()?e.hasChild(t)?o.trackChildChange(dc(t,a)):L(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Eo(t,s)):o.trackChildChange(fc(t,s,a))),e.isLeafNode()&&s.isEmpty())?e:e.updateImmediateChild(t,s).withIndex(this.index_)}updateFullNode(e,t,s){return s!=null&&(e.isLeafNode()||e.forEachChild(nt,(r,i)=>{t.hasChild(r)||s.trackChildChange(dc(r,i))}),t.isLeafNode()||t.forEachChild(nt,(r,i)=>{if(e.hasChild(r)){const o=e.getImmediateChild(r);o.equals(i)||s.trackChildChange(fc(r,i,o))}else s.trackChildChange(Eo(r,i))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?te.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mc{constructor(e){this.indexedFilter_=new Op(e.getIndex()),this.index_=e.getIndex(),this.startPost_=mc.getStartPost_(e),this.endPost_=mc.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,s=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&s}updateChild(e,t,s,r,i,o){return this.matches(new fe(t,s))||(s=te.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,s,r,i,o)}updateFullNode(e,t,s){t.isLeafNode()&&(t=te.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(te.EMPTY_NODE);const i=this;return t.forEachChild(nt,(o,a)=>{i.matches(new fe(o,a))||(r=r.updateImmediateChild(o,te.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,s)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zB{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const s=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?s<=0:s<0},this.withinEndPost=t=>{const s=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?s<=0:s<0},this.rangedFilter_=new mc(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,s,r,i,o){return this.rangedFilter_.matches(new fe(t,s))||(s=te.EMPTY_NODE),e.getImmediateChild(t).equals(s)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,s,r,i,o):this.fullLimitUpdateChild_(e,t,s,i,o)}updateFullNode(e,t,s){let r;if(t.isLeafNode()||t.isEmpty())r=te.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){r=te.EMPTY_NODE.withIndex(this.index_);let i;this.reverse_?i=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):i=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;i.hasNext()&&o<this.limit_;){const a=i.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))r=r.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{r=t.withIndex(this.index_),r=r.updatePriority(te.EMPTY_NODE);let i;this.reverse_?i=r.getReverseIterator(this.index_):i=r.getIterator(this.index_);let o=0;for(;i.hasNext();){const a=i.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:r=r.updateImmediateChild(a.name,te.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,s)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,s,r,i){let o;if(this.reverse_){const d=this.index_.getCompare();o=(f,m)=>d(m,f)}else o=this.index_.getCompare();const a=e;L(a.numChildren()===this.limit_,"");const c=new fe(t,s),u=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),l=this.rangedFilter_.matches(c);if(a.hasChild(t)){const d=a.getImmediateChild(t);let f=r.getChildAfterChild(this.index_,u,this.reverse_);for(;f!=null&&(f.name===t||a.hasChild(f.name));)f=r.getChildAfterChild(this.index_,f,this.reverse_);const m=f==null?1:o(f,c);if(l&&!s.isEmpty()&&m>=0)return i!=null&&i.trackChildChange(fc(t,s,d)),a.updateImmediateChild(t,s);{i!=null&&i.trackChildChange(dc(t,d));const y=a.updateImmediateChild(t,te.EMPTY_NODE);return f!=null&&this.rangedFilter_.matches(f)?(i!=null&&i.trackChildChange(Eo(f.name,f.node)),y.updateImmediateChild(f.name,f.node)):y}}else return s.isEmpty()?e:l&&o(u,c)>=0?(i!=null&&(i.trackChildChange(dc(u.name,u.node)),i.trackChildChange(Eo(t,s))),a.updateImmediateChild(t,s).updateImmediateChild(u.name,te.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fp{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=nt}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return L(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return L(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:xo}hasEnd(){return this.endSet_}getIndexEndValue(){return L(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return L(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:ci}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return L(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===nt}copy(){const e=new Fp;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function GB(n){return n.loadsAllData()?new Op(n.getIndex()):n.hasLimit()?new zB(n):new mc(n)}function $_(n){const e={};if(n.isDefault())return e;let t;if(n.index_===nt?t="$priority":n.index_===qB?t="$value":n.index_===Xi?t="$key":(L(n.index_ instanceof HB,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=mt(t),n.startSet_){const s=n.startAfterSet_?"startAfter":"startAt";e[s]=mt(n.indexStartValue_),n.startNameSet_&&(e[s]+=","+mt(n.indexStartName_))}if(n.endSet_){const s=n.endBeforeSet_?"endBefore":"endAt";e[s]=mt(n.indexEndValue_),n.endNameSet_&&(e[s]+=","+mt(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function q_(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==nt&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml extends QI{constructor(e,t,s,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=s,this.appCheckTokenProvider_=r,this.log_=Kc("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(L(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,s,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const o=ml.getListenId_(e,s),a={};this.listens_[o]=a;const c=$_(e._queryParams);this.restRequest_(i+".json",c,(u,l)=>{let d=l;if(u===404&&(d=null,u=null),u===null&&this.onDataUpdate_(i,d,!1,s),oo(this.listens_,o)===a){let f;u?u===401?f="permission_denied":f="rest_error:"+u:f="ok",r(f,null)}})}unlisten(e,t){const s=ml.getListenId_(e,t);delete this.listens_[s]}get(e){const t=$_(e._queryParams),s=e._path.toString(),r=new Ic;return this.restRequest_(s+".json",t,(i,o)=>{let a=o;i===404&&(a=null,i=null),i===null?(this.onDataUpdate_(s,a,!1,null),r.resolve(a)):r.reject(new Error(a))}),r.promise}refreshAuthToken(e){}restRequest_(e,t={},s){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,i])=>{r&&r.accessToken&&(t.auth=r.accessToken),i&&i.token&&(t.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+fi(t);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(s&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=Ha(a.responseText)}catch{tn("Failed to parse JSON response for "+o+": "+a.responseText)}s(null,c)}else a.status!==401&&a.status!==404&&tn("Got unsuccessful REST response for "+o+" Status: "+a.status),s(a.status);s=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JB{constructor(){this.rootNode_=te.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pl(){return{value:null,children:new Map}}function i1(n,e,t){if(me(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const s=de(e);n.children.has(s)||n.children.set(s,pl());const r=n.children.get(s);e=We(e),i1(r,e,t)}}function b0(n,e,t){n.value!==null?t(e,n.value):QB(n,(s,r)=>{const i=new Me(e.toString()+"/"+s);b0(r,i,t)})}function QB(n,e){n.children.forEach((t,s)=>{e(s,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KB{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Bt(this.last_,(s,r)=>{t[s]=t[s]-r}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y_=10*1e3,jB=30*1e3,XB=5*60*1e3;class ZB{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new KB(e);const s=Y_+(jB-Y_)*Math.random();Sa(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const e=this.statsListener_.get(),t={};let s=!1;Bt(e,(r,i)=>{i>0&&ls(this.statsToReport_,r)&&(t[r]=i,s=!0)}),s&&this.server_.reportStats(t),Sa(this.reportStats_.bind(this),Math.floor(Math.random()*2*XB))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ln;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Ln||(Ln={}));function Bp(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Lp(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Vp(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl{constructor(e,t,s){this.path=e,this.affectedTree=t,this.revert=s,this.type=Ln.ACK_USER_WRITE,this.source=Bp()}operationForChild(e){if(me(this.path)){if(this.affectedTree.value!=null)return L(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Me(e));return new gl(Ie(),t,this.revert)}}else return L(de(this.path)===e,"operationForChild called for unrelated child."),new gl(We(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc{constructor(e,t){this.source=e,this.path=t,this.type=Ln.LISTEN_COMPLETE}operationForChild(e){return me(this.path)?new pc(this.source,Ie()):new pc(this.source,We(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e,t,s){this.source=e,this.path=t,this.snap=s,this.type=Ln.OVERWRITE}operationForChild(e){return me(this.path)?new ui(this.source,Ie(),this.snap.getImmediateChild(e)):new ui(this.source,We(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{constructor(e,t,s){this.source=e,this.path=t,this.children=s,this.type=Ln.MERGE}operationForChild(e){if(me(this.path)){const t=this.children.subtree(new Me(e));return t.isEmpty()?null:t.value?new ui(this.source,Ie(),t.value):new To(this.source,Ie(),t)}else return L(de(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new To(this.source,We(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(e,t,s){this.node_=e,this.fullyInitialized_=t,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(me(e))return this.isFullyInitialized()&&!this.filtered_;const t=de(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e6{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function t6(n,e,t,s){const r=[],i=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&i.push(YB(o.childName,o.snapshotNode))}),fa(n,r,"child_removed",e,s,t),fa(n,r,"child_added",e,s,t),fa(n,r,"child_moved",i,s,t),fa(n,r,"child_changed",e,s,t),fa(n,r,"value",e,s,t),r}function fa(n,e,t,s,r,i){const o=s.filter(a=>a.type===t);o.sort((a,c)=>s6(n,a,c)),o.forEach(a=>{const c=n6(n,a,i);r.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(c,n.query_))})})}function n6(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function s6(n,e,t){if(e.childName==null||t.childName==null)throw Ro("Should only compare child_ events.");const s=new fe(e.childName,e.snapshotNode),r=new fe(t.childName,t.snapshotNode);return n.index_.compare(s,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nh(n,e){return{eventCache:n,serverCache:e}}function Pa(n,e,t,s){return Nh(new Tr(e,t,s),n.serverCache)}function o1(n,e,t,s){return Nh(n.eventCache,new Tr(e,t,s))}function yl(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function li(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nd;const r6=()=>(Nd||(Nd=new ln(HF)),Nd);class Ue{constructor(e,t=r6()){this.value=e,this.children=t}static fromObject(e){let t=new Ue(null);return Bt(e,(s,r)=>{t=t.set(new Me(s),r)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Ie(),value:this.value};if(me(e))return null;{const s=de(e),r=this.children.get(s);if(r!==null){const i=r.findRootMostMatchingPathAndValue(We(e),t);return i!=null?{path:tt(new Me(s),i.path),value:i.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(me(e))return this;{const t=de(e),s=this.children.get(t);return s!==null?s.subtree(We(e)):new Ue(null)}}set(e,t){if(me(e))return new Ue(t,this.children);{const s=de(e),i=(this.children.get(s)||new Ue(null)).set(We(e),t),o=this.children.insert(s,i);return new Ue(this.value,o)}}remove(e){if(me(e))return this.children.isEmpty()?new Ue(null):new Ue(null,this.children);{const t=de(e),s=this.children.get(t);if(s){const r=s.remove(We(e));let i;return r.isEmpty()?i=this.children.remove(t):i=this.children.insert(t,r),this.value===null&&i.isEmpty()?new Ue(null):new Ue(this.value,i)}else return this}}get(e){if(me(e))return this.value;{const t=de(e),s=this.children.get(t);return s?s.get(We(e)):null}}setTree(e,t){if(me(e))return t;{const s=de(e),i=(this.children.get(s)||new Ue(null)).setTree(We(e),t);let o;return i.isEmpty()?o=this.children.remove(s):o=this.children.insert(s,i),new Ue(this.value,o)}}fold(e){return this.fold_(Ie(),e)}fold_(e,t){const s={};return this.children.inorderTraversal((r,i)=>{s[r]=i.fold_(tt(e,r),t)}),t(e,this.value,s)}findOnPath(e,t){return this.findOnPath_(e,Ie(),t)}findOnPath_(e,t,s){const r=this.value?s(t,this.value):!1;if(r)return r;if(me(e))return null;{const i=de(e),o=this.children.get(i);return o?o.findOnPath_(We(e),tt(t,i),s):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Ie(),t)}foreachOnPath_(e,t,s){if(me(e))return this;{this.value&&s(t,this.value);const r=de(e),i=this.children.get(r);return i?i.foreachOnPath_(We(e),tt(t,r),s):new Ue(null)}}foreach(e){this.foreach_(Ie(),e)}foreach_(e,t){this.children.inorderTraversal((s,r)=>{r.foreach_(tt(e,s),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,s)=>{s.value&&e(t,s.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e){this.writeTree_=e}static empty(){return new Un(new Ue(null))}}function Ra(n,e,t){if(me(e))return new Un(new Ue(t));{const s=n.writeTree_.findRootMostValueAndPath(e);if(s!=null){const r=s.path;let i=s.value;const o=en(r,e);return i=i.updateChild(o,t),new Un(n.writeTree_.set(r,i))}else{const r=new Ue(t),i=n.writeTree_.setTree(e,r);return new Un(i)}}}function C0(n,e,t){let s=n;return Bt(t,(r,i)=>{s=Ra(s,tt(e,r),i)}),s}function z_(n,e){if(me(e))return Un.empty();{const t=n.writeTree_.setTree(e,new Ue(null));return new Un(t)}}function k0(n,e){return wi(n,e)!=null}function wi(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(en(t.path,e)):null}function G_(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(nt,(s,r)=>{e.push(new fe(s,r))}):n.writeTree_.children.inorderTraversal((s,r)=>{r.value!=null&&e.push(new fe(s,r.value))}),e}function mr(n,e){if(me(e))return n;{const t=wi(n,e);return t!=null?new Un(new Ue(t)):new Un(n.writeTree_.subtree(e))}}function S0(n){return n.writeTree_.isEmpty()}function Io(n,e){return a1(Ie(),n.writeTree_,e)}function a1(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let s=null;return e.children.inorderTraversal((r,i)=>{r===".priority"?(L(i.value!==null,"Priority writes must always be leaf nodes"),s=i.value):t=a1(tt(n,r),i,t)}),!t.getChild(n).isEmpty()&&s!==null&&(t=t.updateChild(tt(n,".priority"),s)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mh(n,e){return h1(e,n)}function i6(n,e,t,s,r){L(s>n.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),n.allWrites.push({path:e,snap:t,writeId:s,visible:r}),r&&(n.visibleWrites=Ra(n.visibleWrites,e,t)),n.lastWriteId=s}function o6(n,e,t,s){L(s>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:s,visible:!0}),n.visibleWrites=C0(n.visibleWrites,e,t),n.lastWriteId=s}function a6(n,e){for(let t=0;t<n.allWrites.length;t++){const s=n.allWrites[t];if(s.writeId===e)return s}return null}function c6(n,e){const t=n.allWrites.findIndex(a=>a.writeId===e);L(t>=0,"removeWrite called with nonexistent writeId.");const s=n.allWrites[t];n.allWrites.splice(t,1);let r=s.visible,i=!1,o=n.allWrites.length-1;for(;r&&o>=0;){const a=n.allWrites[o];a.visible&&(o>=t&&u6(a,s.path)?r=!1:Cn(s.path,a.path)&&(i=!0)),o--}if(r){if(i)return l6(n),!0;if(s.snap)n.visibleWrites=z_(n.visibleWrites,s.path);else{const a=s.children;Bt(a,c=>{n.visibleWrites=z_(n.visibleWrites,tt(s.path,c))})}return!0}else return!1}function u6(n,e){if(n.snap)return Cn(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&Cn(tt(n.path,t),e))return!0;return!1}function l6(n){n.visibleWrites=c1(n.allWrites,h6,Ie()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function h6(n){return n.visible}function c1(n,e,t){let s=Un.empty();for(let r=0;r<n.length;++r){const i=n[r];if(e(i)){const o=i.path;let a;if(i.snap)Cn(t,o)?(a=en(t,o),s=Ra(s,a,i.snap)):Cn(o,t)&&(a=en(o,t),s=Ra(s,Ie(),i.snap.getChild(a)));else if(i.children){if(Cn(t,o))a=en(t,o),s=C0(s,a,i.children);else if(Cn(o,t))if(a=en(o,t),me(a))s=C0(s,Ie(),i.children);else{const c=oo(i.children,de(a));if(c){const u=c.getChild(We(a));s=Ra(s,Ie(),u)}}}else throw Ro("WriteRecord should have .snap or .children")}}return s}function u1(n,e,t,s,r){if(!s&&!r){const i=wi(n.visibleWrites,e);if(i!=null)return i;{const o=mr(n.visibleWrites,e);if(S0(o))return t;if(t==null&&!k0(o,Ie()))return null;{const a=t||te.EMPTY_NODE;return Io(o,a)}}}else{const i=mr(n.visibleWrites,e);if(!r&&S0(i))return t;if(!r&&t==null&&!k0(i,Ie()))return null;{const o=function(u){return(u.visible||r)&&(!s||!~s.indexOf(u.writeId))&&(Cn(u.path,e)||Cn(e,u.path))},a=c1(n.allWrites,o,e),c=t||te.EMPTY_NODE;return Io(a,c)}}}function d6(n,e,t){let s=te.EMPTY_NODE;const r=wi(n.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(nt,(i,o)=>{s=s.updateImmediateChild(i,o)}),s;if(t){const i=mr(n.visibleWrites,e);return t.forEachChild(nt,(o,a)=>{const c=Io(mr(i,new Me(o)),a);s=s.updateImmediateChild(o,c)}),G_(i).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}else{const i=mr(n.visibleWrites,e);return G_(i).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}}function f6(n,e,t,s,r){L(s||r,"Either existingEventSnap or existingServerSnap must exist");const i=tt(e,t);if(k0(n.visibleWrites,i))return null;{const o=mr(n.visibleWrites,i);return S0(o)?r.getChild(t):Io(o,r.getChild(t))}}function m6(n,e,t,s){const r=tt(e,t),i=wi(n.visibleWrites,r);if(i!=null)return i;if(s.isCompleteForChild(t)){const o=mr(n.visibleWrites,r);return Io(o,s.getNode().getImmediateChild(t))}else return null}function p6(n,e){return wi(n.visibleWrites,e)}function g6(n,e,t,s,r,i,o){let a;const c=mr(n.visibleWrites,e),u=wi(c,Ie());if(u!=null)a=u;else if(t!=null)a=Io(c,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const l=[],d=o.getCompare(),f=i?a.getReverseIteratorFrom(s,o):a.getIteratorFrom(s,o);let m=f.getNext();for(;m&&l.length<r;)d(m,s)!==0&&l.push(m),m=f.getNext();return l}else return[]}function y6(){return{visibleWrites:Un.empty(),allWrites:[],lastWriteId:-1}}function _l(n,e,t,s){return u1(n.writeTree,n.treePath,e,t,s)}function Up(n,e){return d6(n.writeTree,n.treePath,e)}function J_(n,e,t,s){return f6(n.writeTree,n.treePath,e,t,s)}function vl(n,e){return p6(n.writeTree,tt(n.treePath,e))}function _6(n,e,t,s,r,i){return g6(n.writeTree,n.treePath,e,t,s,r,i)}function Wp(n,e,t){return m6(n.writeTree,n.treePath,e,t)}function l1(n,e){return h1(tt(n.treePath,e),n.writeTree)}function h1(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v6{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,s=e.childName;L(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),L(s!==".priority","Only non-priority child changes can be tracked.");const r=this.changeMap.get(s);if(r){const i=r.type;if(t==="child_added"&&i==="child_removed")this.changeMap.set(s,fc(s,e.snapshotNode,r.snapshotNode));else if(t==="child_removed"&&i==="child_added")this.changeMap.delete(s);else if(t==="child_removed"&&i==="child_changed")this.changeMap.set(s,dc(s,r.oldSnap));else if(t==="child_changed"&&i==="child_added")this.changeMap.set(s,Eo(s,e.snapshotNode));else if(t==="child_changed"&&i==="child_changed")this.changeMap.set(s,fc(s,e.snapshotNode,r.oldSnap));else throw Ro("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w6{getCompleteChild(e){return null}getChildAfterChild(e,t,s){return null}}const d1=new w6;class Hp{constructor(e,t,s=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=s}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const s=this.optCompleteServerCache_!=null?new Tr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Wp(this.writes_,e,s)}}getChildAfterChild(e,t,s){const r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:li(this.viewCache_),i=_6(this.writes_,r,t,1,s,e);return i.length===0?null:i[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x6(n){return{filter:n}}function E6(n,e){L(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),L(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function T6(n,e,t,s,r){const i=new v6;let o,a;if(t.type===Ln.OVERWRITE){const u=t;u.source.fromUser?o=P0(n,e,u.path,u.snap,s,r,i):(L(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!me(u.path),o=wl(n,e,u.path,u.snap,s,r,a,i))}else if(t.type===Ln.MERGE){const u=t;u.source.fromUser?o=D6(n,e,u.path,u.children,s,r,i):(L(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),o=R0(n,e,u.path,u.children,s,r,a,i))}else if(t.type===Ln.ACK_USER_WRITE){const u=t;u.revert?o=C6(n,e,u.path,s,r,i):o=A6(n,e,u.path,u.affectedTree,s,r,i)}else if(t.type===Ln.LISTEN_COMPLETE)o=b6(n,e,t.path,s,i);else throw Ro("Unknown operation type: "+t.type);const c=i.getChanges();return I6(e,o,c),{viewCache:o,changes:c}}function I6(n,e,t){const s=e.eventCache;if(s.isFullyInitialized()){const r=s.getNode().isLeafNode()||s.getNode().isEmpty(),i=yl(n);(t.length>0||!n.eventCache.isFullyInitialized()||r&&!s.getNode().equals(i)||!s.getNode().getPriority().equals(i.getPriority()))&&t.push(r1(yl(e)))}}function f1(n,e,t,s,r,i){const o=e.eventCache;if(vl(s,t)!=null)return e;{let a,c;if(me(t))if(L(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const u=li(e),l=u instanceof te?u:te.EMPTY_NODE,d=Up(s,l);a=n.filter.updateFullNode(e.eventCache.getNode(),d,i)}else{const u=_l(s,li(e));a=n.filter.updateFullNode(e.eventCache.getNode(),u,i)}else{const u=de(t);if(u===".priority"){L(Er(t)===1,"Can't have a priority with additional path components");const l=o.getNode();c=e.serverCache.getNode();const d=J_(s,t,l,c);d!=null?a=n.filter.updatePriority(l,d):a=o.getNode()}else{const l=We(t);let d;if(o.isCompleteForChild(u)){c=e.serverCache.getNode();const f=J_(s,t,o.getNode(),c);f!=null?d=o.getNode().getImmediateChild(u).updateChild(l,f):d=o.getNode().getImmediateChild(u)}else d=Wp(s,u,e.serverCache);d!=null?a=n.filter.updateChild(o.getNode(),u,d,l,r,i):a=o.getNode()}}return Pa(e,a,o.isFullyInitialized()||me(t),n.filter.filtersNodes())}}function wl(n,e,t,s,r,i,o,a){const c=e.serverCache;let u;const l=o?n.filter:n.filter.getIndexedFilter();if(me(t))u=l.updateFullNode(c.getNode(),s,null);else if(l.filtersNodes()&&!c.isFiltered()){const m=c.getNode().updateChild(t,s);u=l.updateFullNode(c.getNode(),m,null)}else{const m=de(t);if(!c.isCompleteForPath(t)&&Er(t)>1)return e;const p=We(t),g=c.getNode().getImmediateChild(m).updateChild(p,s);m===".priority"?u=l.updatePriority(c.getNode(),g):u=l.updateChild(c.getNode(),m,g,p,d1,null)}const d=o1(e,u,c.isFullyInitialized()||me(t),l.filtersNodes()),f=new Hp(r,d,i);return f1(n,d,t,r,f,a)}function P0(n,e,t,s,r,i,o){const a=e.eventCache;let c,u;const l=new Hp(r,e,i);if(me(t))u=n.filter.updateFullNode(e.eventCache.getNode(),s,o),c=Pa(e,u,!0,n.filter.filtersNodes());else{const d=de(t);if(d===".priority")u=n.filter.updatePriority(e.eventCache.getNode(),s),c=Pa(e,u,a.isFullyInitialized(),a.isFiltered());else{const f=We(t),m=a.getNode().getImmediateChild(d);let p;if(me(f))p=s;else{const y=l.getCompleteChild(d);y!=null?Pp(f)===".priority"&&y.getChild(jI(f)).isEmpty()?p=y:p=y.updateChild(f,s):p=te.EMPTY_NODE}if(m.equals(p))c=e;else{const y=n.filter.updateChild(a.getNode(),d,p,f,l,o);c=Pa(e,y,a.isFullyInitialized(),n.filter.filtersNodes())}}}return c}function Q_(n,e){return n.eventCache.isCompleteForChild(e)}function D6(n,e,t,s,r,i,o){let a=e;return s.foreach((c,u)=>{const l=tt(t,c);Q_(e,de(l))&&(a=P0(n,a,l,u,r,i,o))}),s.foreach((c,u)=>{const l=tt(t,c);Q_(e,de(l))||(a=P0(n,a,l,u,r,i,o))}),a}function K_(n,e,t){return t.foreach((s,r)=>{e=e.updateChild(s,r)}),e}function R0(n,e,t,s,r,i,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,u;me(t)?u=s:u=new Ue(null).setTree(t,s);const l=e.serverCache.getNode();return u.children.inorderTraversal((d,f)=>{if(l.hasChild(d)){const m=e.serverCache.getNode().getImmediateChild(d),p=K_(n,m,f);c=wl(n,c,new Me(d),p,r,i,o,a)}}),u.children.inorderTraversal((d,f)=>{const m=!e.serverCache.isCompleteForChild(d)&&f.value===null;if(!l.hasChild(d)&&!m){const p=e.serverCache.getNode().getImmediateChild(d),y=K_(n,p,f);c=wl(n,c,new Me(d),y,r,i,o,a)}}),c}function A6(n,e,t,s,r,i,o){if(vl(r,t)!=null)return e;const a=e.serverCache.isFiltered(),c=e.serverCache;if(s.value!=null){if(me(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return wl(n,e,t,c.getNode().getChild(t),r,i,a,o);if(me(t)){let u=new Ue(null);return c.getNode().forEachChild(Xi,(l,d)=>{u=u.set(new Me(l),d)}),R0(n,e,t,u,r,i,a,o)}else return e}else{let u=new Ue(null);return s.foreach((l,d)=>{const f=tt(t,l);c.isCompleteForPath(f)&&(u=u.set(l,c.getNode().getChild(f)))}),R0(n,e,t,u,r,i,a,o)}}function b6(n,e,t,s,r){const i=e.serverCache,o=o1(e,i.getNode(),i.isFullyInitialized()||me(t),i.isFiltered());return f1(n,o,t,s,d1,r)}function C6(n,e,t,s,r,i){let o;if(vl(s,t)!=null)return e;{const a=new Hp(s,e,r),c=e.eventCache.getNode();let u;if(me(t)||de(t)===".priority"){let l;if(e.serverCache.isFullyInitialized())l=_l(s,li(e));else{const d=e.serverCache.getNode();L(d instanceof te,"serverChildren would be complete if leaf node"),l=Up(s,d)}l=l,u=n.filter.updateFullNode(c,l,i)}else{const l=de(t);let d=Wp(s,l,e.serverCache);d==null&&e.serverCache.isCompleteForChild(l)&&(d=c.getImmediateChild(l)),d!=null?u=n.filter.updateChild(c,l,d,We(t),a,i):e.eventCache.getNode().hasChild(l)?u=n.filter.updateChild(c,l,te.EMPTY_NODE,We(t),a,i):u=c,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=_l(s,li(e)),o.isLeafNode()&&(u=n.filter.updateFullNode(u,o,i)))}return o=e.serverCache.isFullyInitialized()||vl(s,Ie())!=null,Pa(e,u,o,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k6{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const s=this.query_._queryParams,r=new Op(s.getIndex()),i=GB(s);this.processor_=x6(i);const o=t.serverCache,a=t.eventCache,c=r.updateFullNode(te.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(te.EMPTY_NODE,a.getNode(),null),l=new Tr(c,o.isFullyInitialized(),r.filtersNodes()),d=new Tr(u,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=Nh(d,l),this.eventGenerator_=new e6(this.query_)}get query(){return this.query_}}function S6(n){return n.viewCache_.serverCache.getNode()}function P6(n){return yl(n.viewCache_)}function R6(n,e){const t=li(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!me(e)&&!t.getImmediateChild(de(e)).isEmpty())?t.getChild(e):null}function j_(n){return n.eventRegistrations_.length===0}function N6(n,e){n.eventRegistrations_.push(e)}function X_(n,e,t){const s=[];if(t){L(e==null,"A cancel should cancel all event registrations.");const r=n.query._path;n.eventRegistrations_.forEach(i=>{const o=i.createCancelEvent(t,r);o&&s.push(o)})}if(e){let r=[];for(let i=0;i<n.eventRegistrations_.length;++i){const o=n.eventRegistrations_[i];if(!o.matches(e))r.push(o);else if(e.hasAnyCallback()){r=r.concat(n.eventRegistrations_.slice(i+1));break}}n.eventRegistrations_=r}else n.eventRegistrations_=[];return s}function Z_(n,e,t,s){e.type===Ln.MERGE&&e.source.queryId!==null&&(L(li(n.viewCache_),"We should always have a full cache before handling merges"),L(yl(n.viewCache_),"Missing event cache, even though we have a server cache"));const r=n.viewCache_,i=T6(n.processor_,r,e,t,s);return E6(n.processor_,i.viewCache),L(i.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=i.viewCache,m1(n,i.changes,i.viewCache.eventCache.getNode(),null)}function M6(n,e){const t=n.viewCache_.eventCache,s=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(nt,(i,o)=>{s.push(Eo(i,o))}),t.isFullyInitialized()&&s.push(r1(t.getNode())),m1(n,s,t.getNode(),e)}function m1(n,e,t,s){const r=s?[s]:n.eventRegistrations_;return t6(n.eventGenerator_,e,t,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xl;class p1{constructor(){this.views=new Map}}function O6(n){L(!xl,"__referenceConstructor has already been defined"),xl=n}function F6(){return L(xl,"Reference.ts has not been loaded"),xl}function B6(n){return n.views.size===0}function $p(n,e,t,s){const r=e.source.queryId;if(r!==null){const i=n.views.get(r);return L(i!=null,"SyncTree gave us an op for an invalid query."),Z_(i,e,t,s)}else{let i=[];for(const o of n.views.values())i=i.concat(Z_(o,e,t,s));return i}}function g1(n,e,t,s,r){const i=e._queryIdentifier,o=n.views.get(i);if(!o){let a=_l(t,r?s:null),c=!1;a?c=!0:s instanceof te?(a=Up(t,s),c=!1):(a=te.EMPTY_NODE,c=!1);const u=Nh(new Tr(a,c,!1),new Tr(s,r,!1));return new k6(e,u)}return o}function L6(n,e,t,s,r,i){const o=g1(n,e,s,r,i);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),N6(o,t),M6(o,t)}function V6(n,e,t,s){const r=e._queryIdentifier,i=[];let o=[];const a=Ir(n);if(r==="default")for(const[c,u]of n.views.entries())o=o.concat(X_(u,t,s)),j_(u)&&(n.views.delete(c),u.query._queryParams.loadsAllData()||i.push(u.query));else{const c=n.views.get(r);c&&(o=o.concat(X_(c,t,s)),j_(c)&&(n.views.delete(r),c.query._queryParams.loadsAllData()||i.push(c.query)))}return a&&!Ir(n)&&i.push(new(F6())(e._repo,e._path)),{removed:i,events:o}}function y1(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function pr(n,e){let t=null;for(const s of n.views.values())t=t||R6(s,e);return t}function _1(n,e){if(e._queryParams.loadsAllData())return Oh(n);{const s=e._queryIdentifier;return n.views.get(s)}}function v1(n,e){return _1(n,e)!=null}function Ir(n){return Oh(n)!=null}function Oh(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let El;function U6(n){L(!El,"__referenceConstructor has already been defined"),El=n}function W6(){return L(El,"Reference.ts has not been loaded"),El}let H6=1;class ev{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ue(null),this.pendingWriteTree_=y6(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function w1(n,e,t,s,r){return i6(n.pendingWriteTree_,e,t,s,r),r?Go(n,new ui(Bp(),e,t)):[]}function $6(n,e,t,s){o6(n.pendingWriteTree_,e,t,s);const r=Ue.fromObject(t);return Go(n,new To(Bp(),e,r))}function cr(n,e,t=!1){const s=a6(n.pendingWriteTree_,e);if(c6(n.pendingWriteTree_,e)){let i=new Ue(null);return s.snap!=null?i=i.set(Ie(),!0):Bt(s.children,o=>{i=i.set(new Me(o),!0)}),Go(n,new gl(s.path,i,t))}else return[]}function Xc(n,e,t){return Go(n,new ui(Lp(),e,t))}function q6(n,e,t){const s=Ue.fromObject(t);return Go(n,new To(Lp(),e,s))}function Y6(n,e){return Go(n,new pc(Lp(),e))}function z6(n,e,t){const s=Yp(n,t);if(s){const r=zp(s),i=r.path,o=r.queryId,a=en(i,e),c=new pc(Vp(o),a);return Gp(n,i,c)}else return[]}function Tl(n,e,t,s,r=!1){const i=e._path,o=n.syncPointTree_.get(i);let a=[];if(o&&(e._queryIdentifier==="default"||v1(o,e))){const c=V6(o,e,t,s);B6(o)&&(n.syncPointTree_=n.syncPointTree_.remove(i));const u=c.removed;if(a=c.events,!r){const l=u.findIndex(f=>f._queryParams.loadsAllData())!==-1,d=n.syncPointTree_.findOnPath(i,(f,m)=>Ir(m));if(l&&!d){const f=n.syncPointTree_.subtree(i);if(!f.isEmpty()){const m=Q6(f);for(let p=0;p<m.length;++p){const y=m[p],g=y.query,x=I1(n,y);n.listenProvider_.startListening(Na(g),gc(n,g),x.hashFn,x.onComplete)}}}!d&&u.length>0&&!s&&(l?n.listenProvider_.stopListening(Na(e),null):u.forEach(f=>{const m=n.queryToTagMap.get(Fh(f));n.listenProvider_.stopListening(Na(f),m)}))}K6(n,u)}return a}function x1(n,e,t,s){const r=Yp(n,s);if(r!=null){const i=zp(r),o=i.path,a=i.queryId,c=en(o,e),u=new ui(Vp(a),c,t);return Gp(n,o,u)}else return[]}function G6(n,e,t,s){const r=Yp(n,s);if(r){const i=zp(r),o=i.path,a=i.queryId,c=en(o,e),u=Ue.fromObject(t),l=new To(Vp(a),c,u);return Gp(n,o,l)}else return[]}function N0(n,e,t,s=!1){const r=e._path;let i=null,o=!1;n.syncPointTree_.foreachOnPath(r,(f,m)=>{const p=en(f,r);i=i||pr(m,p),o=o||Ir(m)});let a=n.syncPointTree_.get(r);a?(o=o||Ir(a),i=i||pr(a,Ie())):(a=new p1,n.syncPointTree_=n.syncPointTree_.set(r,a));let c;i!=null?c=!0:(c=!1,i=te.EMPTY_NODE,n.syncPointTree_.subtree(r).foreachChild((m,p)=>{const y=pr(p,Ie());y&&(i=i.updateImmediateChild(m,y))}));const u=v1(a,e);if(!u&&!e._queryParams.loadsAllData()){const f=Fh(e);L(!n.queryToTagMap.has(f),"View does not exist, but we have a tag");const m=j6();n.queryToTagMap.set(f,m),n.tagToQueryMap.set(m,f)}const l=Mh(n.pendingWriteTree_,r);let d=L6(a,e,t,l,i,c);if(!u&&!o&&!s){const f=_1(a,e);d=d.concat(X6(n,e,f))}return d}function qp(n,e,t){const r=n.pendingWriteTree_,i=n.syncPointTree_.findOnPath(e,(o,a)=>{const c=en(o,e),u=pr(a,c);if(u)return u});return u1(r,e,i,t,!0)}function J6(n,e){const t=e._path;let s=null;n.syncPointTree_.foreachOnPath(t,(u,l)=>{const d=en(u,t);s=s||pr(l,d)});let r=n.syncPointTree_.get(t);r?s=s||pr(r,Ie()):(r=new p1,n.syncPointTree_=n.syncPointTree_.set(t,r));const i=s!=null,o=i?new Tr(s,!0,!1):null,a=Mh(n.pendingWriteTree_,e._path),c=g1(r,e,a,i?o.getNode():te.EMPTY_NODE,i);return P6(c)}function Go(n,e){return E1(e,n.syncPointTree_,null,Mh(n.pendingWriteTree_,Ie()))}function E1(n,e,t,s){if(me(n.path))return T1(n,e,t,s);{const r=e.get(Ie());t==null&&r!=null&&(t=pr(r,Ie()));let i=[];const o=de(n.path),a=n.operationForChild(o),c=e.children.get(o);if(c&&a){const u=t?t.getImmediateChild(o):null,l=l1(s,o);i=i.concat(E1(a,c,u,l))}return r&&(i=i.concat($p(r,n,s,t))),i}}function T1(n,e,t,s){const r=e.get(Ie());t==null&&r!=null&&(t=pr(r,Ie()));let i=[];return e.children.inorderTraversal((o,a)=>{const c=t?t.getImmediateChild(o):null,u=l1(s,o),l=n.operationForChild(o);l&&(i=i.concat(T1(l,a,c,u)))}),r&&(i=i.concat($p(r,n,s,t))),i}function I1(n,e){const t=e.query,s=gc(n,t);return{hashFn:()=>(S6(e)||te.EMPTY_NODE).hash(),onComplete:r=>{if(r==="ok")return s?z6(n,t._path,s):Y6(n,t._path);{const i=YF(r,t);return Tl(n,t,null,i)}}}}function gc(n,e){const t=Fh(e);return n.queryToTagMap.get(t)}function Fh(n){return n._path.toString()+"$"+n._queryIdentifier}function Yp(n,e){return n.tagToQueryMap.get(e)}function zp(n){const e=n.indexOf("$");return L(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Me(n.substr(0,e))}}function Gp(n,e,t){const s=n.syncPointTree_.get(e);L(s,"Missing sync point for query tag that we're tracking");const r=Mh(n.pendingWriteTree_,e);return $p(s,t,r,null)}function Q6(n){return n.fold((e,t,s)=>{if(t&&Ir(t))return[Oh(t)];{let r=[];return t&&(r=y1(t)),Bt(s,(i,o)=>{r=r.concat(o)}),r}})}function Na(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(W6())(n._repo,n._path):n}function K6(n,e){for(let t=0;t<e.length;++t){const s=e[t];if(!s._queryParams.loadsAllData()){const r=Fh(s),i=n.queryToTagMap.get(r);n.queryToTagMap.delete(r),n.tagToQueryMap.delete(i)}}}function j6(){return H6++}function X6(n,e,t){const s=e._path,r=gc(n,e),i=I1(n,t),o=n.listenProvider_.startListening(Na(e),r,i.hashFn,i.onComplete),a=n.syncPointTree_.subtree(s);if(r)L(!Ir(a.value),"If we're adding a query, it shouldn't be shadowed");else{const c=a.fold((u,l,d)=>{if(!me(u)&&l&&Ir(l))return[Oh(l).query];{let f=[];return l&&(f=f.concat(y1(l).map(m=>m.query))),Bt(d,(m,p)=>{f=f.concat(p)}),f}});for(let u=0;u<c.length;++u){const l=c[u];n.listenProvider_.stopListening(Na(l),gc(n,l))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jp{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Jp(t)}node(){return this.node_}}class Qp{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=tt(this.path_,e);return new Qp(this.syncTree_,t)}node(){return qp(this.syncTree_,this.path_)}}const Z6=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},tv=function(n,e,t){if(!n||typeof n!="object")return n;if(L(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return e3(n[".sv"],e,t);if(typeof n[".sv"]=="object")return t3(n[".sv"],e);L(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},e3=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:L(!1,"Unexpected server value: "+n)}},t3=function(n,e,t){n.hasOwnProperty("increment")||L(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const s=n.increment;typeof s!="number"&&L(!1,"Unexpected increment value: "+s);const r=e.node();if(L(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return s;const o=r.getValue();return typeof o!="number"?s:o+s},D1=function(n,e,t,s){return Kp(e,new Qp(t,n),s)},A1=function(n,e,t){return Kp(n,new Jp(e),t)};function Kp(n,e,t){const s=n.getPriority().val(),r=tv(s,e.getImmediateChild(".priority"),t);let i;if(n.isLeafNode()){const o=n,a=tv(o.getValue(),e,t);return a!==o.getValue()||r!==o.getPriority().val()?new _t(a,ft(r)):n}else{const o=n;return i=o,r!==o.getPriority().val()&&(i=i.updatePriority(new _t(r))),o.forEachChild(nt,(a,c)=>{const u=Kp(c,e.getImmediateChild(a),t);u!==c&&(i=i.updateImmediateChild(a,u))}),i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jp{constructor(e="",t=null,s={children:{},childCount:0}){this.name=e,this.parent=t,this.node=s}}function Xp(n,e){let t=e instanceof Me?e:new Me(e),s=n,r=de(t);for(;r!==null;){const i=oo(s.node.children,r)||{children:{},childCount:0};s=new jp(r,s,i),t=We(t),r=de(t)}return s}function Jo(n){return n.node.value}function b1(n,e){n.node.value=e,M0(n)}function C1(n){return n.node.childCount>0}function n3(n){return Jo(n)===void 0&&!C1(n)}function Bh(n,e){Bt(n.node.children,(t,s)=>{e(new jp(t,n,s))})}function k1(n,e,t,s){t&&!s&&e(n),Bh(n,r=>{k1(r,e,!0,s)}),t&&s&&e(n)}function s3(n,e,t){let s=t?n:n.parent;for(;s!==null;){if(e(s))return!0;s=s.parent}return!1}function Zc(n){return new Me(n.parent===null?n.name:Zc(n.parent)+"/"+n.name)}function M0(n){n.parent!==null&&r3(n.parent,n.name,n)}function r3(n,e,t){const s=n3(t),r=ls(n.node.children,e);s&&r?(delete n.node.children[e],n.node.childCount--,M0(n)):!s&&!r&&(n.node.children[e]=t.node,n.node.childCount++,M0(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i3=/[\[\].#$\/\u0000-\u001F\u007F]/,o3=/[\[\].#$\u0000-\u001F\u007F]/,Md=10*1024*1024,Zp=function(n){return typeof n=="string"&&n.length!==0&&!i3.test(n)},S1=function(n){return typeof n=="string"&&n.length!==0&&!o3.test(n)},a3=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),S1(n)},c3=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!Ap(n)||n&&typeof n=="object"&&ls(n,".sv")},u3=function(n,e,t,s){s&&e===void 0||Lh(Ll(n,"value"),e,t)},Lh=function(n,e,t){const s=t instanceof Me?new DB(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Fr(s));if(typeof e=="function")throw new Error(n+"contains a function "+Fr(s)+" with contents = "+e.toString());if(Ap(e))throw new Error(n+"contains "+e.toString()+" "+Fr(s));if(typeof e=="string"&&e.length>Md/3&&Vl(e)>Md)throw new Error(n+"contains a string greater than "+Md+" utf8 bytes "+Fr(s)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,i=!1;if(Bt(e,(o,a)=>{if(o===".value")r=!0;else if(o!==".priority"&&o!==".sv"&&(i=!0,!Zp(o)))throw new Error(n+" contains an invalid key ("+o+") "+Fr(s)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);AB(s,o),Lh(n,a,s),bB(s)}),r&&i)throw new Error(n+' contains ".value" child '+Fr(s)+" in addition to actual children.")}},l3=function(n,e){let t,s;for(t=0;t<e.length;t++){s=e[t];const i=hc(s);for(let o=0;o<i.length;o++)if(!(i[o]===".priority"&&o===i.length-1)){if(!Zp(i[o]))throw new Error(n+"contains an invalid key ("+i[o]+") in path "+s.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(IB);let r=null;for(t=0;t<e.length;t++){if(s=e[t],r!==null&&Cn(r,s))throw new Error(n+"contains a path "+r.toString()+" that is ancestor of another path "+s.toString());r=s}},h3=function(n,e,t,s){if(s&&e===void 0)return;const r=Ll(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(r+" must be an object containing the children to replace.");const i=[];Bt(e,(o,a)=>{const c=new Me(o);if(Lh(r,a,tt(t,c)),Pp(c)===".priority"&&!c3(a))throw new Error(r+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");i.push(c)}),l3(r,i)},P1=function(n,e,t,s){if(!(s&&t===void 0)&&!S1(t))throw new Error(Ll(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},d3=function(n,e,t,s){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),P1(n,e,t,s)},R1=function(n,e){if(de(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},f3=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Zp(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!a3(t))throw new Error(Ll(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m3{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Vh(n,e){let t=null;for(let s=0;s<e.length;s++){const r=e[s],i=r.getPath();t!==null&&!Rp(i,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:i}),t.events.push(r)}t&&n.eventLists_.push(t)}function N1(n,e,t){Vh(n,t),M1(n,s=>Rp(s,e))}function kn(n,e,t){Vh(n,t),M1(n,s=>Cn(s,e)||Cn(e,s))}function M1(n,e){n.recursionDepth_++;let t=!0;for(let s=0;s<n.eventLists_.length;s++){const r=n.eventLists_[s];if(r){const i=r.path;e(i)?(p3(n.eventLists_[s]),n.eventLists_[s]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function p3(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const s=t.getEventRunner();Kr&&Pt("event: "+t.toString()),zo(s)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g3="repo_interrupt",y3=25;class _3{constructor(e,t,s,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=s,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new m3,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=pl(),this.transactionQueueTree_=new jp,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function v3(n,e,t){if(n.stats_=kp(n.repoInfo_),n.forceRestClient_||QF())n.server_=new ml(n.repoInfo_,(s,r,i,o)=>{nv(n,s,r,i,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>sv(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{mt(t)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}n.persistentConnection_=new Os(n.repoInfo_,e,(s,r,i,o)=>{nv(n,s,r,i,o)},s=>{sv(n,s)},s=>{x3(n,s)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(s=>{n.server_.refreshAuthToken(s)}),n.appCheckProvider_.addTokenChangeListener(s=>{n.server_.refreshAppCheckToken(s.token)}),n.statsReporter_=eB(n.repoInfo_,()=>new ZB(n.stats_,n.server_)),n.infoData_=new JB,n.infoSyncTree_=new ev({startListening:(s,r,i,o)=>{let a=[];const c=n.infoData_.getNode(s._path);return c.isEmpty()||(a=Xc(n.infoSyncTree_,s._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),eg(n,"connected",!1),n.serverSyncTree_=new ev({startListening:(s,r,i,o)=>(n.server_.listen(s,i,r,(a,c)=>{const u=o(a,c);kn(n.eventQueue_,s._path,u)}),[]),stopListening:(s,r)=>{n.server_.unlisten(s,r)}})}function w3(n){const t=n.infoData_.getNode(new Me(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function Uh(n){return Z6({timestamp:w3(n)})}function nv(n,e,t,s,r){n.dataUpdateCount++;const i=new Me(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(r)if(s){const c=Lu(t,u=>ft(u));o=G6(n.serverSyncTree_,i,c,r)}else{const c=ft(t);o=x1(n.serverSyncTree_,i,c,r)}else if(s){const c=Lu(t,u=>ft(u));o=q6(n.serverSyncTree_,i,c)}else{const c=ft(t);o=Xc(n.serverSyncTree_,i,c)}let a=i;o.length>0&&(a=Do(n,i)),kn(n.eventQueue_,a,o)}function sv(n,e){eg(n,"connected",e),e===!1&&D3(n)}function x3(n,e){Bt(e,(t,s)=>{eg(n,t,s)})}function eg(n,e,t){const s=new Me("/.info/"+e),r=ft(t);n.infoData_.updateSnapshot(s,r);const i=Xc(n.infoSyncTree_,s,r);kn(n.eventQueue_,s,i)}function tg(n){return n.nextWriteId_++}function E3(n,e,t){const s=J6(n.serverSyncTree_,e);return s!=null?Promise.resolve(s):n.server_.get(e).then(r=>{const i=ft(r).withIndex(e._queryParams.getIndex());N0(n.serverSyncTree_,e,t,!0);let o;if(e._queryParams.loadsAllData())o=Xc(n.serverSyncTree_,e._path,i);else{const a=gc(n.serverSyncTree_,e);o=x1(n.serverSyncTree_,e._path,i,a)}return kn(n.eventQueue_,e._path,o),Tl(n.serverSyncTree_,e,t,null,!0),i},r=>(eu(n,"get for query "+mt(e)+" failed: "+r),Promise.reject(new Error(r))))}function T3(n,e,t,s,r){eu(n,"set",{path:e.toString(),value:t,priority:s});const i=Uh(n),o=ft(t,s),a=qp(n.serverSyncTree_,e),c=A1(o,a,i),u=tg(n),l=w1(n.serverSyncTree_,e,c,u,!0);Vh(n.eventQueue_,l),n.server_.put(e.toString(),o.val(!0),(f,m)=>{const p=f==="ok";p||tn("set at "+e+" failed: "+f);const y=cr(n.serverSyncTree_,u,!p);kn(n.eventQueue_,e,y),O0(n,r,f,m)});const d=sg(n,e);Do(n,d),kn(n.eventQueue_,d,[])}function I3(n,e,t,s){eu(n,"update",{path:e.toString(),value:t});let r=!0;const i=Uh(n),o={};if(Bt(t,(a,c)=>{r=!1,o[a]=D1(tt(e,a),ft(c),n.serverSyncTree_,i)}),r)Pt("update() called with empty data.  Don't do anything."),O0(n,s,"ok",void 0);else{const a=tg(n),c=$6(n.serverSyncTree_,e,o,a);Vh(n.eventQueue_,c),n.server_.merge(e.toString(),t,(u,l)=>{const d=u==="ok";d||tn("update at "+e+" failed: "+u);const f=cr(n.serverSyncTree_,a,!d),m=f.length>0?Do(n,e):e;kn(n.eventQueue_,m,f),O0(n,s,u,l)}),Bt(t,u=>{const l=sg(n,tt(e,u));Do(n,l)}),kn(n.eventQueue_,e,[])}}function D3(n){eu(n,"onDisconnectEvents");const e=Uh(n),t=pl();b0(n.onDisconnect_,Ie(),(r,i)=>{const o=D1(r,i,n.serverSyncTree_,e);i1(t,r,o)});let s=[];b0(t,Ie(),(r,i)=>{s=s.concat(Xc(n.serverSyncTree_,r,i));const o=sg(n,r);Do(n,o)}),n.onDisconnect_=pl(),kn(n.eventQueue_,Ie(),s)}function A3(n,e,t){let s;de(e._path)===".info"?s=N0(n.infoSyncTree_,e,t):s=N0(n.serverSyncTree_,e,t),N1(n.eventQueue_,e._path,s)}function rv(n,e,t){let s;de(e._path)===".info"?s=Tl(n.infoSyncTree_,e,t):s=Tl(n.serverSyncTree_,e,t),N1(n.eventQueue_,e._path,s)}function b3(n){n.persistentConnection_&&n.persistentConnection_.interrupt(g3)}function eu(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Pt(t,...e)}function O0(n,e,t,s){e&&zo(()=>{if(t==="ok")e(null);else{const r=(t||"error").toUpperCase();let i=r;s&&(i+=": "+s);const o=new Error(i);o.code=r,e(o)}})}function O1(n,e,t){return qp(n.serverSyncTree_,e,t)||te.EMPTY_NODE}function ng(n,e=n.transactionQueueTree_){if(e||Wh(n,e),Jo(e)){const t=B1(n,e);L(t.length>0,"Sending zero length transaction queue"),t.every(r=>r.status===0)&&C3(n,Zc(e),t)}else C1(e)&&Bh(e,t=>{ng(n,t)})}function C3(n,e,t){const s=t.map(u=>u.currentWriteId),r=O1(n,e,s);let i=r;const o=r.hash();for(let u=0;u<t.length;u++){const l=t[u];L(l.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),l.status=1,l.retryCount++;const d=en(e,l.path);i=i.updateChild(d,l.currentOutputSnapshotRaw)}const a=i.val(!0),c=e;n.server_.put(c.toString(),a,u=>{eu(n,"transaction put response",{path:c.toString(),status:u});let l=[];if(u==="ok"){const d=[];for(let f=0;f<t.length;f++)t[f].status=2,l=l.concat(cr(n.serverSyncTree_,t[f].currentWriteId)),t[f].onComplete&&d.push(()=>t[f].onComplete(null,!0,t[f].currentOutputSnapshotResolved)),t[f].unwatcher();Wh(n,Xp(n.transactionQueueTree_,e)),ng(n,n.transactionQueueTree_),kn(n.eventQueue_,e,l);for(let f=0;f<d.length;f++)zo(d[f])}else{if(u==="datastale")for(let d=0;d<t.length;d++)t[d].status===3?t[d].status=4:t[d].status=0;else{tn("transaction at "+c.toString()+" failed: "+u);for(let d=0;d<t.length;d++)t[d].status=4,t[d].abortReason=u}Do(n,e)}},o)}function Do(n,e){const t=F1(n,e),s=Zc(t),r=B1(n,t);return k3(n,r,s),s}function k3(n,e,t){if(e.length===0)return;const s=[];let r=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const c=e[a],u=en(t,c.path);let l=!1,d;if(L(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)l=!0,d=c.abortReason,r=r.concat(cr(n.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=y3)l=!0,d="maxretry",r=r.concat(cr(n.serverSyncTree_,c.currentWriteId,!0));else{const f=O1(n,c.path,o);c.currentInputSnapshot=f;const m=e[a].update(f.val());if(m!==void 0){Lh("transaction failed: Data returned ",m,c.path);let p=ft(m);typeof m=="object"&&m!=null&&ls(m,".priority")||(p=p.updatePriority(f.getPriority()));const g=c.currentWriteId,x=Uh(n),_=A1(p,f,x);c.currentOutputSnapshotRaw=p,c.currentOutputSnapshotResolved=_,c.currentWriteId=tg(n),o.splice(o.indexOf(g),1),r=r.concat(w1(n.serverSyncTree_,c.path,_,c.currentWriteId,c.applyLocally)),r=r.concat(cr(n.serverSyncTree_,g,!0))}else l=!0,d="nodata",r=r.concat(cr(n.serverSyncTree_,c.currentWriteId,!0))}kn(n.eventQueue_,t,r),r=[],l&&(e[a].status=2,function(f){setTimeout(f,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?s.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):s.push(()=>e[a].onComplete(new Error(d),!1,null))))}Wh(n,n.transactionQueueTree_);for(let a=0;a<s.length;a++)zo(s[a]);ng(n,n.transactionQueueTree_)}function F1(n,e){let t,s=n.transactionQueueTree_;for(t=de(e);t!==null&&Jo(s)===void 0;)s=Xp(s,t),e=We(e),t=de(e);return s}function B1(n,e){const t=[];return L1(n,e,t),t.sort((s,r)=>s.order-r.order),t}function L1(n,e,t){const s=Jo(e);if(s)for(let r=0;r<s.length;r++)t.push(s[r]);Bh(e,r=>{L1(n,r,t)})}function Wh(n,e){const t=Jo(e);if(t){let s=0;for(let r=0;r<t.length;r++)t[r].status!==2&&(t[s]=t[r],s++);t.length=s,b1(e,t.length>0?t:void 0)}Bh(e,s=>{Wh(n,s)})}function sg(n,e){const t=Zc(F1(n,e)),s=Xp(n.transactionQueueTree_,e);return s3(s,r=>{Od(n,r)}),Od(n,s),k1(s,r=>{Od(n,r)}),t}function Od(n,e){const t=Jo(e);if(t){const s=[];let r=[],i=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(L(i===o-1,"All SENT items should be at beginning of queue."),i=o,t[o].status=3,t[o].abortReason="set"):(L(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),r=r.concat(cr(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&s.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));i===-1?b1(e,void 0):t.length=i+1,kn(n.eventQueue_,Zc(e),r);for(let o=0;o<s.length;o++)zo(s[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S3(n){let e="";const t=n.split("/");for(let s=0;s<t.length;s++)if(t[s].length>0){let r=t[s];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function P3(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const s=t.split("=");s.length===2?e[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):tn(`Invalid query segment '${t}' in query '${n}'`)}return e}const iv=function(n,e){const t=R3(n),s=t.namespace;t.domain==="firebase.com"&&Hs(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||s==="undefined")&&t.domain!=="localhost"&&Hs("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||UF();const r=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new HI(t.host,t.secure,s,r,e,"",s!==t.subdomain),path:new Me(t.pathString)}},R3=function(n){let e="",t="",s="",r="",i="",o=!0,a="https",c=443;if(typeof n=="string"){let u=n.indexOf("//");u>=0&&(a=n.substring(0,u-1),n=n.substring(u+2));let l=n.indexOf("/");l===-1&&(l=n.length);let d=n.indexOf("?");d===-1&&(d=n.length),e=n.substring(0,Math.min(l,d)),l<d&&(r=S3(n.substring(l,d)));const f=P3(n.substring(Math.min(n.length,d)));u=e.indexOf(":"),u>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(u+1),10)):u=e.length;const m=e.slice(0,u);if(m.toLowerCase()==="localhost")t="localhost";else if(m.split(".").length<=2)t=m;else{const p=e.indexOf(".");s=e.substring(0,p).toLowerCase(),t=e.substring(p+1),i=s}"ns"in f&&(i=f.ns)}return{host:e,port:c,domain:t,subdomain:s,secure:o,scheme:a,pathString:r,namespace:i}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1{constructor(e,t,s,r){this.eventType=e,this.eventRegistration=t,this.snapshot=s,this.prevName=r}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+mt(this.snapshot.exportVal())}}class U1{constructor(e,t,s){this.eventRegistration=e,this.error=t,this.path=s}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W1{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return L(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg{constructor(e,t,s,r){this._repo=e,this._path=t,this._queryParams=s,this._orderByCalled=r}get key(){return me(this._path)?null:Pp(this._path)}get ref(){return new fs(this._repo,this._path)}get _queryIdentifier(){const e=q_(this._queryParams),t=bp(e);return t==="{}"?"default":t}get _queryObject(){return q_(this._queryParams)}isEqual(e){if(e=Te(e),!(e instanceof rg))return!1;const t=this._repo===e._repo,s=Rp(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&s&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+TB(this._path)}}class fs extends rg{constructor(e,t){super(e,t,new Fp,!1)}get parent(){const e=jI(this._path);return e===null?null:new fs(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class Ao{constructor(e,t,s){this._node=e,this.ref=t,this._index=s}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new Me(e),s=Il(this.ref,e);return new Ao(this._node.getChild(t),s,nt)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(s,r)=>e(new Ao(r,Il(this.ref,s),nt)))}hasChild(e){const t=new Me(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Rr(n,e){return n=Te(n),n._checkNotDeleted("ref"),e!==void 0?Il(n._root,e):n._root}function Il(n,e){return n=Te(n),de(n._path)===null?d3("child","path",e,!1):P1("child","path",e,!1),new fs(n._repo,tt(n._path,e))}function N3(n){return R1("remove",n._path),H1(n,null)}function H1(n,e){n=Te(n),R1("set",n._path),u3("set",e,n._path,!1);const t=new Ic;return T3(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function Fd(n,e){h3("update",e,n._path,!1);const t=new Ic;return I3(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function M3(n){n=Te(n);const e=new W1(()=>{}),t=new Hh(e);return E3(n._repo,n,t).then(s=>new Ao(s,new fs(n._repo,n._path),n._queryParams.getIndex()))}class Hh{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const s=t._queryParams.getIndex();return new V1("value",this,new Ao(e.snapshotNode,new fs(t._repo,t._path),s))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new U1(this,e,t):null}matches(e){return e instanceof Hh?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class ig{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new U1(this,e,t):null}createEvent(e,t){L(e.childName!=null,"Child events should have a childName.");const s=Il(new fs(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new V1(e.type,this,new Ao(e.snapshotNode,s,r),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof ig?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function O3(n,e,t,s,r){let i;if(typeof s=="object"&&(i=void 0,r=s),typeof s=="function"&&(i=s),r&&r.onlyOnce){const c=t,u=(l,d)=>{rv(n._repo,n,a),c(l,d)};u.userCallback=t.userCallback,u.context=t.context,t=u}const o=new W1(t,i||void 0),a=e==="value"?new Hh(o):new ig(e,o);return A3(n._repo,n,a),()=>rv(n._repo,n,a)}function F3(n,e,t,s){return O3(n,"value",e,t,s)}O6(fs);U6(fs);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B3="FIREBASE_DATABASE_EMULATOR_HOST",F0={};let L3=!1;function V3(n,e,t,s){n.repoInfo_=new HI(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),s&&(n.authTokenProvider_=s)}function U3(n,e,t,s,r){let i=s||n.options.databaseURL;i===void 0&&(n.options.projectId||Hs("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Pt("Using default host for project ",n.options.projectId),i=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=iv(i,r),a=o.repoInfo,c,u;typeof process<"u"&&A_&&(u=A_[B3]),u?(c=!0,i=`http://${u}?ns=${a.namespace}`,o=iv(i,r),a=o.repoInfo):c=!o.repoInfo.secure;const l=r&&c?new ji(ji.OWNER):new jF(n.name,n.options,e);f3("Invalid Firebase Database URL",o),me(o.path)||Hs("Database URL must point to the root of a Firebase Database (not including a child path).");const d=H3(a,n,l,new KF(n.name,t));return new $3(d,n)}function W3(n,e){const t=F0[e];(!t||t[n.key]!==n)&&Hs(`Database ${e}(${n.repoInfo_}) has already been deleted.`),b3(n),delete t[n.key]}function H3(n,e,t,s){let r=F0[e.name];r||(r={},F0[e.name]=r);let i=r[n.toURLString()];return i&&Hs("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new _3(n,L3,t,s),r[n.toURLString()]=i,i}class $3{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(v3(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new fs(this._repo,Ie())),this._rootInternal}_delete(){return this._rootInternal!==null&&(W3(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Hs("Cannot call "+e+" on a deleted database.")}}function q3(n=No(),e){const t=Wl(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const s=Iw("database");s&&Y3(t,...s)}return t}function Y3(n,e,t,s={}){n=Te(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&Hs("Cannot call useEmulator() after instance has already been initialized.");const r=n._repoInternal;let i;if(r.repoInfo_.nodeAdmin)s.mockUserToken&&Hs('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),i=new ji(ji.OWNER);else if(s.mockUserToken){const o=typeof s.mockUserToken=="string"?s.mockUserToken:bw(s.mockUserToken,n.app.options.projectId);i=new ji(o)}V3(r,e,t,i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z3(n){OF(mi),ni(new yr("database",(e,{instanceIdentifier:t})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return U3(s,r,i,t)},"PUBLIC").setMultipleInstances(!0)),ts(b_,C_,n),ts(b_,C_,"esm2017")}function ov(n){return{".sv":{increment:n}}}Os.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};Os.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};z3();const G3={simpletor_golden_business_month_1:1e3,simpletor_advanced_business_month_1:200,simpletor_basic_business_month_1:0,simpletor_landing_business_month_1:0},J3={simpletor_golden_business_month_1:100,simpletor_advanced_business_month_1:20,simpletor_basic_business_month_1:10,simpletor_landing_business_month_1:10};class Dl{constructor(e=0,t=0){h(this,"messagesCounter",0);h(this,"paymentRequestCounter",0);h(this,"listener");this.messagesCounter=e,this.paymentRequestCounter=t}static forNewBusiness(){return new Dl(MF,NF)}static fromProductId(e){return new Dl(G3[e]||0,J3[e]||0)}setBusinessData(e){this.messagesCounter=parseInt(e.val().messagesCounter.toString())||0,this.paymentRequestCounter=parseInt(e.val().paymentRequestCounter.toString())||0}toJson(){const e={};return e.messagesCounter=this.messagesCounter,e.paymentRequestCounter=this.paymentRequestCounter,e}}class Al{constructor({name:e="",description:t="",id:s="",price:r,imageUrl:i=""}={}){h(this,"description","");h(this,"price");h(this,"imageUrl","");h(this,"id","");h(this,"name","");h(this,"createdAt",new Date);this.name=e||"",this.description=t||"",this.id=s||"",this.price=r,this.imageUrl=i||""}static fromProduct(e){const t=new Al({id:e.id,description:e.description,price:e.price,imageUrl:e.imageUrl,name:e.name});return t.createdAt=e.createdAt,t}static fromJson(e,t){const s=new Al({id:t,description:e.description,price:qt.fromJson(e.price),imageUrl:e.imageUrl,name:e.name});return s.createdAt=e.createdAt,s}toJson(){return{description:this.description,price:this.price?this.price.toJson():null,imageUrl:this.imageUrl,name:this.name,createdAt:this.createdAt}}toString(){return JSON.stringify(this.toJson())}}var Q3=(n=>(n[n.scheduleSettings=0]="scheduleSettings",n[n.workSettings=1]="workSettings",n[n.customers=2]="customers",n[n.dataPermission=3]="dataPermission",n[n.waitings=4]="waitings",n[n.storyUpload=5]="storyUpload",n[n.resumePermission=6]="resumePermission",n[n.schedulePemission=7]="schedulePemission",n[n.bookingsPermission=8]="bookingsPermission",n[n.invoicesPremission=9]="invoicesPremission",n[n.paymentRequestPermmission=10]="paymentRequestPermmission",n))(Q3||{});const K3={0:"scheduleSettings",1:"workSettings",2:"customers",6:"resumePermission",3:"dataPermission",9:"invoicesPremission",4:"waitings",5:"storyUpload",7:"schedulePemission",8:"bookingsPermission",10:"paymentRequestPermmission"},j3={scheduleSettings:0,workSettings:1,customers:2,resumePermission:2,dataPermission:3,invoicesPremission:9,waitings:4,storyUpload:5,schedulePermission:7,bookingsPermission:8,paymentRequestPermission:10},X3=[0,1,2,3,4,5,6,7,8,9,10];class bl{constructor(){h(this,"map",{})}static fromJson(e){const t=new bl;return t.map={},Object.entries(e).forEach(([s,r])=>{t.map[s]=new Map,X3.forEach(i=>{t.map[s].set(i,e[s][j3[i]]??!0)})}),t}toJson(){const e={};return Object.entries(this.map).forEach(([t,s])=>{s.forEach((r,i)=>{r||(e[t]??(e[t]={}),e[t][K3[i]]=r)})}),e}}class hi{constructor({shopName:e="",businessId:t,productId:s="",adress:r="",dynamicLink:i="",revenueCatId:o="",ownersName:a="",instagramAccount:c="",shopPhone:u="",design:l}){h(this,"businesseType",Qi.Other);h(this,"currency",Rs);h(this,"notifyOnNewCustomer",!0);h(this,"searchable",!0);h(this,"billingIssue",new Map);h(this,"isLandingPageMode",!1);h(this,"allWorkersIds",new Map);h(this,"workersIds",new Map);h(this,"hypPath");h(this,"expiredDate",new Date);h(this,"workersPermissions",new bl);h(this,"shopPhone","");h(this,"ownersName","");h(this,"companyNumber","");h(this,"ownersPhone","");h(this,"masofNumber","");h(this,"previewDoc","");h(this,"instagramAccount","");h(this,"revenueCatId","");h(this,"pendingWorkersProductsId","");h(this,"adress","");h(this,"workersProductsId","");h(this,"pendingProductId","");h(this,"dynamicLink","");h(this,"shopName","");h(this,"productId","");h(this,"businessId","");h(this,"createdAt",new Date);h(this,"blockedUsersTemp",new Map);h(this,"lastTimeConnected",new Date);h(this,"businessData",new Dl);h(this,"design",new As);this.shopName=e,this.businessId=t,this.productId=s,this.adress=r,this.dynamicLink=i,this.revenueCatId=o,this.ownersName=a,this.instagramAccount=c,this.shopPhone=u,this.design=l}static empty(){return new hi({design:new As,businessId:""})}get businessPayLoadData(){return new wo({businessId:this.businessId,businessName:this.shopName,shopIcon:this.design.shopIconData})}static fromJson(e,t){const s=new hi({businessId:t,design:new As});return s.setData(e,t),s}setData(e,t){if(this.businessId=t,e.currency&&(this.currency=xs.fromJson(e.currency)),e.design)this.design=As.fromJson(e.design);else{const r=e.theme;this.design.pickedThemeKey=r,Object.entries(e.products).forEach(([i,o])=>{this.design.products.set(i,Al.fromJson(o,i))}),e.changingImages&&(this.design.changingImages=e.changingImages.map(i=>i)),e.updates&&e.updates.forEach((i,o)=>{this.design.updates.set(o.toString(),vo.fromJson(i,o.toString()))}),this.design.bottomIcons=e.bottomIcons??!1,this.design.storyTitle=e.storyTitle??"",this.design.changingImagesSwapSeconds=e.changingImagesSwapSeconds??6,this.design.shopIconUrl=e.shopIcon??""}e.workersPermissions!=null&&(this.workersPermissions=bl.fromJson(e.workersPermissions)),this.previewDoc=e.previewDoc??"",this.workersProductsId=e.workersProductsId??"",this.pendingWorkersProductsId=e.pendingWorkersProductsId??"",this.shopName=e.shopName??"",this.isLandingPageMode=e.isLandingPageMode??!1,this.searchable=e.searchable??!0,e.expiredDate!=null&&(this.expiredDate=new Date(e.expiredDate)),this.notifyOnNewCustomer=e.notifyOnNewCustomer??!0,this.companyNumber=e.companyNumber??"",e.hypPath!=null&&(this.hypPath=RF[e.hypPath]),this.allWorkersIds=new Map,e.allWorkersIds!=null&&Object.entries(e.allWorkersIds).forEach(([r,i])=>{this.allWorkersIds.set(r,i)});const s=this.businessId.split("--")[0];this.allWorkersIds.hasOwnProperty("+"+s)||this.allWorkersIds.set("+"+s,""),this.workersIds=new Map,e.workersIds!=null&&Object.entries(e.workersIds).forEach(([r,i])=>{this.workersIds.set(r,i)}),this.workersIds.hasOwnProperty(s)||this.workersIds.set(s,""),this.dynamicLink=e.dynamicLink??"",this.masofNumber=e.masofNumber??"",this.ownersName=e.ownersName??"",this.revenueCatId=e.revenueCatId??"",this.productId=e.productId??"",this.pendingProductId=e.pendingProductId??"",this.businesseType=AI[e.businesseType]??Qi.Other,this.instagramAccount=e.instagramAccount??"",this.adress=e.adress??"",this.shopPhone=e.shopPhone??"";try{e.billingIssue!=null&&Object.entries(e.billingIssue).forEach(([r,i])=>{this.billingIssue.set(r,i.toDate())})}catch{}e.createdAt instanceof Be?this.createdAt=e.createdAt.toDate():typeof e.createdAt=="string"&&(this.createdAt=new Date(e.createdAt)||new Date),e.lastTimeConnected!=null&&(this.lastTimeConnected=new Date(e.lastTimeConnected)||new Date)}toJson(){const e={};return e.notifyOnNewCustomer=this.notifyOnNewCustomer,e.currency=this.currency.toJson(),e.searchable=this.searchable,e.workersProductsId=this.workersProductsId,e.pendingWorkersProductsId=this.pendingWorkersProductsId,e.previewDoc=this.previewDoc,e.masofNumber=this.masofNumber,e.revenueCatId=this.revenueCatId,e.pendingProductId=this.pendingProductId,e.productId=this.productId,e.shopName=this.shopName,this.hypPath&&(e.hypPath=this.hypPath),this.billingIssue.size>0&&(e.billingIssue={},this.billingIssue.forEach((t,s)=>{e.billingIssue[s]=Be.fromDate(t)})),this.dynamicLink!==""&&(e.dynamicLink=this.dynamicLink),e.companyNumber=this.companyNumber,e.expiredDate=this.expiredDate,e.businesseType=this.businesseType,e.ownersName=this.ownersName,e.instagramAccount=this.instagramAccount,e.adress=this.adress,e.shopPhone=this.shopPhone,e.workersPermissions=this.workersPermissions.toJson(),e.workersIds=this.workersIds,e.createdAt=this.createdAt,e.lastTimeConnected=this.lastTimeConnected,this.isLandingPageMode&&(e.isLandingPageMode=this.isLandingPageMode),e.design=this.design.toJson(),e}toString(){return JSON.stringify(this.toJson())}}class Ma{constructor({businessId:e,shopPhone:t,type:s,adress:r,ownerName:i,iconUrl:o,businessName:a}){h(this,"businessName","");h(this,"iconUrl","");h(this,"businessId","");h(this,"type",Qi.Other);h(this,"adress","");h(this,"ownerName","");h(this,"shopPhone","");this.businessId=e,this.shopPhone=t,this.type=s,this.adress=r,this.ownerName=i,this.iconUrl=o,this.businessName=a}static empty(){return new Ma({businessId:"",shopPhone:"",type:Qi.Other,adress:"",ownerName:"",iconUrl:"",businessName:""})}static fromJson(e,t){const s=e.businessName||"",r=e.iconUrl||"",i=AI[e.T]||Qi.Other,o=e.ON||"",a=e.SP||"",c=e.A||"";return new Ma({businessId:t,shopPhone:a,type:i,adress:c,ownerName:o,iconUrl:r,businessName:s})}get toBusinessModel(){const e=new hi({businessId:this.businessId,design:new As({shopIconUrl:this.iconUrl})});return e.ownersName=this.ownerName,e.shopPhone=this.shopPhone,e.shopName=this.businessName,e.adress=this.adress,e.businesseType=this.type,e}static fromBusinessInfo(e){return new Ma({businessId:e.businessId,shopPhone:e.shopPhone,type:e.type,adress:e.adress,ownerName:e.ownerName,iconUrl:e.iconUrl,businessName:e.businessName})}toJson(){const e={};return e.businessName=this.businessName,e.iconUrl=this.iconUrl,e.ON=this.ownerName,e.SP=this.shopPhone,e.A=this.adress,e.T=SF[this.type],e}isTheSame(e){return e.iconUrl===this.iconUrl&&e.ownerName===this.ownerName&&e.shopPhone===this.shopPhone&&e.adress===this.adress&&e.type===this.type&&e.businessName===this.businessName}toString(){return JSON.stringify(this.toJson())}}var $1={exports:{}};function Z3(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Bd={exports:{}};const eL={},tL=Object.freeze(Object.defineProperty({__proto__:null,default:eL},Symbol.toStringTag,{value:"Module"})),nL=aA(tL);var av;function ve(){return av||(av=1,function(n,e){(function(t,s){n.exports=s()})(ue,function(){var t=t||function(s,r){var i;if(typeof window<"u"&&window.crypto&&(i=window.crypto),typeof self<"u"&&self.crypto&&(i=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(i=globalThis.crypto),!i&&typeof window<"u"&&window.msCrypto&&(i=window.msCrypto),!i&&typeof ue<"u"&&ue.crypto&&(i=ue.crypto),!i&&typeof Z3=="function")try{i=nL}catch{}var o=function(){if(i){if(typeof i.getRandomValues=="function")try{return i.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof i.randomBytes=="function")try{return i.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},a=Object.create||function(){function _(){}return function(v){var w;return _.prototype=v,w=new _,_.prototype=null,w}}(),c={},u=c.lib={},l=u.Base=function(){return{extend:function(_){var v=a(this);return _&&v.mixIn(_),(!v.hasOwnProperty("init")||this.init===v.init)&&(v.init=function(){v.$super.init.apply(this,arguments)}),v.init.prototype=v,v.$super=this,v},create:function(){var _=this.extend();return _.init.apply(_,arguments),_},init:function(){},mixIn:function(_){for(var v in _)_.hasOwnProperty(v)&&(this[v]=_[v]);_.hasOwnProperty("toString")&&(this.toString=_.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),d=u.WordArray=l.extend({init:function(_,v){_=this.words=_||[],v!=r?this.sigBytes=v:this.sigBytes=_.length*4},toString:function(_){return(_||m).stringify(this)},concat:function(_){var v=this.words,w=_.words,I=this.sigBytes,D=_.sigBytes;if(this.clamp(),I%4)for(var E=0;E<D;E++){var A=w[E>>>2]>>>24-E%4*8&255;v[I+E>>>2]|=A<<24-(I+E)%4*8}else for(var C=0;C<D;C+=4)v[I+C>>>2]=w[C>>>2];return this.sigBytes+=D,this},clamp:function(){var _=this.words,v=this.sigBytes;_[v>>>2]&=4294967295<<32-v%4*8,_.length=s.ceil(v/4)},clone:function(){var _=l.clone.call(this);return _.words=this.words.slice(0),_},random:function(_){for(var v=[],w=0;w<_;w+=4)v.push(o());return new d.init(v,_)}}),f=c.enc={},m=f.Hex={stringify:function(_){for(var v=_.words,w=_.sigBytes,I=[],D=0;D<w;D++){var E=v[D>>>2]>>>24-D%4*8&255;I.push((E>>>4).toString(16)),I.push((E&15).toString(16))}return I.join("")},parse:function(_){for(var v=_.length,w=[],I=0;I<v;I+=2)w[I>>>3]|=parseInt(_.substr(I,2),16)<<24-I%8*4;return new d.init(w,v/2)}},p=f.Latin1={stringify:function(_){for(var v=_.words,w=_.sigBytes,I=[],D=0;D<w;D++){var E=v[D>>>2]>>>24-D%4*8&255;I.push(String.fromCharCode(E))}return I.join("")},parse:function(_){for(var v=_.length,w=[],I=0;I<v;I++)w[I>>>2]|=(_.charCodeAt(I)&255)<<24-I%4*8;return new d.init(w,v)}},y=f.Utf8={stringify:function(_){try{return decodeURIComponent(escape(p.stringify(_)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(_){return p.parse(unescape(encodeURIComponent(_)))}},g=u.BufferedBlockAlgorithm=l.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(_){typeof _=="string"&&(_=y.parse(_)),this._data.concat(_),this._nDataBytes+=_.sigBytes},_process:function(_){var v,w=this._data,I=w.words,D=w.sigBytes,E=this.blockSize,A=E*4,C=D/A;_?C=s.ceil(C):C=s.max((C|0)-this._minBufferSize,0);var T=C*E,b=s.min(T*4,D);if(T){for(var k=0;k<T;k+=E)this._doProcessBlock(I,k);v=I.splice(0,T),w.sigBytes-=b}return new d.init(v,b)},clone:function(){var _=l.clone.call(this);return _._data=this._data.clone(),_},_minBufferSize:0});u.Hasher=g.extend({cfg:l.extend(),init:function(_){this.cfg=this.cfg.extend(_),this.reset()},reset:function(){g.reset.call(this),this._doReset()},update:function(_){return this._append(_),this._process(),this},finalize:function(_){_&&this._append(_);var v=this._doFinalize();return v},blockSize:16,_createHelper:function(_){return function(v,w){return new _.init(w).finalize(v)}},_createHmacHelper:function(_){return function(v,w){return new x.HMAC.init(_,w).finalize(v)}}});var x=c.algo={};return c}(Math);return t})}(Bd)),Bd.exports}var Ld={exports:{}},cv;function $h(){return cv||(cv=1,function(n,e){(function(t,s){n.exports=s(ve())})(ue,function(t){return function(s){var r=t,i=r.lib,o=i.Base,a=i.WordArray,c=r.x64={};c.Word=o.extend({init:function(u,l){this.high=u,this.low=l}}),c.WordArray=o.extend({init:function(u,l){u=this.words=u||[],l!=s?this.sigBytes=l:this.sigBytes=u.length*8},toX32:function(){for(var u=this.words,l=u.length,d=[],f=0;f<l;f++){var m=u[f];d.push(m.high),d.push(m.low)}return a.create(d,this.sigBytes)},clone:function(){for(var u=o.clone.call(this),l=u.words=this.words.slice(0),d=l.length,f=0;f<d;f++)l[f]=l[f].clone();return u}})}(),t})}(Ld)),Ld.exports}var Vd={exports:{}},uv;function sL(){return uv||(uv=1,function(n,e){(function(t,s){n.exports=s(ve())})(ue,function(t){return function(){if(typeof ArrayBuffer=="function"){var s=t,r=s.lib,i=r.WordArray,o=i.init,a=i.init=function(c){if(c instanceof ArrayBuffer&&(c=new Uint8Array(c)),(c instanceof Int8Array||typeof Uint8ClampedArray<"u"&&c instanceof Uint8ClampedArray||c instanceof Int16Array||c instanceof Uint16Array||c instanceof Int32Array||c instanceof Uint32Array||c instanceof Float32Array||c instanceof Float64Array)&&(c=new Uint8Array(c.buffer,c.byteOffset,c.byteLength)),c instanceof Uint8Array){for(var u=c.byteLength,l=[],d=0;d<u;d++)l[d>>>2]|=c[d]<<24-d%4*8;o.call(this,l,u)}else o.apply(this,arguments)};a.prototype=i}}(),t.lib.WordArray})}(Vd)),Vd.exports}var Ud={exports:{}},lv;function rL(){return lv||(lv=1,function(n,e){(function(t,s){n.exports=s(ve())})(ue,function(t){return function(){var s=t,r=s.lib,i=r.WordArray,o=s.enc;o.Utf16=o.Utf16BE={stringify:function(c){for(var u=c.words,l=c.sigBytes,d=[],f=0;f<l;f+=2){var m=u[f>>>2]>>>16-f%4*8&65535;d.push(String.fromCharCode(m))}return d.join("")},parse:function(c){for(var u=c.length,l=[],d=0;d<u;d++)l[d>>>1]|=c.charCodeAt(d)<<16-d%2*16;return i.create(l,u*2)}},o.Utf16LE={stringify:function(c){for(var u=c.words,l=c.sigBytes,d=[],f=0;f<l;f+=2){var m=a(u[f>>>2]>>>16-f%4*8&65535);d.push(String.fromCharCode(m))}return d.join("")},parse:function(c){for(var u=c.length,l=[],d=0;d<u;d++)l[d>>>1]|=a(c.charCodeAt(d)<<16-d%2*16);return i.create(l,u*2)}};function a(c){return c<<8&4278255360|c>>>8&16711935}}(),t.enc.Utf16})}(Ud)),Ud.exports}var Wd={exports:{}},hv;function xi(){return hv||(hv=1,function(n,e){(function(t,s){n.exports=s(ve())})(ue,function(t){return function(){var s=t,r=s.lib,i=r.WordArray,o=s.enc;o.Base64={stringify:function(c){var u=c.words,l=c.sigBytes,d=this._map;c.clamp();for(var f=[],m=0;m<l;m+=3)for(var p=u[m>>>2]>>>24-m%4*8&255,y=u[m+1>>>2]>>>24-(m+1)%4*8&255,g=u[m+2>>>2]>>>24-(m+2)%4*8&255,x=p<<16|y<<8|g,_=0;_<4&&m+_*.75<l;_++)f.push(d.charAt(x>>>6*(3-_)&63));var v=d.charAt(64);if(v)for(;f.length%4;)f.push(v);return f.join("")},parse:function(c){var u=c.length,l=this._map,d=this._reverseMap;if(!d){d=this._reverseMap=[];for(var f=0;f<l.length;f++)d[l.charCodeAt(f)]=f}var m=l.charAt(64);if(m){var p=c.indexOf(m);p!==-1&&(u=p)}return a(c,u,d)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function a(c,u,l){for(var d=[],f=0,m=0;m<u;m++)if(m%4){var p=l[c.charCodeAt(m-1)]<<m%4*2,y=l[c.charCodeAt(m)]>>>6-m%4*2,g=p|y;d[f>>>2]|=g<<24-f%4*8,f++}return i.create(d,f)}}(),t.enc.Base64})}(Wd)),Wd.exports}var Hd={exports:{}},dv;function iL(){return dv||(dv=1,function(n,e){(function(t,s){n.exports=s(ve())})(ue,function(t){return function(){var s=t,r=s.lib,i=r.WordArray,o=s.enc;o.Base64url={stringify:function(c,u){u===void 0&&(u=!0);var l=c.words,d=c.sigBytes,f=u?this._safe_map:this._map;c.clamp();for(var m=[],p=0;p<d;p+=3)for(var y=l[p>>>2]>>>24-p%4*8&255,g=l[p+1>>>2]>>>24-(p+1)%4*8&255,x=l[p+2>>>2]>>>24-(p+2)%4*8&255,_=y<<16|g<<8|x,v=0;v<4&&p+v*.75<d;v++)m.push(f.charAt(_>>>6*(3-v)&63));var w=f.charAt(64);if(w)for(;m.length%4;)m.push(w);return m.join("")},parse:function(c,u){u===void 0&&(u=!0);var l=c.length,d=u?this._safe_map:this._map,f=this._reverseMap;if(!f){f=this._reverseMap=[];for(var m=0;m<d.length;m++)f[d.charCodeAt(m)]=m}var p=d.charAt(64);if(p){var y=c.indexOf(p);y!==-1&&(l=y)}return a(c,l,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function a(c,u,l){for(var d=[],f=0,m=0;m<u;m++)if(m%4){var p=l[c.charCodeAt(m-1)]<<m%4*2,y=l[c.charCodeAt(m)]>>>6-m%4*2,g=p|y;d[f>>>2]|=g<<24-f%4*8,f++}return i.create(d,f)}}(),t.enc.Base64url})}(Hd)),Hd.exports}var $d={exports:{}},fv;function Ei(){return fv||(fv=1,function(n,e){(function(t,s){n.exports=s(ve())})(ue,function(t){return function(s){var r=t,i=r.lib,o=i.WordArray,a=i.Hasher,c=r.algo,u=[];(function(){for(var y=0;y<64;y++)u[y]=s.abs(s.sin(y+1))*4294967296|0})();var l=c.MD5=a.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(y,g){for(var x=0;x<16;x++){var _=g+x,v=y[_];y[_]=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360}var w=this._hash.words,I=y[g+0],D=y[g+1],E=y[g+2],A=y[g+3],C=y[g+4],T=y[g+5],b=y[g+6],k=y[g+7],P=y[g+8],z=y[g+9],K=y[g+10],ce=y[g+11],$e=y[g+12],Se=y[g+13],Le=y[g+14],Ne=y[g+15],S=w[0],O=w[1],F=w[2],N=w[3];S=d(S,O,F,N,I,7,u[0]),N=d(N,S,O,F,D,12,u[1]),F=d(F,N,S,O,E,17,u[2]),O=d(O,F,N,S,A,22,u[3]),S=d(S,O,F,N,C,7,u[4]),N=d(N,S,O,F,T,12,u[5]),F=d(F,N,S,O,b,17,u[6]),O=d(O,F,N,S,k,22,u[7]),S=d(S,O,F,N,P,7,u[8]),N=d(N,S,O,F,z,12,u[9]),F=d(F,N,S,O,K,17,u[10]),O=d(O,F,N,S,ce,22,u[11]),S=d(S,O,F,N,$e,7,u[12]),N=d(N,S,O,F,Se,12,u[13]),F=d(F,N,S,O,Le,17,u[14]),O=d(O,F,N,S,Ne,22,u[15]),S=f(S,O,F,N,D,5,u[16]),N=f(N,S,O,F,b,9,u[17]),F=f(F,N,S,O,ce,14,u[18]),O=f(O,F,N,S,I,20,u[19]),S=f(S,O,F,N,T,5,u[20]),N=f(N,S,O,F,K,9,u[21]),F=f(F,N,S,O,Ne,14,u[22]),O=f(O,F,N,S,C,20,u[23]),S=f(S,O,F,N,z,5,u[24]),N=f(N,S,O,F,Le,9,u[25]),F=f(F,N,S,O,A,14,u[26]),O=f(O,F,N,S,P,20,u[27]),S=f(S,O,F,N,Se,5,u[28]),N=f(N,S,O,F,E,9,u[29]),F=f(F,N,S,O,k,14,u[30]),O=f(O,F,N,S,$e,20,u[31]),S=m(S,O,F,N,T,4,u[32]),N=m(N,S,O,F,P,11,u[33]),F=m(F,N,S,O,ce,16,u[34]),O=m(O,F,N,S,Le,23,u[35]),S=m(S,O,F,N,D,4,u[36]),N=m(N,S,O,F,C,11,u[37]),F=m(F,N,S,O,k,16,u[38]),O=m(O,F,N,S,K,23,u[39]),S=m(S,O,F,N,Se,4,u[40]),N=m(N,S,O,F,I,11,u[41]),F=m(F,N,S,O,A,16,u[42]),O=m(O,F,N,S,b,23,u[43]),S=m(S,O,F,N,z,4,u[44]),N=m(N,S,O,F,$e,11,u[45]),F=m(F,N,S,O,Ne,16,u[46]),O=m(O,F,N,S,E,23,u[47]),S=p(S,O,F,N,I,6,u[48]),N=p(N,S,O,F,k,10,u[49]),F=p(F,N,S,O,Le,15,u[50]),O=p(O,F,N,S,T,21,u[51]),S=p(S,O,F,N,$e,6,u[52]),N=p(N,S,O,F,A,10,u[53]),F=p(F,N,S,O,K,15,u[54]),O=p(O,F,N,S,D,21,u[55]),S=p(S,O,F,N,P,6,u[56]),N=p(N,S,O,F,Ne,10,u[57]),F=p(F,N,S,O,b,15,u[58]),O=p(O,F,N,S,Se,21,u[59]),S=p(S,O,F,N,C,6,u[60]),N=p(N,S,O,F,ce,10,u[61]),F=p(F,N,S,O,E,15,u[62]),O=p(O,F,N,S,z,21,u[63]),w[0]=w[0]+S|0,w[1]=w[1]+O|0,w[2]=w[2]+F|0,w[3]=w[3]+N|0},_doFinalize:function(){var y=this._data,g=y.words,x=this._nDataBytes*8,_=y.sigBytes*8;g[_>>>5]|=128<<24-_%32;var v=s.floor(x/4294967296),w=x;g[(_+64>>>9<<4)+15]=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,g[(_+64>>>9<<4)+14]=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,y.sigBytes=(g.length+1)*4,this._process();for(var I=this._hash,D=I.words,E=0;E<4;E++){var A=D[E];D[E]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360}return I},clone:function(){var y=a.clone.call(this);return y._hash=this._hash.clone(),y}});function d(y,g,x,_,v,w,I){var D=y+(g&x|~g&_)+v+I;return(D<<w|D>>>32-w)+g}function f(y,g,x,_,v,w,I){var D=y+(g&_|x&~_)+v+I;return(D<<w|D>>>32-w)+g}function m(y,g,x,_,v,w,I){var D=y+(g^x^_)+v+I;return(D<<w|D>>>32-w)+g}function p(y,g,x,_,v,w,I){var D=y+(x^(g|~_))+v+I;return(D<<w|D>>>32-w)+g}r.MD5=a._createHelper(l),r.HmacMD5=a._createHmacHelper(l)}(Math),t.MD5})}($d)),$d.exports}var qd={exports:{}},mv;function q1(){return mv||(mv=1,function(n,e){(function(t,s){n.exports=s(ve())})(ue,function(t){return function(){var s=t,r=s.lib,i=r.WordArray,o=r.Hasher,a=s.algo,c=[],u=a.SHA1=o.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(l,d){for(var f=this._hash.words,m=f[0],p=f[1],y=f[2],g=f[3],x=f[4],_=0;_<80;_++){if(_<16)c[_]=l[d+_]|0;else{var v=c[_-3]^c[_-8]^c[_-14]^c[_-16];c[_]=v<<1|v>>>31}var w=(m<<5|m>>>27)+x+c[_];_<20?w+=(p&y|~p&g)+1518500249:_<40?w+=(p^y^g)+1859775393:_<60?w+=(p&y|p&g|y&g)-1894007588:w+=(p^y^g)-899497514,x=g,g=y,y=p<<30|p>>>2,p=m,m=w}f[0]=f[0]+m|0,f[1]=f[1]+p|0,f[2]=f[2]+y|0,f[3]=f[3]+g|0,f[4]=f[4]+x|0},_doFinalize:function(){var l=this._data,d=l.words,f=this._nDataBytes*8,m=l.sigBytes*8;return d[m>>>5]|=128<<24-m%32,d[(m+64>>>9<<4)+14]=Math.floor(f/4294967296),d[(m+64>>>9<<4)+15]=f,l.sigBytes=d.length*4,this._process(),this._hash},clone:function(){var l=o.clone.call(this);return l._hash=this._hash.clone(),l}});s.SHA1=o._createHelper(u),s.HmacSHA1=o._createHmacHelper(u)}(),t.SHA1})}(qd)),qd.exports}var Yd={exports:{}},pv;function og(){return pv||(pv=1,function(n,e){(function(t,s){n.exports=s(ve())})(ue,function(t){return function(s){var r=t,i=r.lib,o=i.WordArray,a=i.Hasher,c=r.algo,u=[],l=[];(function(){function m(x){for(var _=s.sqrt(x),v=2;v<=_;v++)if(!(x%v))return!1;return!0}function p(x){return(x-(x|0))*4294967296|0}for(var y=2,g=0;g<64;)m(y)&&(g<8&&(u[g]=p(s.pow(y,1/2))),l[g]=p(s.pow(y,1/3)),g++),y++})();var d=[],f=c.SHA256=a.extend({_doReset:function(){this._hash=new o.init(u.slice(0))},_doProcessBlock:function(m,p){for(var y=this._hash.words,g=y[0],x=y[1],_=y[2],v=y[3],w=y[4],I=y[5],D=y[6],E=y[7],A=0;A<64;A++){if(A<16)d[A]=m[p+A]|0;else{var C=d[A-15],T=(C<<25|C>>>7)^(C<<14|C>>>18)^C>>>3,b=d[A-2],k=(b<<15|b>>>17)^(b<<13|b>>>19)^b>>>10;d[A]=T+d[A-7]+k+d[A-16]}var P=w&I^~w&D,z=g&x^g&_^x&_,K=(g<<30|g>>>2)^(g<<19|g>>>13)^(g<<10|g>>>22),ce=(w<<26|w>>>6)^(w<<21|w>>>11)^(w<<7|w>>>25),$e=E+ce+P+l[A]+d[A],Se=K+z;E=D,D=I,I=w,w=v+$e|0,v=_,_=x,x=g,g=$e+Se|0}y[0]=y[0]+g|0,y[1]=y[1]+x|0,y[2]=y[2]+_|0,y[3]=y[3]+v|0,y[4]=y[4]+w|0,y[5]=y[5]+I|0,y[6]=y[6]+D|0,y[7]=y[7]+E|0},_doFinalize:function(){var m=this._data,p=m.words,y=this._nDataBytes*8,g=m.sigBytes*8;return p[g>>>5]|=128<<24-g%32,p[(g+64>>>9<<4)+14]=s.floor(y/4294967296),p[(g+64>>>9<<4)+15]=y,m.sigBytes=p.length*4,this._process(),this._hash},clone:function(){var m=a.clone.call(this);return m._hash=this._hash.clone(),m}});r.SHA256=a._createHelper(f),r.HmacSHA256=a._createHmacHelper(f)}(Math),t.SHA256})}(Yd)),Yd.exports}var zd={exports:{}},gv;function oL(){return gv||(gv=1,function(n,e){(function(t,s,r){n.exports=s(ve(),og())})(ue,function(t){return function(){var s=t,r=s.lib,i=r.WordArray,o=s.algo,a=o.SHA256,c=o.SHA224=a.extend({_doReset:function(){this._hash=new i.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var u=a._doFinalize.call(this);return u.sigBytes-=4,u}});s.SHA224=a._createHelper(c),s.HmacSHA224=a._createHmacHelper(c)}(),t.SHA224})}(zd)),zd.exports}var Gd={exports:{}},yv;function Y1(){return yv||(yv=1,function(n,e){(function(t,s,r){n.exports=s(ve(),$h())})(ue,function(t){return function(){var s=t,r=s.lib,i=r.Hasher,o=s.x64,a=o.Word,c=o.WordArray,u=s.algo;function l(){return a.create.apply(a,arguments)}var d=[l(1116352408,3609767458),l(1899447441,602891725),l(3049323471,3964484399),l(3921009573,2173295548),l(961987163,4081628472),l(1508970993,3053834265),l(2453635748,2937671579),l(2870763221,3664609560),l(3624381080,2734883394),l(310598401,1164996542),l(607225278,1323610764),l(1426881987,3590304994),l(1925078388,4068182383),l(2162078206,991336113),l(2614888103,633803317),l(3248222580,3479774868),l(3835390401,2666613458),l(4022224774,944711139),l(264347078,2341262773),l(604807628,2007800933),l(770255983,1495990901),l(1249150122,1856431235),l(1555081692,3175218132),l(1996064986,2198950837),l(2554220882,3999719339),l(2821834349,766784016),l(2952996808,2566594879),l(3210313671,3203337956),l(3336571891,1034457026),l(3584528711,2466948901),l(113926993,3758326383),l(338241895,168717936),l(666307205,1188179964),l(773529912,1546045734),l(1294757372,1522805485),l(1396182291,2643833823),l(1695183700,2343527390),l(1986661051,1014477480),l(2177026350,1206759142),l(2456956037,344077627),l(2730485921,1290863460),l(2820302411,3158454273),l(3259730800,3505952657),l(3345764771,106217008),l(3516065817,3606008344),l(3600352804,1432725776),l(4094571909,1467031594),l(275423344,851169720),l(430227734,3100823752),l(506948616,1363258195),l(659060556,3750685593),l(883997877,3785050280),l(958139571,3318307427),l(1322822218,3812723403),l(1537002063,2003034995),l(1747873779,3602036899),l(1955562222,1575990012),l(2024104815,1125592928),l(2227730452,2716904306),l(2361852424,442776044),l(2428436474,593698344),l(2756734187,3733110249),l(3204031479,2999351573),l(3329325298,3815920427),l(3391569614,3928383900),l(3515267271,566280711),l(3940187606,3454069534),l(4118630271,4000239992),l(116418474,1914138554),l(174292421,2731055270),l(289380356,3203993006),l(460393269,320620315),l(685471733,587496836),l(852142971,1086792851),l(1017036298,365543100),l(1126000580,2618297676),l(1288033470,3409855158),l(1501505948,4234509866),l(1607167915,987167468),l(1816402316,1246189591)],f=[];(function(){for(var p=0;p<80;p++)f[p]=l()})();var m=u.SHA512=i.extend({_doReset:function(){this._hash=new c.init([new a.init(1779033703,4089235720),new a.init(3144134277,2227873595),new a.init(1013904242,4271175723),new a.init(2773480762,1595750129),new a.init(1359893119,2917565137),new a.init(2600822924,725511199),new a.init(528734635,4215389547),new a.init(1541459225,327033209)])},_doProcessBlock:function(p,y){for(var g=this._hash.words,x=g[0],_=g[1],v=g[2],w=g[3],I=g[4],D=g[5],E=g[6],A=g[7],C=x.high,T=x.low,b=_.high,k=_.low,P=v.high,z=v.low,K=w.high,ce=w.low,$e=I.high,Se=I.low,Le=D.high,Ne=D.low,S=E.high,O=E.low,F=A.high,N=A.low,Ge=C,Ve=T,nn=b,le=k,Ko=P,Ii=z,ed=K,jo=ce,Nn=$e,fn=Se,iu=Le,Xo=Ne,ou=S,Zo=O,td=F,ea=N,Mn=0;Mn<80;Mn++){var xn,Ks,au=f[Mn];if(Mn<16)Ks=au.high=p[y+Mn*2]|0,xn=au.low=p[y+Mn*2+1]|0;else{var Mg=f[Mn-15],Di=Mg.high,ta=Mg.low,zD=(Di>>>1|ta<<31)^(Di>>>8|ta<<24)^Di>>>7,Og=(ta>>>1|Di<<31)^(ta>>>8|Di<<24)^(ta>>>7|Di<<25),Fg=f[Mn-2],Ai=Fg.high,na=Fg.low,GD=(Ai>>>19|na<<13)^(Ai<<3|na>>>29)^Ai>>>6,Bg=(na>>>19|Ai<<13)^(na<<3|Ai>>>29)^(na>>>6|Ai<<26),Lg=f[Mn-7],JD=Lg.high,QD=Lg.low,Vg=f[Mn-16],KD=Vg.high,Ug=Vg.low;xn=Og+QD,Ks=zD+JD+(xn>>>0<Og>>>0?1:0),xn=xn+Bg,Ks=Ks+GD+(xn>>>0<Bg>>>0?1:0),xn=xn+Ug,Ks=Ks+KD+(xn>>>0<Ug>>>0?1:0),au.high=Ks,au.low=xn}var jD=Nn&iu^~Nn&ou,Wg=fn&Xo^~fn&Zo,XD=Ge&nn^Ge&Ko^nn&Ko,ZD=Ve&le^Ve&Ii^le&Ii,eA=(Ge>>>28|Ve<<4)^(Ge<<30|Ve>>>2)^(Ge<<25|Ve>>>7),Hg=(Ve>>>28|Ge<<4)^(Ve<<30|Ge>>>2)^(Ve<<25|Ge>>>7),tA=(Nn>>>14|fn<<18)^(Nn>>>18|fn<<14)^(Nn<<23|fn>>>9),nA=(fn>>>14|Nn<<18)^(fn>>>18|Nn<<14)^(fn<<23|Nn>>>9),$g=d[Mn],sA=$g.high,qg=$g.low,mn=ea+nA,js=td+tA+(mn>>>0<ea>>>0?1:0),mn=mn+Wg,js=js+jD+(mn>>>0<Wg>>>0?1:0),mn=mn+qg,js=js+sA+(mn>>>0<qg>>>0?1:0),mn=mn+xn,js=js+Ks+(mn>>>0<xn>>>0?1:0),Yg=Hg+ZD,rA=eA+XD+(Yg>>>0<Hg>>>0?1:0);td=ou,ea=Zo,ou=iu,Zo=Xo,iu=Nn,Xo=fn,fn=jo+mn|0,Nn=ed+js+(fn>>>0<jo>>>0?1:0)|0,ed=Ko,jo=Ii,Ko=nn,Ii=le,nn=Ge,le=Ve,Ve=mn+Yg|0,Ge=js+rA+(Ve>>>0<mn>>>0?1:0)|0}T=x.low=T+Ve,x.high=C+Ge+(T>>>0<Ve>>>0?1:0),k=_.low=k+le,_.high=b+nn+(k>>>0<le>>>0?1:0),z=v.low=z+Ii,v.high=P+Ko+(z>>>0<Ii>>>0?1:0),ce=w.low=ce+jo,w.high=K+ed+(ce>>>0<jo>>>0?1:0),Se=I.low=Se+fn,I.high=$e+Nn+(Se>>>0<fn>>>0?1:0),Ne=D.low=Ne+Xo,D.high=Le+iu+(Ne>>>0<Xo>>>0?1:0),O=E.low=O+Zo,E.high=S+ou+(O>>>0<Zo>>>0?1:0),N=A.low=N+ea,A.high=F+td+(N>>>0<ea>>>0?1:0)},_doFinalize:function(){var p=this._data,y=p.words,g=this._nDataBytes*8,x=p.sigBytes*8;y[x>>>5]|=128<<24-x%32,y[(x+128>>>10<<5)+30]=Math.floor(g/4294967296),y[(x+128>>>10<<5)+31]=g,p.sigBytes=y.length*4,this._process();var _=this._hash.toX32();return _},clone:function(){var p=i.clone.call(this);return p._hash=this._hash.clone(),p},blockSize:1024/32});s.SHA512=i._createHelper(m),s.HmacSHA512=i._createHmacHelper(m)}(),t.SHA512})}(Gd)),Gd.exports}var Jd={exports:{}},_v;function aL(){return _v||(_v=1,function(n,e){(function(t,s,r){n.exports=s(ve(),$h(),Y1())})(ue,function(t){return function(){var s=t,r=s.x64,i=r.Word,o=r.WordArray,a=s.algo,c=a.SHA512,u=a.SHA384=c.extend({_doReset:function(){this._hash=new o.init([new i.init(3418070365,3238371032),new i.init(1654270250,914150663),new i.init(2438529370,812702999),new i.init(355462360,4144912697),new i.init(1731405415,4290775857),new i.init(2394180231,1750603025),new i.init(3675008525,1694076839),new i.init(1203062813,3204075428)])},_doFinalize:function(){var l=c._doFinalize.call(this);return l.sigBytes-=16,l}});s.SHA384=c._createHelper(u),s.HmacSHA384=c._createHmacHelper(u)}(),t.SHA384})}(Jd)),Jd.exports}var Qd={exports:{}},vv;function cL(){return vv||(vv=1,function(n,e){(function(t,s,r){n.exports=s(ve(),$h())})(ue,function(t){return function(s){var r=t,i=r.lib,o=i.WordArray,a=i.Hasher,c=r.x64,u=c.Word,l=r.algo,d=[],f=[],m=[];(function(){for(var g=1,x=0,_=0;_<24;_++){d[g+5*x]=(_+1)*(_+2)/2%64;var v=x%5,w=(2*g+3*x)%5;g=v,x=w}for(var g=0;g<5;g++)for(var x=0;x<5;x++)f[g+5*x]=x+(2*g+3*x)%5*5;for(var I=1,D=0;D<24;D++){for(var E=0,A=0,C=0;C<7;C++){if(I&1){var T=(1<<C)-1;T<32?A^=1<<T:E^=1<<T-32}I&128?I=I<<1^113:I<<=1}m[D]=u.create(E,A)}})();var p=[];(function(){for(var g=0;g<25;g++)p[g]=u.create()})();var y=l.SHA3=a.extend({cfg:a.cfg.extend({outputLength:512}),_doReset:function(){for(var g=this._state=[],x=0;x<25;x++)g[x]=new u.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(g,x){for(var _=this._state,v=this.blockSize/2,w=0;w<v;w++){var I=g[x+2*w],D=g[x+2*w+1];I=(I<<8|I>>>24)&16711935|(I<<24|I>>>8)&4278255360,D=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360;var E=_[w];E.high^=D,E.low^=I}for(var A=0;A<24;A++){for(var C=0;C<5;C++){for(var T=0,b=0,k=0;k<5;k++){var E=_[C+5*k];T^=E.high,b^=E.low}var P=p[C];P.high=T,P.low=b}for(var C=0;C<5;C++)for(var z=p[(C+4)%5],K=p[(C+1)%5],ce=K.high,$e=K.low,T=z.high^(ce<<1|$e>>>31),b=z.low^($e<<1|ce>>>31),k=0;k<5;k++){var E=_[C+5*k];E.high^=T,E.low^=b}for(var Se=1;Se<25;Se++){var T,b,E=_[Se],Le=E.high,Ne=E.low,S=d[Se];S<32?(T=Le<<S|Ne>>>32-S,b=Ne<<S|Le>>>32-S):(T=Ne<<S-32|Le>>>64-S,b=Le<<S-32|Ne>>>64-S);var O=p[f[Se]];O.high=T,O.low=b}var F=p[0],N=_[0];F.high=N.high,F.low=N.low;for(var C=0;C<5;C++)for(var k=0;k<5;k++){var Se=C+5*k,E=_[Se],Ge=p[Se],Ve=p[(C+1)%5+5*k],nn=p[(C+2)%5+5*k];E.high=Ge.high^~Ve.high&nn.high,E.low=Ge.low^~Ve.low&nn.low}var E=_[0],le=m[A];E.high^=le.high,E.low^=le.low}},_doFinalize:function(){var g=this._data,x=g.words;this._nDataBytes*8;var _=g.sigBytes*8,v=this.blockSize*32;x[_>>>5]|=1<<24-_%32,x[(s.ceil((_+1)/v)*v>>>5)-1]|=128,g.sigBytes=x.length*4,this._process();for(var w=this._state,I=this.cfg.outputLength/8,D=I/8,E=[],A=0;A<D;A++){var C=w[A],T=C.high,b=C.low;T=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,b=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,E.push(b),E.push(T)}return new o.init(E,I)},clone:function(){for(var g=a.clone.call(this),x=g._state=this._state.slice(0),_=0;_<25;_++)x[_]=x[_].clone();return g}});r.SHA3=a._createHelper(y),r.HmacSHA3=a._createHmacHelper(y)}(Math),t.SHA3})}(Qd)),Qd.exports}var Kd={exports:{}},wv;function uL(){return wv||(wv=1,function(n,e){(function(t,s){n.exports=s(ve())})(ue,function(t){/** @preserve
			(c) 2012 by Cdric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(s){var r=t,i=r.lib,o=i.WordArray,a=i.Hasher,c=r.algo,u=o.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),l=o.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),d=o.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),f=o.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),m=o.create([0,1518500249,1859775393,2400959708,2840853838]),p=o.create([1352829926,1548603684,1836072691,2053994217,0]),y=c.RIPEMD160=a.extend({_doReset:function(){this._hash=o.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(D,E){for(var A=0;A<16;A++){var C=E+A,T=D[C];D[C]=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360}var b=this._hash.words,k=m.words,P=p.words,z=u.words,K=l.words,ce=d.words,$e=f.words,Se,Le,Ne,S,O,F,N,Ge,Ve,nn;F=Se=b[0],N=Le=b[1],Ge=Ne=b[2],Ve=S=b[3],nn=O=b[4];for(var le,A=0;A<80;A+=1)le=Se+D[E+z[A]]|0,A<16?le+=g(Le,Ne,S)+k[0]:A<32?le+=x(Le,Ne,S)+k[1]:A<48?le+=_(Le,Ne,S)+k[2]:A<64?le+=v(Le,Ne,S)+k[3]:le+=w(Le,Ne,S)+k[4],le=le|0,le=I(le,ce[A]),le=le+O|0,Se=O,O=S,S=I(Ne,10),Ne=Le,Le=le,le=F+D[E+K[A]]|0,A<16?le+=w(N,Ge,Ve)+P[0]:A<32?le+=v(N,Ge,Ve)+P[1]:A<48?le+=_(N,Ge,Ve)+P[2]:A<64?le+=x(N,Ge,Ve)+P[3]:le+=g(N,Ge,Ve)+P[4],le=le|0,le=I(le,$e[A]),le=le+nn|0,F=nn,nn=Ve,Ve=I(Ge,10),Ge=N,N=le;le=b[1]+Ne+Ve|0,b[1]=b[2]+S+nn|0,b[2]=b[3]+O+F|0,b[3]=b[4]+Se+N|0,b[4]=b[0]+Le+Ge|0,b[0]=le},_doFinalize:function(){var D=this._data,E=D.words,A=this._nDataBytes*8,C=D.sigBytes*8;E[C>>>5]|=128<<24-C%32,E[(C+64>>>9<<4)+14]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,D.sigBytes=(E.length+1)*4,this._process();for(var T=this._hash,b=T.words,k=0;k<5;k++){var P=b[k];b[k]=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360}return T},clone:function(){var D=a.clone.call(this);return D._hash=this._hash.clone(),D}});function g(D,E,A){return D^E^A}function x(D,E,A){return D&E|~D&A}function _(D,E,A){return(D|~E)^A}function v(D,E,A){return D&A|E&~A}function w(D,E,A){return D^(E|~A)}function I(D,E){return D<<E|D>>>32-E}r.RIPEMD160=a._createHelper(y),r.HmacRIPEMD160=a._createHmacHelper(y)}(),t.RIPEMD160})}(Kd)),Kd.exports}var jd={exports:{}},xv;function ag(){return xv||(xv=1,function(n,e){(function(t,s){n.exports=s(ve())})(ue,function(t){(function(){var s=t,r=s.lib,i=r.Base,o=s.enc,a=o.Utf8,c=s.algo;c.HMAC=i.extend({init:function(u,l){u=this._hasher=new u.init,typeof l=="string"&&(l=a.parse(l));var d=u.blockSize,f=d*4;l.sigBytes>f&&(l=u.finalize(l)),l.clamp();for(var m=this._oKey=l.clone(),p=this._iKey=l.clone(),y=m.words,g=p.words,x=0;x<d;x++)y[x]^=1549556828,g[x]^=909522486;m.sigBytes=p.sigBytes=f,this.reset()},reset:function(){var u=this._hasher;u.reset(),u.update(this._iKey)},update:function(u){return this._hasher.update(u),this},finalize:function(u){var l=this._hasher,d=l.finalize(u);l.reset();var f=l.finalize(this._oKey.clone().concat(d));return f}})})()})}(jd)),jd.exports}var Xd={exports:{}},Ev;function lL(){return Ev||(Ev=1,function(n,e){(function(t,s,r){n.exports=s(ve(),og(),ag())})(ue,function(t){return function(){var s=t,r=s.lib,i=r.Base,o=r.WordArray,a=s.algo,c=a.SHA256,u=a.HMAC,l=a.PBKDF2=i.extend({cfg:i.extend({keySize:128/32,hasher:c,iterations:25e4}),init:function(d){this.cfg=this.cfg.extend(d)},compute:function(d,f){for(var m=this.cfg,p=u.create(m.hasher,d),y=o.create(),g=o.create([1]),x=y.words,_=g.words,v=m.keySize,w=m.iterations;x.length<v;){var I=p.update(f).finalize(g);p.reset();for(var D=I.words,E=D.length,A=I,C=1;C<w;C++){A=p.finalize(A),p.reset();for(var T=A.words,b=0;b<E;b++)D[b]^=T[b]}y.concat(I),_[0]++}return y.sigBytes=v*4,y}});s.PBKDF2=function(d,f,m){return l.create(m).compute(d,f)}}(),t.PBKDF2})}(Xd)),Xd.exports}var Zd={exports:{}},Tv;function kr(){return Tv||(Tv=1,function(n,e){(function(t,s,r){n.exports=s(ve(),q1(),ag())})(ue,function(t){return function(){var s=t,r=s.lib,i=r.Base,o=r.WordArray,a=s.algo,c=a.MD5,u=a.EvpKDF=i.extend({cfg:i.extend({keySize:128/32,hasher:c,iterations:1}),init:function(l){this.cfg=this.cfg.extend(l)},compute:function(l,d){for(var f,m=this.cfg,p=m.hasher.create(),y=o.create(),g=y.words,x=m.keySize,_=m.iterations;g.length<x;){f&&p.update(f),f=p.update(l).finalize(d),p.reset();for(var v=1;v<_;v++)f=p.finalize(f),p.reset();y.concat(f)}return y.sigBytes=x*4,y}});s.EvpKDF=function(l,d,f){return u.create(f).compute(l,d)}}(),t.EvpKDF})}(Zd)),Zd.exports}var ef={exports:{}},Iv;function bt(){return Iv||(Iv=1,function(n,e){(function(t,s,r){n.exports=s(ve(),kr())})(ue,function(t){t.lib.Cipher||function(s){var r=t,i=r.lib,o=i.Base,a=i.WordArray,c=i.BufferedBlockAlgorithm,u=r.enc;u.Utf8;var l=u.Base64,d=r.algo,f=d.EvpKDF,m=i.Cipher=c.extend({cfg:o.extend(),createEncryptor:function(T,b){return this.create(this._ENC_XFORM_MODE,T,b)},createDecryptor:function(T,b){return this.create(this._DEC_XFORM_MODE,T,b)},init:function(T,b,k){this.cfg=this.cfg.extend(k),this._xformMode=T,this._key=b,this.reset()},reset:function(){c.reset.call(this),this._doReset()},process:function(T){return this._append(T),this._process()},finalize:function(T){T&&this._append(T);var b=this._doFinalize();return b},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function T(b){return typeof b=="string"?C:D}return function(b){return{encrypt:function(k,P,z){return T(P).encrypt(b,k,P,z)},decrypt:function(k,P,z){return T(P).decrypt(b,k,P,z)}}}}()});i.StreamCipher=m.extend({_doFinalize:function(){var T=this._process(!0);return T},blockSize:1});var p=r.mode={},y=i.BlockCipherMode=o.extend({createEncryptor:function(T,b){return this.Encryptor.create(T,b)},createDecryptor:function(T,b){return this.Decryptor.create(T,b)},init:function(T,b){this._cipher=T,this._iv=b}}),g=p.CBC=function(){var T=y.extend();T.Encryptor=T.extend({processBlock:function(k,P){var z=this._cipher,K=z.blockSize;b.call(this,k,P,K),z.encryptBlock(k,P),this._prevBlock=k.slice(P,P+K)}}),T.Decryptor=T.extend({processBlock:function(k,P){var z=this._cipher,K=z.blockSize,ce=k.slice(P,P+K);z.decryptBlock(k,P),b.call(this,k,P,K),this._prevBlock=ce}});function b(k,P,z){var K,ce=this._iv;ce?(K=ce,this._iv=s):K=this._prevBlock;for(var $e=0;$e<z;$e++)k[P+$e]^=K[$e]}return T}(),x=r.pad={},_=x.Pkcs7={pad:function(T,b){for(var k=b*4,P=k-T.sigBytes%k,z=P<<24|P<<16|P<<8|P,K=[],ce=0;ce<P;ce+=4)K.push(z);var $e=a.create(K,P);T.concat($e)},unpad:function(T){var b=T.words[T.sigBytes-1>>>2]&255;T.sigBytes-=b}};i.BlockCipher=m.extend({cfg:m.cfg.extend({mode:g,padding:_}),reset:function(){var T;m.reset.call(this);var b=this.cfg,k=b.iv,P=b.mode;this._xformMode==this._ENC_XFORM_MODE?T=P.createEncryptor:(T=P.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==T?this._mode.init(this,k&&k.words):(this._mode=T.call(P,this,k&&k.words),this._mode.__creator=T)},_doProcessBlock:function(T,b){this._mode.processBlock(T,b)},_doFinalize:function(){var T,b=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(b.pad(this._data,this.blockSize),T=this._process(!0)):(T=this._process(!0),b.unpad(T)),T},blockSize:128/32});var v=i.CipherParams=o.extend({init:function(T){this.mixIn(T)},toString:function(T){return(T||this.formatter).stringify(this)}}),w=r.format={},I=w.OpenSSL={stringify:function(T){var b,k=T.ciphertext,P=T.salt;return P?b=a.create([1398893684,1701076831]).concat(P).concat(k):b=k,b.toString(l)},parse:function(T){var b,k=l.parse(T),P=k.words;return P[0]==1398893684&&P[1]==1701076831&&(b=a.create(P.slice(2,4)),P.splice(0,4),k.sigBytes-=16),v.create({ciphertext:k,salt:b})}},D=i.SerializableCipher=o.extend({cfg:o.extend({format:I}),encrypt:function(T,b,k,P){P=this.cfg.extend(P);var z=T.createEncryptor(k,P),K=z.finalize(b),ce=z.cfg;return v.create({ciphertext:K,key:k,iv:ce.iv,algorithm:T,mode:ce.mode,padding:ce.padding,blockSize:T.blockSize,formatter:P.format})},decrypt:function(T,b,k,P){P=this.cfg.extend(P),b=this._parse(b,P.format);var z=T.createDecryptor(k,P).finalize(b.ciphertext);return z},_parse:function(T,b){return typeof T=="string"?b.parse(T,this):T}}),E=r.kdf={},A=E.OpenSSL={execute:function(T,b,k,P,z){if(P||(P=a.random(64/8)),z)var K=f.create({keySize:b+k,hasher:z}).compute(T,P);else var K=f.create({keySize:b+k}).compute(T,P);var ce=a.create(K.words.slice(b),k*4);return K.sigBytes=b*4,v.create({key:K,iv:ce,salt:P})}},C=i.PasswordBasedCipher=D.extend({cfg:D.cfg.extend({kdf:A}),encrypt:function(T,b,k,P){P=this.cfg.extend(P);var z=P.kdf.execute(k,T.keySize,T.ivSize,P.salt,P.hasher);P.iv=z.iv;var K=D.encrypt.call(this,T,b,z.key,P);return K.mixIn(z),K},decrypt:function(T,b,k,P){P=this.cfg.extend(P),b=this._parse(b,P.format);var z=P.kdf.execute(k,T.keySize,T.ivSize,b.salt,P.hasher);P.iv=z.iv;var K=D.decrypt.call(this,T,b,z.key,P);return K}})}()})}(ef)),ef.exports}var tf={exports:{}},Dv;function hL(){return Dv||(Dv=1,function(n,e){(function(t,s,r){n.exports=s(ve(),bt())})(ue,function(t){return t.mode.CFB=function(){var s=t.lib.BlockCipherMode.extend();s.Encryptor=s.extend({processBlock:function(i,o){var a=this._cipher,c=a.blockSize;r.call(this,i,o,c,a),this._prevBlock=i.slice(o,o+c)}}),s.Decryptor=s.extend({processBlock:function(i,o){var a=this._cipher,c=a.blockSize,u=i.slice(o,o+c);r.call(this,i,o,c,a),this._prevBlock=u}});function r(i,o,a,c){var u,l=this._iv;l?(u=l.slice(0),this._iv=void 0):u=this._prevBlock,c.encryptBlock(u,0);for(var d=0;d<a;d++)i[o+d]^=u[d]}return s}(),t.mode.CFB})}(tf)),tf.exports}var nf={exports:{}},Av;function dL(){return Av||(Av=1,function(n,e){(function(t,s,r){n.exports=s(ve(),bt())})(ue,function(t){return t.mode.CTR=function(){var s=t.lib.BlockCipherMode.extend(),r=s.Encryptor=s.extend({processBlock:function(i,o){var a=this._cipher,c=a.blockSize,u=this._iv,l=this._counter;u&&(l=this._counter=u.slice(0),this._iv=void 0);var d=l.slice(0);a.encryptBlock(d,0),l[c-1]=l[c-1]+1|0;for(var f=0;f<c;f++)i[o+f]^=d[f]}});return s.Decryptor=r,s}(),t.mode.CTR})}(nf)),nf.exports}var sf={exports:{}},bv;function fL(){return bv||(bv=1,function(n,e){(function(t,s,r){n.exports=s(ve(),bt())})(ue,function(t){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return t.mode.CTRGladman=function(){var s=t.lib.BlockCipherMode.extend();function r(a){if((a>>24&255)===255){var c=a>>16&255,u=a>>8&255,l=a&255;c===255?(c=0,u===255?(u=0,l===255?l=0:++l):++u):++c,a=0,a+=c<<16,a+=u<<8,a+=l}else a+=1<<24;return a}function i(a){return(a[0]=r(a[0]))===0&&(a[1]=r(a[1])),a}var o=s.Encryptor=s.extend({processBlock:function(a,c){var u=this._cipher,l=u.blockSize,d=this._iv,f=this._counter;d&&(f=this._counter=d.slice(0),this._iv=void 0),i(f);var m=f.slice(0);u.encryptBlock(m,0);for(var p=0;p<l;p++)a[c+p]^=m[p]}});return s.Decryptor=o,s}(),t.mode.CTRGladman})}(sf)),sf.exports}var rf={exports:{}},Cv;function mL(){return Cv||(Cv=1,function(n,e){(function(t,s,r){n.exports=s(ve(),bt())})(ue,function(t){return t.mode.OFB=function(){var s=t.lib.BlockCipherMode.extend(),r=s.Encryptor=s.extend({processBlock:function(i,o){var a=this._cipher,c=a.blockSize,u=this._iv,l=this._keystream;u&&(l=this._keystream=u.slice(0),this._iv=void 0),a.encryptBlock(l,0);for(var d=0;d<c;d++)i[o+d]^=l[d]}});return s.Decryptor=r,s}(),t.mode.OFB})}(rf)),rf.exports}var of={exports:{}},kv;function pL(){return kv||(kv=1,function(n,e){(function(t,s,r){n.exports=s(ve(),bt())})(ue,function(t){return t.mode.ECB=function(){var s=t.lib.BlockCipherMode.extend();return s.Encryptor=s.extend({processBlock:function(r,i){this._cipher.encryptBlock(r,i)}}),s.Decryptor=s.extend({processBlock:function(r,i){this._cipher.decryptBlock(r,i)}}),s}(),t.mode.ECB})}(of)),of.exports}var af={exports:{}},Sv;function gL(){return Sv||(Sv=1,function(n,e){(function(t,s,r){n.exports=s(ve(),bt())})(ue,function(t){return t.pad.AnsiX923={pad:function(s,r){var i=s.sigBytes,o=r*4,a=o-i%o,c=i+a-1;s.clamp(),s.words[c>>>2]|=a<<24-c%4*8,s.sigBytes+=a},unpad:function(s){var r=s.words[s.sigBytes-1>>>2]&255;s.sigBytes-=r}},t.pad.Ansix923})}(af)),af.exports}var cf={exports:{}},Pv;function yL(){return Pv||(Pv=1,function(n,e){(function(t,s,r){n.exports=s(ve(),bt())})(ue,function(t){return t.pad.Iso10126={pad:function(s,r){var i=r*4,o=i-s.sigBytes%i;s.concat(t.lib.WordArray.random(o-1)).concat(t.lib.WordArray.create([o<<24],1))},unpad:function(s){var r=s.words[s.sigBytes-1>>>2]&255;s.sigBytes-=r}},t.pad.Iso10126})}(cf)),cf.exports}var uf={exports:{}},Rv;function _L(){return Rv||(Rv=1,function(n,e){(function(t,s,r){n.exports=s(ve(),bt())})(ue,function(t){return t.pad.Iso97971={pad:function(s,r){s.concat(t.lib.WordArray.create([2147483648],1)),t.pad.ZeroPadding.pad(s,r)},unpad:function(s){t.pad.ZeroPadding.unpad(s),s.sigBytes--}},t.pad.Iso97971})}(uf)),uf.exports}var lf={exports:{}},Nv;function vL(){return Nv||(Nv=1,function(n,e){(function(t,s,r){n.exports=s(ve(),bt())})(ue,function(t){return t.pad.ZeroPadding={pad:function(s,r){var i=r*4;s.clamp(),s.sigBytes+=i-(s.sigBytes%i||i)},unpad:function(s){for(var r=s.words,i=s.sigBytes-1,i=s.sigBytes-1;i>=0;i--)if(r[i>>>2]>>>24-i%4*8&255){s.sigBytes=i+1;break}}},t.pad.ZeroPadding})}(lf)),lf.exports}var hf={exports:{}},Mv;function wL(){return Mv||(Mv=1,function(n,e){(function(t,s,r){n.exports=s(ve(),bt())})(ue,function(t){return t.pad.NoPadding={pad:function(){},unpad:function(){}},t.pad.NoPadding})}(hf)),hf.exports}var df={exports:{}},Ov;function xL(){return Ov||(Ov=1,function(n,e){(function(t,s,r){n.exports=s(ve(),bt())})(ue,function(t){return function(s){var r=t,i=r.lib,o=i.CipherParams,a=r.enc,c=a.Hex,u=r.format;u.Hex={stringify:function(l){return l.ciphertext.toString(c)},parse:function(l){var d=c.parse(l);return o.create({ciphertext:d})}}}(),t.format.Hex})}(df)),df.exports}var ff={exports:{}},Fv;function EL(){return Fv||(Fv=1,function(n,e){(function(t,s,r){n.exports=s(ve(),xi(),Ei(),kr(),bt())})(ue,function(t){return function(){var s=t,r=s.lib,i=r.BlockCipher,o=s.algo,a=[],c=[],u=[],l=[],d=[],f=[],m=[],p=[],y=[],g=[];(function(){for(var v=[],w=0;w<256;w++)w<128?v[w]=w<<1:v[w]=w<<1^283;for(var I=0,D=0,w=0;w<256;w++){var E=D^D<<1^D<<2^D<<3^D<<4;E=E>>>8^E&255^99,a[I]=E,c[E]=I;var A=v[I],C=v[A],T=v[C],b=v[E]*257^E*16843008;u[I]=b<<24|b>>>8,l[I]=b<<16|b>>>16,d[I]=b<<8|b>>>24,f[I]=b;var b=T*16843009^C*65537^A*257^I*16843008;m[E]=b<<24|b>>>8,p[E]=b<<16|b>>>16,y[E]=b<<8|b>>>24,g[E]=b,I?(I=A^v[v[v[T^A]]],D^=v[v[D]]):I=D=1}})();var x=[0,1,2,4,8,16,32,64,128,27,54],_=o.AES=i.extend({_doReset:function(){var v;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var w=this._keyPriorReset=this._key,I=w.words,D=w.sigBytes/4,E=this._nRounds=D+6,A=(E+1)*4,C=this._keySchedule=[],T=0;T<A;T++)T<D?C[T]=I[T]:(v=C[T-1],T%D?D>6&&T%D==4&&(v=a[v>>>24]<<24|a[v>>>16&255]<<16|a[v>>>8&255]<<8|a[v&255]):(v=v<<8|v>>>24,v=a[v>>>24]<<24|a[v>>>16&255]<<16|a[v>>>8&255]<<8|a[v&255],v^=x[T/D|0]<<24),C[T]=C[T-D]^v);for(var b=this._invKeySchedule=[],k=0;k<A;k++){var T=A-k;if(k%4)var v=C[T];else var v=C[T-4];k<4||T<=4?b[k]=v:b[k]=m[a[v>>>24]]^p[a[v>>>16&255]]^y[a[v>>>8&255]]^g[a[v&255]]}}},encryptBlock:function(v,w){this._doCryptBlock(v,w,this._keySchedule,u,l,d,f,a)},decryptBlock:function(v,w){var I=v[w+1];v[w+1]=v[w+3],v[w+3]=I,this._doCryptBlock(v,w,this._invKeySchedule,m,p,y,g,c);var I=v[w+1];v[w+1]=v[w+3],v[w+3]=I},_doCryptBlock:function(v,w,I,D,E,A,C,T){for(var b=this._nRounds,k=v[w]^I[0],P=v[w+1]^I[1],z=v[w+2]^I[2],K=v[w+3]^I[3],ce=4,$e=1;$e<b;$e++){var Se=D[k>>>24]^E[P>>>16&255]^A[z>>>8&255]^C[K&255]^I[ce++],Le=D[P>>>24]^E[z>>>16&255]^A[K>>>8&255]^C[k&255]^I[ce++],Ne=D[z>>>24]^E[K>>>16&255]^A[k>>>8&255]^C[P&255]^I[ce++],S=D[K>>>24]^E[k>>>16&255]^A[P>>>8&255]^C[z&255]^I[ce++];k=Se,P=Le,z=Ne,K=S}var Se=(T[k>>>24]<<24|T[P>>>16&255]<<16|T[z>>>8&255]<<8|T[K&255])^I[ce++],Le=(T[P>>>24]<<24|T[z>>>16&255]<<16|T[K>>>8&255]<<8|T[k&255])^I[ce++],Ne=(T[z>>>24]<<24|T[K>>>16&255]<<16|T[k>>>8&255]<<8|T[P&255])^I[ce++],S=(T[K>>>24]<<24|T[k>>>16&255]<<16|T[P>>>8&255]<<8|T[z&255])^I[ce++];v[w]=Se,v[w+1]=Le,v[w+2]=Ne,v[w+3]=S},keySize:256/32});s.AES=i._createHelper(_)}(),t.AES})}(ff)),ff.exports}var mf={exports:{}},Bv;function TL(){return Bv||(Bv=1,function(n,e){(function(t,s,r){n.exports=s(ve(),xi(),Ei(),kr(),bt())})(ue,function(t){return function(){var s=t,r=s.lib,i=r.WordArray,o=r.BlockCipher,a=s.algo,c=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],u=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],l=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],d=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],f=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],m=a.DES=o.extend({_doReset:function(){for(var x=this._key,_=x.words,v=[],w=0;w<56;w++){var I=c[w]-1;v[w]=_[I>>>5]>>>31-I%32&1}for(var D=this._subKeys=[],E=0;E<16;E++){for(var A=D[E]=[],C=l[E],w=0;w<24;w++)A[w/6|0]|=v[(u[w]-1+C)%28]<<31-w%6,A[4+(w/6|0)]|=v[28+(u[w+24]-1+C)%28]<<31-w%6;A[0]=A[0]<<1|A[0]>>>31;for(var w=1;w<7;w++)A[w]=A[w]>>>(w-1)*4+3;A[7]=A[7]<<5|A[7]>>>27}for(var T=this._invSubKeys=[],w=0;w<16;w++)T[w]=D[15-w]},encryptBlock:function(x,_){this._doCryptBlock(x,_,this._subKeys)},decryptBlock:function(x,_){this._doCryptBlock(x,_,this._invSubKeys)},_doCryptBlock:function(x,_,v){this._lBlock=x[_],this._rBlock=x[_+1],p.call(this,4,252645135),p.call(this,16,65535),y.call(this,2,858993459),y.call(this,8,16711935),p.call(this,1,1431655765);for(var w=0;w<16;w++){for(var I=v[w],D=this._lBlock,E=this._rBlock,A=0,C=0;C<8;C++)A|=d[C][((E^I[C])&f[C])>>>0];this._lBlock=E,this._rBlock=D^A}var T=this._lBlock;this._lBlock=this._rBlock,this._rBlock=T,p.call(this,1,1431655765),y.call(this,8,16711935),y.call(this,2,858993459),p.call(this,16,65535),p.call(this,4,252645135),x[_]=this._lBlock,x[_+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function p(x,_){var v=(this._lBlock>>>x^this._rBlock)&_;this._rBlock^=v,this._lBlock^=v<<x}function y(x,_){var v=(this._rBlock>>>x^this._lBlock)&_;this._lBlock^=v,this._rBlock^=v<<x}s.DES=o._createHelper(m);var g=a.TripleDES=o.extend({_doReset:function(){var x=this._key,_=x.words;if(_.length!==2&&_.length!==4&&_.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var v=_.slice(0,2),w=_.length<4?_.slice(0,2):_.slice(2,4),I=_.length<6?_.slice(0,2):_.slice(4,6);this._des1=m.createEncryptor(i.create(v)),this._des2=m.createEncryptor(i.create(w)),this._des3=m.createEncryptor(i.create(I))},encryptBlock:function(x,_){this._des1.encryptBlock(x,_),this._des2.decryptBlock(x,_),this._des3.encryptBlock(x,_)},decryptBlock:function(x,_){this._des3.decryptBlock(x,_),this._des2.encryptBlock(x,_),this._des1.decryptBlock(x,_)},keySize:192/32,ivSize:64/32,blockSize:64/32});s.TripleDES=o._createHelper(g)}(),t.TripleDES})}(mf)),mf.exports}var pf={exports:{}},Lv;function IL(){return Lv||(Lv=1,function(n,e){(function(t,s,r){n.exports=s(ve(),xi(),Ei(),kr(),bt())})(ue,function(t){return function(){var s=t,r=s.lib,i=r.StreamCipher,o=s.algo,a=o.RC4=i.extend({_doReset:function(){for(var l=this._key,d=l.words,f=l.sigBytes,m=this._S=[],p=0;p<256;p++)m[p]=p;for(var p=0,y=0;p<256;p++){var g=p%f,x=d[g>>>2]>>>24-g%4*8&255;y=(y+m[p]+x)%256;var _=m[p];m[p]=m[y],m[y]=_}this._i=this._j=0},_doProcessBlock:function(l,d){l[d]^=c.call(this)},keySize:256/32,ivSize:0});function c(){for(var l=this._S,d=this._i,f=this._j,m=0,p=0;p<4;p++){d=(d+1)%256,f=(f+l[d])%256;var y=l[d];l[d]=l[f],l[f]=y,m|=l[(l[d]+l[f])%256]<<24-p*8}return this._i=d,this._j=f,m}s.RC4=i._createHelper(a);var u=o.RC4Drop=a.extend({cfg:a.cfg.extend({drop:192}),_doReset:function(){a._doReset.call(this);for(var l=this.cfg.drop;l>0;l--)c.call(this)}});s.RC4Drop=i._createHelper(u)}(),t.RC4})}(pf)),pf.exports}var gf={exports:{}},Vv;function DL(){return Vv||(Vv=1,function(n,e){(function(t,s,r){n.exports=s(ve(),xi(),Ei(),kr(),bt())})(ue,function(t){return function(){var s=t,r=s.lib,i=r.StreamCipher,o=s.algo,a=[],c=[],u=[],l=o.Rabbit=i.extend({_doReset:function(){for(var f=this._key.words,m=this.cfg.iv,p=0;p<4;p++)f[p]=(f[p]<<8|f[p]>>>24)&16711935|(f[p]<<24|f[p]>>>8)&4278255360;var y=this._X=[f[0],f[3]<<16|f[2]>>>16,f[1],f[0]<<16|f[3]>>>16,f[2],f[1]<<16|f[0]>>>16,f[3],f[2]<<16|f[1]>>>16],g=this._C=[f[2]<<16|f[2]>>>16,f[0]&4294901760|f[1]&65535,f[3]<<16|f[3]>>>16,f[1]&4294901760|f[2]&65535,f[0]<<16|f[0]>>>16,f[2]&4294901760|f[3]&65535,f[1]<<16|f[1]>>>16,f[3]&4294901760|f[0]&65535];this._b=0;for(var p=0;p<4;p++)d.call(this);for(var p=0;p<8;p++)g[p]^=y[p+4&7];if(m){var x=m.words,_=x[0],v=x[1],w=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360,I=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,D=w>>>16|I&4294901760,E=I<<16|w&65535;g[0]^=w,g[1]^=D,g[2]^=I,g[3]^=E,g[4]^=w,g[5]^=D,g[6]^=I,g[7]^=E;for(var p=0;p<4;p++)d.call(this)}},_doProcessBlock:function(f,m){var p=this._X;d.call(this),a[0]=p[0]^p[5]>>>16^p[3]<<16,a[1]=p[2]^p[7]>>>16^p[5]<<16,a[2]=p[4]^p[1]>>>16^p[7]<<16,a[3]=p[6]^p[3]>>>16^p[1]<<16;for(var y=0;y<4;y++)a[y]=(a[y]<<8|a[y]>>>24)&16711935|(a[y]<<24|a[y]>>>8)&4278255360,f[m+y]^=a[y]},blockSize:128/32,ivSize:64/32});function d(){for(var f=this._X,m=this._C,p=0;p<8;p++)c[p]=m[p];m[0]=m[0]+1295307597+this._b|0,m[1]=m[1]+3545052371+(m[0]>>>0<c[0]>>>0?1:0)|0,m[2]=m[2]+886263092+(m[1]>>>0<c[1]>>>0?1:0)|0,m[3]=m[3]+1295307597+(m[2]>>>0<c[2]>>>0?1:0)|0,m[4]=m[4]+3545052371+(m[3]>>>0<c[3]>>>0?1:0)|0,m[5]=m[5]+886263092+(m[4]>>>0<c[4]>>>0?1:0)|0,m[6]=m[6]+1295307597+(m[5]>>>0<c[5]>>>0?1:0)|0,m[7]=m[7]+3545052371+(m[6]>>>0<c[6]>>>0?1:0)|0,this._b=m[7]>>>0<c[7]>>>0?1:0;for(var p=0;p<8;p++){var y=f[p]+m[p],g=y&65535,x=y>>>16,_=((g*g>>>17)+g*x>>>15)+x*x,v=((y&4294901760)*y|0)+((y&65535)*y|0);u[p]=_^v}f[0]=u[0]+(u[7]<<16|u[7]>>>16)+(u[6]<<16|u[6]>>>16)|0,f[1]=u[1]+(u[0]<<8|u[0]>>>24)+u[7]|0,f[2]=u[2]+(u[1]<<16|u[1]>>>16)+(u[0]<<16|u[0]>>>16)|0,f[3]=u[3]+(u[2]<<8|u[2]>>>24)+u[1]|0,f[4]=u[4]+(u[3]<<16|u[3]>>>16)+(u[2]<<16|u[2]>>>16)|0,f[5]=u[5]+(u[4]<<8|u[4]>>>24)+u[3]|0,f[6]=u[6]+(u[5]<<16|u[5]>>>16)+(u[4]<<16|u[4]>>>16)|0,f[7]=u[7]+(u[6]<<8|u[6]>>>24)+u[5]|0}s.Rabbit=i._createHelper(l)}(),t.Rabbit})}(gf)),gf.exports}var yf={exports:{}},Uv;function AL(){return Uv||(Uv=1,function(n,e){(function(t,s,r){n.exports=s(ve(),xi(),Ei(),kr(),bt())})(ue,function(t){return function(){var s=t,r=s.lib,i=r.StreamCipher,o=s.algo,a=[],c=[],u=[],l=o.RabbitLegacy=i.extend({_doReset:function(){var f=this._key.words,m=this.cfg.iv,p=this._X=[f[0],f[3]<<16|f[2]>>>16,f[1],f[0]<<16|f[3]>>>16,f[2],f[1]<<16|f[0]>>>16,f[3],f[2]<<16|f[1]>>>16],y=this._C=[f[2]<<16|f[2]>>>16,f[0]&4294901760|f[1]&65535,f[3]<<16|f[3]>>>16,f[1]&4294901760|f[2]&65535,f[0]<<16|f[0]>>>16,f[2]&4294901760|f[3]&65535,f[1]<<16|f[1]>>>16,f[3]&4294901760|f[0]&65535];this._b=0;for(var g=0;g<4;g++)d.call(this);for(var g=0;g<8;g++)y[g]^=p[g+4&7];if(m){var x=m.words,_=x[0],v=x[1],w=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360,I=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,D=w>>>16|I&4294901760,E=I<<16|w&65535;y[0]^=w,y[1]^=D,y[2]^=I,y[3]^=E,y[4]^=w,y[5]^=D,y[6]^=I,y[7]^=E;for(var g=0;g<4;g++)d.call(this)}},_doProcessBlock:function(f,m){var p=this._X;d.call(this),a[0]=p[0]^p[5]>>>16^p[3]<<16,a[1]=p[2]^p[7]>>>16^p[5]<<16,a[2]=p[4]^p[1]>>>16^p[7]<<16,a[3]=p[6]^p[3]>>>16^p[1]<<16;for(var y=0;y<4;y++)a[y]=(a[y]<<8|a[y]>>>24)&16711935|(a[y]<<24|a[y]>>>8)&4278255360,f[m+y]^=a[y]},blockSize:128/32,ivSize:64/32});function d(){for(var f=this._X,m=this._C,p=0;p<8;p++)c[p]=m[p];m[0]=m[0]+1295307597+this._b|0,m[1]=m[1]+3545052371+(m[0]>>>0<c[0]>>>0?1:0)|0,m[2]=m[2]+886263092+(m[1]>>>0<c[1]>>>0?1:0)|0,m[3]=m[3]+1295307597+(m[2]>>>0<c[2]>>>0?1:0)|0,m[4]=m[4]+3545052371+(m[3]>>>0<c[3]>>>0?1:0)|0,m[5]=m[5]+886263092+(m[4]>>>0<c[4]>>>0?1:0)|0,m[6]=m[6]+1295307597+(m[5]>>>0<c[5]>>>0?1:0)|0,m[7]=m[7]+3545052371+(m[6]>>>0<c[6]>>>0?1:0)|0,this._b=m[7]>>>0<c[7]>>>0?1:0;for(var p=0;p<8;p++){var y=f[p]+m[p],g=y&65535,x=y>>>16,_=((g*g>>>17)+g*x>>>15)+x*x,v=((y&4294901760)*y|0)+((y&65535)*y|0);u[p]=_^v}f[0]=u[0]+(u[7]<<16|u[7]>>>16)+(u[6]<<16|u[6]>>>16)|0,f[1]=u[1]+(u[0]<<8|u[0]>>>24)+u[7]|0,f[2]=u[2]+(u[1]<<16|u[1]>>>16)+(u[0]<<16|u[0]>>>16)|0,f[3]=u[3]+(u[2]<<8|u[2]>>>24)+u[1]|0,f[4]=u[4]+(u[3]<<16|u[3]>>>16)+(u[2]<<16|u[2]>>>16)|0,f[5]=u[5]+(u[4]<<8|u[4]>>>24)+u[3]|0,f[6]=u[6]+(u[5]<<16|u[5]>>>16)+(u[4]<<16|u[4]>>>16)|0,f[7]=u[7]+(u[6]<<8|u[6]>>>24)+u[5]|0}s.RabbitLegacy=i._createHelper(l)}(),t.RabbitLegacy})}(yf)),yf.exports}var _f={exports:{}},Wv;function bL(){return Wv||(Wv=1,function(n,e){(function(t,s,r){n.exports=s(ve(),xi(),Ei(),kr(),bt())})(ue,function(t){return function(){var s=t,r=s.lib,i=r.BlockCipher,o=s.algo;const a=16,c=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],u=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var l={pbox:[],sbox:[]};function d(g,x){let _=x>>24&255,v=x>>16&255,w=x>>8&255,I=x&255,D=g.sbox[0][_]+g.sbox[1][v];return D=D^g.sbox[2][w],D=D+g.sbox[3][I],D}function f(g,x,_){let v=x,w=_,I;for(let D=0;D<a;++D)v=v^g.pbox[D],w=d(g,v)^w,I=v,v=w,w=I;return I=v,v=w,w=I,w=w^g.pbox[a],v=v^g.pbox[a+1],{left:v,right:w}}function m(g,x,_){let v=x,w=_,I;for(let D=a+1;D>1;--D)v=v^g.pbox[D],w=d(g,v)^w,I=v,v=w,w=I;return I=v,v=w,w=I,w=w^g.pbox[1],v=v^g.pbox[0],{left:v,right:w}}function p(g,x,_){for(let E=0;E<4;E++){g.sbox[E]=[];for(let A=0;A<256;A++)g.sbox[E][A]=u[E][A]}let v=0;for(let E=0;E<a+2;E++)g.pbox[E]=c[E]^x[v],v++,v>=_&&(v=0);let w=0,I=0,D=0;for(let E=0;E<a+2;E+=2)D=f(g,w,I),w=D.left,I=D.right,g.pbox[E]=w,g.pbox[E+1]=I;for(let E=0;E<4;E++)for(let A=0;A<256;A+=2)D=f(g,w,I),w=D.left,I=D.right,g.sbox[E][A]=w,g.sbox[E][A+1]=I;return!0}var y=o.Blowfish=i.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var g=this._keyPriorReset=this._key,x=g.words,_=g.sigBytes/4;p(l,x,_)}},encryptBlock:function(g,x){var _=f(l,g[x],g[x+1]);g[x]=_.left,g[x+1]=_.right},decryptBlock:function(g,x){var _=m(l,g[x],g[x+1]);g[x]=_.left,g[x+1]=_.right},blockSize:64/32,keySize:128/32,ivSize:64/32});s.Blowfish=i._createHelper(y)}(),t.Blowfish})}(_f)),_f.exports}(function(n,e){(function(t,s,r){n.exports=s(ve(),$h(),sL(),rL(),xi(),iL(),Ei(),q1(),og(),oL(),Y1(),aL(),cL(),uL(),ag(),lL(),kr(),bt(),hL(),dL(),fL(),mL(),pL(),gL(),yL(),_L(),vL(),wL(),xL(),EL(),TL(),IL(),DL(),AL(),bL())})(ue,function(t){return t})})($1);var CL=$1.exports;const kL=yw(CL),{AES:SL,enc:yc,SHA256:cg}=kL,PL="16charactersiv!";function RL(n,e){const t=NL(e),s=yc.Utf8.parse(PL);return SL.encrypt(n,t,{iv:s}).toString()}function NL(n){let e="htr;lmn;rkmnkryemnkrmnbavsdbshtg6437";return e=cg(n+e).toString(yc.Hex).substring(0,32),yc.Utf8.parse(e)}function HV(n,e="simpleCode"){return n===""?"":cg(n+e).toString(yc.Hex)}function ML({id:n}){if(n.length<7)return"";const e=n.substring(3,6),t=cg(n+e).toString(yc.Hex);return t.substring(0,Math.min(10,t.length)).replace(/[/.*]/g,"")}function di(n){return RL(n+lC,uC).replace("/","").replace("*","").replace(".","")}var Wn=(n=>(n[n.shortestTreatment=0]="shortestTreatment",n[n.longestTreatment=1]="longestTreatment",n[n.custom=2]="custom",n[n.first=3]="first",n[n.last=4]="last",n[n.edges=5]="edges",n))(Wn||{});const OL={3:"first",4:"last",5:"edges",0:"shortestTreatment",1:"longestTreatment",2:"custom"},FL={first:3,last:4,edges:5,shortestTreatment:0,longestTreatment:1,custom:2};class z1{constructor({start:e,end:t}){h(this,"start");h(this,"end");this.start=e,this.end=t}}function G1(n){n.sort((r,i)=>r.start.getTime()-i.start.getTime());const e=[];let t=0;for(let r=0;r<n.length;r=t){const i=n[r];for(e.push(i),t=r+1;t<n.length;t++){const o=n[t],a=Ac(va(i.start),va(i.end),va(o.start),va(o.end));if(a==="AFTER")if(i.end.toUTCString()===o.start.toUTCString())i.end=o.end;else break;a==="STRIKE"&&(o.start.getTime()<i.start.getTime()&&(i.start=o.start),o.end.getTime()>i.end.getTime()&&(i.end=o.end))}}const s=[];return e.forEach(r=>{s.push(pn(r.start)),s.push(pn(r.end))}),s}function BL(n){const e=[];for(let t=0;t<n.length;t+=2){const s=hn(n[t]),r=hn(n[t+1]);e.push(new z1({start:s,end:r}))}return e}function Hv(n,e){for(let t=0;t<e.length;t+=2){const s=new Date(e[t]),r=new Date(e[t+1]);n.push(new z1({start:s,end:r}))}}class is{constructor({token:e="",joinDate:t,id:s="",activeNotifications:r=!0}){h(this,"token");h(this,"joinDate");h(this,"id");h(this,"activeNotifications");this.token=e,this.joinDate=t,this.id=s,this.activeNotifications=r}static fromJson(e,t){const s=new is({joinDate:new Date(0)});return s.id=t,s.activeNotifications=e.activeNotifications??!0,s.token=e.token??"",s}toJson(){const e={};return this.activeNotifications||(e.activeNotifications=this.activeNotifications),e.token=this.token,e.joinDate=Ze(this.joinDate),e}static fromDevice(e){return new is({joinDate:e.joinDate,id:e.id,activeNotifications:e.activeNotifications,token:e.token})}}function _a(n,e=-1){let t="",s="",r="",i="",o="",a="",c=n.days;Math.floor(c/30)>0&&(Math.floor(c/30)===1&&(a=J("month")),Math.floor(c/30)===2&&(a=J("twoMonths")),Math.floor(c/30)>2&&(a=`${Math.floor(c/30)} `+J("months"))),c-=Math.floor(c/30)*30,Math.floor(c/7)>0&&(Math.floor(c/7)===1&&(o=J("week")),Math.floor(c/7)===2&&(o=J("twoWeeks")),Math.floor(c/7)>2&&(o=`${Math.floor(c/7)} `+J("weeks"))),c-=Math.floor(c/7)*7,c===1&&(i=J("day")),c===2&&(i=J("twoDays")),c>2&&(i=`${c} `+J("days"));let u=n.hours-n.days*24;u===1&&(t=J("hour")),u===2&&(t=J("twoHours")),u>2&&(t=`${u}`+J("hoursChar"));let l=n.minutes-n.hours*60;s=l>0?`${l}`+J("minutesChar"):"";let d=n.seconds-n.minutes*60;d===1&&(r=J("second",void 0,!1)),d>1&&(r=`${d} `+J("seconds"));let f="";return n.days===365?f=J("year"):n.days%365===0&&n.days>365?f=(n.days/365).toFixed(0)+" "+J("years"):o===""&&a!==""&&i===""?f=a:o!==""&&a===""&&i===""?f=o:o!==""&&a!==""&&i===""?f=a+" "+J("and")+o:o!==""&&a===""&&i!==""?f=o+" "+J("and")+i:o===""&&a!==""&&i!==""?f=a+" "+J("and")+i:o!==""&&a!==""&&i!==""?f=a+" ,"+o+" "+J("and")+i:s===""&&t===""&&i!==""?f=i:s!==""&&t===""&&i===""?f=s:s===""&&t!==""&&i===""?f=t:s!==""&&t!==""&&i===""?f=t+" "+J("and")+s:s!==""&&t===""&&i!==""?f=i+" "+J("and")+s:s===""&&t!==""&&i!==""?f=i+" "+J("and")+t:s!==""&&t!==""&&i!==""?f=i+" ,"+t+" "+J("and")+s:r!==""&&(f=r),f.length===0?"":e===-1||e>f.length?f:f.slice(0,e)+".."+f.slice(e)}function $V(n){const e=s=>s.toString().padStart(2,"0"),t=e(n.minutes%60);return`${e(n.hours)}:${t}`}function qV(n,e=""){let t="";Nt(n,"dd-MM-yyyy")===Nt(em(new Date,1),"dd-MM-yyyy")&&(t=J("tomorrow")),Nt(n,"dd-MM-yyyy")===Nt(new Date,"dd-MM-yyyy")&&(t=J("today"));const s=_C[n.getDay()];return`${t!==""?t:e+J(s)}`}function LL(n){try{const e=n.indexOf("-");let t=n.substring(e+1,n.length);return t="0"+t,t.substring(0,3)+"-"+t.substring(3,t.length)}catch{return n}}var jn=(n=>(n[n.deposit=0]="deposit",n[n.payment=1]="payment",n))(jn||{});const B0={0:"deposit",1:"payment"},L0={deposit:0,payment:1};class jr{constructor({type:e=1,amount:t=0,id:s="",hypId:r="",createdAt:i=new Date(0)}){h(this,"type",1);h(this,"amount",0);h(this,"createdAt",new Date(0));h(this,"id","");h(this,"hypId","");this.type=e,this.amount=parseFloat(t.toFixed(2)),this.id=s,this.hypId=r,this.createdAt=i}static fromJson(e,t){const s=new jr({});return e.amount!=null&&(s.amount=e.amount),s.hypId=e.hypId||"",s.id=t,s.type=L0[e.type]||1,s.createdAt=e.createdAt?new Date(e.createdAt):new Date(0),s}static fromTransaction(e){const t=new jr({});return t.type=e.type,t.amount=e.amount,t.id=e.id,t.hypId=e.hypId,t.createdAt=e.createdAt,t}toJson(){const e={};return e.amount=this.amount,e.hypId=this.hypId,e.type=B0[this.type],e.createdAt=oe(this.createdAt),e}toString(){return JSON.stringify(this.toJson(),null,2)}}class Zi{constructor({workMinutes:e=0,breakMinutes:t=0,title:s=""}){h(this,"workMinutes",0);h(this,"breakMinutes",0);h(this,"title","");this.workMinutes=e,this.breakMinutes=t,this.title=s}get wholeMinutes(){return this.workMinutes+this.breakMinutes}static fromTreatmentTime(e){return new Zi({breakMinutes:e.breakMinutes,workMinutes:e.workMinutes,title:e.title})}static fromJson(e){return new Zi({breakMinutes:e.break||0,workMinutes:e.duration||0,title:e.title||""})}toJson(){const e={};return e.break=this.breakMinutes,e.duration=this.workMinutes,e.title=this.title,e}toString(){return JSON.stringify(this,null,2)}}class Mt{constructor({times:e=new Map,id:t="",price:s,count:r=1,name:i="",isMulti:o=!1,maxTicketsForUser:a=1,index:c="",amountInAdvance:u=0,colorIndex:l=-2,hide:d=!1,paymentType:f,note:m="",maxParticipants:p=1,showPrice:y=!0,showParticipants:g=!0,showTime:x=!0}={}){h(this,"totalMinutes",0);h(this,"index","");h(this,"id","");h(this,"note","");h(this,"price");h(this,"amountInAdvance",0);h(this,"paymentType");h(this,"isMulti",!1);h(this,"showPrice",!0);h(this,"showTime",!0);h(this,"count",1);h(this,"name","");h(this,"colorIndex",-2);h(this,"maxParticipants",1);h(this,"maxTicketsForUser",1);h(this,"tempMaxParticipants");h(this,"hide",!1);h(this,"showParticipants",!0);h(this,"times",new Map);h(this,"priceChangingNote");this.times=e,this.id=t,this.price=s,this.count=r,this.name=i,this.isMulti=o,this.maxTicketsForUser=a,this.index=c,this.amountInAdvance=u,this.colorIndex=l,this.hide=d,this.paymentType=f,this.note=m,this.maxParticipants=p,this.showPrice=y,this.showParticipants=g,this.showTime=x,this.totalMinutes=this.totalTotalMinutes}isEqual(e){return!0}get totalTotalMinutes(){let e=0;return this.times.forEach((t,s)=>{e+=t.wholeMinutes}),e}get totalWorkMinutes(){let e=0;return this.times.forEach((t,s)=>{e+=t.workMinutes}),e}get totalMinutesForBooking(){return this.totalMinutes*this.count}get amountInAdvanceForBooking(){return this.amountInAdvance*this.count}get totalPriceForBooking(){return this.price.amount*this.count}get nameForBooking(){return this.count===1?this.name:`${this.name} X${this.count}`}static fromTreatment(e){const t=new Mt({times:new Map,showTime:e.showTime,paymentType:e.paymentType,id:e.id,hide:e.hide,showPrice:e.showPrice,price:e.price,index:e.index,maxTicketsForUser:e.maxTicketsForUser,colorIndex:e.colorIndex,name:e.name,isMulti:e.isMulti,note:e.note,count:e.count,maxParticipants:e.maxParticipants,amountInAdvance:e.amountInAdvance});return t.priceChangingNote=e.priceChangingNote,t.tempMaxParticipants=e.tempMaxParticipants,t.totalMinutes=e.totalMinutes,e.times.forEach((s,r)=>{t.times.set(r,Zi.fromTreatmentTime(s))}),t}static fromTreatmentsMap(e){let t=0;const s=new Mt({price:new qt({amount:"0",currency:Rs})});return e.forEach((r,i)=>{for(let o=0;o<r.count;o++)r.times.forEach((a,c)=>{s.times.set(t.toString(),a),t++}),r.price&&(s.price.amount+=r.price.amount,s.price.currency=r.price.currency),s.name===""?s.name=r.name:s.name+=` + ${r.name}`,s.showTime=s.showTime&&r.showTime,s.showPrice=s.showPrice&&r.showPrice,s.paymentType=r.paymentType,s.amountInAdvance+=r.amountInAdvance,s.totalMinutes+=r.totalMinutes}),s}get participants(){return this.tempMaxParticipants!==void 0?this.tempMaxParticipants:this.maxParticipants}priceToString(){return this.price.toString()}minutesToString(){return _a(new V({minutes:this.totalMinutes}))}static fromJson(e,t){const s=new Mt({times:new Map,id:e.id||"",colorIndex:e.colorIndex||-2,maxTicketsForUser:e.maxTicketsForUser||1,index:t,hide:e.hide||!1,name:e.name||"",isMulti:e.isMulti||!1,note:e.note||"",count:e.count||1,price:e.price?qt.fromJson(e.price):void 0,amountInAdvance:e.amountInAdvance!==void 0?typeof e.amountInAdvance=="number"?e.amountInAdvance:parseFloat(e.amountInAdvance):0,maxParticipants:e.maxParticipants||1,paymentType:L0[e.paymentType],showPrice:e.showPrice||!1,showTime:e.showTime||!1,showParticipants:e.showParticipants||!0});if(s.priceChangingNote=e.priceChangingNote,s.tempMaxParticipants=e.tempMaxParticipants,e.times)for(const r in e.times)s.times.set(r,Zi.fromJson(e.times[r]));return s.totalMinutes=s.totalTotalMinutes,s}toJson(){const e={};return e.times={},this.times.forEach((t,s)=>{e.times[s]=t.toJson()}),e.name=this.name,this.note!==""&&(e.note=this.note),this.id!==""&&(e.id=this.id),this.hide&&(e.hide=this.hide),this.maxTicketsForUser>1&&(e.maxTicketsForUser=this.maxTicketsForUser),this.colorIndex!==-2&&(e.colorIndex=this.colorIndex),this.priceChangingNote!==void 0&&(e.priceChangingNote=this.priceChangingNote),e.price=this.price?this.price.toJson():void 0,this.amountInAdvance!==0&&(e.amountInAdvance=this.amountInAdvance),this.paymentType!=null&&B0[this.paymentType]!=null&&(e.paymentType=B0[this.paymentType]),this.isMulti&&(e.isMulti=this.isMulti),this.tempMaxParticipants!==void 0&&(e.tempMaxParticipants=this.tempMaxParticipants),this.count!==1&&(e.count=this.count),this.maxParticipants!==1&&(e.maxParticipants=this.maxParticipants),this.showParticipants||(e.showParticipants=this.showParticipants),e.showPrice=this.showPrice,e.showTime=this.showTime,e}static fromOldJson(e,t,s,r){const i=new Mt({});if(e.times)for(const o in e.times)e.times.hasOwnProperty(o)&&i.times.set(o,Zi.fromJson(e.times[o]));return i.id="",i.colorIndex=r,i.index=t,i.name=i.parseNameFromDbField(s),e.price&&(i.price=qt.fromJson(e.price)),e.amountInAdvance!==void 0&&(i.amountInAdvance=typeof e.amountInAdvance=="number"?e.amountInAdvance:parseFloat(e.amountInAdvance)),i.paymentType=L0[e.paymentType],i.showPrice=e.showPrice||!1,i.showTime=e.showTime||!1,i.totalMinutes=i.totalTotalMinutes,i}parseNameFromDbField(e){return e.replace(ay,"/").replace(cy,"*")}parseNameToDbField(e){return e.replace("/",ay).replace("*",cy)}toString(){return JSON.stringify(this,null,2)}}class eo{constructor({treatmentId:e,minutes:t,maxParticipants:s,paymentRequestId:r,showWaitingList:i=!0,currentParticipants:o=0,expiredDate:a,index:c=0}){h(this,"treatmentId","");h(this,"currentParticipants",0);h(this,"maxParticipants");h(this,"minutes",0);h(this,"index",0);h(this,"showWaitingList",!0);h(this,"expiredDate");h(this,"paymentRequestId");this.treatmentId=e,this.currentParticipants=o,this.minutes=t,this.showWaitingList=i,this.maxParticipants=s,this.expiredDate=a,this.paymentRequestId=r,this.index=c}static fromMultiBookingTime(e){return new eo({treatmentId:e.treatmentId,currentParticipants:e.currentParticipants,minutes:e.minutes,showWaitingList:e.showWaitingList,maxParticipants:e.maxParticipants,expiredDate:e.expiredDate,paymentRequestId:e.paymentRequestId,index:e.index})}static fromJson(e){const t=e.TI||"",s=e.CP||0,r=e.M||0,i=e.PRI,o=e.SWL||!0,a=e.ED,c=e.MP,u=e.I||0,l=a?new Date(a):void 0;return new eo({treatmentId:t,currentParticipants:s,minutes:r,maxParticipants:c,paymentRequestId:i,showWaitingList:o,expiredDate:l,index:u})}toJson(){const e={};return this.treatmentId!==""&&(e.TI=this.treatmentId),this.currentParticipants!==0&&(e.CP=this.currentParticipants),this.maxParticipants!==void 0&&(e.MP=this.maxParticipants),this.paymentRequestId!==void 0&&(e.PRI=this.paymentRequestId),e.M=this.minutes,this.index!==0&&(e.I=this.index),this.showWaitingList||(e.SWL=this.showWaitingList),this.expiredDate!==void 0&&(e.ED=oe(this.expiredDate)),e}}class ug{constructor(){h(this,"times",{});h(this,"duringPaymentsTimes",{});h(this,"listener");h(this,"lastBookingTimeDate")}static fromJson(e){const t=new ug;return t.setData(e),t}setData(e,t=!0){this.times={},e.eventsTimes!==null&&Object.entries(e.eventsTimes).forEach(([s,r])=>{const i=new Date(s),o=new Date;o.setDate(o.getDate()-7),i>=o&&r instanceof Object&&Object.keys(r).length>0&&(this.times[s]={},Object.entries(r).forEach(([a,c])=>{this.times[s][a]=eo.fromJson(c)}))}),e.eventsTimeDuringPayment!==null&&t&&Object.entries(e.eventsTimeDuringPayment).forEach(([s,r])=>{const i=new Date(s),o=new Date;o.setDate(o.getDate()-7),i>=o&&Object.entries(r).forEach(([a,c])=>{var l,d;const u=eo.fromJson(c);if(u.expiredDate!==null&&u.expiredDate.getTime()>Date.now()){if((l=this.times)[s]??(l[s]={}),this.times[s][a]===null){const f=eo.fromMultiBookingTime(u);f.expiredDate=void 0,this.times[s][a]=f}else this.times[s][a].currentParticipants+=u.currentParticipants;i>(this.lastBookingTimeDate||new Date(0))&&(this.lastBookingTimeDate=i),(d=this.duringPaymentsTimes)[s]??(d[s]={}),this.duringPaymentsTimes[s][a]=u}})})}toJson(){const e={};return e.eventsTimes={},Object.entries(this.times).forEach(([t,s])=>{e.eventsTimes[t]={},Object.entries(s).forEach(([r,i])=>{e.eventsTimes[t][r]=i.toJson()})}),e}}class to{constructor(){h(this,"showAdressAlert",!1);h(this,"showAdressMessage",!1);h(this,"showPhoneAlert",!1);h(this,"showPhoneMessage",!1);h(this,"recurrenceNotificationsLastDate");h(this,"notifyOnPayments",!0);h(this,"notifyOnWaitingListEvents",!0);h(this,"notifyAboutCancelNearDeadline",!0);h(this,"notifyOnClientConfirmArrival",!0);h(this,"notifyAboutOrderNearDeadline",!0);h(this,"notificationOption",He.PushOrSMS);h(this,"notifyWhenGettingBooking",!0);h(this,"remindersTypes",new Map)}static fromJson(e){const t=new to;if(t.notifyOnWaitingListEvents=e.notifyOnWaitingListEvents??!0,e.notificationOption!==void 0&&(t.notificationOption=ql[e.notificationOption]??He.PushOrSMS),t.recurrenceNotificationsLastDate=e.recurrenceNotificationsLastDate?new Date(e.recurrenceNotificationsLastDate):void 0,t.remindersTypes=new Map,e.remindersTypes!==void 0)for(const[s,r]of Object.entries(e.remindersTypes)){const i=Ur[s];i!==void 0&&t.remindersTypes.set(i,r)}else t.remindersTypes.set(jt.regular,e.minutesBeforeNotify??60);return t.notifyOnClientConfirmArrival=e.notifyOnClientConfirmArrival??!0,t.showAdressAlert=e.showAdressAlert??!1,t.showAdressMessage=e.showAdressMessage??!1,t.showPhoneAlert=e.showPhoneAlert??!1,t.showPhoneMessage=e.showPhoneMessage??!1,t.notifyOnPayments=e.notifyOnPayments??!0,t.notifyAboutCancelNearDeadline=e.notifyAboutCancelNearDeadline??!0,t.notifyAboutOrderNearDeadline=e.notifyAboutOrderNearDeadline??!0,t.notifyWhenGettingBooking=e.notifyWhenGettingBooking??!0,t}isEqual(e){return JSON.stringify(e.toJson())===JSON.stringify(this.toJson())}static fromWorkerNotificatiosSettings(e){return to.fromJson(e.toJson())}toJson(){const e={};return this.notifyOnWaitingListEvents||(e.notifyOnWaitingListEvents=this.notifyOnWaitingListEvents),this.notificationOption!==He.PushOrSMS&&(e.notificationOption=He[this.notificationOption]),this.recurrenceNotificationsLastDate!=null&&(e.recurrenceNotificationsLastDate=oe(this.recurrenceNotificationsLastDate)),this.notifyOnClientConfirmArrival||(e.notifyOnClientConfirmArrival=this.notifyOnClientConfirmArrival),this.notifyOnPayments||(e.notifyOnPayments=this.notifyOnPayments),e.remindersTypes={},this.remindersTypes.forEach((t,s)=>{e.remindersTypes[jt[s]]=t}),this.notifyAboutCancelNearDeadline||(e.notifyAboutCancelNearDeadline=this.notifyAboutCancelNearDeadline),this.notifyAboutOrderNearDeadline||(e.notifyAboutOrderNearDeadline=this.notifyAboutOrderNearDeadline),this.notifyWhenGettingBooking||(e.notifyWhenGettingBooking=this.notifyWhenGettingBooking),this.showAdressAlert&&(e.showAdressAlert=this.showAdressAlert),this.showAdressMessage&&(e.showAdressMessage=this.showAdressMessage),this.showPhoneAlert&&(e.showPhoneAlert=this.showPhoneAlert),this.showPhoneMessage&&(e.showPhoneMessage=this.showPhoneMessage),e}toString(){return JSON.stringify(this.toJson())}}class no{constructor({freeFromPayments:e=!1,hashNumber:t="",blocked:s=!1}={}){h(this,"freeFromPayments");h(this,"hashNumber");h(this,"blocked");this.freeFromPayments=e,this.hashNumber=t,this.blocked=s}static fromJson(e,t){return new no({freeFromPayments:e.freeFromPayments,hashNumber:t})}static fromMinimalJson(e,t){return new no({blocked:e.B??!1,freeFromPayments:e.FP,hashNumber:t})}static fromCustomerData(e){return new no({blocked:e.blocked,freeFromPayments:e.freeFromPayments,hashNumber:e.hashNumber})}toJson(){const e={};return e.freeFromPayments=this.freeFromPayments,e.blocked=this.blocked,e}toMinimalJson(){const e={};return e.FP=this.freeFromPayments,e.B=this.blocked,e}toString(){return JSON.stringify(this.toJson(),null,2)}}class lg{constructor({publicCustomersData:e}={}){h(this,"publicCustomersData");this.publicCustomersData=e}static fromJson(e){return new lg().setPublicCustomersDataJson(e)}setPublicCustomersDataJson(e){return e.data??(e.data={}),this.publicCustomersData={},Object.entries(e.data).forEach(([t,s])=>{const r=no.fromMinimalJson(s,t);this.publicCustomersData[t]=r}),this}toMinimalJson(){const e={};return e.data={},this.publicCustomersData??(this.publicCustomersData={}),Object.entries(this.publicCustomersData).forEach(([t,s])=>{e.data[t]=s.toMinimalJson()}),e}}class Lr extends Set{constructor(e,t){super(e),t&&this.sort(t)}sort(e){this.clear(),Array.from(this).sort(e).forEach(t=>this.add(t))}get last(){if(this.size===0)return;const e=Array.from(this);return e[e.length-1]}get isEmpty(){return this.size===0}elementAt(e){if(!(e<0||e>=this.size))return Array.from(this)[e]}intersection(e){const t=new Lr;return this.forEach(s=>{e.has(s)&&t.add(s)}),t}}const VL={0:"years",1:"months",2:"weeks",3:"days"},UL={years:0,months:1,weeks:2,days:3},WL={0:"YEARLY",1:"MONTHLY",2:"WEEKLY",3:"DAILY"};var J1=(n=>(n[n.endless=0]="endless",n[n.date=1]="date",n[n.repeats=2]="repeats",n))(J1||{});const vf=["SU","MO","TU","WE","TH","FR","SA"],wf={0:new V({days:365}),1:new V({days:30}),2:new V({days:7}),3:new V({days:1})};class Vn{constructor({start:e,endOption:t=2,endDate:s,repeats:r=10,interval:i=1,weekDays:o=new Lr,customEndDate:a,freqRecurrence:c=3,exceptionDates:u=new Set}){h(this,"start");h(this,"endDate");h(this,"repeats",10);h(this,"interval",1);h(this,"freqRecurrence",3);h(this,"weekDays",new Lr);h(this,"endOption",2);h(this,"exceptionDates",new Set);h(this,"customEndDate");this.start=e,this.weekDays=o,this.endOption=t,this.endDate=s,this.repeats=r,this.interval=i,this.customEndDate=a,this.freqRecurrence=c,this.exceptionDates=u}static fromJson(e,t){const s=new Vn({});return s.start=t,e.ED?(s.endDate=$s(e.ED),s.endOption=1):e.R?(s.repeats=e.R,s.endOption=2):s.endOption=0,s.interval=e.I||1,s.weekDays=new Lr(e.WD||[]),s.exceptionDates=new Set(Object.keys(e.EDA||{}).map($s)),s.freqRecurrence=UL[e.FR]||3,s}toJson({saveStartDate:e=!1,saveEnd:t=!0,saveException:s=!0}){const r={};return t&&this.endDate&&this.endOption===1&&(r.ED=Ze(this.endDate)),t&&this.endOption===2&&(r.R=this.repeats),this.interval!==1&&(r.I=this.interval),this.weekDays.size>0&&this.freqRecurrence===2&&(r.WD=[...this.weekDays]),s&&this.exceptionDates.size>0&&(r.EDA={},this.exceptionDates.forEach(i=>{r.EDA[Ze(i)]=""})),e&&this.start&&(r.SD=oe(this.start)),r.FR=VL[this.freqRecurrence],r}static fromRecurrenceEvent(e){return new Vn({start:e.start,endDate:e.endDate,repeats:e.repeats,interval:e.interval,freqRecurrence:e.freqRecurrence,weekDays:new Lr(e.weekDays),endOption:e.endOption,exceptionDates:new Set(e.exceptionDates)})}isEqual(e){var t,s;return!this.start||!e.start||this.start.getTime()!==e.start.getTime()||(((t=this.endDate)==null?void 0:t.getTime())||0)!==(((s=e.endDate)==null?void 0:s.getTime())||0)?!1:this.repeats===e.repeats&&this.interval===e.interval&&this.freqRecurrence===e.freqRecurrence&&E_(e.weekDays,this.weekDays)&&E_(e.exceptionDates,this.exceptionDates)&&this.endOption===e.endOption}get syncfuString(){var t,s,r,i;let e=`FREQ=${WL[this.freqRecurrence]};`;if(this.freqRecurrence===1&&this.start&&(e+=`BYMONTHDAY=${this.start.getDate()};`),this.freqRecurrence===0&&this.start&&(e+=`BYMONTHDAY=${this.start.getDate()};BYMONTH=${this.start.getMonth()+1};`),e+=`INTERVAL=${this.interval};`,this.freqRecurrence===2&&this.weekDays.size>0&&(e+="BYDAY=",this.weekDays.forEach(o=>{o<vf.length&&(e+=vf[o]+",")}),e=e.slice(0,-1)+";"),this.customEndDate&&(this.endOption===0||this.endOfTheEvent&&this.endOfTheEvent>new Date)){const o=new Date(this.customEndDate.getFullYear(),this.customEndDate.getMonth(),this.customEndDate.getDate(),((t=this.start)==null?void 0:t.getHours())??0,((s=this.start)==null?void 0:s.getMinutes())??0);e+=`UNTIL=${Nt(o,"yyyyMMdd'T'HHmmss'Z'")}`}else switch(this.endOption){case 0:break;case 1:if(this.endDate){const o=new Date(this.endDate.getFullYear(),this.endDate.getMonth(),this.endDate.getDate(),((r=this.start)==null?void 0:r.getHours())??0,((i=this.start)==null?void 0:i.getMinutes())??0);e+=`UNTIL=${Nt(o,"yyyyMMdd'T'HHmmss'Z'")}`}break;case 2:e+=`COUNT=${this.repeats}`;break}return e}get accurances(){if(this.start&&this.endOption!==0){if(this.endOption===2)return this.repeats-this.exceptionDates.size;if(this.endOption===1&&this.endDate){let e=0;if(this.exceptionDates.forEach(t=>{t<=this.endDate&&e++}),this.freqRecurrence===2){let t=0;const s=Nr(this.start);this.weekDays.forEach(u=>{this.isAccureInDate({date:Z(s,new V({days:u})),considerException:!1})&&t++});const r=Math.abs(Z(s,new V({days:6})).getTime()-Nr(this.endDate).getTime()),i=Math.floor(r/this.rangeBetweenInterval.inMilliseconds),o=Nr(this.endDate);let a=0;return an(o).getTime()!==an(s).getTime()&&this.weekDays.forEach(u=>{this.isAccureInDate({date:Z(o,new V({days:u})),considerException:!1})&&a++}),i*this.weekDays.size+a+t-e}else if(this.freqRecurrence===1){const t=Qv(this.start,this.endDate);return Math.floor(t/this.interval)-e}else{const t=this.start.getTime()-this.endDate.getTime();return Math.floor(Math.abs(t)/this.rangeBetweenInterval.inDays)-e}}}}get rangeBetweenInterval(){return new V({minutes:wf[this.freqRecurrence].inMinutes*this.interval})}get endOfTheEvent(){const e=this.rangeBetweenInterval;if(this.endOption===1&&this.endDate!==void 0)return this.endDate??void 0;if(this.endOption===2)if(this.freqRecurrence===2){let t=0;const s=this.start.getDay()===7?0:this.start.getDay();this.weekDays.forEach(u=>{u>=s&&t++});const r=this.repeats-t,i=Math.ceil(r/this.weekDays.size),o=r%this.weekDays.size,a=new Date(this.start.getTime()+new V({minutes:e.inMinutes*i}).milliseconds),c=Nr(a);this.weekDays=new Lr(this.weekDays,(u,l)=>u-l);try{return new Date(c.getTime()+new V({days:o-1<0?this.weekDays.last:this.weekDays.elementAt(o-1)}).inMilliseconds)}catch{return}}else return this.freqRecurrence===1?Jv(this.start,(this.repeats-1)*this.interval):Z(this.start,new V({minutes:e.inMinutes*(this.repeats-1)}))}get explainText(){if(this.start===void 0)return"";let e="";const t=new V({minutes:wf[this.freqRecurrence].inMinutes*this.interval});switch(this.freqRecurrence){case 0:e+=J("yearTamplate").replaceAll("DURATION",_a(t)).replaceAll("DATE",Nt(this.start,"dd/MM"));break;case 1:e+=J("monthTemplate").replaceAll("DURATION",_a(t)).replaceAll("DATE",this.start.getDate().toString());break;case 2:let r="";this.weekDays.forEach(i=>{r+=J(vf[i])+", "}),r=r.substring(0,r.length-2),e+=J("weekTemplate").replaceAll("DURATION",_a(t)).replaceAll("DAYS",r).replaceAll("AMOUNT",J(Object.keys(this.weekDays).length===1?"onDay":"onDays"));break;case 3:e+=J("dayTemplate").replaceAll("DURATION",_a(t));break}const s=this.endOfTheEvent;return s!==void 0&&(e+=` ${J("until")} ${Ze(s)}`),e}isAccureInDate({date:e,considerException:t=!0}){if(this.start===void 0||an(this.start)>e)return!1;const s=this.endOfTheEvent;if(s!==void 0&&s<an(e)||t&&this.exceptionDates.has(an(e)))return!1;const r=new V({minutes:wf[this.freqRecurrence].inMinutes*this.interval}),i=Gr(e,an(this.start)),o=this.start.getDay()===7?0:this.start.getDay(),a=e.getDay()===7?0:e.getDay();if(this.freqRecurrence===2){const c=7-o,u=r.inDays-o,l=(i.inDays+r.inDays)%r.inDays;return(l<c||l>=u)&&this.weekDays.has(a)}if(this.freqRecurrence===1){const c=Qv(this.start,e);return this.start.getDate()===e.getDate()&&c%this.interval===0}return i.inDays%r.inDays===0}addRangeBetween(e){return this.freqRecurrence===1?Jv(e,this.interval):Z(e,this.rangeBetweenInterval)}overlapingDatesWith(e){if(this.start===void 0||e.start===void 0)return new Set([new Date(0)]);if(this.endOfTheEvent===void 0&&e.endOfTheEvent===void 0)return new Set([new Date(0)]);const t=new Set,s=this._getOptimalEventToPassOver(this,e),r=s[0],i=s[1];let o=r.start;for(;an(o)<=an(r.endOfTheEvent);){if(r.freqRecurrence===2){const a=Nr(o);r.weekDays.forEach(c=>{const u=Z(a,new V({days:c}));i.isAccureInDate({date:u})&&r.isAccureInDate({date:u})&&t.add(an(u))})}else i.isAccureInDate({date:o})&&r.isAccureInDate({date:o})&&t.add(an(o));o=this.addRangeBetween(o)}return t}get isRelevant(){return this.endOfTheEvent===void 0||this.endOfTheEvent>new Date}nearestFutureAccurenceDate(e,{needToBeAfterStart:t=!0}={}){if(console.log("eeeeeeeeeeeee",this.endOfTheEvent),this.endOfTheEvent!=null&&e>this.endOfTheEvent)return;if(this.start===void 0||e<this.start&&t&&this.isAccureInDate({date:this.start}))return this.start;const s=Gr(e,this.start).inDays;if(this.freqRecurrence===2){const a=Math.floor(s/this.rangeBetweenInterval.inDays);let c=Z(this.start,new V({days:a*this.rangeBetweenInterval.inDays})),u=Nr(c);for(const l of this.weekDays){const d=Z(u,new V({days:l}));if(d>=e&&(this.endOfTheEvent===void 0||c<=this.endOfTheEvent))return d}c=Z(c,this.rangeBetweenInterval),u=Nr(c);for(const l of this.weekDays){const d=Z(u,new V({days:l}));if(d>=e&&(this.endOfTheEvent===void 0||c<=this.endOfTheEvent))return d}return}const r=Math.ceil(s/this.rangeBetweenInterval.inDays);let i=Z(this.start,new V({days:r*this.rangeBetweenInterval.inDays}));i<e&&(i=this.addRangeBetween(i));const o=this.endOfTheEvent;for(;!this.isAccureInDate({date:i})&&(o===void 0||i<o);)console.log(this.isAccureInDate({date:i})),i=this.addRangeBetween(i);if(o===void 0||i<=o)return i}_getOptimalEventToPassOver(e,t){return e.endOfTheEvent===void 0&&t.endOfTheEvent!==void 0?[t,e]:e.endOfTheEvent!==void 0&&t.endOfTheEvent===void 0?[e,t]:(t.jumps??99999)<(e.jumps??99999)?[t,e]:[e,t]}get jumps(){if(this.start===void 0||this.endOfTheEvent===void 0)return;const t=new V({milliseconds:this.start.getTime()-this.endOfTheEvent.getTime()}).inMinutes/this.rangeBetweenInterval.inMinutes;return Math.ceil(t*Math.max(this.weekDays.size,1))}toString(){return JSON.stringify(this,void 0,2)}}class Cl{constructor({end:e,start:t,title:s="",id:r="",workerId:i=""}){h(this,"start",new Date(0));h(this,"end",new Date(0));h(this,"id","");h(this,"createdAt");h(this,"workerId","");h(this,"addedToDeviceCalendar",!1);h(this,"colorIndex",1);h(this,"title","");h(this,"recurrenceObj");this.start=t,this.end=e,this.title=s,this.id=r,this.workerId=i,this.recurrenceObj=new Vn({start:t,endDate:e,endOption:J1.date})}isOneDay(){return Ze(this.end)===Ze(this.start)}static fromEvent(e){var s;const t=new Cl({});return t.start=e.from,(s=e.recurrenceEvent)!=null&&s.endDate&&(t.end=e.recurrenceEvent.endDate),t.title=e.eventName,t.createdAt=e.vacationCreatedAt,t.id=e.vacationId,t.recurrenceObj=e.recurrenceEvent,t.addedToDeviceCalendar=e.vacationAddedToDeviceCalendar,t.colorIndex=e.colorIndex,t.workerId=e.ids.length>0?e.ids[0]:"",t}static fromVacation(e){const t=new Cl({});return t.start=e.start,t.end=e.end,t.addedToDeviceCalendar=e.addedToDeviceCalendar,t.id=e.id,t.createdAt=e.createdAt,t.workerId=e.workerId,t.title=e.title,t.colorIndex=e.colorIndex,t}}class HL{constructor(){h(this,"listener");h(this,"recurrenceEvents",{});h(this,"vacationsEvents",{})}get recurrenceEventsList(){const e=[];return Object.entries(this.recurrenceEvents).forEach(([t,s])=>{e.push(...Object.values(s))}),e}get recurrenceEventsListWithOutVacations(){const e=[];return Object.entries(this.recurrenceEvents).forEach(([t,s])=>{Object.entries(s).forEach(([r,i])=>{i.isVacation||e.push(i)})}),e}setRecurrenceEvents(e,t,s,{putBreaks:r=!0}={}){this.recurrenceEvents={},this.vacationsEvents={},Object.entries(e).forEach(([i,o])=>{this.recurrenceEvents[i]={};const a=$s(i);Object.entries(o).forEach(([c,u])=>{let l="",d="";const f=c.split("_");f.length===2&&(l=f[1]),d=f[0];const m=wc.fromJson({json:u,timeStr:d,businessModel:s,newTimeId:l,dayString:W0(a),monthString:Dr(a),workerId:t});m.isVacation&&(this.vacationsEvents[Ze(m.from)]=m),!(!r&&m.isBreak)&&(this.recurrenceEvents[i][c]=m)})})}vacationInDate(e){var t;for(const s of Object.values(this.vacationsEvents))if((t=s.recurrenceEvent)!=null&&t.isAccureInDate({date:e}))return Cl.fromEvent(s)}}const $L={R:"R",A:"A"},qL={R:"R",A:"A"};class kl{constructor({start:e,end:t,operation:s,shifts:r}){h(this,"start",new Date(0));h(this,"end",new Date(0));h(this,"operation","R");h(this,"shifts",[]);this.start=e,this.end=t,this.operation=s,this.shifts=r}static fromJson(e,t){const s=t.split("&"),r=new Date(s[0]),i=new Date(s[1]),o=qL[e.operation]||"R",a=e.shifts.map(c=>c);return new kl({start:r,end:i,operation:o,shifts:a})}static fromShiftChangeRange(e){const{start:t,end:s,operation:r,shifts:i}=e;return new kl({start:t,end:s,operation:r,shifts:[...i]})}isSameAs(e){return this.start.getTime()===e.start.getTime()&&this.end.getTime()===e.end.getTime()&&this.operation===e.operation&&this.shifts.toString()===e.shifts.toString()}toJson(){return{operation:$L[this.operation],shifts:this.shifts}}combineShifts(e){if(this.operation==="R")return this.shifts;const t=[];return Hv(t,e),Hv(t,this.shifts),G1(t)}getKey(){const e=Ze(this.start),t=Ze(this.end);return`${e}&${t}`}toString(){return JSON.stringify(this.toJson())}}class Sl{constructor({name:e,treatments:t,index:s}){h(this,"name","");h(this,"index","");h(this,"treatments",new Map);this.name=e,this.treatments=t,this.index=s}static fromJson(e,t,{pointerShortBookingTime:s,pointerLognestBookingTime:r}={}){const i=e.name||"",o=t,a=new Map;return e.treatments&&Object.entries(e.treatments).forEach(([c,u])=>{a.set(c,Mt.fromJson(u,c)),s&&(a.get(c).totalMinutes<s[0]&&(s[0]=Math.max(a.get(c).times.get("0").workMinutes,5)),a.get(c).totalMinutes===s[0]&&(s[0]=Math.min(Math.max(a.get(c).times.get("0").workMinutes,5),s[0]))),r&&a.get(c).totalMinutes>r[0]&&(r[0]=Math.max(a.get(c).totalMinutes,5))}),new Sl({name:i,treatments:a,index:o})}containTreatment(e){for(const[t,s]of this.treatments)if(s.id===e)return!0;return!1}toJson(){const e={};return e.name=this.name,e.treatments={},Object.entries(this.treatments).forEach(([t,s])=>{e.treatments[t]=s.toJson()}),e}fromTreatmentSubject(e){return this.name=e.name,this.index=e.index,this.treatments=new Map,e.treatments.forEach((t,s)=>{this.treatments.set(s,Mt.fromTreatment(t))}),this}toString(){return JSON.stringify(this.toJson(),null,2)}}const Q1=new Set([new Date(2023,10,29)]);class YL{constructor(){h(this,"bookingsTimes",{});h(this,"lastBookingTimeDate");h(this,"duringPaymentBookingsTime",{});h(this,"listener")}findLastBookingsTimesDate(){let e;return Object.entries(this.bookingsTimes).forEach(([t,s])=>{const r=new Date(t);Object.keys(s).length>0&&(!e||r>e)&&(e=r)}),e}setWorkerPublicData(e,t=!0){this.duringPaymentBookingsTime={},this.bookingsTimes={},Q1.forEach(s=>{s=Z(s,new V({hours:1})),this.bookingsTimes[Ze(s)]={[pn(s)]:60}}),e.bookingsTimes!=null&&Object.entries(e.bookingsTimes).forEach(([s,r])=>{const i=$s(s),o=Fn(new Date,new V({days:7}));i>=o&&Object.keys(r).length!=0&&(this.bookingsTimes[s]={},Object.entries(r).forEach(([a,c])=>{a.includes("00:00v")?t&&(this.bookingsTimes[s]={"00:00":1439}):(a!=="00:00"||this.bookingsTimes[s]["00:00"]!=1439)&&(this.bookingsTimes[s][a]=c)}),Object.keys(r).length>0&&i>(this.lastBookingTimeDate||new Date(0))&&(this.lastBookingTimeDate=i))}),e.duringPaymentBookingsTime!==null&&Object.entries(e.duringPaymentBookingsTime).forEach(([s,r])=>{const i=new Date(s),o=new Date;o.setDate(o.getDate()-7),i>=o&&Object.entries(r).forEach(([a,c])=>{c.length===2&&c[0]instanceof Be&&c[0].toDate().getTime()>Date.now()&&typeof c[1]=="number"&&(s in this.bookingsTimes?this.bookingsTimes[s][a]=c[1]:this.bookingsTimes[s]={[a]:c[1]},i>(this.lastBookingTimeDate||new Date(0))&&(this.lastBookingTimeDate=i),s in this.duringPaymentBookingsTime?this.duringPaymentBookingsTime[s][a]=c:this.duringPaymentBookingsTime[s]={[a]:c})})})}emptyBookingTimesDatesInMonth(e){Object.entries(this.bookingsTimes).forEach(([t,s])=>{t.includes(e)&&(this.bookingsTimes[t]={})})}toWorkerPublicDataJson(){const e={};return e.bookingsTimes={},Object.entries(this.bookingsTimes).forEach(([t,s])=>{e.bookingsTimes[t]={},Object.entries(s).forEach(([r,i])=>{e.bookingsTimes[t][r]=i})}),e.duringPaymentBookingsTime={},Object.entries(this.duringPaymentBookingsTime).forEach(([t,s])=>{e.duringPaymentBookingsTime[t]={},Object.entries(s).forEach(([r,i])=>{e.duringPaymentBookingsTime[t][r]=i})}),e}}class _c{constructor({}){h(this,"daysToAllowBookings",7);h(this,"name","");h(this,"phone","");h(this,"id","");h(this,"profileImg","");h(this,"about","");h(this,"maxTreatments",5);h(this,"allowAppNotification",!0);h(this,"religions",[]);h(this,"waitingListExceptionDays",new Set);h(this,"closeScheduleOnHolidays",!1);h(this,"weekendDays",[5,6]);h(this,"onHoldMinutes",0);h(this,"cancelMinutes",0);h(this,"minutesBeforeBookingToConfirm",1440);h(this,"tempFcm");h(this,"hasRecurrenceEvents",!1);h(this,"windowSpaces",Wn.shortestTreatment);h(this,"customWindowMinute",30);h(this,"showWaitingListWhenThereIsChoises",!0);h(this,"isVerifiedPhone",!1);h(this,"lastCleanDate",new Date);h(this,"gender",Ee.anonymous);h(this,"deleteNeerDedlineBookingMessage");h(this,"orderNeerDedlineBookingMessage");h(this,"generalBookingMessage");h(this,"closeCalendarDate");h(this,"minDateForShowinData",new Date(0));h(this,"openCalendar",!0);h(this,"maxFutureBookings",4);h(this,"currentClientCount",0);h(this,"showVacations",!0);h(this,"mustVerifyPhone",!0);h(this,"allowBookingConfirmations",!0);h(this,"devices",new Map);h(this,"storyImages",new Map);h(this,"createdAt",new Date(0));h(this,"workTime",new Map([["sunday",[]],["monday",[]],["tuesday",[]],["wednesday",[]],["thursday",[]],["friday",[]],["saturday",[]]]));h(this,"isCustomersNeedRecurrence",!1);h(this,"specificRangeChanges",new Map);h(this,"treatmentsSubjects",new Map);h(this,"workerPublicData",new YL);h(this,"publicCustomers",new lg);h(this,"storylikesAmount",{});h(this,"multiEventsTimes",new ug);h(this,"generalBookingsCount",0);h(this,"passedBookingsCount",0);h(this,"shortBookingTime",999);h(this,"longestBookingTime",0);h(this,"recurrence",new HL);h(this,"notifications",new to);h(this,"workerDocListner")}static fromUserPublicData(e){const t=new _c({});return t.phone=e.phoneNumber||"",t.currentClientCount=e.currentClientCount||0,t.id=e.id||t.phone,t.name=e.name||"",e.devices!=null&&typeof e.devices=="object"?Object.entries(e.devices).forEach(([s,r])=>{t.devices.set(s,is.fromJson(r,s))}):e.currentFcm!=null&&e.currentFcm!==""&&(t.tempFcm=e.currentFcm),t.gender=Bs[e.gender]||Ee.anonymous,t.lastCleanDate=new Date,t.createdAt=new Date,t.notifications.remindersTypes=new Map([[jt.regular,60]]),t}static fromWorkerDocJson(e){const t=new _c({});return t.setFromWorkerDoc(e),t}get treatmentsLength(){let e=0;return Object.values(this.treatmentsSubjects).forEach(t=>{e+=Object.values(t.treatments).length}),e}shiftsFor({day:e}){const t=this.workTime.get(Nt(e,"EEEE").toLowerCase())||[];console.log("this.workTime",this.workTime),console.log("format(day, EEEE).toLowerCase()",Nt(e,"EEEE").toLowerCase()),console.log("defaultShifts",t);for(const s of Object.values(this.specificRangeChanges))if(Ac(s.start,new Date(s.end.getTime()+23*60*60*1e3+59*60*1e3),e,e)==="STRIKE")return s.combineShifts(t);return G1(BL(t))}get fcmsTokens(){if(!this.allowAppNotification)return new Set;if(this.tempFcm!=null)return new Set([this.tempFcm]);const e=new Set;for(const t of Object.values(this.devices))t.activeNotifications&&e.add(t.token);return e}isClosingDate(e){return!this.openCalendar||this.closeCalendarDate!=null&&an(this.closeCalendarDate).getTime()===an(e).getTime()}hasTreatemnt(e){for(const[t,s]of this.treatmentsSubjects)if(s.containTreatment(e))return!0;return!1}get useWhatsApp(){return this.notifications.notificationOption===He.WhatsApp||this.notifications.notificationOption===He.PushOrWhatsApp}setFromWorkerDoc(e){if(this.daysToAllowBookings=e.daysToAllowBookings||7,this.profileImg=e.profileImg||"",this.about=e.about||"",e.lastCleanDate instanceof Be?this.lastCleanDate=e.lastCleanDate.toDate():typeof e.lastCleanDate=="string"&&(this.lastCleanDate=new Date(e.lastCleanDate)||new Date),e.religions&&(this.religions=e.religions.map(t=>yC[t])),e.windowSpaces&&(this.windowSpaces=FL[e.windowSpaces]||Wn.shortestTreatment),this.isCustomersNeedRecurrence=e.isCustomersNeedRecurrence||!1,this.showWaitingListWhenThereIsChoises=e.showWaitingListWhenThereIsChoises||!0,this.customWindowMinute=e.customWindowMinute||30,this.closeScheduleOnHolidays=e.closeScheduleOnHolidays||!1,this.weekendDays=e.weekendDays||[5,6],this.mustVerifyPhone=e.mustVerifyPhone||!0,this.showVacations=e.showVacations||!0,this.gender=Bs[e.gender]||Ee.anonymous,this.allowAppNotification=e.allowAppNotification||!0,this.name=e.name||"",this.maxTreatments=e.maxTreatments||3,this.phone=e.phone||"",this.hasRecurrenceEvents=e.hasRecurrenceEvents||!1,this.id=e.id||e.phone||"",this.minutesBeforeBookingToConfirm=e.minutesBeforeBookingToConfirm||1440,this.maxFutureBookings=e.maxFutureBookings||4,this.treatmentsSubjects=new Map,this.shortBookingTime=999,e.treatmentsSubjects){let t=[this.shortBookingTime],s=[this.longestBookingTime];Object.entries(e.treatmentsSubjects).forEach(([r,i])=>{const o=Sl.fromJson(i,r,{pointerShortBookingTime:t,pointerLognestBookingTime:s});this.treatmentsSubjects.set(r,o)}),this.shortBookingTime=t[0],this.longestBookingTime=s[0]}else if(e.treatments){const t=new Map;let s=0;Object.entries(e.treatments).forEach(([r,i])=>{const o=Mt.fromOldJson(i,s.toString(),r,s+4);t.set(s.toString(),o),o.totalMinutes<this.shortBookingTime&&(this.shortBookingTime=Math.max(o.times.get("0").workMinutes,5)),o.totalMinutes===this.shortBookingTime&&(this.shortBookingTime=Math.min(Math.max(o.times.get("0").workMinutes,5),this.shortBookingTime)),s+=1}),this.treatmentsSubjects=new Map([["0",new Sl({name:J("general"),treatments:t,index:"0"})]])}this.onHoldMinutes=e.onHoldMinutes||0,this.cancelMinutes=e.cancelMinutes||0,e.devices!=null&&typeof e.devices=="object"&&Object.entries(e.devices).forEach(([t,s])=>{this.devices.set(t,is.fromJson(s,t))}),this.deleteNeerDedlineBookingMessage=e.deleteNeerDedlineBookingMessage,this.orderNeerDedlineBookingMessage=e.orderNeerDedlineBookingMessage,this.generalBookingMessage=e.generalBookingMessage,this.workTime=new Map,e.workTime&&Object.entries(e.workTime).forEach(([t,s])=>{this.workTime.set(t,s.map(r=>r))}),this.waitingListExceptionDays=new Set,e.waitingListExceptionDays&&e.waitingListExceptionDays.forEach(t=>{this.waitingListExceptionDays.add(t)}),e.notifications?this.notifications=to.fromJson(e.notifications):(this.notifications=new to,this.notifications.notifyOnWaitingListEvents=e.notifyOnWaitingListEvents||!0,this.notifications.showAdressAlert=e.showAdressAlert||!1,this.notifications.showAdressMessage=e.showAdressMessage||!1,this.notifications.showPhoneAlert=e.showPhoneAlert||!1,this.notifications.showPhoneMessage=e.showPhoneMessage||!1,this.notifications.remindersTypes=new Map([[jt.regular,e.minutesBeforeNotify||60]]),this.notifications.notifyOnPayments=e.notifyOnPayments||!0,this.notifications.notifyAboutCancelNearDeadline=e.notifyAboutCancelNearDeadline||!0,this.notifications.notifyAboutOrderNearDeadline=e.notifyAboutOrderNearDeadline||!0,this.notifications.notifyWhenGettingBooking=e.notifyWhenGettingBooking||!0,e.notificationOption&&(this.notifications.notificationOption=ql[e.notificationOption]||He.OnlyPush),e.recurrenceNotificationsLastDate?this.notifications.recurrenceNotificationsLastDate=new Date(e.recurrenceNotificationsLastDate):this.notifications.recurrenceNotificationsLastDate=new Date),this.specificRangeChanges=new Map,e.specificRangeChanges&&Object.entries(e.specificRangeChanges).forEach(([t,s])=>{const r=kl.fromJson(s,t);r.end>=an(new Date)&&this.specificRangeChanges.set(t,r)}),this.storyImages=new Map,e.storyImages&&Object.entries(e.storyImages).forEach(([t,s])=>{this.storyImages.set(t,s)}),e.closeCalendarDate&&(this.closeCalendarDate=new Date(e.closeCalendarDate)),e.minDateForShowinData&&(this.minDateForShowinData=$s(e.minDateForShowinData)),this.openCalendar=e.openCalendar||!0,this.allowBookingConfirmations=e.allowBookingConfirmations||!0,e.createdAt?this.createdAt=new Date(e.createdAt):this.createdAt=new Date(2023,0,1),this.id===this.phone?this.isVerifiedPhone=!0:this.isVerifiedPhone=e.isVerifiedPhone||!1}getInvoiceWorkerInfo(){return new InvoiceWorkerInfo({workerId:this.id,workerName:this.name})}getFcmsTokens(){if(!this.allowAppNotification)return new Set;if(this.tempFcm!=null)return new Set([this.tempFcm]);const e=new Set;return Object.values(this.devices).forEach(t=>{t.activeNotifications&&e.add(t.token)}),e}toWorkerDocJson(){const e={};return e.workTime={},Object.entries(this.workTime).forEach(([t,s])=>{e.workTime[t]=s}),e.specificRangeChanges={},Object.entries(this.specificRangeChanges).forEach(([t,s])=>{e.specificRangeChanges[t]=s.toJson()}),e.religions=[],this.religions.forEach(t=>{e.religions.push(gC[t])}),this.closeCalendarDate!=null&&(e.closeCalendarDate=new Intl.DateTimeFormat("en-US",{day:"2-digit",month:"2-digit",year:"numeric"}).format(this.closeCalendarDate)),this.minDateForShowinData.getFullYear()!=new Date(0).getFullYear()&&(e.minDateForShowinData=Ze(this.minDateForShowinData)),this.openCalendar||(e.openCalendar=this.openCalendar),e.allowBookingConfirmations=this.allowBookingConfirmations,this.mustVerifyPhone||(e.mustVerifyPhone=this.mustVerifyPhone),this.isCustomersNeedRecurrence&&(e.isCustomersNeedRecurrence=this.isCustomersNeedRecurrence),e.weekendDays=this.weekendDays,e.maxTreatments=this.maxTreatments,e.gender=ao[this.gender],e.onHoldMinutes=this.onHoldMinutes,e.cancelMinutes=this.cancelMinutes,this.hasRecurrenceEvents&&(e.hasRecurrenceEvents=this.hasRecurrenceEvents),this.showVacations||(e.showVacations=this.showVacations),e.devices={},Object.entries(this.devices).forEach(([t,s])=>{e.devices[t]=s.toJson()}),e.deleteNeerDedlineBookingMessage=this.deleteNeerDedlineBookingMessage,e.orderNeerDedlineBookingMessage=this.orderNeerDedlineBookingMessage,e.generalBookingMessage=this.generalBookingMessage,e.closeScheduleOnHolidays=this.closeScheduleOnHolidays,this.customWindowMinute!=30&&(e.customWindowMinute=this.customWindowMinute),this.windowSpaces!=Wn.shortestTreatment&&(e.windowSpaces=OL[this.windowSpaces]),this.minutesBeforeBookingToConfirm!=1440&&(e.minutesBeforeBookingToConfirm=this.minutesBeforeBookingToConfirm),e.bookingDaysToDeleteLocal=[],e.notifications=this.notifications.toJson(),e.lastCleanDate=this.lastCleanDate.toString(),e.daysToAllowBookings=this.daysToAllowBookings,this.maxFutureBookings!=4&&(e.maxFutureBookings=this.maxFutureBookings),this.currentClientCount!=0&&(e.currentClientCount=this.currentClientCount),this.allowAppNotification||(e.allowAppNotification=this.allowAppNotification),this.waitingListExceptionDays.entries.length>0&&(e.waitingListExceptionDays=Array.from(this.waitingListExceptionDays)),e.treatmentsSubjects={},Object.entries(this.treatmentsSubjects).forEach(([t,s])=>{e.treatmentsSubjects[t]=s.toJson()}),this.showWaitingListWhenThereIsChoises||(e.showWaitingListWhenThereIsChoises=this.showWaitingListWhenThereIsChoises),this.isVerifiedPhone&&(e.isVerifiedPhone=this.isVerifiedPhone),e.profileImg=this.profileImg,e.about=this.about,e.name=name,e.phone=this.phone,e.id=this.id,e.storyImages={},Object.entries(this.storyImages).forEach(([t,s])=>{e.storyImages[t]=s}),e.createdAt=oe(this.createdAt),e}toString(){return JSON.stringify(this.toWorkerDocJson())+this.workerPublicData.toWorkerPublicDataJson().toString()}}function K1({booking:n,worker:e,notificationOption:t,customHsEnoughMessages:s}){if(t=t||(e==null?void 0:e.notifications.notificationOption),!t)return X.none;const r=s||je.GI().business.businessData.messagesCounter>1;switch(t){case He.OnlyPush:return Object.values(n.userFcms).length===0?X.none:X.push;case He.SMSOnly:return!n.canSendMessage||!r?X.none:X.message;case He.WhatAppOnly:return!n.canSendMessage||!r?X.none:X.whatsapp;case He.PushOrSMS:return Object.values(n.userFcms).length>0?X.push:!n.canSendMessage||!r?X.none:X.message;case He.PushOrWhatsApp:return Object.values(n.userFcms).length>0?X.push:!n.canSendMessage||!r?X.none:X.whatsapp;case He.SMSOrPush:return n.canSendMessage&&r?X.message:Object.values(n.userFcms).length>0?X.push:X.none;case He.WhatsAppOrPush:return n.canSendMessage&&r?X.whatsapp:Object.values(n.userFcms).length>0?X.push:X.none;default:return X.none}}function zL(n,e){const t=je.GI().business.businessData.messagesCounter>1;switch(e.notifications.notificationOption){case He.OnlyPush:return Object.keys(n.userFcms).length===0?X.none:X.push;case He.SMSOnly:return!n.canSendMessage||!t?X.none:X.message;case He.WhatAppOnly:return!n.canSendMessage||!t?X.none:X.whatsapp;case He.PushOrSMS:return Object.values(n.userFcms).length>0?X.push:!n.canSendMessage||!t?X.none:X.message;case He.PushOrWhatsApp:return Object.values(n.userFcms).length>0?X.push:!n.canSendMessage||!t?X.none:X.whatsapp;case He.SMSOrPush:return n.canSendMessage&&t?X.message:Object.values(n.userFcms).length>0?X.push:X.none;case He.WhatsAppOrPush:return n.canSendMessage&&t?X.whatsapp:Object.values(n.userFcms).length>0?X.push:X.none;default:return X.none}}var V0={exports:{}},$v=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if($v){var qv=new Uint8Array(16);V0.exports=function(){return $v(qv),qv}}else{var Yv=new Array(16);V0.exports=function(){for(var e=0,t;e<16;e++)e&3||(t=Math.random()*4294967296),Yv[e]=t>>>((e&3)<<3)&255;return Yv}}var j1=V0.exports,X1=[];for(var Eu=0;Eu<256;++Eu)X1[Eu]=(Eu+256).toString(16).substr(1);function GL(n,e){var t=e||0,s=X1;return[s[n[t++]],s[n[t++]],s[n[t++]],s[n[t++]],"-",s[n[t++]],s[n[t++]],"-",s[n[t++]],s[n[t++]],"-",s[n[t++]],s[n[t++]],"-",s[n[t++]],s[n[t++]],s[n[t++]],s[n[t++]],s[n[t++]],s[n[t++]]].join("")}var Z1=GL,JL=j1,QL=Z1,zv,xf,Ef=0,Tf=0;function KL(n,e,t){var s=e&&t||0,r=e||[];n=n||{};var i=n.node||zv,o=n.clockseq!==void 0?n.clockseq:xf;if(i==null||o==null){var a=JL();i==null&&(i=zv=[a[0]|1,a[1],a[2],a[3],a[4],a[5]]),o==null&&(o=xf=(a[6]<<8|a[7])&16383)}var c=n.msecs!==void 0?n.msecs:new Date().getTime(),u=n.nsecs!==void 0?n.nsecs:Tf+1,l=c-Ef+(u-Tf)/1e4;if(l<0&&n.clockseq===void 0&&(o=o+1&16383),(l<0||c>Ef)&&n.nsecs===void 0&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Ef=c,Tf=u,xf=o,c+=122192928e5;var d=((c&268435455)*1e4+u)%4294967296;r[s++]=d>>>24&255,r[s++]=d>>>16&255,r[s++]=d>>>8&255,r[s++]=d&255;var f=c/4294967296*1e4&268435455;r[s++]=f>>>8&255,r[s++]=f&255,r[s++]=f>>>24&15|16,r[s++]=f>>>16&255,r[s++]=o>>>8|128,r[s++]=o&255;for(var m=0;m<6;++m)r[s+m]=i[m];return e||QL(r)}var jL=KL,XL=j1,ZL=Z1;function e8(n,e,t){var s=e&&t||0;typeof n=="string"&&(e=n==="binary"?new Array(16):null,n=null),n=n||{};var r=n.random||(n.rng||XL)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e)for(var i=0;i<16;++i)e[s+i]=r[i];return e||ZL(r)}var t8=e8,n8=jL,eD=t8,hg=eD;hg.v1=n8;hg.v4=eD;var s8=hg;const dg=yw(s8);class Fs{constructor({monthStr:e,invoiceId:t,docId:s,amount:r,issuedBy:i}){h(this,"invoiceId","");h(this,"docId","");h(this,"monthStr","");h(this,"issuedBy","");h(this,"amount",0);this.monthStr=e,this.invoiceId=t,this.docId=s,this.amount=r,this.issuedBy=i}toJson(){const e={};return e.monthStr=this.monthStr,e.docId=this.docId,e.issuedBy=this.issuedBy,e.amount=this.amount,e}static fromJson(e,t,s){const r=new Fs({});return r.invoiceId=t,r.docId=e.docId??"",r.monthStr=e.monthStr??"",r.issuedBy=e.issuedBy??s,e.amount!=null&&(r.amount=typeof e.amount=="number"?e.amount:parseFloat(e.amount)),r}static fromBookingInvoiceData(e){const t=new Fs({});return t.invoiceId=e.invoiceId,t.docId=e.docId,t.monthStr=e.monthStr,t.issuedBy=e.issuedBy,t.amount=e.amount,t}toString(){return JSON.stringify(this.toJson(),null,2)}}class Ti{constructor({userId:e="",name:t="",gender:s=Ee.male,isVerifiedPhone:r=!1,phone:i="",isExist:o=!0,userDecline:a=!1}){h(this,"userId","");h(this,"name","");h(this,"gender",Ee.male);h(this,"phone","");h(this,"payments",{});h(this,"isExist",!1);h(this,"fcmTokens");h(this,"isVerifiedPhone",!1);h(this,"userDecline",!1);this.userId=e,this.name=t,this.gender=s,this.isVerifiedPhone=r,this.phone=i,this.isExist=o,this.userDecline=a}get customerHashPhone(){return di(this.phone)}get customerPhoneAsCollection(){return this.phone.replaceAll("-","")}get isPaid(){return Object.keys(this.payments).length>0}static fromJson(e,t){const s=new Ti({userId:t,name:e.N??"",gender:e.G?Bs[e.G]:Ee.male,isVerifiedPhone:e.IVP??!1,phone:e.P??"",isExist:e.IE??!0,userDecline:e.UD??!1});return e.PY!=null&&typeof e.PY=="object"&&Object.entries(e.PY).forEach(([r,i])=>{s.payments[r]=i?new Date(i):new Date(0)}),s}toJson(){const e={};return e.N=this.name,this.isVerifiedPhone&&(e.IVP=this.isVerifiedPhone),this.isExist||(e.IE=this.isExist),e.P=this.phone,this.gender!==Ee.male&&(e.G=Ee[this.gender]),Object.keys(this.payments).length>0&&(e.PY={},Object.entries(this.payments).forEach(([t,s])=>{e.PY[t]=oe(s)})),this.userDecline&&(e.UD=this.userDecline),e}toString(){return JSON.stringify(this.toJson(),null,"  ")}}class bo{constructor({createdAt:e,amount:t,id:s,showUser:r,description:i=""}){h(this,"createdAt",new Date(0));h(this,"id","");h(this,"amount",0);h(this,"description","");h(this,"showUser",!1);this.createdAt=e,this.amount=t,this.id=s,this.showUser=r,this.description=i}static fromJson(e,t){return new bo({createdAt:e.createdAt?new Date(e.createdAt):new Date(0),amount:e.amount!=null?typeof e.amount=="number"?e.amount:parseFloat(e.amount):0,id:t,showUser:e.showUser??!1,description:e.description??""})}static fromDebt(e){return new bo({createdAt:e.createdAt,amount:e.amount,id:e.id,showUser:e.showUser,description:e.description})}isEqual(e){return e.id===this.id&&e.description===this.description&&e.showUser===this.showUser&&oe(e.createdAt)===oe(this.createdAt)&&this.amount===e.amount}toJson(){const e={};return e.createdAt=oe(this.createdAt),e.amount=this.amount,this.showUser&&(e.showUser=this.showUser),this.description!==""&&(e.description=this.description),e}}const{v4:r8}=dg;class fg{constructor(){h(this,"customerName","");h(this,"customerPhone","");h(this,"isVerifiedPhone",!1);h(this,"notificationType",X.none);h(this,"workerNotificationOption",He.PushOrSMS);h(this,"workerRemindersTypes",new Map);h(this,"customerId","");h(this,"orderingOptions",In.app);h(this,"remindersTypes",new Map);h(this,"isUserExist",!0);h(this,"signOnDeviceCalendar",!1);h(this,"lastTimeNotifyOnDebt",null);h(this,"clientMail","");h(this,"finishInvoices",!1);h(this,"showAdressAlert",!1);h(this,"userBookingId","");h(this,"showPhoneAlert",!1);h(this,"cancelDate",null);h(this,"wasWaiting",!1);h(this,"createdAt",new Date(0));h(this,"needCancel",!1);h(this,"userGender",Ee.anonymous);h(this,"status",Ht.approved);h(this,"confirmedArrival",!1);h(this,"userFcms",new Set);h(this,"clientNote","");h(this,"invoices",new Map);h(this,"transactions",new Map);h(this,"debts",new Map);h(this,"addToClientAt",!1);h(this,"userDeleted",!1)}copyDataToOrder({worker:e,needToHoldOn:t,workerAction:s,bookingDate:r,addToCalendar:i,business:o,user:a,noteText:c=""}){this.clientNote=c,t?this.status=Ht.waiting:this.status=Ht.approved,this.showAdressAlert=e.notifications.showAdressAlert,this.showPhoneAlert=e.notifications.showPhoneAlert,!s&&!t&&r.getTime()-Date.now()<60*60*1e3&&(this.confirmedArrival=!0),this.signOnDeviceCalendar=i,this.workerNotificationOption=e.notifications.notificationOption,this.workerRemindersTypes=new Map(e.notifications.remindersTypes),e.notifications.remindersTypes.forEach((l,d)=>{r.getTime()<Date.now()||d===jt.confirmArrival&&this.confirmedArrival||(r.getTime()-l*60*1e3<Date.now()+1e3?(this.remindersTypes.set(d,Math.abs(Math.floor((Date.now()-r.getTime())/1e3/60/2))-Math.abs(Math.floor((Date.now()-r.getTime())/1e3/60/2))%5),this.remindersTypes.get(d)<10&&this.remindersTypes.delete(d)):this.remindersTypes.set(d,l))}),this.orderingOptions=In.web,this.isUserExist=!0,this.userFcms=new Set(a.userPublicData.fcmsTokens),this.isVerifiedPhone=a.isVerifiedPhone;const u=a.userPublicData.clientAt;this.addToClientAt=!u.has(o.businessId)||!u.get(o.businessId).has(e.id),this.createdAt.getTime()===new Date(0).getTime()&&(this.createdAt=new Date),this.userBookingId===""&&(this.userBookingId=r8()),this.notificationType=zL(this,e)}get isDepositTransaction(){let e=!1;return this.transactions.forEach((t,s)=>{e=t.type===jn.deposit}),e}get transactionsTotalPaymentAmount(){let e=0;return this.transactions.forEach((t,s)=>{t.type===jn.payment&&(e+=t.amount)}),e}get canSendMessage(){return this.isVerifiedPhone||this.orderingOptions===In.byWorker}get totalDebtAmount(){let e=0;return this.debts.forEach((t,s)=>{e+=t.amount}),e}get invoicePriceAmount(){return Array.from(this.invoices.values()).reduce((e,t)=>e+t.amount,0)}invoicesCoverPrice(e){const{totalAmount:t}=e;return this.finishInvoices||this.invoices.size>0&&Array.from(this.invoices.values()).reduce((s,r)=>s+r.amount,0)>=t}get transactionsTotalDepositAmount(){let e=0;return this.transactions.forEach((t,s)=>{t.type===jn.deposit&&(e+=t.amount)}),e}get customerHashPhone(){return di(this.customerPhone)}get customerPhoneAsCollection(){return this.customerPhone.replace(/-/g,"")}reminderId(e){return this.userBookingId+"__"+Hi[e]}get toPaymentRequestUser(){return new Ti({name:this.customerName,userId:this.customerId,gender:this.userGender,isExist:this.isUserExist,isVerifiedPhone:this.isVerifiedPhone,phone:this.customerPhone})}get typesOfEvents(){const e=new Map;return this.needCancel&&e.set(zr.needCancel,1),this.debts.size>0&&e.set(zr.withDebts,1),this.status===Ht.waiting&&e.set(zr.onHold,1),e}static fromJson(e,t,s){const r=new fg;return r.customerName=e.customerName||"",r.customerId=e.customerId||"",r.customerPhone=e.customerPhone||r.customerId,r.needCancel=e.needCancel||!1,r.remindersTypes=e.remindersTypes?new Map(Object.entries(e.remindersTypes).map(([i,o])=>[Ur[i],o])):new Map([[jt.regular,e.minutesBeforeNotify||60]]),r.workerRemindersTypes=e.workerRemindersTypes?new Map(Object.entries(e.workerRemindersTypes).map(([i,o])=>[Ur[i],o])):new Map,r.signOnDeviceCalendar=e.signOnDeviceCalendar||!1,r.userDeleted=e.userDeleted||!1,r.isVerifiedPhone=e.isVerifiedPhone||!1,r.clientMail=e.clientMail||"",r.clientNote=e.clientNote||"",r.userBookingId=t,r.orderingOptions=Zw[e.orderingOptions]||In.app,r.debts=e.debts?new Map(Object.entries(e.debts).map(([i,o])=>[i,bo.fromJson(o,i)])):new Map,r.finishInvoices=e.finishInvoices||!1,r.cancelDate=e.cancelDate?new Date(e.cancelDate):null,r.wasWaiting=e.wasWaiting||!1,r.isUserExist=e.isUserExist||!0,r.lastTimeNotifyOnDebt=e.lastTimeNotifyOnDebt?new Date(e.lastTimeNotifyOnDebt):null,r.invoices=e.invoices?new Map(Object.entries(e.invoices).map(([i,o])=>[i,Fs.fromJson(o,i,s)])):new Map,r.userGender=Bs[e.userGender]||Ee.anonymous,r.status=jw[e.status.toString()]||Ht.approved,r.confirmedArrival=e.confirmedArrival||!1,r.showAdressAlert=e.showAdressAlert||!1,r.showPhoneAlert=e.showPhoneAlert||!1,r.notificationType=ex[e.notificationType]||X.none,r.workerNotificationOption=ql[e.workerNotificationOption]||He.PushOrSMS,r.userFcms=e.userFcms?new Set(e.userFcms):e.deviceFCM&&e.deviceFCM!==""?new Set([e.deviceFCM]):new Set,r.createdAt=e.createdAt?new Date(e.createdAt):new Date(0),r.transactions=e.transactions?new Map(Object.entries(e.transactions).map(([i,o])=>[i,jr.fromJson(o,i)])):new Map,r}toJson(){const e={};return e.customerName=this.customerName,e.customerId=this.customerId,this.wasWaiting&&(e.wasWaiting=this.wasWaiting),this.cancelDate&&(e.cancelDate=oe(this.cancelDate)),e.remindersTypes={},this.remindersTypes.forEach((t,s)=>{e.remindersTypes[Hi[s]]=t}),e.workerRemindersTypes={},this.workerRemindersTypes.forEach((t,s)=>{e.workerRemindersTypes[Hi[s]]=t}),this.userDeleted&&(e.userDeleted=this.userDeleted),this.signOnDeviceCalendar&&(e.signOnDeviceCalendar=this.signOnDeviceCalendar),this.clientNote!==""&&(e.clientNote=this.clientNote),this.needCancel&&(e.needCancel=this.needCancel),this.finishInvoices&&(e.finishInvoices=this.finishInvoices),e.userGender=ao[this.userGender],this.invoices.size>0&&(e.invoices={},this.invoices.forEach((t,s)=>{e.invoices[s]=t.toJson()})),this.debts.size>0&&(e.debts={},this.debts.forEach((t,s)=>{e.debts[s]=t.toJson()})),this.lastTimeNotifyOnDebt&&(e.lastTimeNotifyOnDebt=oe(this.lastTimeNotifyOnDebt)),this.isUserExist||(e.isUserExist=this.isUserExist),this.orderingOptions!==In.app&&(e.orderingOptions=Xw[this.orderingOptions]),this.showAdressAlert&&(e.showAdressAlert=this.showAdressAlert),this.showPhoneAlert&&(e.showPhoneAlert=this.showPhoneAlert),this.clientMail!==""&&(e.clientMail=this.clientMail),e.customerPhone=this.customerPhone,this.status!==Ht.approved&&(e.status=Kw[this.status]),this.confirmedArrival&&(e.confirmedArrival=this.confirmedArrival),this.isVerifiedPhone&&(e.isVerifiedPhone=this.isVerifiedPhone),this.userFcms.size>0&&(e.userFcms=Array.from(this.userFcms)),e.createdAt=oe(this.createdAt),this.transactions.size>0&&(e.transactions={},this.transactions.forEach((t,s)=>{e.transactions[s]=t.toJson()})),e}toString(){return JSON.stringify(this,null,"  ")}}class gr{constructor({name:e="",amoutOfBookings:t=0,gender:s=Ee.male,email:r="",id:i="",freeFromPayments:o=!1,addedManually:a=!1,customerUuid:c="",isVerifiedPhone:u=!1,workerNaming:l="",blocked:d=!1,phoneNumber:f="",firstBookingsDate:m,userFirstBookingsDate:p,lastBookingsDate:y}){h(this,"name","");h(this,"workerNaming","");h(this,"phoneNumber","");h(this,"freeFromPayments",!1);h(this,"isExapmle",!1);h(this,"id","");h(this,"customerUuid","");h(this,"blocked",!1);h(this,"isVerifiedPhone",!1);h(this,"email","");h(this,"addedManually",!1);h(this,"gender",Ee.male);h(this,"amoutOfBookings",0);h(this,"firstBookingsDate");h(this,"userFirstBookingsDate");h(this,"lastBookingsDate");h(this,"belongings",new Set);h(this,"isDeleted",!1);this.name=e,this.amoutOfBookings=t,this.gender=s,this.email=r,this.id=i,this.freeFromPayments=o,this.addedManually=a,this.customerUuid=c,this.isVerifiedPhone=u,this.workerNaming=l,this.blocked=d,this.phoneNumber=f,this.firstBookingsDate=m,this.userFirstBookingsDate=p,this.lastBookingsDate=y}static fromJson(e,t){const s=new gr({});return s.name=e.name??"",e.gender!=null&&(s.gender=s.getGenderFromStr(e.gender)),s.isVerifiedPhone=e.isVerifiedPhone??!1,s.freeFromPayments=e.freeFromPayments??!1,s.customerUuid=t,s.phoneNumber=e.phoneNumber??(t.length<20&&t.includes("-")?t:""),e.firstBookingsDate!=""&&e.firstBookingsDate!=null&&(s.firstBookingsDate=new Date(e.firstBookingsDate)),e.userFirstBookingsDate!=""&&e.userFirstBookingsDate!=null&&(s.userFirstBookingsDate=new Date(e.userFirstBookingsDate),(s.firstBookingsDate==null||s.userFirstBookingsDate<s.firstBookingsDate)&&(s.firstBookingsDate=s.userFirstBookingsDate)),e.lastBookingsDate!=null&&(s.lastBookingsDate=new Date(e.lastBookingsDate)),s.workerNaming=e.workerNaming??"",s.amoutOfBookings=e.amoutOfBookings??0,s.blocked=e.blocked??!1,s.email=e.email??"",s.id=e.id??"",s.addedManually=e.AM??!1,s}fromCustomerData(e){return this.name=e.name,this.gender=e.gender,this.isVerifiedPhone=e.isVerifiedPhone,this.phoneNumber=e.phoneNumber,this.belongings=e.belongings,this.email=e.email,this.isDeleted=e.isDeleted,this.blocked=e.blocked,this.id=e.id,this.addedManually=e.addedManually,this.freeFromPayments=e.freeFromPayments,this.customerUuid=e.customerUuid,this.workerNaming=e.workerNaming,this.firstBookingsDate=e.firstBookingsDate,this.lastBookingsDate=e.lastBookingsDate,this.amoutOfBookings=e.amoutOfBookings,this.userFirstBookingsDate=e.userFirstBookingsDate,this}get nameForWorker(){return this.workerNaming==""?this.name:this.workerNaming}get getFirstDate(){return this.firstBookingsDate==null||this.userFirstBookingsDate!=null&&this.userFirstBookingsDate<this.firstBookingsDate?this.userFirstBookingsDate:this.firstBookingsDate}get customerHashPhone(){return di(this.phoneNumber)}get customerPhoneAsCollection(){return this.phoneNumber.replaceAll("-","")}isTheSameAs(e,{withId:t=!1}={}){const s=this.toJson();t&&(s.id=e.customerUuid);const r=e.toJson();return t&&(r.id=this.customerUuid),JSON.stringify(r)===JSON.stringify(s)}getGenderFromStr(e){return e==null||e=="A"?Ee.anonymous:e=="F"?Ee.female:Ee.male}getStrFromGender(e){return{[Ee.anonymous]:"A",[Ee.male]:"M",[Ee.female]:"F"}[e]||"A"}get toMultiBookingUser(){const e=new fg;return e.customerName=this.name!=""?this.name:this.workerNaming,e.customerPhone=this.phoneNumber,e.customerId=this.customerUuid,e.userGender=this.gender,e}get toPaymentRequestUser(){return new Ti({userId:this.customerUuid,name:this.nameForWorker,gender:this.gender,isExist:!this.addedManually,isVerifiedPhone:this.isVerifiedPhone,phone:this.phoneNumber})}isMissing(e){return this.lastBookingsDate==null?!1:(new Date().getTime()-this.lastBookingsDate.getTime())/(1e3*3600*24)>e}amountOfBookingsInMonth(){if(this.firstBookingsDate==null)return-1;if(this.lastBookingsDate==null)return 0;const e=this.lastBookingsDate>new Date?new Date:this.lastBookingsDate,t=Math.max((e.getTime()-this.firstBookingsDate.getTime())/(1e3*3600*24),1);return this.amoutOfBookings/t*30}toJson(){const e={};return this.name!==""&&(e.name=this.name),this.gender!==Ee.male&&(e.gender=this.getStrFromGender(this.gender)),this.phoneNumber!==this.id&&(e.phoneNumber=this.phoneNumber),this.firstBookingsDate!=null&&(e.firstBookingsDate=oe(this.firstBookingsDate)),this.userFirstBookingsDate!=null&&(e.userFirstBookingsDate=oe(this.userFirstBookingsDate)),this.lastBookingsDate!=null&&(e.lastBookingsDate=oe(this.lastBookingsDate)),this.amoutOfBookings!==0&&(e.amoutOfBookings=this.amoutOfBookings),this.isVerifiedPhone&&(e.isVerifiedPhone=this.isVerifiedPhone),e.freeFromPayments=this.freeFromPayments,this.email!==""&&(e.email=this.email),e.blocked=this.blocked,this.id!==""&&(e.id=this.id),this.addedManually&&(e.AM=this.addedManually),this.workerNaming!==""&&(e.workerNaming=this.workerNaming),e}toMinimalJson(){const e={};return e.N=this.name!==""?this.name:this.workerNaming,e.G=this.getStrFromGender(this.gender),e.P=this.phoneNumber,this.phoneNumber!==this.customerUuid&&(e.CU=this.customerUuid),this.email!==""&&(e.E=this.email),this.id!==""&&(e.ID=this.id),e}static fromMinimalJson(e){const t=new gr({});return t.workerNaming=e.N??"",t.name=e.N??"",e.G!=null&&(t.gender=t.getGenderFromStr(e.gender)),t.addedManually=e.AM??!1,t.phoneNumber=e.P??"",t.customerUuid=e.CU??e.P??"",t.email=e.E??"",t.id=e.ID??"",t}get publicCustomer(){return new no({freeFromPayments:this.freeFromPayments,blocked:this.blocked,hashNumber:ML({id:this.customerUuid})})}get forUpdate(){const e=new gr({});return e.name=this.name,e.gender=this.gender,e.isVerifiedPhone=this.isVerifiedPhone,e.phoneNumber=this.phoneNumber,e.belongings=this.belongings,e.email=this.email,e.isDeleted=this.isDeleted,e.blocked=this.blocked,e.id=this.id,e.addedManually=this.addedManually,e.freeFromPayments=this.freeFromPayments,e.customerUuid=this.customerUuid,e.workerNaming=this.workerNaming,e.firstBookingsDate=null,e.userFirstBookingsDate=null,e.amoutOfBookings=0,e.lastBookingsDate=null,e}toString(){return JSON.stringify(this.toJson(),null,"  ")}}const Gv="~.9.~",i8="..",If="_";class vc{constructor({workerName:e="",date:t="",workerId:s="",timeStr:r="",treatmentId:i="",treatmentName:o="",businessId:a=""}){h(this,"id","");h(this,"businessId","");h(this,"workerName","");h(this,"date","");h(this,"workerId","");h(this,"timeStr","");h(this,"treatmentId","");h(this,"treatmentName","");this.workerName=e,this.date=t,this.workerId=s,this.timeStr=r,this.treatmentId=i,this.treatmentName=o,this.businessId=a}fixEmptyAttributes(){this.workerName=this.workerName===""?"E":this.workerName,this.date=this.date===""?"E":this.date,this.businessId=this.businessId===""?"E":this.businessId,this.workerId=this.workerId===""?"E":this.workerId}static fromJson(e,t){const s=new vc({});return s.id=t,s.workerName=e.workerName??"",s.date=e.date??"",s.timeStr=e.timeStr??"",s.treatmentId=e.treatmentId??"",s.treatmentName=e.treatmentName??"",s.businessId=e.businessId??"",s.workerId=e.workerId??"",s}get isMulti(){return this.timeStr!==""}static fromTopicStr(e){const t=new vc({}),s=e.split(i8),r=s[0].split(If),i=s[1].split(If);return t.businessId=r[0],t.workerId=r[1].replaceAll(Gv,"+"),t.date=r[2],t.workerName=i[1],t}isEqual(e){return JSON.stringify(e.toJson())===JSON.stringify(this.toJson())}toTopicStr(){this.fixEmptyAttributes();const e=this.workerId.replaceAll("+",Gv);return[this.businessId,e,this.date,this.timeStr,this.treatmentId].join(If).split("").filter(r=>pC.test(r)).join("")}get dateTime(){const e=$s(this.date),t=this.timeStr===""?new Date(0):hn(this.timeStr);return new Date(e.getFullYear(),e.getMonth(),e.getDate(),t.getHours(),t.getMinutes())}toJson(){const e={};return e.businessId=this.businessId,this.workerName!==""&&(e.workerName=this.workerName),this.workerId!==""&&(e.workerId=this.workerId),this.date!==""&&(e.date=this.date),this.timeStr!==""&&(e.timeStr=this.timeStr),this.treatmentName!==""&&(e.treatmentName=this.treatmentName),this.treatmentId!==""&&(e.treatmentId=this.treatmentId),e}toString(){return JSON.stringify(this.toJson())}}const o8={1:"PL",2:"MasterCard",3:"Visa",4:"Maestro",5:"Isracard"},a8={PL:"1",MasterCard:"2",Visa:"3",Maestro:"4",Isracard:"5"},c8={1:"Isracard",2:"Visa Cal",3:"Diners",4:"Amex",6:"Leumi Card"},u8={Isracard:"1","Visa Cal":"2",Diners:"3",Amex:"4","Leumi Card":"6"};class Oa{constructor({brand:e="",token:t="",validityMonth:s="",validityYear:r="",name:i="",userId:o="",bankName:a="",l4Digits:c="",cardId:u="",businessId:l="",attemptsLeft:d=Iu}={}){h(this,"brand","");h(this,"token","");h(this,"validityMonth","");h(this,"validityYear","");h(this,"name","");h(this,"bankName","");h(this,"l4Digits","");h(this,"userId","");h(this,"attemptsLeft",Iu);h(this,"cardId","");h(this,"businessId","");this.brand=e,this.token=t,this.validityMonth=s,this.validityYear=r,this.name=i,this.userId=o,this.bankName=a,this.l4Digits=c,this.cardId=u,this.businessId=l,this.attemptsLeft=d}static fromJson(e,t,s){const r=new Oa;return r.cardId=t,r.brand=o8[e.brand]||"Card",r.token=e.token||"",r.userId=e.userId||"",r.attemptsLeft=e.attemptsLeft||Iu,r.validityMonth=e.validityMonth||"",r.validityYear=e.validityYear||"",r.businessId=s,r.name=e.name||"",r.bankName=e.bankName||"",r.bankName=c8[e.bankName]||"Bank",r.l4Digits=e.l4Digits||"",r}fromPaymentCard(e){this.brand=e.brand,this.token=e.token,this.userId=e.userId,this.businessId=e.businessId,this.cardId=e.cardId,this.attemptsLeft=e.attemptsLeft,this.validityMonth=e.validityMonth,this.validityYear=e.validityYear,this.name=e.name,this.bankName=e.bankName,this.l4Digits=e.l4Digits}toJson(){const e={};return e.brand=a8[this.brand]||"",e.token=this.token,e.userId=this.userId,e.attemptsLeft=this.attemptsLeft,e.validityMonth=this.validityMonth,e.validityYear=this.validityYear,e.name=this.name,e.bankName=this.bankName,e.bankName=u8[this.bankName]||"",e.l4Digits=this.l4Digits,e}decryptCard(e){return new Oa({cardId:this.cardId,brand:this.brand,token:decryptText({encryption:this.token,password:e}),validityMonth:decryptText({encryption:this.validityMonth,password:e}),validityYear:decryptText({encryption:this.validityYear,password:e}),name:this.name,userId:this.userId,bankName:this.bankName,businessId:this.businessId,l4Digits:this.l4Digits})}encryptCard(e){return new Oa({cardId:this.cardId,brand:this.brand,token:encryptText({text:this.token,password:e}),validityMonth:encryptText({text:this.validityMonth,password:e}),validityYear:encryptText({text:this.validityYear,password:e}),name:this.name,userId:this.userId,bankName:this.bankName,businessId:this.businessId,l4Digits:this.l4Digits})}isTheSameAs(e){return this.bankName===e.bankName&&this.brand===e.brand&&this.name===e.name&&this.l4Digits===e.l4Digits&&this.userId===e.userId&&this.validityMonth===e.validityMonth&&this.validityYear===e.validityYear}toString(){return JSON.stringify(this,null,"  ")}}class l8{constructor(){h(this,"futureBookings",{});h(this,"passedBookings",{});h(this,"recurrence")}setMonth(e,t){const s=tD(t),r=nD(new Date);s.getTime()===r.getTime()?(this.passedBookings[t]={},this.futureBookings[t]={}):s.getTime()>r.getTime()?this.futureBookings[t]={}:s.getTime()<r.getTime()&&(this.passedBookings[t]={}),Object.entries(e).forEach(([i,o])=>{const a=Tt.fromJson(o,i);a.cancelDate==null&&(a.isPassed?this.passedBookings[t][i]=a:this.futureBookings[t][i]=a)})}setRecurrence(e){this.recurrence={},Object.entries(e).forEach(([t,s])=>{const r=Tt.fromJson(s,t);r.cancelDate===void 0&&(this.recurrence[t]=r)})}get all(){const e={};return Object.values(this.futureBookings).forEach(t=>{Object.entries(t).forEach(([s,r])=>{e[r.bookingId]=r})}),Object.values(this.passedBookings).forEach(t=>{Object.entries(t).forEach(([s,r])=>{e[r.bookingId]=r})}),this.recurrence!==void 0&&Object.entries(this.recurrence).forEach(([t,s])=>{e[t]=s}),e}addBooking(e){var t,s;if(e.recurrenceEvent!==null)this.recurrence??(this.recurrence={}),this.recurrence[e.bookingId]=e;else{const r=Dr(e.bookingDate);e.isPassed?((t=this.passedBookings)[r]??(t[r]={}),this.passedBookings[r][e.bookingId]=e):((s=this.futureBookings)[r]??(s[r]={}),this.futureBookings[r][e.bookingId]=e)}}deleteBooking(e){var t,s,r;if(e.recurrenceEvent!==null)(t=this.recurrence)==null||delete t[e.bookingId];else{const i=Dr(e.bookingDate);(s=this.passedBookings[i])==null||delete s[e.bookingId],(r=this.futureBookings[i])==null||delete r[e.bookingId]}}lastBookingForBusiness({businessId:e,workerId:t,includePast:s=!1,initDate:r,exclude:i}){let o=r;return Object.entries(this.futureBookings).forEach(([a,c])=>{Object.entries(c).forEach(([u,l])=>{e!==l.buisnessId||t!==l.workerId||i!=null&&i.getTime()===l.bookingDate.getTime()||(o===void 0||l.bookingDate.getTime()>o.getTime())&&(o=l.bookingDate)})}),o}firstBookingForBusiness({businessId:e,workerId:t,includePast:s,initDate:r,exclude:i}){let o=r;for(const[a,c]of Object.entries(this.futureBookings))for(const[u,l]of Object.entries(c))e!==l.buisnessId||t!==l.workerId||i!=null&&i.getTime()===l.bookingDate.getTime()||(o===void 0||l.bookingDate.getTime()<o.getTime())&&(o=l.bookingDate);if(o===void 0&&s)for(const[a,c]of Object.entries(this.passedBookings))for(const[u,l]of Object.entries(c))e!==l.buisnessId||t!==l.workerId||i!==void 0&&i.getTime()===l.bookingDate.getTime()||(o===void 0||l.bookingDate.getTime()<o.getTime())&&(o=l.bookingDate);return o}}class mg{constructor(e,t){h(this,"docId","");h(this,"path","");this.docId=e,this.path=t}toJson(){const e={};return e.docId=this.docId,e.path=this.path,e}static fromJson(e){const t=new mg("","");return t.docId=e.docId||"",t.path=e.path||"",t}toString(){return JSON.stringify(this,null,2)}}class qh{constructor({docId:e=""}){h(this,"bookingCount",0);h(this,"lastUpdateTime",new Date(0));h(this,"docId","");this.docId=e}static fromJson(e,t){const s=new qh({});return e!==void 0&&t!==void 0&&(s.docId=t,s.bookingCount=e.bookingCount??0,s.lastUpdateTime=e.lastUpdateTime?new Date(e.lastUpdateTime):new Date(0)),s}toJson(){const e={};return this.lastUpdateTime.getTime()!==new Date(0).getTime()&&(e.lastUpdateTime=oe(this.lastUpdateTime)),this.bookingCount>0&&(e.bookingCount=this.bookingCount),e}toString(){return JSON.stringify(this.toJson(),null,"  ")}}class Fa{constructor({email:e="",isVerifiedPhone:t=!1,isVerifiedEmail:s=!1,name:r="",phoneNumber:i="",id:o="",gender:a=Ee.anonymous,devices:c=new Map}){h(this,"email","");h(this,"name","");h(this,"phoneNumber","");h(this,"id","");h(this,"devices",new Map);h(this,"gender",Ee.anonymous);h(this,"myBuisnessesIds",[]);h(this,"reminders");h(this,"clientAt",new Map);h(this,"hasNotificationPermission",!0);h(this,"permission",new Map);h(this,"tempFcm");h(this,"allowAppNotification",!0);h(this,"isVerifiedPhone",!1);h(this,"isVerifiedEmail",!1);h(this,"invoiceCounter");h(this,"newWorkerWelcomes",new Set);h(this,"bookings",new Map);h(this,"bookingsPreviews",new Map);h(this,"bookingsDocsToLoad",new Set);h(this,"localDocsToDelete",new Set);this.email=e,this.isVerifiedPhone=t,this.isVerifiedEmail=s,this.name=r,this.phoneNumber=i,this.id=o,this.gender=a,this.devices=c}static fromJson(e,t){const s=new Fa({email:e.email,isVerifiedPhone:e.isVerifiedPhone,isVerifiedEmail:e.isVerifiedEmail,name:e.name,phoneNumber:e.phoneNumber,id:e.id,gender:e.gender});return s.setUserPublicData(e,t),s}get customerData(){return new gr({customerUuid:this.id,name:this.name,email:this.email,isVerifiedPhone:this.isVerifiedPhone,gender:this.gender,phoneNumber:this.phoneNumber})}setUserPublicData(e,t){if(this.permission=new Map,this.myBuisnessesIds=[],this.isVerifiedEmail=e.isVerifiedEmail||!1,this.email=e.email||"",this.allowAppNotification=e.allowAppNotification||!0,this.email=e.email||"",this.name=e.name||"",this.clientAt=new Map,e.clientAt&&Object.entries(e.clientAt).forEach(([s,r])=>{Object.keys(r).length!==0&&(this.clientAt.set(s,new Set),Object.keys(r).forEach(i=>{this.clientAt.set(s,this.clientAt.get(s).add(i))}))}),e.localDocsToDelete&&(this.localDocsToDelete=new Set,e.localDocsToDelete.forEach(s=>{this.localDocsToDelete.add(mg.fromJson(s))})),this.invoiceCounter=e.invoiceCounter,this.devices=new Map,e.devices&&typeof e.devices=="object"?Object.entries(e.devices).forEach(([s,r])=>{this.devices.set(s,is.fromJson(r,s))}):e.currentFcm&&e.currentFcm!==""&&(this.tempFcm=e.currentFcm),this.hasNotificationPermission=e.hasNotificationPermission||!0,e.gender&&(this.gender=Bs[e.gender]||Ee.anonymous),this.phoneNumber=e.phoneNumber||"",this.id=e.id||e.phoneNumber||"",e.permission&&Object.entries(e.permission).forEach(([s,r])=>{r===2&&this.myBuisnessesIds.push(s),this.permission.set(s,r)}),e.bookings&&(this.bookings=new Map,Object.entries(e.bookings).forEach(([s,r])=>{const i=Tt.fromJson(r,s);i.cancelDate||this.bookings.set(s,i)})),this.bookingsDocsToLoad=new Set,e.bookingsPreviews){const s=new Map;Object.entries(e.bookingsPreviews).forEach(([r,i])=>{s.set(r,qh.fromJson(i,r))}),s.forEach((r,i)=>{var o,a;((o=this.bookingsPreviews.get(i))==null?void 0:o.lastUpdateTime)!==r.lastUpdateTime&&(i===Jw||tD(i)>=nD(new Date)||(((a=t==null?void 0:t.passedBookings)==null?void 0:a.hasOwnProperty(i))??!1))&&this.bookingsDocsToLoad.add(i)}),this.bookingsPreviews=s}this.id===this.phoneNumber?this.isVerifiedPhone=!0:this.isVerifiedPhone=e.isVerifiedPhone||!1,this.newWorkerWelcomes=new Set,e.newWorkerWelcomes&&Object.keys(e.newWorkerWelcomes).forEach(s=>{this.newWorkerWelcomes.add(s)})}get fcmsTokens(){if(!this.allowAppNotification)return new Set;if(this.tempFcm)return new Set(this.tempFcm);const e=new Set;return Object.values(this.devices).forEach(t=>{t.activeNotifications&&e.add(t.token)}),e}getDevicesByToken(e){const t=[];return Object.values(this.devices).forEach(s=>{s.token===e&&t.push(is.fromDevice(s))}),t}toJson(){const e={};return this.hasNotificationPermission||(e.hasNotificationPermission=this.hasNotificationPermission),this.isVerifiedPhone&&(e.isVerifiedPhone=this.isVerifiedPhone),this.isVerifiedEmail&&(e.isVerifiedEmail=this.isVerifiedEmail),this.email!==""&&(e.email=this.email),Object.keys(this.bookingsPreviews).length>0&&(e.bookingsPreviews={},Object.entries(this.bookingsPreviews).forEach(([t,s])=>{e.bookingsPreviews[t]=s.toJson()})),this.allowAppNotification||(e.allowAppNotification=this.allowAppNotification),e.permission={},Object.entries(this.permission).forEach(([t,s])=>{e.permission[t]=s}),this.localDocsToDelete.size>0&&(e.localDocsToDelete=[],this.localDocsToDelete.forEach(t=>{e.localDocsToDelete.push(t.toJson())})),e.email=this.email,e.name=this.name,e.devices={},this.devices.forEach((t,s)=>{e.devices[s]=t.toJson()}),e.clientAt={},this.clientAt.forEach((t,s)=>{e.clientAt[s]={},t.forEach(r=>{e.clientAt[s][r]=""})}),e.gender=ao[this.gender],e.phoneNumber=this.phoneNumber,e.id=this.id,this.newWorkerWelcomes.size>0&&(e.newWorkerWelcomes={},this.newWorkerWelcomes.forEach(t=>{e.newWorkerWelcomes[t]=""})),e}}class pg{constructor(e,t,s){h(this,"businessId","");h(this,"date");h(this,"productId","");this.businessId=e,this.date=t,this.productId=s}static fromJson(e,t){const s=new pg(t,null,"");return s.businessId=e.businessId||"",e.date instanceof Be&&(s.date=e.date),s}toJson(){const e={};return e.businessId=this.businessId,this.date!==null&&this.date!==void 0&&(e.date=this.date),e}}class so{constructor({name:e="",phoneNumber:t="",id:s="",productsIds:r={},myBuisnessesIds:i=[],revenueCatId:o="",limitOfBuisnesses:a=1,gender:c=Ee.anonymous,lastVisitedBuisnesses:u=[],lastVisitedBuisnessesRemoved:l=[],paymentCards:d={},isVerifiedPhone:f=!1,isVerifiedEmail:m=!1,email:p="",lastCleanDate:y=Be.fromDate(new Date),createdAt:g=new Date}){h(this,"productsIds",{});h(this,"pendingProductsIds",{});h(this,"id","");h(this,"revenueCatId","");h(this,"limitOfBuisnesses",1);h(this,"preferdTipPercentage",0);h(this,"cardPaymentsPass","");h(this,"lastTimeUpdatePhone",new Date(0));h(this,"lastTimeUpdateEmail",new Date(0));h(this,"authProviders",new Map);h(this,"businessesInfo",{});h(this,"storyLikes",[]);h(this,"paymentCards",{});h(this,"lastVisitedBuisnesses",[]);h(this,"lastVisitedBuisnessesRemoved",[]);h(this,"lastCleanDate",Be.fromDate(new Date));h(this,"businessTopics",new Set);h(this,"waitingListTopics",{});h(this,"tempFcm");h(this,"termsApprovals",{});h(this,"seenUpdates",{});h(this,"createdAt",new Date);h(this,"userPublicData",new Fa({}));h(this,"name","");h(this,"isVerifiedPhone",!1);h(this,"phoneNumber","");h(this,"gender",Ee.anonymous);h(this,"lastTimeConnect",new Date);h(this,"userPublicDataListener");h(this,"connectedGoogleEmail","");h(this,"currentMonthInvoices");h(this,"currentMonthPaymentRequest");h(this,"currentMonthPayments");h(this,"existInvoicesDocs",new Set);h(this,"existPaymentsDocs",new Set);h(this,"existPaymentRequestsDocs",new Set);h(this,"invoices",{});h(this,"devices",{});h(this,"bookings",new l8);h(this,"hasOldNotification",!1);this.userPublicData=new Fa({email:p,isVerifiedEmail:m,isVerifiedPhone:f,name:e,phoneNumber:t,id:s,gender:c}),this.name=e,this.phoneNumber=t,this.id=s,this.productsIds=r,this.revenueCatId=o,this.limitOfBuisnesses=a,this.gender=c,this.lastVisitedBuisnesses=u,this.lastVisitedBuisnessesRemoved=l,this.paymentCards=d,this.isVerifiedPhone=f,this.cardPaymentsPass="",this.lastCleanDate=y,this.createdAt=g}get toPaymentRequestUser(){return new Ti({userId:this.id,name:this.name,gender:this.gender,isVerifiedPhone:this.isVerifiedPhone,isExist:!0,phone:this.phoneNumber,userDecline:!1})}customerDataFromBooking({booking:e,exclude:t,needDelete:s=!1,initDate:r}){return new gr({name:this.name,email:this.userPublicData.email,gender:this.gender,customerUuid:this.id,phoneNumber:this.phoneNumber,isVerifiedPhone:this.isVerifiedPhone,userFirstBookingsDate:this.bookings.firstBookingForBusiness({businessId:e.buisnessId,workerId:e.workerId,exclude:s?e.bookingDate:t,initDate:s?r:e.bookingDate}),lastBookingsDate:this.bookings.lastBookingForBusiness({businessId:e.buisnessId,workerId:e.workerId,exclude:s?e.bookingDate:t,initDate:s?r:e.bookingDate})})}get fcmsTokens(){if(!this.userPublicData.allowAppNotification)return new Set;if(this.tempFcm)return new Set([this.tempFcm]);const e=new Set;return Object.values(this.devices).forEach(t=>{t.activeNotifications&&e.add(t.token)}),e}getDeviceByToken(e){let t;return Object.values(this.devices).forEach(s=>{s.token===e&&(t=is.fromDevice(s))}),t}static fromUserDocJson(e){const t=new so({name:e.name,phoneNumber:e.phoneNumber,id:e.id,productsIds:{},myBuisnessesIds:[],revenueCatId:e.revenueCatId,limitOfBuisnesses:e.limitOfBuisnesses,gender:Bs[e.gender],lastVisitedBuisnesses:e.lastVisitedBuisnesses,lastVisitedBuisnessesRemoved:e.lastVisitedBuisnessesRemoved,paymentCards:{},isVerifiedPhone:e.isVerifiedPhone,isVerifiedEmail:!1,email:"",lastCleanDate:e.lastCleanDate,createdAt:new Date(e.createdAt)});return e.devices&&typeof e.devices=="object"?Object.entries(e.devices).forEach(([s,r])=>{t.devices[s]=is.fromJson(r,s)}):e.currentFcm&&e.currentFcm!==""&&(t.tempFcm=e.currentFcm),e.termsApprovals&&Object.entries(e.termsApprovals).forEach(([s,r])=>{t.termsApprovals[s]=new Date(r)||new Date(0)}),t.seenUpdates={},e.seenUpdates&&Object.entries(e.seenUpdates).forEach(([s,r])=>{t.seenUpdates[s]=new Set(r)}),t.phoneNumber=e.phoneNumber||"0",t.id=e.id||e.phoneNumber,t.preferdTipPercentage=0,e.preferdTipPercentage&&(t.preferdTipPercentage=Number.isInteger(e.preferdTipPercentage)?e.preferdTipPercentage:Math.floor(e.preferdTipPercentage)),t.cardPaymentsPass=e.cardPaymentsPass||"",e.storyLikes&&e.storyLikes.forEach(s=>t.storyLikes.push(s)),e.lastTimeUpdatePhone&&(t.lastTimeUpdatePhone=new Date(e.lastTimeUpdatePhone)||new Date(0)),e.lastTimeUpdateEmail&&(t.lastTimeUpdateEmail=new Date(e.lastTimeUpdateEmail)||new Date(0)),t.productsIds={},e.productsIds&&Object.entries(e.productsIds).forEach(([s,r])=>{t.productsIds[s]=pg.fromJson(r,s)}),e.pendingProductsIds&&Object.entries(e.pendingProductsIds).forEach(([s,r])=>{t.pendingProductsIds[s]=r}),t.revenueCatId=e.revenueCatId||"",t.lastCleanDate=e.lastCleanDate,e.lastVisitedBuisnesses.forEach(s=>t.lastVisitedBuisnesses.push(s)),e.lastVisitedBuisnessesRemoved&&e.lastVisitedBuisnessesRemoved.forEach(s=>t.lastVisitedBuisnessesRemoved.push(s)),t.businessesInfo={},e.businessesInfo&&Object.entries(e.businessesInfo).forEach(([s,r])=>{t.businessesInfo[s]=Ma.fromJson(r,s)}),e.businessTopics&&e.businessTopics.forEach(s=>{t.businessTopics.add(s)}),e.waitingListTopics&&(t.waitingListTopics={},Object.entries(e.waitingListTopics).forEach(([s,r])=>{const i=vc.fromJson(r,s);i.date===""?t.businessTopics.add(s):t.waitingListTopics[s]=i})),t.paymentCards={},e.paymentCards&&Object.entries(e.paymentCards).forEach(([s,r])=>{t.paymentCards[s]={},Object.entries(r).forEach(([i,o])=>{t.paymentCards[s][i]=Oa.fromJson(o,i,s)})}),t.createdAt=new Date(e.createdAt),t.limitOfBuisnesses=e.limitOfBuisnesses||1,e.authProviders?Object.entries(e.authProviders).forEach(([s,r])=>{if(Dy[s]){const i=Dy[s];t.authProviders.set(i,new Date(r)||new Date(2023))}}):t.authProviders=new Map([[rE.Phone,t.createdAt]]),t.id===t.phoneNumber?t.isVerifiedPhone=!0:t.isVerifiedPhone=e.isVerifiedPhone||!1,e.lastTimeConnect&&(t.lastTimeConnect=new Date(e.lastTimeConnect)||new Date),t.userPublicData=new Fa({isVerifiedPhone:t.isVerifiedPhone,phoneNumber:t.phoneNumber}),t}setUserPublicData(e){this.name=e.name||"",e.devices&&typeof e.devices=="object"&&Object.entries(e.devices).forEach(([t,s])=>{this.devices[t]=is.fromJson(s,t)}),this.gender=Bs[e.gender],this.phoneNumber=e.phoneNumber,this.id=e.id||e.phoneNumber,this.userPublicData.setUserPublicData(e,this.bookings)}firstEnterance(e){return!new Set([...this.lastVisitedBuisnesses,...this.lastVisitedBuisnessesRemoved]).has(e)}toUserDocJson(){const e={};return e.name=this.name,e.devices={},Object.entries(this.devices).forEach(([t,s])=>{e.devices[t]=s.toJson()}),this.lastTimeUpdateEmail.getTime()!==new Date(0).getTime()&&(e.lastTimeUpdateEmail=oe(this.lastTimeUpdateEmail)),this.lastTimeUpdatePhone.getTime()!==new Date(0).getTime()&&(e.lastTimeUpdatePhone=oe(this.lastTimeUpdatePhone)),e.gender=ao[this.gender],e.phoneNumber=this.phoneNumber,e.id=this.id,Object.keys(this.termsApprovals).length>0&&(e.termsApprovals={},Object.entries(this.termsApprovals).forEach(([t,s])=>{e.termsApprovals[t]=oe(s)})),Object.keys(this.seenUpdates).length>0&&(e.seenUpdates={},Object.entries(this.seenUpdates).forEach(([t,s])=>{e.seenUpdates[t]=Array.from(s)})),this.isVerifiedPhone&&(e.isVerifiedPhone=this.isVerifiedPhone),e.preferdTipPercentage=this.preferdTipPercentage,e.revenueCatId=this.revenueCatId,Object.keys(this.productsIds).length>0&&(e.productsIds={},Object.entries(this.productsIds).forEach(([t,s])=>{e.productsIds[t]=s.toJson()})),e.pendingProductsIds=this.pendingProductsIds,e.lastCleanDate=this.lastCleanDate,e.limitOfBuisnesses=this.limitOfBuisnesses,e.lastVisitedBuisnesses=this.lastVisitedBuisnesses,e.lastVisitedBuisnessesRemoved=this.lastVisitedBuisnessesRemoved,e.businessesInfo={},this.cardPaymentsPass!==""&&(e.cardPaymentsPass=this.cardPaymentsPass),Object.entries(this.businessesInfo).forEach(([t,s])=>{e.businessesInfo[t]=s.toJson()}),e.storyLikes=this.storyLikes,e.waitingListTopics={},Object.entries(this.waitingListTopics).forEach(([t,s])=>{e.waitingListTopics[t]=s.toJson()}),e.businessTopics=Array.from(this.businessTopics),e.authProviders={},this.authProviders.forEach((t,s)=>{e.authProviders[s]=oe(t)}),e.paymentCards={},Object.entries(this.paymentCards).forEach(([t,s])=>{e.paymentCards[t]={},Object.entries(s).forEach(([r,i])=>{e.paymentCards[t][r]=i.toJson()})}),e.createdAt=oe(this.createdAt),e}get developerId(){return this.id.replace("+","")}toString(){return JSON.stringify(this.toUserDocJson())+JSON.stringify(this.userPublicData.toJson())}}let U0=Po(new so({})),Df=Po(!1);function J(n,e=Tn(cA),t=!0){const s=e(n);return Tn(_w)==="he"&&t?h8(s):s}function h8(n){const e=Tn(U0).gender;return e===Ee.male||e===Ee.anonymous||Object.keys(dy).forEach(s=>{n=n.replaceAll(s,dy[s])}),n}class wc{constructor(){h(this,"eventName","");h(this,"from",new Date(0));h(this,"to",new Date(0));h(this,"colorIndex",-1);h(this,"isBreak",!1);h(this,"eventIndex",0);h(this,"eventsBelong",1);h(this,"partOfRecurrence",!1);h(this,"treatmentName","");h(this,"transactionCounter",0);h(this,"wantDelete",!1);h(this,"onHold",!1);h(this,"hasInvoice",!1);h(this,"durationMinutes",0);h(this,"breakNotificaiton",!1);h(this,"minutesBreakNotification",60);h(this,"extraData");h(this,"note");h(this,"ids",[]);h(this,"recurrenceEvent");h(this,"timeId");h(this,"hasDebt",!1);h(this,"confirmArrival",!1);h(this,"treatmentId");h(this,"isMulti",!1);h(this,"currentParticipants",0);h(this,"debtCounter",0);h(this,"onHoldCounter",0);h(this,"invoiceCoverCounter",0);h(this,"transactionsPerUser",0);h(this,"wantDeleteCounter",0);h(this,"confirmedArrivalAmount",0);h(this,"recurrenceFatherBookingId");h(this,"recurrenceBreakFatherDate");h(this,"blockSchedule",!0);h(this,"recurrenceBreakRefInfo");h(this,"breakIconData");h(this,"breakBusinessName");h(this,"breakFatherRecurrenceId");h(this,"breakBusinessId");h(this,"breakAddedToDeviceCalendar",!1);h(this,"breakId","");h(this,"vacationId","");h(this,"belongTreatments",1);h(this,"vacationCreatedAt");h(this,"isVacation",!1);h(this,"vacationAddedToDeviceCalendar",!1);h(this,"vacationEndTemp");h(this,"isHoliday",!1);h(this,"holidayReligion");h(this,"subTreatmentName","");h(this,"totalBookingMinutes",0);h(this,"waitingListCounter",1);h(this,"isWaitingList",!1);h(this,"waitingListCustomerGender",Ee.male);h(this,"customerPhoneWaitingList","")}static fromJson({json:e,timeStr:t,dayString:s,monthString:r,workerId:i,businessModel:o,newTimeId:a}){const c=new wc;c.eventName=e.p??"",c.eventIndex=e.i??0,c.onHold=e.oH??!1,c.eventsBelong=e.EB??1,c.wantDelete=e.wD??!1,c.isVacation=e.IV??!1,c.isVacation&&c.eventName===""&&(c.eventName=J("Vacation")),c.vacationId=a??"",c.breakFatherRecurrenceId=e.BFRI??"",c.vacationAddedToDeviceCalendar=e.VATDC??!1,c.blockSchedule=e.BS??!0,c.transactionCounter=e.TC??0,c.transactionsPerUser=e.TPU??0,c.hasDebt=e.HD??!1,c.debtCounter=e.DC??0,c.treatmentId=e.TID,c.confirmArrival=e.CA??!1,c.confirmedArrivalAmount=e.CAA??0,c.durationMinutes=e.d??0,c.treatmentName=e.TN??"",c.hasInvoice=e.Hi??!1,c.invoiceCoverCounter=e.ICC??0,c.note=e.N,c.recurrenceFatherBookingId=e.RFBI,c.wantDeleteCounter=e.WDC??0,c.onHoldCounter=e.OHC??0,c.isMulti=e.IM??!1,c.currentParticipants=e.CP??0,c.breakNotificaiton=e.BN??!1,c.partOfRecurrence=e.POR??!1,c.minutesBreakNotification=e.MBN??60,c.recurrenceBreakRefInfo=e.RBRI?Vn.fromJson(e.RBRI):void 0,c.recurrenceBreakFatherDate=e.RBFD;const u=e.IB??!1,l=new Date(t),d=new Date(`${s}-${r}`),f=new Date(d.getFullYear(),d.getMonth(),d.getDate(),l.getHours(),l.getMinutes());return c.to=Z(f,new V({minutes:c.durationMinutes})),c.recurrenceEvent=e.RE?Vn.fromJson(e.RE,f):void 0,c.colorIndex=e.c??(c.isVacation?1:0),c.ids=[i],c.isHoliday=!1,c.subTreatmentName="",c.totalBookingMinutes=0,c.waitingListCounter=1,c.isWaitingList=!1,c.waitingListCustomerGender=Ee.male,c.customerPhoneWaitingList="",u&&(c.breakIconData=o==null?void 0:o.design.shopIconData,c.breakBusinessName=o==null?void 0:o.shopName,c.breakBusinessId=o==null?void 0:o.businessId),e.VE&&(c.vacationEndTemp=$s(e.VE)),c}get endOfBooking(){return Z(this.from,new V({minutes:this.totalBookingMinutes}))}toJson(){const e={};return e.p=this.eventName,e.d=this.durationMinutes,e.c=this.colorIndex,this.minutesBreakNotification!==60&&(e.MBN=this.minutesBreakNotification),this.breakNotificaiton&&(e.BN=this.breakNotificaiton),this.onHoldCounter>0&&(e.OHC=this.onHoldCounter),this.confirmArrival&&(e.CA=this.confirmArrival),this.confirmedArrivalAmount>0&&(e.CAA=this.confirmedArrivalAmount),this.blockSchedule||(e.BS=this.blockSchedule),this.treatmentId!==void 0&&(e.TID=this.treatmentId),this.wantDeleteCounter>0&&(e.WDC=this.wantDeleteCounter),this.hasDebt&&(e.HD=this.hasDebt),this.transactionCounter>0&&(e.TC=this.transactionCounter),this.transactionsPerUser>0&&(e.TPU=this.transactionsPerUser),this.debtCounter>0&&(e.DC=this.debtCounter),this.invoiceCoverCounter>0&&(e.ICC=this.invoiceCoverCounter),this.eventsBelong!==1&&(e.EB=this.eventsBelong),this.isBreak&&(e.IB=this.isBreak),this.breakId!==""&&(e.BI=this.breakId),this.eventIndex!==0&&(e.i=this.eventIndex),this.treatmentName!==""&&(e.TN=this.treatmentName),this.onHold&&(e.oH=this.onHold),this.isMulti&&(e.IM=this.isMulti),this.currentParticipants>0&&(e.CP=this.currentParticipants),this.wantDelete&&(e.wD=this.wantDelete),this.hasInvoice&&(e.Hi=this.hasInvoice),this.recurrenceEvent!=null&&(e.RE=this.recurrenceEvent.toJson({})),this.note!==void 0&&this.note!==""&&(e.N=this.note),this.partOfRecurrence&&(e.POR=this.partOfRecurrence),this.recurrenceFatherBookingId!=null&&(e.RFBI=this.recurrenceFatherBookingId),this.isVacation&&(e.IV=this.isVacation),this.breakFatherRecurrenceId!=null&&(e.BFRI=this.breakFatherRecurrenceId),this.vacationAddedToDeviceCalendar&&(e.VATDC=this.vacationAddedToDeviceCalendar),this.vacationCreatedAt!=null&&(e.VCA=oe(this.vacationCreatedAt)),this.breakAddedToDeviceCalendar&&(e.BATDC=this.breakAddedToDeviceCalendar),this.timeId!==void 0&&this.recurrenceEvent===void 0&&(e.RTI=this.timeId),this.recurrenceBreakFatherDate!==void 0&&(e.RBFD=this.recurrenceBreakFatherDate),this.recurrenceBreakRefInfo!=null&&(e.RBRI=this.recurrenceBreakRefInfo.toJson({saveStartDate:!1,saveEnd:!0,saveException:!1})),this.subTreatmentName!==""&&(e.STN=this.subTreatmentName),this.totalBookingMinutes!==this.durationMinutes&&(e.TBM=this.totalBookingMinutes),this.belongTreatments>1&&(e.BTR=this.belongTreatments),e}toString(){return JSON.stringify(this,void 0,2)}}function YV(n,e){const t=Z(e.bookingDate,new V({minutes:e.totalMinutes}));return n.getTime()===hn("23:59").getTime()&&t.getHours()===0&&t.getMinutes()===0}function d8(n,e){const t=[];for(let s=0;s<n.length;s+=2)n[s+1]>=e&&t.push(n[s],n[s+1]);return t}function pn(n){return Nt(n,"HH:mm")}function zV(n,e){return Nt(n,e,{})}function W0(n){return Nt(n,"dd")}function Dr(n){return Nt(n,"MM-yyyy")}function Ze(n){return Nt(n,"dd-MM-yyyy")}function hn(n){const e=W(n,"HH:mm").toDate();return e.setFullYear(1970),e.setMonth(0),e.setDate(1),e}function $s(n){const[e,t,s]=n.split("-").map(Number);return new Date(s,t-1,e)}function tD(n){return W(n,"MM-yyyy").toDate()}function GV(n){return n.getHours()>=19&&n.getHours()<=23||n.getHours()>=0&&n.getHours()<=2?J("night"):n.getHours()>=3&&n.getHours()<=4?J("beforeMorning"):n.getHours()>=5&&n.getHours()<=11?J("morning"):J("noon")}function nD(n){return new Date(n.getFullYear(),n.getMonth(),1)}function an(n){return new Date(n.getFullYear(),n.getMonth(),n.getDate())}function va(n){return new Date(1970,0,1,n.getHours(),n.getMinutes())}function Jv(n,e){return new Date(n.getFullYear(),n.getMonth()+e,n.getDate(),n.getHours(),n.getMinutes())}function f8(n){const e=[];for(let t=0;t<n.length;t++)e.push(hn(n[t]));return e}function Nr(n){const e=n.getDay(),t=n.getDate()-e+(e===0?-6:1);return new Date(n.setDate(t))}function sD(n,e){let t=!1;return n.religions.forEach(s=>{var i,o;console.log(e);let r=Ze(e);switch(s){case $f.christian:r=r.substring(0,r.length-4)+"0000",t=(t||((i=fy[$f.christian])==null?void 0:i[r])!=null)??!1;break;default:t=(t||((o=fy[s])==null?void 0:o[r])!=null)??!1;break}}),t}function oe(n){return`${Nt(n,"yyyy-MM-dd")}T${Nt(n,"HH:mm:ss")}.000Z`}function H0(n){return new Date(new Date().toISOString())}function gg(n){return gS(Nt(n,"dd-MM-yyyy"),"dd-MM-yyyy",new Date)}function Qv(n,e){let t=n.getFullYear()-e.getFullYear(),s=n.getMonth()-e.getMonth();return s<0&&(t-=1,s+=12),Math.abs(t*12+s)}function Af(n,e){return Fn(H0(n.bookingDate),new V({minutes:e}))}class tu{constructor({businessId:e="",date:t,id:s="",workerId:r="",businessName:i="",shopIcon:o=new Fe}={}){h(this,"businessId","");h(this,"businessName","");h(this,"date");h(this,"id","");h(this,"workerId","");h(this,"shopIcon",new Fe);this.businessId=e,this.date=t||null,this.id=s,this.workerId=r,this.businessName=i,this.shopIcon=o}static fromJsonStr(e){const t=JSON.parse(e),s=t.date?new Date(t.date):null,r=t.shopIcon?Fe.fromJsonStr(t.shopIcon):new Fe,i=new tu({businessId:t.businessId,date:s,id:t.id,workerId:t.workerId,businessName:t.businessName});return i.shopIcon=r,i}toJsonStr(){const e={businessId:this.businessId,date:this.date?oe(this.date):void 0,id:this.id,workerId:this.workerId,businessName:this.businessName,shopIcon:this.shopIcon.toJsonStr()};return JSON.stringify(e)}toString(){return this.toJsonStr()}}class yg extends tu{constructor({businessId:t,date:s,id:r,workerId:i,businessName:o,totalMinutes:a,isRecurrence:c,shopIcon:u}){super({businessId:t,date:s,id:r,workerId:i,businessName:o,shopIcon:u});h(this,"isRecurrence",!1);h(this,"totalMinutes",0);this.totalMinutes=a,this.isRecurrence=c}static fromJsonStr(t){const s=JSON.parse(t),r=s.businessId||"",i=s.businessName||"",o=s.date?new Date(s.date):void 0,a=s.workerId||"",c=s.id||"",u=s.isRecurrence||!1,l=s.totalMinutes||0,d=s.shopIcon?Fe.fromJsonStr(s.shopIcon):void 0;return new yg({businessId:r,date:o,id:c,workerId:a,businessName:i,totalMinutes:l,isRecurrence:u,shopIcon:d})}toJsonStr(){var s;const t={};return t.businessId=this.businessId,t.isRecurrence=this.isRecurrence,t.totalMinutes=this.totalMinutes,this.date!==void 0&&(t.date=oe(this.date)),t.businessName=this.businessName,t.id=this.id,t.workerId=this.workerId,t.shopIcon=((s=this.shopIcon)==null?void 0:s.toJsonStr())||null,JSON.stringify(t)}toString(){return this.toJsonStr()}}class _g{constructor({businessId:e,id:t,businessName:s,type:r,dateToNotify:i,isMulti:o,minutesToAdd:a,address:c,phoneToContact:u,shopIcon:l,fcms:d,totalEventMinutes:f=0,isRecurrence:m=!1}){h(this,"id","");h(this,"businessId","");h(this,"shopIcon",new Fe);h(this,"businessName","");h(this,"dateToNotify",new Date(0));h(this,"fcms",new Set);h(this,"minutesToAdd",0);h(this,"address","");h(this,"phoneToContact","");h(this,"isMulti",!1);h(this,"isRecurrence",!1);h(this,"totalEventMinutes",0);h(this,"type","");this.businessId=e,this.id=t,this.businessName=s,this.type=r,this.dateToNotify=i,this.isMulti=o,this.minutesToAdd=a,this.address=c,this.phoneToContact=u,this.shopIcon=l,this.fcms=d,this.totalEventMinutes=f,this.isRecurrence=m}isEqual(e){return e.businessId===this.businessId&&e.businessName===this.businessName&&JSON.stringify([...e.fcms])===JSON.stringify([...this.fcms])&&e.shopIcon.isEqual(this.shopIcon)&&e.totalEventMinutes===this.totalEventMinutes&&e.isMulti===this.isMulti&&e.minutesToAdd===this.minutesToAdd&&e.isRecurrence===this.isRecurrence&&e.type===this.type}static fromJson(e){const t=Fe.fromJson(e.SI),s=new Set(e.FS||[]),r=new Date(e.dateToNotify);return new _g({businessId:e.I,id:e.ID,businessName:e.B,type:e.T,dateToNotify:r,isMulti:e.IM,minutesToAdd:e.MTA,address:e.A,phoneToContact:e.P,shopIcon:t,fcms:s,totalEventMinutes:e.TEM,isRecurrence:e.IR})}get dbPath(){return`/${iC}/${aC}/1/${this.dateToNotify.getFullYear()}/${this.dateToNotify.getMonth()}/${this.dateToNotify.getDay()}/${this.dateToNotify.getHours()}`}toJson(){const e={};return this.phoneToContact!==""&&(e.P=this.phoneToContact),this.address!==""&&(e.A=this.address),this.type!==""&&(e.T=this.type),this.businessName!==""&&(e.B=this.businessName),this.fcms.size>0&&(e.FS=Array.from(this.fcms)),this.businessId!==""&&(e.I=this.businessId),this.isMulti&&(e.IM=this.isMulti),this.minutesToAdd!==3&&(e.MTA=this.minutesToAdd),this.isRecurrence&&(e.IR=this.isRecurrence),this.totalEventMinutes>0&&(e.TEM=this.totalEventMinutes),e.SI=this.shopIcon.toJson(),e}toString(){return JSON.stringify(this.toJson(),null,2)}}class Yh{constructor({id:e,date:t,isMultiBooking:s,workerId:r,signNewMultiBookingUsers:i=!1}){h(this,"id","");h(this,"date",new Date(0));h(this,"isMultiBooking",!1);h(this,"workerId","");h(this,"signNewMultiBookingUsers",!1);this.id=e,this.date=t,this.isMultiBooking=s,this.workerId=r,this.signNewMultiBookingUsers=i}toJson(){const e={};return e.I=this.id,e.D=oe(this.date),e.WI=this.workerId,this.isMultiBooking&&(e.IMB=this.isMultiBooking),this.signNewMultiBookingUsers&&(e.SNMBU=this.signNewMultiBookingUsers),e}static fromJson(e){const t=e.D?new Date(e.D):new Date(0),s=e.I||"",r=e.IMB||!1,i=e.WI||"",o=e.SNMBU||!1;return new Yh({id:s,date:t,isMultiBooking:r,workerId:i,signNewMultiBookingUsers:o})}toString(){return JSON.stringify(this,null,2)}}class m8{constructor({workerId:e="",workerName:t="",businessName:s="",buisnessId:r="",workerPhone:i=""}={}){h(this,"date",new Date(0));h(this,"workerId","");h(this,"workerName","");h(this,"workerPhone","");h(this,"buisnessId","");h(this,"businessName","");h(this,"recurrenceEvent");h(this,"recurrenceRef");h(this,"recurrenceFatherDate");h(this,"recurrenceEventRefInfo");h(this,"recurrenceNotificationsLastDate");h(this,"recurrenceChildDate");this.workerId=e,this.workerName=t,this.businessName=s,this.buisnessId=r,this.workerPhone=i}}const vg="simpletor.officialsimplecode.com",JV="businesses?BusinessId=BUISNESS_ID",wg="?PaymentId=PAYMENT_ID";class zh{constructor({id:e,workerId:t}){h(this,"id","");h(this,"workerId","");h(this,"createdAt",new Date(0));h(this,"signNewMultiBookingUsers",!0);this.id=e,this.workerId=t}get link(){return`https://${vg}/${wg}`.replace("PAYMENT_ID",this.id)}static fromJson(e){const t=new zh({});return t.id=e.id??"",e.createdAt!=null&&(t.createdAt=new Date(e.createdAt)||new Date(0)),t.workerId=e.workerId??"",t.signNewMultiBookingUsers=e.signNewMultiBookingUsers??!0,t}toJson(){const e={};return this.createdAt.getTime()!==new Date(0).getTime()&&(e.createdAt=oe(this.createdAt)),this.signNewMultiBookingUsers||(e.signNewMultiBookingUsers=this.signNewMultiBookingUsers),e.id=this.id,e.workerId=this.workerId,e}toString(){return JSON.stringify(this.toJson(),null,2)}}const{v4:Kv}=dg;class Tt extends m8{constructor({workerId:t,workerName:s,businessName:r,buisnessId:i,workerPhone:o}){super({workerId:t,workerName:s,businessName:r,buisnessId:i,workerPhone:o});h(this,"customerName","");h(this,"customerPhone","");h(this,"customerId","");h(this,"orderingOptions",In.app);h(this,"isVerifiedPhone",!1);h(this,"isUserExist",!0);h(this,"notificationType",X.none);h(this,"workerNotificationOption",He.PushOrSMS);h(this,"remindersTypes",new Map);h(this,"workerRemindersTypes",new Map);h(this,"workerDeleted",!1);h(this,"clientMail","");h(this,"showAdressAlert",!1);h(this,"showPhoneAlert",!1);h(this,"signOnDeviceCalendar",!1);h(this,"isMultiRef",!1);h(this,"cancelDate");h(this,"lastTimeNotifyOnDebt");h(this,"adress","");h(this,"wasWaiting",!1);h(this,"bookingDate",new Date(0));h(this,"note","");h(this,"needCancel",!1);h(this,"treatments",new Map);h(this,"userGender",Ee.anonymous);h(this,"workerGender",Ee.anonymous);h(this,"status",Ht.approved);h(this,"confirmedArrival",!1);h(this,"bookingId","");h(this,"userFcms",new Set);h(this,"clientNote","");h(this,"shopIcon",new Fe);h(this,"createdAt",new Date);h(this,"finishInvoices",!1);h(this,"invoices",new Map);h(this,"transactions",new Map);h(this,"recurrenceTimeId");h(this,"recurreneFatherDate");h(this,"debts",new Map);h(this,"addToClientAt",!1);h(this,"paymentRequest");h(this,"userDeleted",!1);h(this,"fatherMultiBooking");h(this,"fatherRecurrenceBooking")}static empty(){return new Tt({})}static fromBooking(t){const s=new Tt({});return s.customerName=t.customerName,s.customerPhone=t.customerPhone,s.customerId=t.customerId,s.workerPhone=t.workerPhone,s.workerGender=t.workerGender,s.userGender=t.userGender,s.businessName=t.businessName,s.buisnessId=t.buisnessId,s.bookingId=t.bookingId,s.workerGender=t.workerGender,s.shopIcon=t.shopIcon,s.recurrenceTimeId=t.recurrenceTimeId,s.note=t.note,s.workerRemindersTypes={...t.workerRemindersTypes},s.signOnDeviceCalendar=t.signOnDeviceCalendar,s.userDeleted=t.userDeleted,s.workerNotificationOption=t.workerNotificationOption,s.paymentRequest=t.paymentRequest,s.remindersTypes={...t.remindersTypes},s.isVerifiedPhone=t.isVerifiedPhone,s.workerDeleted=t.workerDeleted,s.finishInvoices=t.finishInvoices,s.adress=t.adress,s.addToClientAt=t.addToClientAt,s.showAdressAlert=t.showAdressAlert,s.showPhoneAlert=t.showPhoneAlert,s.orderingOptions=t.orderingOptions,s.isUserExist=t.isUserExist,s.isMultiRef=t.isMultiRef,s.needCancel=t.needCancel,s.userGender=t.userGender,s.bookingDate=t.bookingDate,t.recurrenceEventRefInfo!==void 0&&(s.recurrenceEventRefInfo=Vn.fromRecurrenceEvent(t.recurrenceEventRefInfo)),t.recurrenceEvent!==void 0&&(s.recurrenceEvent=Vn.fromRecurrenceEvent(t.recurrenceEvent)),s.recurrenceNotificationsLastDate=t.recurrenceNotificationsLastDate,s.cancelDate=t.cancelDate,s.customerId=t.customerId,s.workerPhone=t.workerPhone,s.lastTimeNotifyOnDebt=t.lastTimeNotifyOnDebt,t.debts.forEach((r,i)=>{s.debts.set(i,bo.fromDebt(r))}),s.treatments=new Map,t.treatments.forEach((r,i)=>{const o=Mt.fromTreatment(r);o.index=i,s.treatments.set(i,r)}),s.invoices=new Map,t.invoices.forEach((r,i)=>{s.invoices.set(i,Fs.fromBookingInvoiceData(r))}),s.clientNote=t.clientNote,s.status=t.status,s.confirmedArrival=t.confirmedArrival,s.createdAt=t.createdAt,s.clientMail=t.clientMail,s.workerName=t.workerName,s.buisnessId=t.buisnessId,s.notificationType=t.notificationType,s.userFcms=new Set(t.userFcms),s.recurreneFatherDate=t.recurreneFatherDate,s.recurrenceRef=t.recurrenceRef,s.transactions=new Map,t.transactions.forEach((r,i)=>{s.transactions.set(i,jr.fromTransaction(r))}),s}static fromJson(t,s){try{const r=new Tt({});if(r.workerGender=Bs[t.workerGender]||Ee.anonymous,r.customerName=t.customerName||"",r.note=t.note||"",r.bookingId=s,r.signOnDeviceCalendar=t.signOnDeviceCalendar||!1,r.userDeleted=t.userDeleted||!1,r.workerDeleted=t.workerDeleted||!1,r.customerId=t.customerId||t.customerPhone||"",r.workerPhone=t.workerPhone||"",r.customerPhone=t.customerPhone||"",r.recurrenceTimeId=t.recurrenceTimeId,r.workerId=t.workerId||t.workerPhone||"",r.adress=t.adress||"",t.shopIcon!=null&&(r.shopIcon=Fe.fromJson(t.shopIcon)),r.isVerifiedPhone=t.isVerifiedPhone||!1,r.customerId==r.customerPhone&&r.customerId.length==14&&(r.isVerifiedPhone=!0),r.isMultiRef=t.isMultiRef||!1,r.needCancel=t.needCancel||!1,t.lastTimeNotifyOnDebt!=null&&(r.lastTimeNotifyOnDebt=new Date(t.lastTimeNotifyOnDebt)),r.finishInvoices=t.finishInvoices||!1,t.remindersTypes!=null?Object.entries(t.remindersTypes).forEach(([i,o])=>{Ur[i]!=null&&r.remindersTypes.set(Ur[i],o)}):r.remindersTypes=new Map([jt.regular,t.minutesBeforeNotify||60]),t.workerRemindersTypes!=null&&Object.entries(t.workerRemindersTypes).forEach(([i,o])=>{Ur[i]!=null&&r.workerRemindersTypes.set(Ur[i],o)}),r.clientMail=t.clientMail||"",t.recurrenceNotificationsLastDate!=null&&(r.recurrenceNotificationsLastDate=new Date(t.recurrenceNotificationsLastDate)),r.clientNote=t.clientNote||"",r.recurreneFatherDate=t.recurreneFatherDate,r.recurrenceRef=t.recurrenceRef,t.orderingOptions!=null&&(r.orderingOptions=Zw[t.orderingOptions]||In.app),t.debts!=null&&Object.entries(t.debts).forEach(([i,o])=>{r.debts.set(i,bo.fromJson(o,i))}),t.cancelDate!=null&&(r.cancelDate=new Date(t.cancelDate)),r.wasWaiting=t.wasWaiting||!1,r.isUserExist=t.isUserExist||!0,t.invoices!=null&&Object.entries(t.invoices).forEach(([i,o])=>{r.invoices.set(i,Fs.fromJson(o,i,r.workerId))}),t.userGender!=null&&(r.userGender=Bs[t.userGender]||Ee.anonymous),r.status=jw[t.status.toString()]||Ht.approved,r.confirmedArrival=t.confirmedArrival||!1,t.bookingDate!=null&&(r.bookingDate=new Date(t.bookingDate)||new Date(0)),console.log(r.bookingDate),console.log(t.bookingDate),t.treatments!=null){r.treatments=new Map;let i=0;Object.entries(t.treatments).forEach(([o,a])=>{const c=t.treatments[i.toString()];r.treatments.set(i.toString(),Mt.fromJson(c,i.toString())),i+=1})}else if(t.treatment!=null){const i=Mt.fromJson(t.treatment,"0");r.treatments.set("0",i)}return r.showAdressAlert=t.showAdressAlert||!1,r.showPhoneAlert=t.showPhoneAlert||!1,r.workerName=t.workerName||"",r.businessName=t.businessName||"",r.buisnessId=t.buisnessId||"",t.notificationType!=null?r.notificationType=ex[t.notificationType]||X.push:t.withMessage?r.notificationType=X.message:r.notificationType=X.push,t.workerNotificationOption!=null&&(r.workerNotificationOption=ql[t.workerNotificationOption]||He.PushOrSMS),t.userFcms!=null?t.userFcms.forEach(i=>{r.userFcms.add(i)}):t.deviceFCM!=null&&t.deviceFCM!=""&&(r.userFcms=new Set([t.deviceFCM])),t.createdAt!=null&&(r.createdAt=new Date(t.createdAt)||new Date(0)),t.RE!=null&&(r.recurrenceEvent=Vn.fromJson(t.RE,r.bookingDate)),t.RERI!=null&&(r.recurrenceEventRefInfo=Vn.fromJson(t.RERI)),r.transactions=new Map,t.transactions!=null&&Object.entries(t.transactions).forEach(([i,o])=>{r.transactions.set(i,jr.fromJson(o,i))}),t.paymentRequest!=null&&(r.paymentRequest=zh.fromJson(t.paymentRequest)),r}catch(r){return he.error(`Error loading booking doc ${s}: ${r}`),new Tt({})}}get treatmentLength(){return Array.from(this.treatments.values()).reduce((t,s)=>s.count+t,0)}get canSendMessage(){return this.isVerifiedPhone||this.orderingOptions===In.byWorker}get treatmentsToStringNotDetailed(){return this.treatmentLength===1?this.treatments.values().next().value.name:this.treatments.size===1?`${this.treatments.values().next().value.name}x${this.treatmentLength}`:`${this.treatments.values().next().value.name}+${this.treatmentLength-1}`}get isPassed(){if(this.recurrenceEvent!=null){if(this.recurrenceChildDate!=null)return Z(this.recurrenceChildDate,new V({minutes:this.totalMinutes+2}))<new Date;const t=this.recurrenceEvent.endOfTheEvent;return t!==void 0&&t<gg(new Date)}else return Z(this.bookingDate,new V({minutes:this.totalMinutes+2}))<new Date}get isRightNow(){return Z(this.recurrenceChildDate??this.bookingDate,new V({minutes:this.totalMinutes}))>new Date&&(this.recurrenceChildDate??this.bookingDate)<new Date}get currentDisplayDate(){return this.recurrenceChildDate??this.bookingDate}get totalMinutes(){let t=0;return this.treatments.forEach((s,r)=>{t+=s.totalMinutesForBooking}),t}get customerHashPhone(){return di(this.customerPhone)}get bookingWorkTimes(){const t=new Map;let s=this.bookingDate;return this.treatments.forEach((r,i)=>{Array.from({length:r.count}).forEach(()=>{r.times.forEach((o,a)=>{s=Z(s,new V({minutes:o.breakMinutes})),t.set(pn(s),o.workMinutes),s=Z(s,new V({minutes:o.workMinutes}))})})}),t}get totalEventsCount(){let t=0;return Object.values(this.treatments).forEach(s=>{t+=s.times.length*s.count}),t}get currency(){return this.treatments.size===0?Rs:this.treatments.values().next().value.price.currency}get invoicesCoverPrice(){const t=Object.values(this.invoices).reduce((s,r)=>s+r.amount,0);return this.finishInvoices||this.invoices.size>0&&t>=this.totalPrice.amount}get totalPrice(){let t=new qt({amount:"0",currency:Rs});return Object.values(this.treatments).forEach(s=>{t.amount+=s.totalPriceForBooking,t.currency=s.price.currency}),t}get typesOfEvents(){const t=new Map;return this.recurrenceEvent!==null?new Map:(this.needCancel&&t.set(zr.needCancel,1),this.debts.size>0&&t.set(zr.withDebts,1),this.status===Ht.waiting&&t.set(zr.onHold,1),t)}get remindersToFutureNotifications(){const t=[];for(const[s,r]of this.remindersTypes){const i=this.reminder(s);i!==null&&t.push(i)}return t}reminder(t){if(this.notificationType!==X.push)return null;const s=this.remindersTypes.get(t);if(s===void 0||s===0)return null;const r=Af(this,s);return r<H0()||this.userFcms.size===0?null:new _g({businessName:this.businessName,shopIcon:this.shopIcon,address:this.showAdressAlert?this.adress:"",isMulti:this.isMultiRef,isRecurrence:this.recurrenceEvent!==null||this.recurrenceRef!==null,id:this.reminderId(t),dateToNotify:r,phoneToContact:this.showPhoneAlert?LL(this.workerPhone):"",businessId:this.buisnessId,type:this.treatmentsToStringNotDetailed,minutesToAdd:this.utcDeltaMinutes()+s,totalEventMinutes:this.totalMinutes,fcms:{...this.userFcms}})}utcDeltaMinutes(){const t=new Date,s=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes());return Math.floor((Date.now()-s.getTime())/(60*1e3))}get remindersOnBooking(){const t={};return this.cancelDate!==null?{}:this.userFcms.size===0?{}:this.notificationType===X.message?{}:(this.remindersTypes.forEach((s,r)=>{var o;if(s<=0)return;const i=Af(this,s);i>=H0()&&(t[o=oe(i)]??(t[o]={}),t[oe(i)]={[this.reminderId(r)]:null})}),t)}get bookingsEventsAsJson(){const t=new Map;let s=this.bookingDate,r=this.totalEventsCount,i=0;return this.invoicesCoverPrice,this.treatments.forEach((o,a)=>{Array.from({length:o.count}).forEach(()=>{o.times.forEach((c,u)=>{s=Z(s,new V({minutes:c.breakMinutes}));const l=this.recurrenceTimeId!=null&&this.recurrenceEvent!=null?`${pn(s)}_${this.recurrenceTimeId}`:pn(s),d=new wc;d.eventIndex=i,d.treatmentId=o.id,d.subTreatmentName=c.title,d.totalBookingMinutes=this.totalMinutes,d.belongTreatments=this.treatmentLength,d.onHold=this.status==="waiting",d.wantDelete=this.needCancel,d.ids=[this.workerId],d.confirmArrival=this.confirmedArrival,d.hasDebt=this.debts.size>0,d.timeId=this.recurrenceEvent!=null?this.recurrenceTimeId:void 0,d.treatmentName=o.name,d.transactionCounter=this.transactions.size,d.eventsBelong=r,d.isBreak=!1,d.partOfRecurrence=this.recurrenceRef!=null,d.hasInvoice,d.recurrenceEvent=this.recurrenceEvent,d.eventName=this.customerId,d.from=s,d.durationMinutes=c.workMinutes,d.colorIndex=o.colorIndex,t.set(l,d.toJson()),s=Z(s,new V({minutes:c.workMinutes})),i+=1})})}),t}get monthStr(){return Dr(this.bookingDate)}get toBookingReferencePaymentObj(){return new Yh({id:this.bookingId,isMultiBooking:!1,date:this.bookingDate,workerId:this.workerId})}async copyDataToOrder({user:t,worker:s,needToHoldOn:r,business:i,clientNoteText:o=""}){var c;this.customerName=t.name,this.customerId=t.id,this.customerPhone=t.phoneNumber,this.userGender=t.gender,this.isVerifiedPhone=t.isVerifiedPhone,this.clientMail=t.userPublicData.email;const a=t.userPublicData.clientAt;this.addToClientAt=!a.hasOwnProperty(i.businessId)||!((c=a.get(i.businessId))!=null&&c.has(s.id)),this.userFcms=t.fcmsTokens,this.isVerifiedPhone=t.isVerifiedPhone,this.orderingOptions=In.web,this.adress=i.adress,this.clientNote=o,this.wasWaiting=!1,this.shopIcon=i.design.shopIconData,Gr(this.bookingDate,new Date).inMinutes<60&&!r&&(this.confirmedArrival=!0),this.workerNotificationOption=s.notifications.notificationOption,this.workerRemindersTypes=new Map(s.notifications.remindersTypes);for(const[u,l]of s.notifications.remindersTypes)this.isPassed||u===jt.confirmArrival&&this.confirmedArrival||(Fn(this.bookingDate,new V({minutes:l}))<Z(new Date,new V({seconds:1}))&&this.recurrenceEvent===void 0?(this.remindersTypes.set(u,this.remindersTypes.get(u)-this.remindersTypes.get(u)%5),this.remindersTypes.get(u)<10&&this.remindersTypes.delete(u)):this.remindersTypes.set(u,l));this.workerId=s.id,this.workerPhone=s.phone,this.workerName=s.name,this.workerGender=s.gender,this.showPhoneAlert=s.notifications.showPhoneAlert,this.showAdressAlert=s.notifications.showAdressAlert,this.businessName=i.shopName,this.bookingId=this.bookingId===""?Kv():this.bookingId,this.buisnessId=i.businessId,r?this.status=Ht.waiting:this.status=Ht.approved,this.notificationType=K1({booking:this,worker:s})}updateBookingByBooking({oldBooking:t,worker:s,needToHoldOn:r,business:i,newClientNote:o,keepRecurrence:a=!1}){if(this.customerName=t.customerName,this.customerPhone=t.customerPhone,this.userGender=t.userGender,this.clientMail=t.clientMail,this.customerId=t.customerId,this.note=t.note,t.treatments.size>this.treatments.size){const u=new Map;let l=0;for(const[d,f]of Object.entries(this.treatments))u.set(l.toString(),f),l+=1;this.treatments=u}const c=new Map([...t.treatments.entries()].sort((u,l)=>u[0].localeCompare(l[0])));t.treatments=c,t.customerPhone!=this.customerPhone?this.orderingOptions=In.byWorker:this.orderingOptions=t.orderingOptions,o!=null?this.clientNote=o:this.clientNote=t.clientNote,this.workerNotificationOption=s.notifications.notificationOption,this.workerRemindersTypes=new Map(s.notifications.remindersTypes),s.notifications.remindersTypes.forEach((u,l)=>{Fn(this.bookingDate,new V({minutes:u}))<Z(new Date,new V({minutes:1}))&&(this.remindersTypes.set(l,Math.abs(Math.floor(Gr(new Date,this.bookingDate).inMinutes/2))),this.remindersTypes.set(l,this.remindersTypes.get(l)-this.remindersTypes.get(l)%5),this.remindersTypes.get(l)<10&&this.remindersTypes.delete(l))}),this.debts=new Map(t.debts),this.isUserExist=t.isUserExist,this.createdAt=t.createdAt,this.lastTimeNotifyOnDebt=t.lastTimeNotifyOnDebt,this.cancelDate=t.cancelDate,this.wasWaiting=t.wasWaiting,this.signOnDeviceCalendar=t.signOnDeviceCalendar,this.recurrenceEvent=void 0,this.recurrenceNotificationsLastDate=void 0,this.recurrenceTimeId=void 0,a||(this.recurrenceRef=void 0,this.recurreneFatherDate=void 0,this.recurrenceEventRefInfo=void 0),this.userDeleted=t.userDeleted,this.paymentRequest=t.paymentRequest,this.shopIcon=i.design.shopIconData,this.workerName=s.name,this.workerGender=s.gender,this.workerId=s.id,this.workerPhone=s.phone,this.showPhoneAlert=s.notifications.showPhoneAlert,this.showAdressAlert=s.notifications.showAdressAlert,this.adress=i.adress,this.businessName=i.shopName,this.bookingId=t.bookingId===""||t.recurrenceEvent!=null?Kv():t.bookingId,this.buisnessId=t.buisnessId,this.notificationType=t.notificationType,this.bookingDate===t.bookingDate?this.status=t.status:this.status=r?Ht.waiting:Ht.approved,this.confirmedArrival=!1,r||Gr(this.bookingDate,new Date).inMinutes<60&&(this.confirmedArrival=!0),this.needCancel=t.needCancel,this.finishInvoices=t.finishInvoices,this.invoices=new Map,t.invoices.forEach((u,l)=>{this.invoices.set(l,Fs.fromBookingInvoiceData(u))}),this.transactions=new Map,t.transactions.forEach((u,l)=>{this.transactions.set(l,jr.fromTransaction(u))})}sameTreatments(t){let s=!0;return this.treatmentLength!==t.treatmentLength?!1:(Object.entries(this.treatments).forEach(([r,i])=>{let o=!1;Object.entries(t.treatments).forEach(([a,c])=>{i.id===c.id&&i.count===c.count&&(o=!0)}),s=s&&o}),s)}get businessPayloadData(){return new wo({businessName:this.businessName,businessId:this.buisnessId,shopIcon:this.shopIcon})}get notificationTopic(){return new vc({date:Ze(this.bookingDate),businessId:this.buisnessId,workerId:this.workerId,workerName:this.workerName})}get remindersToScheduleMessages(){const t=[];return this.remindersTypes.forEach((s,r)=>{const i=this.reminderMessage(r);i!=null&&t.push(i)}),t}reminderMessage(t){const s=this.remindersTypes.get(t);s==null||s===0||Fn(this.bookingDate,new V({minutes:s}))<new Date}get toBookingNotificationPayload(){return new yg({businessId:this.buisnessId,id:this.bookingId,businessName:this.businessName,totalMinutes:this.totalMinutes,isRecurrence:this.recurrenceEvent!=null,date:this.bookingDate,workerId:this.workerId,shopIcon:this.shopIcon})}get transactionsTotalPaymentPrice(){let t=new qt({amount:"0",currency:this.totalPrice.currency});for(const s of Object.values(this.transactions))s.type===jn.payment&&(t.amount+=s.amount);return t}get isDepositTransaction(){return Object.keys(this.transactions).length===1?Object.values(this.transactions)[0].type===jn.deposit:!1}get totalDebtAmount(){let t=0;for(const s of Object.values(this.debts))t+=s.amount;return t}get treatmentsToStringDetailed(){let t="";for(const s of Object.values(this.treatments))t+=s.nameForBooking+" + ";return t.length>0?t.substring(0,t.length-3):""}get priceInAdvance(){const t=new qt({amount:"0",currency:Rs});for(const s of Object.values(this.treatments))t.amount+=s.amountInAdvanceForBooking,t.currency=s.price.currency;return t}get messageRemindersOnBooking(){const t=[];if(this.cancelDate!==null||this.userFcms.size===0||this.notificationType===X.push)return t;for(const[s,r]of this.remindersTypes){if(r<=0)continue;Af(this,r).toUTCString()>=new Date().toUTCString()&&t.push(this.reminderId(s))}return t}get invoiceItem(){return new InvoiceItem({code:0,information:this.treatmentsToStringDetailed,amountPerItem:this.totalPrice.amount,quantity:1})}get toPaymentRequestUser(){return new Ti({name:this.customerName,userId:this.customerId,gender:this.userGender,isVerifiedPhone:this.isVerifiedPhone,isExist:this.isUserExist,phone:this.customerPhone})}get invoiceItems(){const t=new Map;let s=0;for(const r of Object.values(this.treatments)){let i=r.name;r.priceChangingNote!==null&&r.priceChangingNote!==""&&(i+=`: ${r.priceChangingNote}.`),Array.from({length:r.count},o=>{t.set(s,new InvoiceItem({code:s,information:i,amountPerItem:r.price.amount,quantity:1})),s++})}return t}get transactionsTotalDepositPrice(){let t=new qt({amount:"0",currency:this.totalPrice.currency});for(const s of Object.values(this.transactions))s.type===jn.deposit&&(t.amount+=s.amount);return t}get transactionDepositLength(){let t=0;for(const s of Object.values(this.transactions))s.type===jn.deposit&&(t+=1);return t}get transactionPaymentLength(){let t=0;for(const s of Object.values(this.transactions))s.type===jn.payment&&(t+=1);return t}reminderId(t){return this.createdAt<sC?this.bookingId:`${this.bookingId}__${Hi[t]}`}get bookingsEventsAsEvents(){const t=new Map;let s=this.bookingDate,r=this.totalEventsCount,i=0;return this.invoicesCoverPrice,this.treatments.forEach((o,a)=>{Array.from({length:o.count}).forEach(()=>{o.times.forEach((c,u)=>{s=Z(s,new V({minutes:c.breakMinutes}));const l=this.recurrenceTimeId!=null&&this.recurrenceEvent!=null?`${pn(s)}_${this.recurrenceTimeId}`:pn(s),d=new wc;d.eventIndex=i,d.treatmentId=o.id,d.subTreatmentName=c.title,d.totalBookingMinutes=this.totalMinutes,d.belongTreatments=this.treatmentLength,d.onHold=this.status==="waiting",d.wantDelete=this.needCancel,d.ids=[this.workerId],d.confirmArrival=this.confirmedArrival,d.hasDebt=this.debts.size>0,d.timeId=this.recurrenceEvent!=null?this.recurrenceTimeId:void 0,d.treatmentName=o.name,d.transactionCounter=this.transactions.size,d.eventsBelong=r,d.isBreak=!1,d.partOfRecurrence=this.recurrenceRef!=null,d.hasInvoice,d.recurrenceEvent=this.recurrenceEvent,d.eventName=this.customerId,d.from=s,d.durationMinutes=c.workMinutes,d.colorIndex=o.colorIndex,t.set(l,d),s=Z(s,new V({minutes:c.workMinutes})),i+=1})})}),t}isTheSameAs({booking:t,customerId:s,note:r}){var o,a;let i=!0;if(this.treatments.size!==t.treatments.size)return!1;for(const[c,u]of this.treatments)if(((o=t.treatments.get(c))==null?void 0:o.id)!=u.id||((a=t.treatments.get(c))==null?void 0:a.count)!=u.count){i=!1;break}return i&&t.customerId===s&&t.clientNote===this.clientNote&&t.note===r&&this.bookingDate.getTime()===t.bookingDate.getTime()&&this.workerId===t.workerId}toJson(){const t={};return t.workerGender=ao[this.workerGender],t.customerName=this.customerName,t.note=this.note,t.customerId=this.customerId,this.wasWaiting&&(t.wasWaiting=this.wasWaiting),this.workerDeleted&&(t.workerDeleted=this.workerDeleted),this.cancelDate!=null&&(t.cancelDate=oe(this.cancelDate)),t.remindersTypes={},this.remindersTypes.forEach((s,r)=>{t.remindersTypes[Hi[r]]=s}),t.workerRemindersTypes={},this.workerRemindersTypes.forEach((s,r)=>{t.workerRemindersTypes[Hi[r]]=s}),this.clientNote!=""&&(t.clientNote=this.clientNote),this.finishInvoices&&(t.finishInvoices=this.finishInvoices),this.debts.size>0&&(t.debts={},this.debts.forEach((s,r)=>{t.debts[r]=s.toJson()})),this.lastTimeNotifyOnDebt!=null&&(t.lastTimeNotifyOnDebt=oe(this.lastTimeNotifyOnDebt)),this.isVerifiedPhone&&(t.isVerifiedPhone=this.isVerifiedPhone),this.userDeleted&&(t.userDeleted=this.userDeleted),t.bookingId=this.bookingId,t.needCancel=this.needCancel,t.userGender=ao[this.userGender],t.businessName=this.businessName,this.signOnDeviceCalendar&&(t.signOnDeviceCalendar=this.signOnDeviceCalendar),this.recurrenceTimeId!=null&&(t.recurrenceTimeId=this.recurrenceTimeId),t.treatments={},this.recurrenceRef!=null&&(t.recurrenceRef=this.recurrenceRef),this.recurreneFatherDate!=null&&(t.recurreneFatherDate=this.recurreneFatherDate),this.treatments.forEach((s,r)=>{t.treatments[r.toString()]=s.toJson()}),t.invoices={},this.invoices.forEach((s,r)=>{t.invoices[r]=s.toJson()}),this.isMultiRef&&(t.isMultiRef=this.isMultiRef),this.isUserExist||(t.isUserExist=this.isUserExist),this.orderingOptions!=In.app&&(t.orderingOptions=Xw[this.orderingOptions]),this.showAdressAlert&&(t.showAdressAlert=this.showAdressAlert),this.showPhoneAlert&&(t.showPhoneAlert=this.showPhoneAlert),this.adress!=""&&(t.adress=this.adress),this.clientMail!=""&&(t.clientMail=this.clientMail),t.customerPhone=this.customerPhone,t.status=Kw[this.status],t.confirmedArrival=this.confirmedArrival,t.bookingDate=oe(this.bookingDate),t.workerId=this.workerId.toString(),t.workerName=this.workerName,t.buisnessId=this.buisnessId,t.shopIcon=this.shopIcon.toJson(),this.recurrenceNotificationsLastDate!=null&&(t.recurrenceNotificationsLastDate=oe(this.recurrenceNotificationsLastDate)),t.notificationType=hC[this.notificationType],t.workerNotificationOption=mC[this.workerNotificationOption],t.userFcms=Array.from(this.userFcms),t.createdAt=oe(this.createdAt),this.recurrenceEvent!=null&&(t.RE=this.recurrenceEvent.toJson({})),this.recurrenceEventRefInfo!=null&&(t.RERI=this.recurrenceEventRefInfo.toJson({saveStartDate:!0,saveException:!1,saveEnd:!1})),t.transactions={},this.transactions.forEach((s,r)=>{t.transactions[r]=s.toJson()}),this.paymentRequest!=null&&(t.paymentRequest=this.paymentRequest.toJson()),t}}class xg extends tu{constructor({businessId:e="",date:t,id:s="",workerId:r="",businessName:i="",shopIcon:o}={}){super({businessId:e,date:t,id:s,workerId:r,businessName:i,shopIcon:o})}static fromJsonStr(e){const t=JSON.parse(e),s=t.date?new Date(t.date):null,r=t.shopIcon?Fe.fromJsonStr(t.shopIcon):new Fe,i=new xg({businessId:t.businessId,date:s,id:t.id,workerId:t.workerId,businessName:t.businessName});return i.shopIcon=r,i}toJsonStr(){const e={businessId:this.businessId,date:this.date?oe(this.date):void 0,businessName:this.businessName,id:this.id,workerId:this.workerId,shopIcon:this.shopIcon.toJsonStr()};return JSON.stringify(e)}toString(){return this.toJsonStr()}}class Eg{constructor(){h(this,"price",new qt({amount:"0",currency:Rs}));h(this,"id","");h(this,"createdAt",new Date(0))}}class Co{constructor({masofNumber:e="",businessName:t="",adress:s="",businessId:r="",shopIcon:i,businessNumber:o=""}={}){h(this,"masofNumber","");h(this,"businessName","");h(this,"adress","");h(this,"businessNumber","");h(this,"businessId","");h(this,"shopIcon");this.masofNumber=e||"",this.businessName=t||"",this.adress=s||"",this.businessNumber=o||"",this.businessId=r||"",this.shopIcon=i}toJson(){const e={};return e.MN=this.masofNumber,this.shopIcon!==void 0&&(e.SI=this.shopIcon.toJson()),e.BNA=this.businessName,e.BID=this.businessId,e.A=this.adress,e.BNU=this.businessNumber,e}static fromJson(e){const t=e.SI!==void 0?Fe.fromJson(e.SI):void 0;return new Co({masofNumber:e.MN||"",businessName:e.BNA||"",businessId:e.BID||"",shopIcon:t,adress:e.A||"",businessNumber:e.BNU||""})}}class jv{constructor(e=0){h(this,"amount");this.amount=e}addAmount(e){this.amount+=e}removeAmount(e){this.amount-=e}}class Pl{constructor(e,t,s,r,i,o){h(this,"accountNumber","");h(this,"bankBranch","");h(this,"bankNumber","");h(this,"checkNumber","");h(this,"amount",0);h(this,"repaymentDate",new Date(0));this.accountNumber=e,this.bankBranch=t,this.bankNumber=s,this.checkNumber=r,this.amount=i,this.repaymentDate=o}toJson(){const e={};return e.AN=this.accountNumber,e.BB=this.bankBranch,e.BN=this.bankNumber,e.CN=this.checkNumber,e.A=this.amount,e.RD=oe(this.repaymentDate),e}static fromJson(e){return new Pl(e.AN||"",e.BB||"",e.BN||"",e.CN||"",e.A||0,new Date(e.RD||"1970-01-01T00:00:00.000Z"))}toString(){return JSON.stringify(this,null,2)}}class Rl{constructor({amount:e=0,currency:t,onlinePayment:s,cash:r}={}){h(this,"checks",[]);h(this,"onlinePayment");h(this,"cash");h(this,"applicationPayments",[]);h(this,"amount",0);h(this,"currency");this.amount=e,this.currency=t,this.onlinePayment=s,this.cash=r}addCheck(e){this.checks.push(e),this.amount+=e.amount}removeCheck(e){const t=this.checks.indexOf(e);t!==-1&&(this.checks.splice(t,1),this.amount-=e.amount)}addCashAmount(e){this.cash||(this.cash=new jv),this.cash.addAmount(e),this.amount+=e}removeCashAmount(e){this.cash&&(this.cash.removeAmount(e),this.amount-=e)}get cashAmount(){return this.cash?this.cash.amount:0}get allChecks(){return new MultipleChecks({checks:this.checks})}get allPaymentsAsChecks(){const e=new MultipleChecks({checks:this.checks});if(this.cash||this.applicationPayments.length>0){let t=0;this.cash&&(t+=this.cash.amount),this.applicationPayments.length>0&&this.applicationPayments.forEach(s=>{t+=s.amount}),e.addCheck(new Pl({accountNumber:"",bankBranch:"",bankNumber:"",checkNumber:"",amount:t,repaymentDate:new Date(0)}))}return e}toJson(){const e={};return this.checks.length>0&&(e.Ch=this.checks.map(t=>t.toJson())),this.applicationPayments.length>0&&(e.AP=this.applicationPayments.map(t=>t.toJson())),this.cash&&this.cash.amount>0&&(e.CA=this.cash.amount),this.onlinePayment&&(e.OP=this.onlinePayment.amount),e.A=this.amount,e.C=this.currency,e}static fromJson(e){const t=new Rl;if(t.checks=[],e.Ch&&e.Ch.forEach(s=>{t.checks.push(Pl.fromJson(s))}),e.AP&&e.AP.forEach(s=>{t.applicationPayments.push(ApplicationPayment.fromJson(s))}),e.CA){const s=typeof e.CA=="number"?e.CA:parseFloat(e.CA);t.cash=new jv({amount:s})}return e.OP&&(t.onlinePayment=new OnlinePayment({amount:e.OP})),e.A&&(t.amount=typeof e.A=="number"?e.A:parseFloat(e.A)),t.currency=e.C||"",t}}class Tg extends Eg{constructor({customerData:t,createdAt:s,paymentsMethods:r,items:i,businessInfo:o,workerInfo:a,invoiceNumber:c,invoiceId:u=""}){super();h(this,"customerData",new gr({}));h(this,"invoiceNumber");h(this,"workerInfo",new InvoiceWorkerInfo);h(this,"businessInfo",new Co);h(this,"invoiceId","");h(this,"signature");h(this,"items",{});h(this,"paymentsMethods",new Rl);this.customerData=t,this.createdAt=s,this.paymentsMethods=r,this.items=i,this.businessInfo=o,this.workerInfo=a,this.invoiceNumber=c,this.invoiceId=u||"",this.price=new qt({amount:this.paymentsMethods.amount.toString(),currency:ly[this.paymentsMethods.currency??""]||Rs})}get itemsAsString(){let t="";for(const s in this.items)t+=this.items[s].toItemFormat();return t}get itemsTotalAmount(){let t=0;for(const s in this.items)t+=this.items[s].totalAmount;return t}get toBookingInvoiceData(){return new Fs({issuedBy:this.workerInfo.workerId,docId:this.getInvoiceDocIndexByDate(this.createdAt).toString(),monthStr:Dr(this.createdAt),invoiceId:this.invoiceId,amount:this.paymentsMethods.amount})}getInvoiceDocIndexByDate(t){return(parseInt(W0(t),10)||0)>16?2:1}static fromJson(t,s){const r=new Tg({});return r.invoiceId=s,t.CD!==void 0&&(r.customerData=gr.fromMinimalJson(t.CD)),t.RD!==void 0&&(r.createdAt=new Date(t.RD)),t.BI!==void 0&&(r.businessInfo=Co.fromJson(t.BI)),t.WIN!==void 0&&(r.workerInfo=InvoiceWorkerInfo.fromJson(t.WIN)),r.items={},Object.entries(t.I).forEach(([i,o])=>{r.items[parseInt(i,10)]=InvoiceItem.fromJson(o,parseInt(i,10))}),t.PM!==void 0&&(r.paymentsMethods=Rl.fromJson(t.PM)),t.IN!==void 0&&(r.invoiceNumber=parseInt(t.IN,10)),r.price=new qt({amount:r.paymentsMethods.amount.toString(),currency:ly[r.paymentsMethods.currency??""]||Rs}),r.signature=t.Sig,r}toJson(){const t={};this.invoiceNumber!==void 0&&(t.IN=this.invoiceNumber.toString()),this.signature!==void 0&&(t.Sig=this.signature),t.BI=this.businessInfo.toJson(),t.WIN=this.workerInfo.toJson(),t.RD=oe(this.createdAt),t.CD=this.customerData.toMinimalJson(),t.I={};for(const s in this.items)t.I[s]=this.items[s].toJson();return t.PM=this.paymentsMethods.toJson(),t}get customerHashPhone(){return di(this.customerData.phoneNumber)}get customerPhoneAsCollection(){return this.customerData.phoneNumber.replace(/-/g,"")}get bookingInvoiceData(){return new Fs({docId:this.docId.toString(),amount:this.paymentsMethods.amount,monthStr:Dr(this.createdAt),issuedBy:this.workerInfo.workerId,invoiceId:this.invoiceId})}get link(){let t="";return this.signature===void 0?"":(this.invoiceNumber!==void 0&&(t=dC.replace("MASOFNUMBER",this.businessInfo.masofNumber).replace("INVOICENUMBER",this.invoiceNumber.toString()).replace("SIGNATURE",this.signature)),t)}get toInvoiceNoticaficationPayload(){return new xg({businessId:this.businessInfo.businessId,businessName:this.businessInfo.businessName,date:this.createdAt,id:this.invoiceId})}get docId(){return(parseInt(W0(this.createdAt),10)||0)>16?2:1}toString(){return JSON.stringify(this,null,2)}}class Gh extends tu{constructor({businessId:e,date:t,id:s,workerId:r,businessName:i,shopIcon:o}){super({businessId:e,date:t,id:s,workerId:r,businessName:i})}static fromJsonStr(e){const t=JSON.parse(e),s=t.businessId||"",r=t.businessName||"",i=t.date?new Date(t.date):void 0,o=t.workerId||"",a=t.id||"",c=t.shopIcon?Fe.fromJsonStr(t.shopIcon):void 0;return new Gh({businessId:s,date:i,id:a,workerId:o,businessName:r,shopIcon:c})}toJsonStr(){var t;const e={};return e.businessId=this.businessId,this.date!==void 0&&(e.date=oe(this.date)),e.businessName=this.businessName,e.id=this.id,e.workerId=this.workerId,e.shopIcon=((t=this.shopIcon)==null?void 0:t.toJsonStr())||null,JSON.stringify(e)}toString(){return this.toJsonStr()}}class Jh extends Eg{constructor({id:t,price:s,createdAt:r,summary:i="",multi:o=!1,userDecline:a=!1,canceled:c=!1,oneTime:u,shopIcon:l,closeForAll:d,workerInfo:f,businessInfo:m}){super();h(this,"id","");h(this,"summary","");h(this,"workerInfo",new InvoiceWorkerInfo);h(this,"businessInfo",new Co);h(this,"payers",0);h(this,"multi",!1);h(this,"closeForAll",!0);h(this,"users",{});h(this,"oneTime",!0);h(this,"userPayments",{});h(this,"userDecline",!1);h(this,"canceled",!1);h(this,"shopIcon",new Fe);this.price=s,this.createdAt=r,this.id=t,this.summary=i,this.multi=o,this.userDecline=a,this.canceled=c,this.oneTime=u,this.shopIcon=l,this.closeForAll=d,this.workerInfo=f,this.businessInfo=m}get link(){return`https://${vg}/${wg}`.replace("PAYMENT_ID",this.id)}get toPaymentRequestPreview(){const t=new xc({id:this.id,businessName:this.businessInfo.businessName,shopIcon:this.shopIcon,businessId:this.businessInfo.businessId,workerId:this.workerInfo.workerId,price:this.price,oneTime:this.oneTime,workerName:this.workerInfo.workerName,summary:this.summary,closeForAll:this.closeForAll});return t.users=this.users,t.createdAt=this.createdAt,t}get toPaymentRequestNotificationPayload(){const t=new Gh({businessId:this.businessInfo.businessId,id:this.id,businessName:this.businessInfo.businessName,date:this.createdAt,workerId:this.workerInfo.workerId,shopIcon:this.shopIcon});return t.shopIcon=this.shopIcon,t}get businessPayloadData(){return new wo({businessName:this.businessInfo.businessName,businessId:this.businessInfo.businessId,shopIcon:this.shopIcon})}get docId(){return Dr(this.createdAt)}get toBookingPaymentRequestData(){const t=new zh({});return t.createdAt=this.createdAt,t.id=this.id,t.workerId=this.workerInfo.workerId,t}get userPay(){return Object.keys(this.userPayments).length>0}static fromJson(t,s){const r=new Jh({});return r.id=s,t.businessInfo!=null&&(r.businessInfo=Co.fromJson(t.businessInfo)),r.closeForAll=t.closeForAll??!0,t.workerInfo!=null&&(r.workerInfo=InvoiceWorkerInfo.fromJson(t.workerInfo)),t.shopIcon!=null&&(r.shopIcon=Fe.fromJson(t.shopIcon)),r.canceled=t.canceled??!1,r.oneTime=t.oneTime??!0,t.price!=null&&(r.price=qt.fromJson(t.price)),r.multi=t.multi??!1,r.userDecline=t.userDecline??!1,t.userPayments!=null&&typeof t.userPayments=="object"&&Object.entries(t.userPayments).forEach(([i,o])=>{r.userPayments[i]=o!=null?new Date(o):new Date(0)}),r.summary=t.summary??"",t.createdAt!=null&&(r.createdAt=t.createdAt!=null?new Date(t.createdAt):new Date(0)),r.payers=t.payers??0,r}toJson(){const t={};return this.createdAt!=null&&this.createdAt.getTime()!==new Date(0).getTime()&&(t.createdAt=oe(this.createdAt)),this.oneTime||(t.oneTime=this.oneTime),this.canceled&&(t.canceled=this.canceled),this.summary!==""&&(t.summary=this.summary),this.closeForAll||(t.closeForAll=this.closeForAll),Object.keys(this.userPayments).length>0&&(t.userPayments={},Object.entries(this.userPayments).forEach(([s,r])=>{t.userPayments[s]=oe(r)})),this.payers>0&&(t.payers=this.payers),this.userDecline&&(t.userDecline=this.userDecline),this.multi&&(t.multi=this.multi),t.price=this.price.toJson(),t.workerInfo=this.workerInfo.toJson(),t.businessInfo=this.businessInfo.toJson(),t.shopIcon=this.shopIcon.toJson(),t}toString(){return JSON.stringify(this,null,"  ")}}class xc extends Eg{constructor({id:t,price:s,createdAt:r,summary:i="",businessName:o,shopIcon:a,oneTime:c=!1,closeForAll:u=!1,workerName:l,workerId:d,businessId:f}){super();h(this,"id","");h(this,"summary","");h(this,"workerId","");h(this,"businessName","");h(this,"workerName","");h(this,"businessId");h(this,"multi",!1);h(this,"closeForAll",!0);h(this,"users",{});h(this,"oneTime",!0);h(this,"userPayments",{});h(this,"userDecline",!1);h(this,"canceled",!1);h(this,"bookingReference");h(this,"shopIcon",new Fe);this.id=t,this.price=s,this.createdAt=r,this.summary=i,this.workerId=d,this.businessId=f,this.businessName=o,this.workerName=l,this.users={},this.closeForAll=u,this.oneTime=c,this.bookingReference=void 0,this.shopIcon=new Fe}static empty(){return new xc({})}get link(){return`https://${vg}/${wg}`.replaceAll("PAYMENT_ID",this.id)}get payers(){let t=0;return Object.values(this.users).forEach(s=>{t+=Object.keys(s.payments).length}),t}get docId(){return Dr(this.createdAt)}toPaymentRequest(t,s){const r=new Jh({id:this.id,price:this.price,oneTime:this.oneTime,shopIcon:this.shopIcon,multi:Object.keys(this.users).length>1,workerInfo:t,businessInfo:s,summary:this.summary,closeForAll:this.closeForAll});return r.createdAt=this.createdAt,r}get toPaymentRequestNotificationPayload(){return new Gh({businessId:this.businessId,businessName:this.businessName,id:this.id,date:this.createdAt,workerId:this.workerId,shopIcon:this.shopIcon})}static fromJson(t,s){const r=new xc({});return r.id=s,t.price!=null&&(r.price=qt.fromJson(t.price)),r.closeForAll=t.closeForAll??!0,r.summary=t.summary??"",t.shopIcon!=null&&(r.shopIcon=Fe.fromJson(t.shopIcon)),t.createdAt!=null&&(r.createdAt=new Date(t.createdAt)??new Date(0)),r.oneTime=t.oneTime??!0,r.businessName=t.businessName??"",r.workerId=t.workerId??"",r.businessId=t.businessId??"",r.workerName=t.workerName??"",r.users={},t.users!=null&&Object.entries(t.users).forEach(([i,o])=>{r.users[i]=Ti.fromJson(o,i)}),t.bookingReference!=null&&(r.bookingReference=Yh.fromJson(t.bookingReference)),r}toJson(){const t={};return this.createdAt!=new Date(0)&&(t.createdAt=dateIsoStr(this.createdAt)),this.summary!==""&&(t.summary=this.summary),this.oneTime||(t.oneTime=this.oneTime),this.closeForAll||(t.closeForAll=this.closeForAll),t.price=this.price.toJson(),t.workerId=this.workerId,t.businessName=this.businessName,t.businessId=this.businessId,t.workerName=this.workerName,Object.keys(this.users).length>0&&(t.users={},Object.entries(this.users).forEach(([s,r])=>{t.users[s]=r.toJson()})),this.bookingReference!=null&&(t.bookingReference=this.bookingReference.toJson()),t.shopIcon=this.shopIcon.toJson(),t}toString(){return JSON.stringify(this.toJson(),null,"  ")}}class p8{constructor(){h(this,"bookings",{});h(this,"invoices",{});h(this,"paymentsRequests",{});h(this,"clientAt",{})}get isEmpty(){return this.bookingCount===0&&this.invoicesCount===0&&this.paymentsRequestCount===0}get bookingCount(){let e=0;for(const t of Object.values(this.bookings))e+=Object.keys(t).length;return e}get invoicesCount(){let e=0;for(const t of Object.values(this.invoices))e+=Object.keys(t).length;return e}get paymentsRequestCount(){let e=0;for(const t of Object.values(this.paymentsRequests))e+=Object.keys(t).length;return e}get clientAtJson(){const e={};for(const[t,s]of Object.entries(this.clientAt)){e[t]={};for(const r of s)e[t][r]=""}return e}get bookingsJson(){const e={};for(const[t,s]of Object.entries(this.bookings)){e[t]={};for(const[r,i]of Object.entries(s))e[t][r]=i.toJson()}return e}get invoicesJson(){const e={};for(const[t,s]of Object.entries(this.invoices)){e[t]={};for(const[r,i]of Object.entries(s))e[t][r]=i.toJson()}return e}get paymentRequestJson(){const e={};for(const[t,s]of Object.entries(this.paymentsRequests)){e[t]={};for(const[r,i]of Object.entries(s))e[t][r]=i.toJson()}return e}get bookingsPreviewsJson(){const e={};for(const[t,s]of Object.entries(this.bookings)){const r=new qh({});for(const[i,o]of Object.entries(s))o.cancelDate===null&&(r.bookingCount=r.bookingCount+1);r.lastUpdateTime=new Date,e[t]=r.toJson()}return e}get whatWeFoundStr(){let e=J("weFound");const t=[];return this.bookingCount>0&&t.push(J("foundBookings").replace("COUNTER",this.bookingCount.toString())),this.invoicesCount>0&&t.push(J("foundInvoices").replace("COUNTER",this.invoicesCount.toString())),this.paymentsRequestCount>0&&t.push(J("foundPaymentsRequests").replace("COUNTER",this.paymentsRequestCount.toString())),t.forEach((s,r)=>{if(r===0){e+=s;return}if(r===t.length-1){e+=" ",e+=J("and")+s;return}e+=", "+s}),e+=", "+J("thatAutoMaticllyAdded"),e}}class g8{constructor(){h(this,"_db");X0().length===0?Hl(G0):No(),this._db=q3()}async getChild({childPath:e}){try{const t=Rr(this._db,`${Ke}/${e}`);return await M3(t)}catch(t){throw t}}async updateChild({childPath:e,data:t}){try{const s=Rr(this._db,`${Ke}/${e}`);return await Fd(s,t),!0}catch{return!1}}async removeChild({childPath:e}){try{const t=Rr(this._db,`${Ke}/${e}`);return await N3(t),!0}catch{return!1}}async incrementNumberChild({childPath:e,valueId:t,delta:s,command:r}){try{r===Ea.decrement&&(s=-s);const i={[t]:ov(s)},o=Rr(this._db,`${Ke}/${e}`);return await Fd(o,i),!0}catch{return!1}}async incrementMultipleNumberChild({childPath:e,data:t}){try{const s={};for(const[i,o]of Object.entries(t))s[i]=ov(o);const r=Rr(this._db,`${Ke}/${e}`);return await Fd(r,s),!0}catch{return!1}}listenToChild({childPath:e,callback:t}){const s=Rr(this._db,`${Ke}/${e}`);return F3(s,t)}async setChild({childPath:e,data:t}){try{const s=Rr(this._db,`${Ke}/${e}`);return await H1(s,t),!0}catch{return!1}}}class y8 extends g8{constructor(){X0().length===0?Hl(G0):No();super();h(this,"_firestore");this._firestore=lF()}get getBatch(){return kF(this._firestore)}async getDocSRV({path:t,docId:s,insideEnviroments:r=!0}){try{const i=Vt(this._firestore,r?`${Ke}/${t}`:t),o=sn(i,s);return await w_(o)}catch(i){throw i instanceof Error&&(he.error(i.message),_e.GI().addError({error:se.serverError,details:i.message})),i}}async getAllDocsInsideCollection(t){try{const s=Vt(this._firestore,`${Ke}/${t}`);return(await x_(s)).docs.map(i=>i.data())}catch(s){if(s instanceof Error)throw _e.GI().addError({error:se.serverError,details:s.toString()}),s;return[]}}async commmitBatch(t){try{return await t.commit(),!0}catch(s){throw he.error("Error while commit batch -->",s),s instanceof Error&&_e.GI().addError({error:se.serverError,details:s.toString()}),new Error(`Server Error: ${s}`)}}async runTransaction(t){try{return await AF(this._firestore,async r=>{try{return await t(r)}catch(i){return i instanceof Error&&(he.error(`Error while run transaction -> ${i} ${i.stack}`),_e.GI().addError({error:se.serverError,details:i.toString()})),!1}})}catch(s){throw console.error("Error while run transaction -->",s),s instanceof Error&&_e.GI().addError({error:se.serverError,details:s.toString()}),new Error(`Server Error: ${s}`)}}async transactionGet(t,s,r){try{const i=Vt(this._firestore,`${Ke}/${s}`),o=sn(i,r);return await t.get(o)}catch(i){throw console.error("Error while getting document in transaction -->",i),i instanceof Error&&_e.GI().addError({error:se.serverError,details:i.toString()}),new Error(`Server Error: ${i}`)}}async transactionUpdateAsMap({transaction:t,path:s,docId:r,fieldName:i,value:o}){try{const a=Vt(this._firestore,`${Ke}/${s}`),c=sn(a,r),u={[i]:o||Cd()};t.update(c,u)}catch(a){throw he.error("Error while updating document in transaction -->",a),a instanceof Error&&_e.GI().addError({error:se.serverError,details:a.toString()}),new Error(`Server Error: ${a}`)}}async setAsMap({batch:t,path:s,docId:r,data:i,insideEnviroments:o=!0}){try{const a=Vt(this._firestore,o?`${Ke}/${s}`:s),c=sn(a,r);t.set(c,i,{merge:!0})}catch(a){throw a instanceof Error&&_e.GI().addError({error:se.serverError,details:a.toString()}),a}}async getAllDocsAndIdsInsideCollection({path:t}){try{const s=Vt(this._firestore,`$envKey/${t}`),r=await x_(s),i={};return r.docs.forEach(o=>{i[o.id]=o.data()}),i}catch(s){throw s instanceof Error&&_e.GI().addError({error:se.serverError,details:s.toString()}),s}}async transactionUpdateMultipleFieldsAsMap({transaction:t,path:s,docId:r,data:i,insideEnvironments:o=!0}){try{const a=Vt(this._firestore,o?`${Ke}/${s}`:s),c=sn(a,r),u=this.organizeData(i);t.update(c,u)}catch(a){throw console.error("Error while updating multiple fields in transaction -->",a),a instanceof Error&&_e.GI().addError({error:se.serverError,details:a.toString()}),new Error(`Server Error: ${a}`)}}async transactionCreateDoc({transaction:t,path:s,docId:r,value:i}){try{const o=Vt(this._firestore,`${Ke}/${s}`),a=sn(o,r);t.set(a,i)}catch(o){throw he.error("Error while creating document in transaction -->",o),o instanceof Error&&_e.GI().addError({error:se.serverError,details:o.toString()}),new Error(`Server Error: ${o}`)}}async transactionSetAsMap({transaction:t,path:s,docId:r,data:i}){try{const o=Vt(this._firestore,`${Ke}/${s}`),a=sn(o,r),c=this.organizeData(i);console.log(c),t.set(a,c,{merge:!0})}catch(o){throw he.error("Error while setting document as map in transaction -->",o),o instanceof Error&&_e.GI().addError({error:se.serverError,details:o.toString()}),new Error(`Server Error: ${o}`)}}async deleteDoc({batch:t,path:s,docId:r}){try{const i=Vt(this._firestore,`${Ke}/${s}`),o=sn(i,r);t.delete(o)}catch(i){throw i instanceof Error&&_e.GI().addError({error:se.serverError,details:i.toString()}),i}}async setDoc({batch:t,path:s,docId:r,valueToSet:i,insideEnviroments:o=!0}){try{const a=Vt(this._firestore,o?`${Ke}/${s}`:s),c=sn(a,r);t.set(c,i)}catch(a){throw a instanceof Error&&_e.GI().addError({error:se.serverError,details:a.toString()}),a}}async createDoc({batch:t,path:s,docId:r,valueAsJson:i,insideEnviroments:o=!0,mergeIfExist:a=!1}){try{const c=Vt(this._firestore,o?`${Ke}/${s}`:s),u=sn(c,r);t.set(u,i,{merge:a})}catch(c){throw c instanceof Error&&_e.GI().addError({error:se.serverError,details:c.toString()}),c}}async updateFieldInsideDocAsMap({batch:t,path:s,docId:r,value:i,fieldName:o,command:a,insideEnviroments:c=!0}){try{const u=Vt(this._firestore,c?`${Ke}/${s}`:s),l=sn(u,r);a===void 0?t.update(l,{[o]:i??Cd()}):t.update(l,{[o]:a===Ea.increment?vu(1):vu(-1)})}catch(u){throw u instanceof Error&&_e.GI().addError({error:se.serverError,details:u.toString()}),u}}async updateMultipleFieldsInsideDocAsMap({batch:t,path:s,docId:r,data:i,insideEnviroments:o=!0}){try{const a=Vt(this._firestore,o?`${Ke}/${s}`:s),c=sn(a,r);t.update(c,this.organizeData(i))}catch(a){throw he.error("Error while updating the batch -->",a),a instanceof Error&&_e.GI().addError({error:se.serverError,details:a.toString()}),new Error(`Server Error: ${a}`)}}updateFieldInsideDocAsArray({batch:t,path:s,docId:r,fieldName:i,value:o,command:a=Hf.add}){try{const c=Vt(this._firestore,`${Ke}/${s}`),u=sn(c,r);t.update(u,{[i]:a===Hf.remove?CF([o]):bF([o])})}catch(c){throw c instanceof Error&&_e.GI().addError({error:se.serverError,details:c.toString()}),new Error(`Server Error: ${c}`)}}docListener({path:t,docId:s,onChanged:r}){try{const i=Vt(this._firestore,`${Ke}/${t}`),o=sn(i,s);return w_(o).then(a=>{a.exists()&&r(a)}),xF(o,r)}catch(i){throw i instanceof Error&&_e.GI().addError({error:se.serverError,details:i.message}),i}}organizeData(t){var s={};return Object.entries(t).forEach(([r,i])=>{let o=i;o==null&&(o=Cd()),o===Ea.increment&&(o=vu(1)),o===Ea.decrement&&(o=vu(-1)),s[r]=o}),s}get currentTimestamp(){return Be.now()}}class rD extends y8{constructor(){super()}async getDocRepo({path:e,docId:t,insideEnviroments:s=!0}){return await super.getDocSRV({path:e,docId:t,insideEnviroments:s})}async createDocRepo({path:e,docId:t,valueAsJson:s,insideEnviroments:r=!0,mergeIfExist:i=!1}){const o=this.getBatch;return super.createDoc({batch:o,path:e,docId:t,valueAsJson:s,insideEnviroments:r,mergeIfExist:i}),await this.commmitBatch(o)}async updateFieldInsideDocAsArrayRepo({path:e,docId:t,fieldName:s,value:r,command:i}){const o=this.getBatch;return super.updateFieldInsideDocAsArray({batch:o,path:e,docId:t,fieldName:s,value:r,command:i}),await this.commmitBatch(o)}async updateFieldInsideDocAsMapRepo({path:e,docId:t,fieldName:s,value:r,insideEnviroments:i=!0,command:o=void 0}){const a=this.getBatch;return this.updateFieldInsideDocAsMap({batch:a,path:e,docId:t,fieldName:s,value:r,command:o,insideEnviroments:i}),await this.commmitBatch(a)}async updateMultipleFieldsInsideDocAsMapRepo({path:e,docId:t,data:s,insideEnviroments:r=!0}){const i=this.getBatch;return super.updateMultipleFieldsInsideDocAsMap({batch:i,path:e,docId:t,data:s,insideEnviroments:r}),await this.commmitBatch(i)}async deleteDocRepo({path:e,docId:t}){const s=this.getBatch;return super.deleteDoc({batch:s,path:e,docId:t}),await this.commmitBatch(s)}async setDocRepo({path:e,docId:t,valueAsJson:s,insideEnviroments:r=!0}){const i=this.getBatch;return super.setDoc({batch:i,path:e,docId:t,valueToSet:s,insideEnviroments:r}),await this.commmitBatch(i)}async setAsMapWithMergeRepo({path:e,docId:t,valueAsJson:s,insideEnviroments:r=!0}){const i=this.getBatch;return super.setAsMap({batch:i,path:e,docId:t,data:s,insideEnviroments:r}),await this.commmitBatch(i)}docListenerRepo({path:e,docId:t,onChanged:s}){return super.docListener({path:e,docId:t,onChanged:s})}async getWorkerFromTransactionRepo({transaction:e,workerId:t,businessModel:s,needMultiDoc:r=!1}){const i=`${kt}/${xt.currentBusinesssId}/${un}`,o=await this.transactionGet(e,i,t);if(!o.exists())return;const a=_c.fromWorkerDocJson(o.data());return await super.transactionGet(e,`${i}/${t}/${dt}`,cn).then(c=>{c.exists()&&a.workerPublicData.setWorkerPublicData(c.data())}),a.hasRecurrenceEvents&&a.isCustomersNeedRecurrence&&await super.transactionGet(e,`${i}/${t}/${dt}`,Gw).then(c=>{c.exists()&&c.data()!=null&&a.recurrence.setRecurrenceEvents(c.data(),t,s??hi.empty())}),r&&await super.transactionGet(e,`${i}/${t}/${dt}`,Qw).then(c=>{c.exists()&&a.multiEventsTimes.setData(c.data())}),a}toFormatedCustomerData({customerData:e,amountOfBookingsCommand:t,useUserFirstBookingsDate:s=!1,saveExtraData:r=!1}){const i=e.toJson();i.amoutOfBookings=t;const o={};return o[`data.${e.customerUuid}.amoutOfBookings`]=i.amoutOfBookings,i.lastBookingsDate!=null&&(o[`data.${e.customerUuid}.lastBookingsDate`]=i.lastBookingsDate),s?i.userFirstBookingsDate!=null&&(o[`data.${e.customerUuid}.userFirstBookingsDate`]=i.userFirstBookingsDate):i.firstBookingsDate!=null&&(o[`data.${e.customerUuid}.firstBookingsDate`]=i.firstBookingsDate),r&&(i.gender!=null&&(o[`data.${e.customerUuid}.gender`]=i.gender),i.name!=null&&(o[`data.${e.customerUuid}.name`]=i.name),i.workerNaming!=null&&(o[`data.${e.customerUuid}.name`]=i.workerNaming),i.email!=null&&(o[`data.${e.customerUuid}.email`]=i.email),i.id!=null&&(o[`data.${e.customerUuid}.id`]=i.id)),o}async realTimeEventsCounterHandler({businessId:e,workerId:t,types:s,increment:r}){if(s.size===0)return!0;const i=Ya.GI().getWorkerCountersPath(e,t),o={};return s.forEach((a,c)=>{my[c]!==null&&a!==0&&(o[my[c]]=(r?1:-1)*a)}),Object.keys(o).length===0?!0:await this.incrementMultipleNumberChild({childPath:i,data:o})}}class _8 extends rD{constructor(){super()}async updatePublicUserField({userId:e,businessesIds:t,fieldName:s,cangeUserDoc:r=!0,value:i}){console.log(i);const o=this.getBatch;return r&&this.updateFieldInsideDocAsMap({batch:o,path:on,docId:e,fieldName:s,value:i}),this.updateFieldInsideDocAsMap({batch:o,path:`${on}/${e}/${dt}`,docId:cn,fieldName:s,value:i}),t.forEach(a=>{this.updateFieldInsideDocAsMap({batch:o,path:`${kt}/${a}/${un}`,docId:e,fieldName:s,value:i})}),await this.commmitBatch(o)}async updatePublicUserFields({userId:e,businessesIds:t,cangeUserDoc:s=!0,dataForWorker:r,data:i}){const o=this.getBatch;return s&&this.updateMultipleFieldsInsideDocAsMap({batch:o,path:on,docId:e,data:i}),this.updateMultipleFieldsInsideDocAsMap({batch:o,path:`${on}/${e}/${dt}`,docId:cn,data:i}),t.forEach(a=>{this.updateMultipleFieldsInsideDocAsMap({batch:o,path:`${kt}/${a}/${un}`,docId:e,data:r||i})}),await this.commmitBatch(o)}async createUser({user:e}){const t=this.getBatch;return this.createDoc({batch:t,path:on,docId:e.id,valueAsJson:e.toUserDocJson()}),this.setAsMap({batch:t,path:`${on}/${e.id}/${dt}`,docId:cn,data:e.userPublicData.toJson()}),await this.commmitBatch(t)}async mergePhoneDataWithUser({phone:e,userId:t,name:s}){const r=new p8,i=di(e),o=e.replaceAll("-",""),a=async c=>{const u=await this.transactionGet(c,zn,i);if(u.exists()&&u.data().userId!=t)return _e.GI().error=se.alreadyExistPhone,!1;const l=await this.transactionGet(c,`${zn}/${i}/${o}`,ry);l.exists()&&l.data()!=null&&Object.entries(l.data().clientAt).forEach(([p,y])=>{Object.keys(y).length!==0&&(r.clientAt[p]=new Set,Object.entries(y).forEach(([g,x])=>{r.clientAt[p].add(g)}))});const d=await this.getAllDocsAndIdsInsideCollection({path:`${zn}/${i}/${o}/${bi}/${xa}`});Object.entries(d).forEach(([p,y])=>{var g;(g=r.bookings)[p]??(g[p]={}),Object.entries(y).forEach(([x,_])=>{const v=Tt.fromJson(_,x);v.customerId=t,v.isUserExist=!0,r.bookings[p][x]=v})});const f=await this.getAllDocsAndIdsInsideCollection({path:`${zn}/${i}/${o}/${bi}/${ld}`});Object.entries(f).forEach(([p,y])=>{var g;(g=r.invoices)[p]??(g[p]={}),Object.entries(y).forEach(([x,_])=>{const v=Tg.fromJson(_,x);r.invoices[p][x]=v})});const m=await this.getAllDocsAndIdsInsideCollection({path:`${zn}/${i}/${o}/${bi}/${hd}`});return Object.entries(m).forEach(([p,y])=>{var g;(g=r.paymentsRequests)[p]??(g[p]={}),Object.entries(y).forEach(([x,_])=>{const v=Jh.fromJson(_,x);r.paymentsRequests[p][x]=v})}),(r.clientAt.isNotEmpty||r.bookingCount>0)&&this.transactionSetAsMap({transaction:c,path:`${on}/${t}/${dt}`,docId:cn,data:{clientAt:r.clientAtJson,bookingsPreviews:r.bookingsPreviewsJson}}),this.transactionCreateDoc({transaction:c,path:zn,docId:di(e),value:{userId:t,name:s}}),Object.entries(r.bookingsJson).forEach(([p,y])=>{this.transactionSetAsMap({transaction:c,path:`${on}/${t}/${dt}/${cn}/${xa}`,docId:p,data:y})}),Object.entries(r.invoicesJson).forEach(([p,y])=>{this.transactionSetAsMap({transaction:c,path:`${on}/${t}/${dt}/${cn}/${ld}`,docId:p,data:y})}),Object.entries(r.paymentRequestJson).forEach(([p,y])=>{this.transactionSetAsMap({transaction:c,path:`${on}/${t}/${dt}/${cn}/${hd}`,docId:p,data:y})}),!0};return await this.runTransaction(a).then(async c=>{if(c){const u=[];return r.clientAt.isNotEmpty&&u.push(this.deleteDoc({batch:this.getBatch,path:`${zn}/${i}/${o}`,docId:ry})),Object.entries(r.invoices).forEach(([l,d])=>{u.push(this.deleteDoc({batch:this.getBatch,path:`${zn}/${i}/${o}/${bi}/${ld}`,docId:l}))}),Object.entries(r.paymentsRequests).forEach(([l,d])=>{u.push(this.deleteDoc({batch:this.getBatch,path:`${zn}/${i}/${o}/${bi}/${hd}`,docId:l}))}),Object.entries(r.bookings).forEach(([l,d])=>{u.push(this.deleteDoc({batch:this.getBatch,path:`${zn}/${i}/${o}/${bi}/${xa}`,docId:l}))}),r.bookings.isNotEmpty&&Object.entries(r.bookings).forEach(([l,d])=>{Object.entries(d).forEach(([f,m])=>{u.push(this.updateMultipleFieldsInsideDocAsMapRepo({path:`${kt}/${m.buisnessId}/${un}/${m.workerId}/${dt}/${cn}/${zw}`,docId:Ze(m.bookingDate),data:m.isMultiRef?{[`${pn(m.bookingDate)}.users.${f}.customerId`]:t,[`${pn(m.bookingDate)}.users.${f}.isUserExist`]:!0,[`${pn(m.bookingDate)}.users.${f}.isVerifiedPhone`]:!0}:{[`${f}.customerId`]:t,[`${f}.isUserExist`]:!0,[`${f}.isVerifiedPhone`]:!0}}))})}),r.paymentsRequests.isNotEmpty&&Object.entries(r.paymentsRequests).forEach(([l,d])=>{Object.entries(d).forEach(([f,m])=>{u.push(new Promise(async()=>{const p=await this.getDocSRV({path:sy,docId:f});if(p.data()===void 0||!p.exists())return;const g=xc.fromJson(p.data(),f).users[e];g!=null&&(g.isExist=!0,g.isVerifiedPhone=!0,g.userId=t,await this.updateMultipleFieldsInsideDocAsMapRepo({path:sy,docId:f,data:{[`users.${e}`]:void 0,[`users.${t}`]:g.toJson()}}))}))})}),u.length>0&&await Promise.all(u),r}})}}function iD(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const v8=iD,oD=new Dc("auth","Firebase",iD());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nl=new Ul("@firebase/auth");function w8(n,...e){Nl.logLevel<=pe.WARN&&Nl.warn(`Auth (${mi}): ${n}`,...e)}function Ru(n,...e){Nl.logLevel<=pe.ERROR&&Nl.error(`Auth (${mi}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function us(n,...e){throw Dg(n,...e)}function _n(n,...e){return Dg(n,...e)}function aD(n,e,t){const s=Object.assign(Object.assign({},v8()),{[e]:t});return new Dc("auth","Firebase",s).create(e,{appName:n.name})}function Ig(n,e,t){const s=t;if(!(e instanceof s))throw s.name!==e.constructor.name&&us(n,"argument-error"),aD(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Dg(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return oD.create(n,...e)}function $(n,e,...t){if(!n)throw Dg(e,...t)}function Cs(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Ru(e),new Error(e)}function qs(n,e){n||Cs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $0(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function cD(){return Xv()==="http:"||Xv()==="https:"}function Xv(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x8(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(cD()||yA()||"connection"in navigator)?navigator.onLine:!0}function E8(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nu{constructor(e,t){this.shortDelay=e,this.longDelay=t,qs(t>e,"Short delay should be less than long delay!"),this.isMobile=K0()||Cw()}get(){return x8()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ag(n,e){qs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uD{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Cs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Cs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Cs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T8={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I8=new nu(3e4,6e4);function Qs(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Rn(n,e,t,s,r={}){return lD(n,r,async()=>{let i={},o={};s&&(e==="GET"?o=s:i={body:JSON.stringify(s)});const a=fi(Object.assign({key:n.config.apiKey},o)).slice(1),c=await n._getAdditionalHeaders();return c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode),uD.fetch()(hD(n,n.config.apiHost,t,a),Object.assign({method:e,headers:c,referrerPolicy:"no-referrer"},i))})}async function lD(n,e,t){n._canInitEmulator=!1;const s=Object.assign(Object.assign({},T8),e);try{const r=new D8(n),i=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw wa(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[c,u]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw wa(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw wa(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw wa(n,"user-disabled",o);const l=s[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw aD(n,l,u);us(n,l)}}catch(r){if(r instanceof zs)throw r;us(n,"network-request-failed",{message:String(r)})}}async function Qh(n,e,t,s,r={}){const i=await Rn(n,e,t,s,r);return"mfaPendingCredential"in i&&us(n,"multi-factor-auth-required",{_serverResponse:i}),i}function hD(n,e,t,s){const r=`${e}${t}?${s}`;return n.config.emulator?Ag(n.config,r):`${n.config.apiScheme}://${r}`}class D8{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(_n(this.auth,"network-request-failed")),I8.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function wa(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const r=_n(n,e,s);return r.customData._tokenResponse=t,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zv(n){return n!==void 0&&n.getResponse!==void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A8(n){return(await Rn(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function b8(n,e){return Rn(n,"POST","/v1/accounts:delete",e)}async function C8(n,e){return Rn(n,"POST","/v1/accounts:update",e)}async function k8(n,e){return Rn(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ba(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function S8(n,e=!1){const t=Te(n),s=await t.getIdToken(e),r=bg(s);$(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const i=typeof r.firebase=="object"?r.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:r,token:s,authTime:Ba(bf(r.auth_time)),issuedAtTime:Ba(bf(r.iat)),expirationTime:Ba(bf(r.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function bf(n){return Number(n)*1e3}function bg(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return Ru("JWT malformed, contained fewer than 3 sections"),null;try{const r=Bu(t);return r?JSON.parse(r):(Ru("Failed to decode base64 JWT payload"),null)}catch(r){return Ru("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function P8(n){const e=bg(n);return $(e,"internal-error"),$(typeof e.exp<"u","internal-error"),$(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ko(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof zs&&R8(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function R8({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N8{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const r=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dD{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ba(this.lastLoginAt),this.creationTime=Ba(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ec(n){var e;const t=n.auth,s=await n.getIdToken(),r=await ko(n,k8(t,{idToken:s}));$(r==null?void 0:r.users.length,t,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?F8(i.providerUserInfo):[],a=O8(n.providerData,o),c=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!(a!=null&&a.length),l=c?u:!1,d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new dD(i.createdAt,i.lastLoginAt),isAnonymous:l};Object.assign(n,d)}async function M8(n){const e=Te(n);await Ec(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function O8(n,e){return[...n.filter(s=>!e.some(r=>r.providerId===s.providerId)),...e]}function F8(n){return n.map(e=>{var{providerId:t}=e,s=z0(e,["providerId"]);return{providerId:t,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B8(n,e){const t=await lD(n,{},async()=>{const s=fi({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:i}=n.config,o=hD(n,r,"/v1/token",`key=${i}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",uD.fetch()(o,{method:"POST",headers:a,body:s})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function L8(n,e){return Rn(n,"POST","/v2/accounts:revokeToken",Qs(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){$(e.idToken,"internal-error"),$(typeof e.idToken<"u","internal-error"),$(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):P8(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return $(!this.accessToken||this.refreshToken,e,"user-token-expired"),!t&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:r,expiresIn:i}=await B8(e,t);this.updateTokensAndExpiration(s,r,Number(i))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:r,expirationTime:i}=t,o=new Tc;return s&&($(typeof s=="string","internal-error",{appName:e}),o.refreshToken=s),r&&($(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),i&&($(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Tc,this.toJSON())}_performRefresh(){return Cs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function er(n,e){$(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Xr{constructor(e){var{uid:t,auth:s,stsTokenManager:r}=e,i=z0(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new N8(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=s,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new dD(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await ko(this,this.stsTokenManager.getToken(this.auth,e));return $(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return S8(this,e)}reload(){return M8(this)}_assign(e){this!==e&&($(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Xr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){$(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await Ec(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await ko(this,b8(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var s,r,i,o,a,c,u,l;const d=(s=t.displayName)!==null&&s!==void 0?s:void 0,f=(r=t.email)!==null&&r!==void 0?r:void 0,m=(i=t.phoneNumber)!==null&&i!==void 0?i:void 0,p=(o=t.photoURL)!==null&&o!==void 0?o:void 0,y=(a=t.tenantId)!==null&&a!==void 0?a:void 0,g=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,x=(u=t.createdAt)!==null&&u!==void 0?u:void 0,_=(l=t.lastLoginAt)!==null&&l!==void 0?l:void 0,{uid:v,emailVerified:w,isAnonymous:I,providerData:D,stsTokenManager:E}=t;$(v&&E,e,"internal-error");const A=Tc.fromJSON(this.name,E);$(typeof v=="string",e,"internal-error"),er(d,e.name),er(f,e.name),$(typeof w=="boolean",e,"internal-error"),$(typeof I=="boolean",e,"internal-error"),er(m,e.name),er(p,e.name),er(y,e.name),er(g,e.name),er(x,e.name),er(_,e.name);const C=new Xr({uid:v,auth:e,email:f,emailVerified:w,displayName:d,isAnonymous:I,photoURL:p,phoneNumber:m,tenantId:y,stsTokenManager:A,createdAt:x,lastLoginAt:_});return D&&Array.isArray(D)&&(C.providerData=D.map(T=>Object.assign({},T))),g&&(C._redirectEventId=g),C}static async _fromIdTokenResponse(e,t,s=!1){const r=new Tc;r.updateFromServerResponse(t);const i=new Xr({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:s});return await Ec(i),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ew=new Map;function ks(n){qs(n instanceof Function,"Expected a class definition");let e=ew.get(n);return e?(qs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,ew.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fD{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}fD.type="NONE";const tw=fD;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nu(n,e,t){return`firebase:${n}:${e}:${t}`}class ro{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:r,name:i}=this.auth;this.fullUserKey=Nu(this.userKey,r.apiKey,i),this.fullPersistenceKey=Nu("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Xr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new ro(ks(tw),e,s);const r=(await Promise.all(t.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=r[0]||ks(tw);const o=Nu(s,e.config.apiKey,e.name);let a=null;for(const u of t)try{const l=await u._get(o);if(l){const d=Xr._fromJSON(e,l);u!==i&&(a=d),i=u;break}}catch{}const c=r.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new ro(i,e,s):(i=c[0],a&&await i._set(o,a.toJSON()),await Promise.all(t.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new ro(i,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nw(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(gD(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(mD(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(_D(e))return"Blackberry";if(vD(e))return"Webos";if(Cg(e))return"Safari";if((e.includes("chrome/")||pD(e))&&!e.includes("edge/"))return"Chrome";if(yD(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function mD(n=Jt()){return/firefox\//i.test(n)}function Cg(n=Jt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function pD(n=Jt()){return/crios\//i.test(n)}function gD(n=Jt()){return/iemobile/i.test(n)}function yD(n=Jt()){return/android/i.test(n)}function _D(n=Jt()){return/blackberry/i.test(n)}function vD(n=Jt()){return/webos/i.test(n)}function Kh(n=Jt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function V8(n=Jt()){var e;return Kh(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function U8(){return _A()&&document.documentMode===10}function wD(n=Jt()){return Kh(n)||yD(n)||vD(n)||_D(n)||/windows phone/i.test(n)||gD(n)}function W8(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xD(n,e=[]){let t;switch(n){case"Browser":t=nw(Jt());break;case"Worker":t=`${nw(Jt())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${mi}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H8{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=i=>new Promise((o,a)=>{try{const c=e(i);o(c)}catch(c){a(c)}});s.onAbort=t,this.queue.push(s);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $8(n,e={}){return Rn(n,"GET","/v2/passwordPolicy",Qs(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q8=6;class Y8{constructor(e){var t,s,r,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:q8,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(s=e.allowedNonAlphanumericCharacters)===null||s===void 0?void 0:s.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,s,r,i,o,a;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(s=c.meetsMaxPasswordLength)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(r=c.containsLowercaseLetter)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let r=0;r<e.length;r++)s=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z8{constructor(e,t,s,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new sw(this),this.idTokenSubscription=new sw(this),this.beforeStateQueue=new H8(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=oD,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ks(t)),this._initializationPromise=this.queue(async()=>{var s,r;if(!this._deleted&&(this.persistenceManager=await ro.create(this,e),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var t;const s=await this.assertedPersistence.getCurrentUser();let r=s,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=r==null?void 0:r._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&(c!=null&&c.user)&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return $(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Ec(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=E8()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?Te(e):null;return t&&$(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&$(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(ks(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await $8(this),t=new Y8(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Dc("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await L8(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ks(e)||this._popupRedirectResolver;$(t,this,"argument-error"),this.redirectPersistenceManager=await ro.create(this,[ks(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,s;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,r){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if($(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof t=="function"){const c=e.addObserver(t,s,r);return()=>{o=!0,c()}}else{const c=e.addObserver(t);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return $(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=xD(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());s&&(t["X-Firebase-Client"]=s);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&w8(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Sr(n){return Te(n)}class sw{constructor(e){this.auth=e,this.observer=null,this.addObserver=bA(t=>this.observer=t)}get next(){return $(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G8(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}function ED(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=r=>{const i=_n("internal-error");i.customData=r,t(i)},s.type="text/javascript",s.charset="UTF-8",G8().appendChild(s)})}function TD(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J8(n,e){const t=Wl(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),i=t.getOptions();if(Vu(i,e??{}))return r;us(r,"already-initialized")}return t.initialize({options:e})}function Q8(n,e){const t=(e==null?void 0:e.persistence)||[],s=(Array.isArray(t)?t:[t]).map(ks);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function K8(n,e,t){const s=Sr(n);$(s._canInitEmulator,s,"emulator-config-failed"),$(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const r=!!(t!=null&&t.disableWarnings),i=ID(e),{host:o,port:a}=j8(e),c=a===null?"":`:${a}`;s.config.emulator={url:`${i}//${o}${c}/`},s.settings.appVerificationDisabledForTesting=!0,s.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||X8()}function ID(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function j8(n){const e=ID(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(s);if(r){const i=r[1];return{host:i,port:rw(s.substr(i.length+1))}}else{const[i,o]=s.split(":");return{host:i,port:rw(o)}}}function rw(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function X8(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Cs("not implemented")}_getIdTokenResponse(e){return Cs("not implemented")}_linkToIdToken(e,t){return Cs("not implemented")}_getReauthenticationResolver(e){return Cs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function io(n,e){return Qh(n,"POST","/v1/accounts:signInWithIdp",Qs(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z8="http://localhost";class Ys extends kg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ys(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):us("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:r}=t,i=z0(t,["providerId","signInMethod"]);if(!s||!r)return null;const o=new Ys(s,r);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return io(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,io(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,io(e,t)}buildRequest(){const e={requestUri:Z8,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=fi(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e9(n,e){return Rn(n,"POST","/v1/accounts:sendVerificationCode",Qs(n,e))}async function t9(n,e){return Qh(n,"POST","/v1/accounts:signInWithPhoneNumber",Qs(n,e))}async function n9(n,e){const t=await Qh(n,"POST","/v1/accounts:signInWithPhoneNumber",Qs(n,e));if(t.temporaryProof)throw wa(n,"account-exists-with-different-credential",t);return t}const s9={USER_NOT_FOUND:"user-not-found"};async function r9(n,e){const t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return Qh(n,"POST","/v1/accounts:signInWithPhoneNumber",Qs(n,t),s9)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr extends kg{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Zr({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Zr({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return t9(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return n9(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return r9(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:s,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:s,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:s,phoneNumber:r,temporaryProof:i}=e;return!s&&!t&&!r&&!i?null:new Zr({verificationId:t,verificationCode:s,phoneNumber:r,temporaryProof:i})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo extends su{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class La extends Qo{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return $("providerId"in t&&"signInMethod"in t,"argument-error"),Ys._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return $(e.idToken||e.accessToken,"argument-error"),Ys._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return La.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return La.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s,oauthTokenSecret:r,pendingToken:i,nonce:o,providerId:a}=e;if(!s&&!r&&!t&&!i||!a)return null;try{return new La(a)._credential({idToken:t,accessToken:s,nonce:o,pendingToken:i})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs extends Qo{constructor(){super("facebook.com")}static credential(e){return Ys._fromParams({providerId:vs.PROVIDER_ID,signInMethod:vs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return vs.credentialFromTaggedObject(e)}static credentialFromError(e){return vs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return vs.credential(e.oauthAccessToken)}catch{return null}}}vs.FACEBOOK_SIGN_IN_METHOD="facebook.com";vs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws extends Qo{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ys._fromParams({providerId:ws.PROVIDER_ID,signInMethod:ws.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ws.credentialFromTaggedObject(e)}static credentialFromError(e){return ws.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return ws.credential(t,s)}catch{return null}}}ws.GOOGLE_SIGN_IN_METHOD="google.com";ws.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr extends Qo{constructor(){super("github.com")}static credential(e){return Ys._fromParams({providerId:sr.PROVIDER_ID,signInMethod:sr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return sr.credentialFromTaggedObject(e)}static credentialFromError(e){return sr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return sr.credential(e.oauthAccessToken)}catch{return null}}}sr.GITHUB_SIGN_IN_METHOD="github.com";sr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr extends Qo{constructor(){super("twitter.com")}static credential(e,t){return Ys._fromParams({providerId:rr.PROVIDER_ID,signInMethod:rr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return rr.credentialFromTaggedObject(e)}static credentialFromError(e){return rr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return rr.credential(t,s)}catch{return null}}}rr.TWITTER_SIGN_IN_METHOD="twitter.com";rr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,r=!1){const i=await Xr._fromIdTokenResponse(e,s,r),o=iw(s);return new So({user:i,providerId:o,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const r=iw(s);return new So({user:e,providerId:r,_tokenResponse:s,operationType:t})}}function iw(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml extends zs{constructor(e,t,s,r){var i;super(t.code,t.message),this.operationType=s,this.user=r,Object.setPrototypeOf(this,Ml.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,r){return new Ml(e,t,s,r)}}function DD(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Ml._fromErrorAndOperation(n,i,e,s):i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AD(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i9(n,e){const t=Te(n);await bD(!0,t,e);const{providerUserInfo:s}=await C8(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),r=AD(s||[]);return t.providerData=t.providerData.filter(i=>r.has(i.providerId)),r.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function Sg(n,e,t=!1){const s=await ko(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return So._forOperation(n,"link",s)}async function bD(n,e,t){await Ec(e);const s=AD(e.providerData),r=n===!1?"provider-already-linked":"no-such-provider";$(s.has(t)===n,e.auth,r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CD(n,e,t=!1){const{auth:s}=n,r="reauthenticate";try{const i=await ko(n,DD(s,r,e,n),t);$(i.idToken,s,"internal-error");const o=bg(i.idToken);$(o,s,"internal-error");const{sub:a}=o;return $(n.uid===a,s,"user-mismatch"),So._forOperation(n,r,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&us(s,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kD(n,e,t=!1){const s="signIn",r=await DD(n,s,e),i=await So._fromIdTokenResponse(n,s,r);return t||await n._updateCurrentUser(i.user),i}async function SD(n,e){return kD(Sr(n),e)}async function o9(n,e){const t=Te(n);return await bD(!1,t,e.providerId),Sg(t,e)}async function a9(n,e){return CD(Te(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c9(n,e){return Rn(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u9(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const s=Te(n),i={idToken:await s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await ko(s,c9(s.auth,i));s.displayName=o.displayName||null,s.photoURL=o.photoUrl||null;const a=s.providerData.find(({providerId:c})=>c==="password");a&&(a.displayName=s.displayName,a.photoURL=s.photoURL),await s._updateTokensIfNecessary(o)}function l9(n,e,t,s){return Te(n).onIdTokenChanged(e,t,s)}function h9(n,e,t){return Te(n).beforeAuthStateChanged(e,t)}function d9(n,e,t,s){return Te(n).onAuthStateChanged(e,t,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f9(n,e){return Rn(n,"POST","/v2/accounts/mfaEnrollment:start",Qs(n,e))}const Ol="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PD{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ol,"1"),this.storage.removeItem(Ol),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m9(){const n=Jt();return Cg(n)||Kh(n)}const p9=1e3,g9=10;class RD extends PD{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=m9()&&W8(),this.fallbackToPolling=wD(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),r=this.localCache[t];s!==r&&e(t,r,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const s=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const o=this.storage.getItem(s);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(s,e.newValue):this.storage.removeItem(s);else if(this.localCache[s]===e.newValue&&!t)return}const r=()=>{const o=this.storage.getItem(s);!t&&this.localCache[s]===o||this.notifyListeners(s,o)},i=this.storage.getItem(s);U8()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,g9):r()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},p9)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}RD.type="LOCAL";const y9=RD;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ND extends PD{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}ND.type="SESSION";const MD=ND;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _9(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const s=new jh(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:r,data:i}=t.data,o=this.handlersMap[r];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:r});const a=Array.from(o).map(async u=>u(t.origin,i)),c=await _9(a);t.ports[0].postMessage({status:"done",eventId:s,eventType:r,response:c})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}jh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pg(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v9{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,o;return new Promise((a,c)=>{const u=Pg("",20);r.port1.start();const l=setTimeout(()=>{c(new Error("unsupported_event"))},s);o={messageChannel:r,onMessage(d){const f=d;if(f.data.eventId===u)switch(f.data.status){case"ack":clearTimeout(l),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(f.data.response);break;default:clearTimeout(l),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ut(){return window}function w9(n){ut().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rg(){return typeof ut().WorkerGlobalScope<"u"&&typeof ut().importScripts=="function"}async function x9(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function E9(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function T9(){return Rg()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OD="firebaseLocalStorageDb",I9=1,Fl="firebaseLocalStorage",FD="fbase_key";class ru{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Xh(n,e){return n.transaction([Fl],e?"readwrite":"readonly").objectStore(Fl)}function D9(){const n=indexedDB.deleteDatabase(OD);return new ru(n).toPromise()}function q0(){const n=indexedDB.open(OD,I9);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(Fl,{keyPath:FD})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(Fl)?e(s):(s.close(),await D9(),e(await q0()))})})}async function ow(n,e,t){const s=Xh(n,!0).put({[FD]:e,value:t});return new ru(s).toPromise()}async function A9(n,e){const t=Xh(n,!1).get(e),s=await new ru(t).toPromise();return s===void 0?null:s.value}function aw(n,e){const t=Xh(n,!0).delete(e);return new ru(t).toPromise()}const b9=800,C9=3;class BD{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await q0(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>C9)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Rg()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=jh._getInstance(T9()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await x9(),!this.activeServiceWorker)return;this.sender=new v9(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((e=s[0])===null||e===void 0)&&e.fulfilled&&!((t=s[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||E9()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await q0();return await ow(e,Ol,"1"),await aw(e,Ol),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>ow(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>A9(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>aw(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const i=Xh(r,!1).getAll();return new ru(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:r,value:i}of e)s.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!s.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),b9)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}BD.type="LOCAL";const k9=BD;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S9(n,e){return Rn(n,"POST","/v2/accounts/mfaSignIn:start",Qs(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P9=500,R9=6e4,Tu=1e12;class N9{constructor(e){this.auth=e,this.counter=Tu,this._widgets=new Map}render(e,t){const s=this.counter;return this._widgets.set(s,new M9(e,this.auth.name,t||{})),this.counter++,s}reset(e){var t;const s=e||Tu;(t=this._widgets.get(s))===null||t===void 0||t.delete(),this._widgets.delete(s)}getResponse(e){var t;const s=e||Tu;return((t=this._widgets.get(s))===null||t===void 0?void 0:t.getResponse())||""}async execute(e){var t;const s=e||Tu;return(t=this._widgets.get(s))===null||t===void 0||t.execute(),""}}class M9{constructor(e,t,s){this.params=s,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const r=typeof e=="string"?document.getElementById(e):e;$(r,"argument-error",{appName:t}),this.container=r,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=O9(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},R9)},P9))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function O9(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let s=0;s<n;s++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cf=TD("rcb"),F9=new nu(3e4,6e4),B9="https://www.google.com/recaptcha/api.js?";class L9{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=ut().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return $(V9(t),e,"argument-error"),this.shouldResolveImmediately(t)&&Zv(ut().grecaptcha)?Promise.resolve(ut().grecaptcha):new Promise((s,r)=>{const i=ut().setTimeout(()=>{r(_n(e,"network-request-failed"))},F9.get());ut()[Cf]=()=>{ut().clearTimeout(i),delete ut()[Cf];const a=ut().grecaptcha;if(!a||!Zv(a)){r(_n(e,"internal-error"));return}const c=a.render;a.render=(u,l)=>{const d=c(u,l);return this.counter++,d},this.hostLanguage=t,s(a)};const o=`${B9}?${fi({onload:Cf,render:"explicit",hl:t})}`;ED(o).catch(()=>{clearTimeout(i),r(_n(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=ut().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function V9(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class U9{async load(e){return new N9(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LD="recaptcha",W9={theme:"light",type:"image"};class H9{constructor(e,t,s=Object.assign({},W9)){this.parameters=s,this.type=LD,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Sr(e),this.isInvisible=this.parameters.size==="invisible",$(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const r=typeof t=="string"?document.getElementById(t):t;$(r,this.auth,"argument-error"),this.container=r,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new U9:new L9,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),s=t.getResponse(e);return s||new Promise(r=>{const i=o=>{o&&(this.tokenChangeListeners.delete(i),r(o))};this.tokenChangeListeners.add(i),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){$(!this.parameters.sitekey,this.auth,"argument-error"),$(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),$(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(s=>s(t)),typeof e=="function")e(t);else if(typeof e=="string"){const s=ut()[e];typeof s=="function"&&s(t)}}}assertNotDestroyed(){$(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){$(cD()&&!Rg(),this.auth,"internal-error"),await $9(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await A8(this.auth);$(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return $(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function $9(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q9{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=Zr._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function Y9(n,e,t){const s=Sr(n),r=await VD(s,e,Te(t));return new q9(r,i=>SD(s,i))}async function VD(n,e,t){var s;const r=await t.verify();try{$(typeof r=="string",n,"argument-error"),$(t.type===LD,n,"argument-error");let i;if(typeof e=="string"?i={phoneNumber:e}:i=e,"session"in i){const o=i.session;if("phoneNumber"in i)return $(o.type==="enroll",n,"internal-error"),(await f9(n,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,recaptchaToken:r}})).phoneSessionInfo.sessionInfo;{$(o.type==="signin",n,"internal-error");const a=((s=i.multiFactorHint)===null||s===void 0?void 0:s.uid)||i.multiFactorUid;return $(a,n,"missing-multi-factor-info"),(await S9(n,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:r}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:o}=await e9(n,{phoneNumber:i.phoneNumber,recaptchaToken:r});return o}}finally{t._reset()}}async function z9(n,e){await Sg(Te(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(e){this.providerId=ei.PROVIDER_ID,this.auth=Sr(e)}verifyPhoneNumber(e,t){return VD(this.auth,e,Te(t))}static credential(e,t){return Zr._fromVerification(e,t)}static credentialFromResult(e){const t=e;return ei.credentialFromTaggedObject(t)}static credentialFromError(e){return ei.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:s}=e;return t&&s?Zr._fromTokenResponse(t,s):null}}ei.PROVIDER_ID="phone";ei.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zh(n,e){return e?ks(e):($(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ng extends kg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return io(e,this._buildIdpRequest())}_linkToIdToken(e,t){return io(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return io(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function G9(n){return kD(n.auth,new Ng(n),n.bypassAuthState)}function J9(n){const{auth:e,user:t}=n;return $(t,e,"internal-error"),CD(t,new Ng(n),n.bypassAuthState)}async function Q9(n){const{auth:e,user:t}=n;return $(t,e,"internal-error"),Sg(t,new Ng(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UD{constructor(e,t,s,r,i=!1){this.auth=e,this.resolver=s,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:r,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:t,sessionId:s,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return G9;case"linkViaPopup":case"linkViaRedirect":return Q9;case"reauthViaPopup":case"reauthViaRedirect":return J9;default:us(this.auth,"internal-error")}}resolve(e){qs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){qs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K9=new nu(2e3,1e4);async function kf(n,e,t){const s=Sr(n);Ig(n,e,su);const r=Zh(s,t);return new Ss(s,"signInViaPopup",e,r).executeNotNull()}async function Sf(n,e,t){const s=Te(n);Ig(s.auth,e,su);const r=Zh(s.auth,t);return new Ss(s.auth,"reauthViaPopup",e,r,s).executeNotNull()}async function Pf(n,e,t){const s=Te(n);Ig(s.auth,e,su);const r=Zh(s.auth,t);return new Ss(s.auth,"linkViaPopup",e,r,s).executeNotNull()}class Ss extends UD{constructor(e,t,s,r,i){super(e,t,r,i),this.provider=s,this.authWindow=null,this.pollId=null,Ss.currentPopupAction&&Ss.currentPopupAction.cancel(),Ss.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return $(e,this.auth,"internal-error"),e}async onExecution(){qs(this.filter.length===1,"Popup operations only handle one event");const e=Pg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(_n(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(_n(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ss.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,s;if(!((s=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_n(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,K9.get())};e()}}Ss.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j9="pendingRedirect",Mu=new Map;class X9 extends UD{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=Mu.get(this.auth._key());if(!e){try{const s=await Z9(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}Mu.set(this.auth._key(),e)}return this.bypassAuthState||Mu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Z9(n,e){const t=n5(e),s=t5(n);if(!await s._isAvailable())return!1;const r=await s._get(t)==="true";return await s._remove(t),r}function e5(n,e){Mu.set(n._key(),e)}function t5(n){return ks(n._redirectPersistence)}function n5(n){return Nu(j9,n.config.apiKey,n.name)}async function s5(n,e,t=!1){const s=Sr(n),r=Zh(s,e),o=await new X9(s,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await s._persistUserIfCurrent(o.user),await s._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r5=10*60*1e3;class i5{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!o5(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var s;if(e.error&&!WD(e)){const r=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";t.onError(_n(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=r5&&this.cachedEventUids.clear(),this.cachedEventUids.has(cw(e))}saveEventToCache(e){this.cachedEventUids.add(cw(e)),this.lastProcessedEventTime=Date.now()}}function cw(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function WD({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function o5(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return WD(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function a5(n,e={}){return Rn(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c5=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,u5=/^https?/;async function l5(n){if(n.config.emulator)return;const{authorizedDomains:e}=await a5(n);for(const t of e)try{if(h5(t))return}catch{}us(n,"unauthorized-domain")}function h5(n){const e=$0(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===s}if(!u5.test(t))return!1;if(c5.test(n))return s===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d5=new nu(3e4,6e4);function uw(){const n=ut().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function f5(n){return new Promise((e,t)=>{var s,r,i;function o(){uw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{uw(),t(_n(n,"network-request-failed"))},timeout:d5.get()})}if(!((r=(s=ut().gapi)===null||s===void 0?void 0:s.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((i=ut().gapi)===null||i===void 0)&&i.load)o();else{const a=TD("iframefcb");return ut()[a]=()=>{gapi.load?o():t(_n(n,"network-request-failed"))},ED(`https://apis.google.com/js/api.js?onload=${a}`).catch(c=>t(c))}}).catch(e=>{throw Ou=null,e})}let Ou=null;function m5(n){return Ou=Ou||f5(n),Ou}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p5=new nu(5e3,15e3),g5="__/auth/iframe",y5="emulator/auth/iframe",_5={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},v5=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function w5(n){const e=n.config;$(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Ag(e,y5):`https://${n.config.authDomain}/${g5}`,s={apiKey:e.apiKey,appName:n.name,v:mi},r=v5.get(n.config.apiHost);r&&(s.eid=r);const i=n._getFrameworks();return i.length&&(s.fw=i.join(",")),`${t}?${fi(s).slice(1)}`}async function x5(n){const e=await m5(n),t=ut().gapi;return $(t,n,"internal-error"),e.open({where:document.body,url:w5(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:_5,dontclear:!0},s=>new Promise(async(r,i)=>{await s.restyle({setHideOnLeave:!1});const o=_n(n,"network-request-failed"),a=ut().setTimeout(()=>{i(o)},p5.get());function c(){ut().clearTimeout(a),r(s)}s.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E5={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},T5=500,I5=600,D5="_blank",A5="http://localhost";class lw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function b5(n,e,t,s=T5,r=I5){const i=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-s)/2,0).toString();let a="";const c=Object.assign(Object.assign({},E5),{width:s.toString(),height:r.toString(),top:i,left:o}),u=Jt().toLowerCase();t&&(a=pD(u)?D5:t),mD(u)&&(e=e||A5,c.scrollbars="yes");const l=Object.entries(c).reduce((f,[m,p])=>`${f}${m}=${p},`,"");if(V8(u)&&a!=="_self")return C5(e||"",a),new lw(null);const d=window.open(e||"",a,l);$(d,n,"popup-blocked");try{d.focus()}catch{}return new lw(d)}function C5(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k5="__/auth/handler",S5="emulator/auth/handler",P5=encodeURIComponent("fac");async function hw(n,e,t,s,r,i){$(n.config.authDomain,n,"auth-domain-config-required"),$(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:mi,eventId:r};if(e instanceof su){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",Nf(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[l,d]of Object.entries(i||{}))o[l]=d}if(e instanceof Qo){const l=e.getScopes().filter(d=>d!=="");l.length>0&&(o.scopes=l.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const l of Object.keys(a))a[l]===void 0&&delete a[l];const c=await n._getAppCheckToken(),u=c?`#${P5}=${encodeURIComponent(c)}`:"";return`${R5(n)}?${fi(a).slice(1)}${u}`}function R5({config:n}){return n.emulator?Ag(n,S5):`https://${n.authDomain}/${k5}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rf="webStorageSupport";class N5{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=MD,this._completeRedirectFn=s5,this._overrideRedirectResult=e5}async _openPopup(e,t,s,r){var i;qs((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await hw(e,t,s,$0(),r);return b5(e,o,Pg())}async _openRedirect(e,t,s,r){await this._originValidation(e);const i=await hw(e,t,s,$0(),r);return w9(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:i}=this.eventManagers[t];return r?Promise.resolve(r):(qs(i,"If manager is not set, promise should be"),i)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await x5(e),s=new i5(e);return t.register("authEvent",r=>($(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:s.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Rf,{type:Rf},r=>{var i;const o=(i=r==null?void 0:r[0])===null||i===void 0?void 0:i[Rf];o!==void 0&&t(!!o),us(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=l5(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return wD()||Cg()||Kh()}}const M5=N5;var dw="@firebase/auth",fw="1.5.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O5{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){$(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F5(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function B5(n){ni(new yr("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=s.options;$(o&&!o.includes(":"),"invalid-api-key",{appName:s.name});const c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:xD(n)},u=new z8(s,r,i,c);return Q8(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),ni(new yr("auth-internal",e=>{const t=Sr(e.getProvider("auth").getImmediate());return(s=>new O5(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ts(dw,fw,F5(n)),ts(dw,fw,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L5=5*60,V5=Aw("authIdTokenMaxAge")||L5;let mw=null;const U5=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>V5)return;const r=t==null?void 0:t.token;mw!==r&&(mw=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function W5(n=No()){const e=Wl(n,"auth");if(e.isInitialized())return e.getImmediate();const t=J8(n,{popupRedirectResolver:M5,persistence:[k9,y9,MD]}),s=Aw("authTokenSyncURL");if(s){const i=U5(s);h9(t,i,()=>i(t.currentUser)),l9(t,o=>i(o))}const r=Tw("auth");return r&&K8(t,`http://${r}`),t}B5("Browser");const Ri={"operation-not-allowed":se.providerNotAllowed,"user-disabled":se.userDisable,"provider-already-linked":se.providerAlreadyLinked,"credential-already-in-use":se.credentialAlreadyInUse,"invalid-verification-code":se.wrongOptCode,"invalid-verification-id":se.verification,"invalid-credential":se.invalidCredential,"user-mismatch":se.userMissmatch,"user-not-found":se.userNotFound,"no-such-provider":se.noSuchProvider,canceled:se.userExitManually,"too-many-requests":se.tooManyAttempts,"too-many-attempts":se.tooManyAttempts,"expired-code":se.expiredCode,"account-exists-with-different-credential":se.credentialAlreadyInUse,"invalid-phone-number":se.invalidPhoneNumber};var H5=(n=>(n[n.login=0]="login",n[n.link=1]="link",n[n.reauthenticate=2]="reauthenticate",n[n.phoneUpdate=3]="phoneUpdate",n))(H5||{});class $5{constructor(){h(this,"_auth");X0().length===0?Hl(G0):No(),this._auth=W5(),this._auth.languageCode=Tn(_w)??"en"}async signInWithFacebookSRV(e){try{return await this.signInWithFacebookWebSRV(e),!0}catch(t){return t instanceof Error&&(console.error(`Error: ${t}`),he.error(`it was an error the error is --> ${t}`),he.error(t.name),_e.GI().details=t.name,_e.GI().error=Ri[t.name]??se.unknown),!1}}async signInWithFacebookWebSRV(e){const t=new vs;switch(t.addScope("email"),t.setCustomParameters({display:"popup"}),e){case 0:await kf(this._auth,t);break;case 1:await Pf(this._auth.currentUser,t);break;case 2:await Sf(this._auth.currentUser,t);break}}async signInWithGoogleSRV(e){try{return await this.signInWithGoogleWebSRV(e),!0}catch(t){return t instanceof Error&&(console.error(`Error: ${t}`),he.error(`it was an error the error is --> ${t}`),he.error(t.name),_e.GI().details=t.name,_e.GI().error=Ri[t.name]??se.unknown),!1}}async signInWithGoogleWebSRV(e){const t=new ws;switch(t.addScope("email"),t.addScope("profile"),t.setCustomParameters({login_hint:"user@example.com"}),e){case 0:await kf(this._auth,t);break;case 1:await Pf(this._auth.currentUser,t);break;case 2:await Sf(this._auth.currentUser,t);break}}async signInWithAppleSRV(e){try{return await this.signInWithAppleWebSRV(e),!0}catch(t){return t instanceof Error&&(console.error(`Error: ${t}`),he.error(`it was an error the error is --> ${t}`),he.error(t.name),_e.GI().details=t.name,_e.GI().error=Ri[t.name]??se.unknown),!1}}async signInWithAppleWebSRV(e){const t=new La("apple.com");switch(t.addScope("email"),t.addScope("name"),e){case 0:await kf(this._auth,t);break;case 1:await Pf(this._auth.currentUser,t);break;case 2:await Sf(this._auth.currentUser,t);break}}async signInWithOtpSRV({loginType:e,verificationId:t,otp:s,autocredential:r}){const i=r??ei.credential(t,s);try{switch(e){case 0:await SD(this._auth,i);break;case 1:await o9(this._auth.currentUser,i);break;case 2:await a9(this._auth.currentUser,i);break;case 3:await z9(this._auth.currentUser,i);break}return!0}catch(o){return console.error(`Error: ${o}`),o instanceof Error&&(console.error(`Error: ${o}`),he.error(`it was an error the error is --> ${o}`),he.error(o.name),_e.GI().details=o.name,_e.GI().error=Ri[o.name]??se.unknown),!1}}get isLoggedInSRV(){return this._auth.currentUser!=null}onAuthUserStateChangedSRV(e){return d9(this._auth,e)}async updateUserNameSRV(e){try{await u9(this._auth.currentUser,{displayName:e}),await this._auth.currentUser.reload()}catch(t){throw t instanceof Error&&_e.GI().addError({error:se.updateDisplayName,details:t.toString()}),t}}userConnectedOnlyLocallySRV(){return this.isLoggedInSRV&&this._auth.currentUser.displayName===null}async sendSmsForFirebaseVerificationSRV({completePhone:e,onCodeSent:t,onFailed:s}){const r=new Date;let i;const o=document.getElementById("recaptcha-container");console.log(o),console.log("wwwwwww");const a=new H9(this._auth,o,{size:"invisible",callback:c=>{console.log(c)}});console.log("222222222222222"),await Y9(this._auth,e,a).then(c=>{console.log("ssssssssssss"),t(c.verificationId)}).catch(c=>{console.log("wwwwwwwwwwwwwwwww"),c instanceof Error&&(_e.GI().details=c.message,_e.GI().error=Ri[c.message]??Ri[c.name]??se.unknown,s(e,c,i,r))})}get lastLoginDateSRV(){var e;return(e=this._auth.currentUser)==null?void 0:e.metadata.lastSignInTime}get userIdSRV(){if(this._auth.currentUser!=null){const e=this._auth.currentUser.displayName;return e!==null&&e.includes("&&")&&e.includes("+")?this.userPhoneSRV:this._auth.currentUser.uid}return""}get userDataSRV(){return this._auth.currentUser}async userClaimsSRV(){return this._auth.currentUser===null?null:(await this._auth.currentUser.getIdToken(!0),(await this._auth.currentUser.getIdTokenResult()).claims)}get userPhoneSRV(){if(this._auth.currentUser!==null){const t=this._auth.currentUser.displayName.split("&&")[1];return this._auth.currentUser.phoneNumber.replace(t,`${t}-`)}return""}get existsProvidersSRV(){if(this._auth.currentUser===null)return new Set;const e=new Set;return this._auth.currentUser.providerData.forEach(t=>{e.add(t.providerId)}),e}async deleteUserSRV(){if(this._auth.currentUser===null)return!1;try{return await this._auth.currentUser.delete(),!0}catch{return!1}}async unlinkProviderSRV({providerId:e}){try{return i9(this._auth.currentUser,e),!0}catch{return!1}}async reloadUserSRV(){this._auth.currentUser!==null&&await this._auth.currentUser.reload()}async logoutSRV(){try{return await this._auth.signOut(),!this.isLoggedInSRV}catch{return!1}}}class q5 extends $5{constructor(){super()}async signInWithGoogle(e){return await this.signInWithGoogleSRV(e)}async signInWithApple(e){return await this.signInWithAppleSRV(e)}async signInWithFacebook(e){return await this.signInWithFacebookSRV(e)}onAuthUserStateChanged(e){return this.onAuthUserStateChangedSRV(e)}async sendSmsForFirebaseVerification({completePhone:e,onCodeSent:t,onFailed:s}){await this.sendSmsForFirebaseVerificationSRV({completePhone:e,onCodeSent:t,onFailed:s})}async signInWithOtp({loginType:e,verificationId:t,otp:s}){return await this.signInWithOtpSRV({loginType:e,verificationId:t,otp:s})}async logout(){return await this.logoutSRV()}async unlinkProvider({providerId:e}){return await this.unlinkProviderSRV({providerId:e})}async deleteUser(){return await this.deleteUserSRV()}async reloadUser(){await this.reloadUserSRV()}userConnectedOnlyLocally(){return this.userConnectedOnlyLocallySRV()}async updateUserName({name:e}){try{return await this.updateUserNameSRV(e),!0}catch(t){return console.error(`Error occurred while saving user name --> ${t}`),!1}}get isLoggedIn(){return this.isLoggedInSRV}get existsProviders(){return this.existsProvidersSRV}get userData(){return this.userDataSRV}get userId(){return this.userIdSRV}get lastLoginDate(){return this.lastLoginDateSRV}async userClaims(){return await this.userClaimsSRV}}async function Y5(){var r,i;if(xt.currentBusinesssId!==""){let o=0;for(;je.GI().workers.isEmpty&&o<10;)o++,await new Promise(a=>setTimeout(a,100))}const n={},e=Ps.GI().user,t=new Map,s=e.bookings.recurrence||{};for(const o of Object.values(e.bookings.futureBookings))for(const[a,c]of Object.entries(o))t.set(a,c);for(const[o,a]of Object.entries(s)){if(a.buisnessId!==je.GI().business.businessId||a.status!==Ht.approved||a.recurrenceEvent==null)continue;const c=je.GI().workers[a.workerId];if(c==null)continue;const u=c.notifications.remindersTypes.size===0?0:Math.max(...Object.values(c.notifications.remindersTypes));let l=new Date(new Date().getFullYear(),new Date().getMonth(),new Date().getDay(),a.bookingDate.getHours(),a.bookingDate.getMinutes());for(;l<Z(new Date,new V({minutes:u}));){if(l<new Date){l=new Date(l.getTime()+24*60*60*1e3);continue}if(!a.recurrenceEvent.isAccureInDate({date:l})){l=new Date(l.getTime()+24*60*60*1e3);continue}const d=Tt.fromBooking(a);d.bookingDate=l;let f=!1;Fn(l,uy)<new Date&&(f=!0,n[r=jt.regular]??(n[r]=[]),n[jt.regular].push(d));for(const[m,p]of a.remindersTypes)jt.regular===m&&f||c.notifications.remindersTypes.get(m)!=null&&(Fn(l,new V({minutes:c.notifications.remindersTypes.get(m)}))<new Date||(n[m]||(n[m]=[]),n[m].push(d)));l=Z(l,new V({days:1}))}}for(const[o,a]of t){if(a.buisnessId!==je.GI().business.businessId||a.status!==Ht.approved)continue;const c=je.GI().workers[a.workerId];if(c==null||a.bookingDate<new Date)continue;let u=!1;Fn(a.bookingDate,uy)<new Date&&(u=!0,n[i=jt.regular]||(n[i]=[]),n[jt.regular].push(a));for(const[l,d]of a.remindersTypes)c.notifications.remindersTypes.get(l)!=null&&(jt.regular===l&&u||Fn(a.bookingDate,new V({minutes:c.notifications.remindersTypes.get(l)}))>=new Date)}return n}function QV(n,e){const t=new Date;return t.setMinutes(t.getMinutes()+e.onHoldMinutes),t.getTime()>n.getTime()}const Vr=class Vr{constructor(){h(this,"user",new so({}));h(this,"verificationRepo",new q5);h(this,"userRepo",new _8);h(this,"userDoc")}static GI(){return Vr.instance||(Vr.instance=new Vr),Vr.instance}get getPermission(){return 0}isDeveloper(){return this.isConnected?xt.developers.hasOwnProperty(this.user.id.replace("+","")):!1}get isConnected(){return this.verificationRepo.isLoggedIn}get userId(){try{return this.verificationRepo.userId}catch{return""}}async setupUser({newUserId:e="",logoutIfDosentExist:t=!1}){var s;try{return Df.set(!1),he.info(`The user id is -> ${e}`),e.length<5?(await this.verificationRepo.logout(),!0):(this.userDoc===void 0&&(this.userDoc=await this.userRepo.getDocSRV({path:on,docId:e})),!t&&(this.userDoc===void 0||!this.userDoc.exists())?(this.userDoc=void 0,!0):(this.user=so.fromUserDocJson((s=this.userDoc)==null?void 0:s.data()),this.startPublicDataListening(),U0.set(this.user),Df.set(!0),!0))}catch(r){return this.userDoc=void 0,r instanceof Error&&(he.error(`Error while setting up the user --> ${r}`),_e.GI().addError({details:r.toString()})),!1}}async startPublicDataListening(){this.isConnected&&(this.user.userPublicDataListener=this.userRepo.docListener({path:`${on}/${this.user.id}/${dt}`,docId:cn,onChanged:async e=>{try{e.exists()&&(this.user.setUserPublicData(e.data()),console.log("eeeeeeeeeeeeeeee"),console.log(this.user.userPublicData.bookingsDocsToLoad),await this.loadBookingsDocs(this.user.userPublicData.bookingsDocsToLoad),he.info("Getting new user data from database"),this.user.userPublicData.reminders={},xt.currentBusinesssId!==""&&(this.user.userPublicData.reminders=await Y5()))}catch(t){console.error(`Error in startPublicDataListening: ${t}`)}}}))}async loadBookingsDocs(e){const t=[];e.forEach(s=>{t.push(this.loadBookingDoc(s))}),await Promise.all(t)}async logout(){return this.verificationRepo.logout().then(async e=>(e&&(this.user=new so({}),U0.set(this.user),Df.set(!1)),e))}async loadBookingDoc(e){try{const t=await this.userRepo.getDocSRV({path:Ya.GI().userBookingsPathByUser(this.user.id),docId:e});e===Jw?this.user.bookings.setRecurrence((t==null?void 0:t.data())||{}):this.user.bookings.setMonth((t==null?void 0:t.data())||{},e)}catch(t){he.error(`Error loading booking doc ${e}: ${t}`)}}};h(Vr,"instance");let Ps=Vr;const HD=1440,$D=60,z5=40,G5=150,{v4:J5}=dg;class bn{constructor({displayDate:e,maxParticipants:t=1,currentParticipants:s=0,isMulti:r=!1,isHoliday:i=!1,signedPaymentRequestId:o,isVacation:a=!1,recurrenceTimeId:c,showParticipants:u=!0,showMultiWaitingList:l=!0,recurrenceFatherBookingId:d,isWaitingList:f=!1,recurrenceMultiEvent:m,fatherRecurrenceMultiEventDate:p}){h(this,"displayDate");h(this,"from",new Date(0));h(this,"maxParticipants",0);h(this,"currentParticipants",0);h(this,"showParticipants",!0);h(this,"isWaitingList",!1);h(this,"showMultiWaitingList",!0);h(this,"duration",new V({}));h(this,"isMulti",!1);h(this,"recurrenceMultiEvent");h(this,"fatherRecurrenceMultiEventDate");h(this,"recurrenceFatherBookingId");h(this,"recurrenceTimeId");h(this,"isVacation",!1);h(this,"isHoliday",!1);h(this,"id","");h(this,"signedPaymentRequestId");this.id=J5(),this.displayDate=e,this.maxParticipants=t,this.currentParticipants=s,this.isMulti=r,this.isHoliday=i,this.signedPaymentRequestId=o,this.isVacation=a,this.recurrenceTimeId=c,this.showParticipants=u,this.showMultiWaitingList=l,this.recurrenceFatherBookingId=d,this.isWaitingList=f,this.recurrenceMultiEvent=m,this.fatherRecurrenceMultiEventDate=p}static fromTimePickerObj(e){const t=new bn({displayDate:e.displayDate,recurrenceTimeId:e.recurrenceTimeId,showMultiWaitingList:e.showMultiWaitingList,isVacation:e.isVacation,isHoliday:e.isHoliday,isMulti:e.isMulti,signedPaymentRequestId:e.signedPaymentRequestId,maxParticipants:e.maxParticipants,currentParticipants:e.currentParticipants,showParticipants:e.showParticipants,recurrenceFatherBookingId:e.recurrenceFatherBookingId,recurrenceMultiEvent:e.recurrenceMultiEvent,fatherRecurrenceMultiEventDate:e.fatherRecurrenceMultiEventDate});return t.from=e.from,t.duration=e.duration,t}get hasFreePlace(){return this.maxParticipants>this.currentParticipants}get timeId(){if(this.displayDate)return this.recurrenceTimeId?`${this.dateToTimeStr(this.displayDate)}_${this.recurrenceTimeId}`:this.dateToTimeStr(this.displayDate)}static fromScheduleEvent(e){const t=new bn({});return t.displayDate=e.displayDate,t.recurrenceTimeId=e.recurrenceTimeId,t.showMultiWaitingList=e.showMultiWaitingList,t.isVacation=e.isVacation??!1,t.isHoliday=e.isHoliday??!1,t.isMulti=e.isMulti??!1,t.signedPaymentRequestId=e.signedPaymentRequestId,t.maxParticipants=e.maxParticipants??0,t.currentParticipants=e.currentParticipants??0,t.showParticipants=e.showParticipants??!0,t.recurrenceFatherBookingId=e.recurrenceFatherBookingId,e.recurrenceMultiEvent!=null&&(t.recurrenceMultiEvent=Vn.fromJson(e.recurrenceMultiEvent)),t.fatherRecurrenceMultiEventDate=e.fatherRecurrenceMultiEventDate,t.from=e.from,t.duration=e.duration,t}toJson(){const e={};return e.from=this.from,e.id=this.id,e.duration=this.duration.inMinutes,e.to=Z(this.from,this.duration),e.displayDate=this.displayDate??"",this.recurrenceTimeId!=null&&(e.recurrenceTimeId=this.recurrenceTimeId),this.recurrenceFatherBookingId!=null&&(e.recurrenceFatherBookingId=this.recurrenceFatherBookingId),this.fatherRecurrenceMultiEventDate!=null&&(e.fatherRecurrenceMultiEventDate=this.fatherRecurrenceMultiEventDate),this.recurrenceMultiEvent!=null&&(e.recurrenceMultiEvent=this.recurrenceMultiEvent.toJson({})),this.showMultiWaitingList||(e.showMultiWaitingList=this.showMultiWaitingList),this.isVacation&&(e.isVacation=this.isVacation),this.isHoliday&&(e.isHoliday=this.isHoliday),this.isMulti&&(e.isMulti=this.isMulti),this.signedPaymentRequestId!=null&&(e.signedPaymentRequestId=this.signedPaymentRequestId),this.maxParticipants!=0&&(e.maxParticipants=this.maxParticipants),this.currentParticipants!=0&&(e.currentParticipants=this.currentParticipants),this.showParticipants||(e.showParticipants=this.showParticipants),e}dateToTimeStr(e){return""}}function qD(n,e,t,s){return n.closeScheduleOnHolidays&&sD(n,e)?(he.debug("Holiday is a free day for this worker -> don't generate times"),!0):!t&&n.recurrence.vacationInDate(e)!=null?(he.debug("Vacation is a free day for this worker -> don't generate times"),!0):!s&&n.isClosingDate(e)?(he.debug("This day is closing by the worker"),!0):!1}function YD(n,e,t){let s=0,r=0;const i=Array.from(e.values());return n.forEach(o=>{const a=i[r].start,c=Z(a,i[r].duration);for(o;o<t.length&&!(o+1>=t.length);o+=2){const u=Ac(t[o],t[o+1],a,c);if(u==="STRIKE"){const l=Gr(t[o+1],a);s=Math.max(s,l.inMinutes);break}if(u==="BEFORE")break}r+=1}),s}function Q5(n,e,t){let s=0;const r=Object.values(e);let i=r.length-1;return n.forEach(o=>{const a=r[i].start,c=Z(a,r[i].duration);for(o;o>=0&&!(o-1<0);o-=2){const u=Ac(t[o-1],t[o],a,c);if(u==="STRIKE"){const l=Gr(c,t[o-1]).inMinutes;s=Math.max(s,l);break}if(u==="AFTER")break}i-=1}),s}function Xn(n,e){n.forEach((t,s)=>{t.start=Z(t.start,new V({minutes:e})),n.set(s,t)})}function K5(n,e,t,s){const r=s.windowSpaces===Wn.custom?s.customWindowMinute:s.windowSpaces===Wn.longestTreatment?s.longestBookingTime:s.shortBookingTime;console.log("worker.longestBookingTime",s.longestBookingTime,"worker.shortBookingTime",s.shortBookingTime);const i=Z(n,new V({minutes:r}));if(t.length<=0||t[0]+1>=e.length)return r;const o=e[t[0]],a=e[t[0]+1];return o>n&&o<i?new V({milliseconds:a.getTime()-n.getTime()}).inMinutes:r}function j5(n,e,t,s){const r=s.windowSpaces===Wn.custom?s.customWindowMinute:s.windowSpaces===Wn.longestTreatment?s.longestBookingTime:s.shortBookingTime,i=Fn(n,new V({minutes:r}));if(t.length<=0||t[0]+1>=e.length)return r;const o=e[t[0]];return o.getTime()<n.getTime()&&o.getTime()>i.getTime()?n.getTime()-o.getTime():r}function X5({worker:n,bookingDate:e,oldBooking:t,recurrenceSkipDate:s,isUpdate:r=!1,workerAction:i=!1}){const o=[],a=$s(e);n.workerPublicData.bookingsTimes[e]&&Object.entries(n.workerPublicData.bookingsTimes[e]).forEach(([l,d])=>{const f=hn(l);o.push(f,Z(f,new V({minutes:d})))});const c=new Set;r&&t&&t.recurrenceEvent&&s&&t.bookingsEventsAsEvents.forEach((l,d)=>{const f=hn(d);c.add(oe(new Date(s.getFullYear(),s.getMonth(),s.getDate(),f.getHours(),f.getMinutes())))});let u=!1;if(Object.entries(n.recurrence.recurrenceEvents).forEach(([l,d])=>{Object.entries(d).forEach(([f,m])=>{if(!(!m.blockSchedule&&m.isBreak)&&!(m.isVacation&&i)&&!u){if(r&&t&&t.recurrenceEvent){const p=hn(f),y=Z(a,new V({hours:p.getHours(),minutes:p.getMinutes()}));if(c.has(oe(y)))return}if(m.recurrenceEvent&&m.recurrenceEvent.isAccureInDate({date:a})){const p=hn(f);m.isVacation&&(u=!0,o.length=0),o.push(p,Z(p,new V({minutes:m.durationMinutes})))}}})}),r&&t&&t.workerId===n.id&&!t.recurrenceEvent){const l=an(t.bookingDate);if(a.getTime()/1e3-l.getTime()/1e3===0){let d=va(t.bookingDate);Mt.fromTreatmentsMap(t.treatments).times.forEach((m,p)=>{d=Z(d,new V({minutes:m.breakMinutes}));const y=Z(d,new V({minutes:m.workMinutes}));o.splice(o.indexOf(d),2),o.splice(o.indexOf(y),2),d=y})}}return o}function Z5(n,e,t){const s=pn(new Date),r=t??e===Ze(new Date),i=n<hn(s);return r&&i}function eV(n,e){const t=pn(new Date),s=e===Ze(new Date),r=n<hn(t);return s&&r}function tV(n,e){const t=new Map;let s=e;return Mt.fromTreatmentsMap(n.treatments).times.forEach((i,o)=>{s=Z(s,new V({minutes:i.breakMinutes})),t.set(o,{start:s,duration:new V({minutes:i.workMinutes})}),s=Z(s,new V({minutes:i.workMinutes}))}),t}function nV(n,e){const t=new Map,s=Mt.fromTreatmentsMap(n.treatments);let r=Fn(e,new V({minutes:s.totalMinutes}));return s.times.forEach((i,o)=>{r=Z(r,new V({minutes:i.breakMinutes})),t.set(o,{start:r,duration:new V({minutes:i.workMinutes})}),r=Z(r,new V({minutes:i.workMinutes}))}),t}function KV(n,e,t,s,r){if(!s.workerPublicData.duringPaymentBookingsTime[t])return!1;const i=[];Object.entries(s.workerPublicData.duringPaymentBookingsTime[t]).forEach(([l,d])=>{try{const f=hn(l),m=Z(f,new V({minutes:d[1]}));i.push(f,m)}catch(f){he.error(`Error while creating the during payment list, illegal list -> ${d}
${f}`)}});const o=d8(i,e),a=Mt.fromTreatmentsMap(n.treatments),c=Array.from({length:a.times.keys.length},(l,d)=>0);return YD(c,r,o)!==0}function sV(n,e=!1){const t=n.getMinutes(),s=Math.floor(t/10),r=t%10,i=Math.ceil(r/5);return e?new Date(1970,0,1,n.getHours(),s*10+i*5):new Date(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),s*10+i*5)}function Va({worker:n,booking:e,isUpdate:t=!1,oldBooking:s,workerSheet:r=!1,reverse:i=!1,workerAction:o=!1,amoutLimit:a,recurrenceSkipDate:c}){const u=[];if(n===void 0||qD(n,e.bookingDate,o,r))return u;const l=Ze(e.bookingDate),d=f8(n.shiftsFor({day:e.bookingDate})),m=X5({worker:n,bookingDate:l,isUpdate:t,workerAction:o,oldBooking:s,recurrenceSkipDate:c});m.sort(),d.sort();const p=Mt.fromTreatmentsMap(e.treatments);if(console.log("work",d),console.log("forbbidenTimes",m),console.log("treatment",p),i)return rV({worker:n,work:d,forbbidenTimes:m,bookingDate:l,treatment:p,booking:Tt.fromBooking(e),workerSheet:r,amoutLimit:a});const y=Array.from({length:p.times.size},()=>0);console.log("forbiddenTimesPointers",y);let g=sV(new Date,!0);console.log("currentTime",g);let x=0;for(let _=0;_<d.length;_+=2){let v=d[_];const w=d[_+1];if(console.log("pointerWork",v),console.log("endWork",w),Z5(v,l)){switch(Ac(g,g,v,w)){case"BEFORE":he.debug("Alg duration status - BEFORE");continue;case"AFTER":he.debug("Alg duration status - AFTER");break;case"STRIKE":he.debug("Alg duration status - STRIKE");break}v=g}const I=tV(e,v),D=Array.from(I.values()),E=D[D.length-1],A=D[0];for(console.log("valuesArr",D),console.log("valuesArr",D),console.log("lastTimeSegment",E),console.log("firstTimeSegment",A);Z(E.start,E.duration)<=w;){if(x++,x>500){he.error("Infinity loop in times algorithm - stopping");break}const C=YD(y,I,m),T=K5(A.start,m,y,n),b=C===0;if(console.log("pointerWork",v),console.log("minutesToJump",C),console.log("jump",T),b){const k=A.start,P=new Date(e.bookingDate.getFullYear(),e.bookingDate.getMonth(),e.bookingDate.getDate(),k.getHours(),k.getMinutes());if(console.log("allowedTime",b),console.log("timeToAdd",k),console.log("timeToAdd",k),u.push(new bn({displayDate:P})),a!==void 0&&a>=u.length)return u;r?Xn(I,5):(console.log("BEFORE"),I.forEach((z,K)=>{console.log("Values for key",K),console.log(z.start),console.log(z.duration)}),Xn(I,T),console.log("AFTER"),I.forEach((z,K)=>{console.log("Values for key",K),console.log(z.start),console.log(z.duration)}))}else m.length-1<y[0]+1?r?Xn(I,5):Xn(I,T):Xn(I,C)}}return u}function rV({worker:n,work:e,forbbidenTimes:t,bookingDate:s,treatment:r,booking:i,workerSheet:o=!1,amoutLimit:a}){const c=[];if(qD(n,i.bookingDate,!1,o))return c;const u=Array.from({length:r.times.size},()=>t.length-1);let l=0;for(let d=e.length-1;d>=0;d-=2){const f=e[d],m=e[d-1],p=nV(i,f),g=Array.from(p.values())[0];for(;g.start>=m;){if(l++,l>500){he.error("Infinity loop in times algorithm - stopping");break}if(eV(g.start,s))break;const x=Q5(u,p,t),_=j5(g.start,t,u,n);if(x===0){const w=g.start,I=new Date(i.bookingDate.getFullYear(),i.bookingDate.getMonth(),i.bookingDate.getDate(),w.getHours(),w.getMinutes());if(c.push(new bn({displayDate:I})),a!==void 0&&a>=c.length)return c;o?Xn(p,-5):Xn(p,-_)}else u[0]<0?o?Xn(p,-5):Xn(p,-_):Xn(p,-x)}}return c}function iV({worker:n,dateForCheck:e,treatment:t}){const s=[];if(Ze(n.closeCalendarDate??new Date(0))===Ze(e)||!n.openCalendar)return s;const r=n.multiEventsTimes.times[Ze(e)]??{};return Object.entries(r).forEach(([i,o])=>{if(o.treatmentId===t.id&&o.index===0){const a=hn(i),c=new Date(e.getFullYear(),e.getMonth(),e.getDate(),a.getHours(),a.getMinutes());if(c<new Date)return;const u=o.maxParticipants??t.participants;s.push(new bn({isMulti:!0,showMultiWaitingList:o.showWaitingList,signedPaymentRequestId:o.paymentRequestId,displayDate:c,maxParticipants:u,isWaitingList:u<=o.currentParticipants,currentParticipants:o.currentParticipants,showParticipants:t.showParticipants}))}}),Object.entries(n.recurrence.recurrenceEvents).forEach(([i,o])=>{Object.entries(o).forEach(([a,c])=>{var d;if(!c.isMulti||c.recurrenceEvent===null||c.treatmentId!==t.id||!((d=c.recurrenceEvent)!=null&&d.isAccureInDate({date:e}))||c.eventIndex!==0)return;const u=hn(a),l=new Date(e.getFullYear(),e.getMonth(),e.getDate(),u.getHours(),u.getMinutes());s.push(new bn({displayDate:l,isMulti:!0,recurrenceTimeId:c.timeId??void 0,recurrenceFatherBookingId:c.recurrenceFatherBookingId,maxParticipants:t.participants,currentParticipants:c.currentParticipants,isWaitingList:t.participants<=c.currentParticipants,showParticipants:t.showParticipants,recurrenceMultiEvent:c.recurrenceEvent,fatherRecurrenceMultiEventDate:c.from}))})}),s.sort((i,o)=>i.displayDate.getTime()-o.displayDate.getTime()),s}function oV(n,e,t,s,r,i){const o=Tn(yt);if(Kt.visibleDates=n,console.log(o),e==null)return;Kt.timePickerObjects={},n.length>1&&(Kt.firstDateToShow=n[0]);const a=lV(e);if(a===void 0)return;const c={};let u=0;n.forEach((d,f)=>{if(d>=a||d<gg(new Date))return;let m=[];if(o.isMultiEvent===!0)Object.keys(o.services).length===1&&(m=iV({worker:e,dateForCheck:d,treatment:Object.values(o.services)[0]}));else{const p=Kt.bookingFromValues;switch(p.bookingDate=d,m=[],e.windowSpaces){case Wn.first:m=Va({worker:e,booking:Tt.fromBooking(p),isUpdate:s,oldBooking:r,recurrenceSkipDate:i,amoutLimit:1});break;case Wn.last:m=Va({worker:e,booking:Tt.fromBooking(p),isUpdate:s,oldBooking:r,recurrenceSkipDate:i,reverse:!0,amoutLimit:1});break;case Wn.edges:m=aV(e,p,r,s,i);break;default:m=Va({worker:e,booking:Tt.fromBooking(p),isUpdate:s,oldBooking:r,recurrenceSkipDate:i});break}}if(m.length<=0){c[Ze(d)]=[];return}c[Ze(d)]=m,u=Math.max(u,c[Ze(d)].length)}),u=Math.max(u+1,15),u+=e.showWaitingListWhenThereIsChoises?4:0,cV(u,t);const l=uV(t);console.log(u),Object.entries(c).forEach(([d,f])=>{const m=$s(d);if(e.recurrence.vacationInDate(m)!=null){if(e.showVacations){const g=new bn({displayDate:void 0,isVacation:!0});g.from=m,g.duration=new V({minutes:Math.floor(l*1.3)}),Kt.timePickerObjects[g.id]=g.toJson()}return}if(sD(e,m)&&e.closeScheduleOnHolidays){const g=new bn({displayDate:void 0,isHoliday:!0});g.from=m,g.duration=new V({minutes:Math.floor(l*1.3)}),Kt.timePickerObjects[g.id]=g.toJson();return}const p=Math.floor(HD/u);console.log(p);let y=0;if(f.forEach((g,x)=>{if(o.isMultiEvent!==!0||g.hasFreePlace){const _=g.showParticipants&&g.isMulti?Math.ceil(p*1.5):p;let v=Z(m,new V({minutes:y}));Q1.has(m)&&v>Z(m,new V({hours:1}))&&(v=Z(v,new V({hours:1})));const w=bn.fromTimePickerObj(g);w.from=v,w.duration=new V({minutes:_}),Kt.timePickerObjects[w.id]=w.toJson(),y+=_}else{if(o.isMultiEvent===!0&&!g.showMultiWaitingList)return;const _=new bn({...g,isWaitingList:!0});_.from=Z(m,new V({minutes:y})),_.duration=new V({minutes:Math.ceil(l*1.1)}),Kt.timePickerObjects[_.id]=_.toJson(),y+=Math.ceil(l*1.1)}}),(f.length===0||e.showWaitingListWhenThereIsChoises)&&o.isMultiEvent!=!0){const g=new bn({displayDate:void 0,isWaitingList:!0});g.from=Z(m,new V({minutes:y})),g.duration=new V({minutes:l}),Kt.timePickerObjects[g.id]=g.toJson();return}})}function aV(n,e,t,s,r){const i=Va({worker:n,booking:Tt.fromBooking(e),isUpdate:s,oldBooking:t,recurrenceSkipDate:r,amoutLimit:1}),o=Va({worker:n,booking:Tt.fromBooking(e),reverse:!0,isUpdate:s,oldBooking:t,recurrenceSkipDate:r,amoutLimit:1}),a=new Set;return i.length>0&&a.add(i[0]),o.length>0&&a.add(o[0]),Array.from(a)}function cV(n,e){if(n===0)return;const t=Math.floor(HD/n);e[0]=z5*($D/t)}function uV(n){const e=G5/n[0];return Math.ceil(e*$D)}function lV(n){if(n!==void 0)return Z(gg(new Date),new V({days:n.daysToAllowBookings}))}const yt=Po(),Ct=class Ct{static initializeBookingMaker({bookingForUpdate:e}){console.log("eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee");const t={workerId:e==null?void 0:e.workerId,showVerificationAlert:!1,services:{},date:e==null?void 0:e.bookingDate,isUpdate:e!=null,currentPaymentType:jn.payment,currentCurrencyCode:e==null?void 0:e.currency.code,pickMultipleServices:((e==null?void 0:e.treatmentLength)??0)>1,hasMultiTreatment:!1,isBookingWithPaymentUpdate:!1,currentStep:0,isMultiEvent:!1};e==null||e.treatments.forEach((s,r)=>{t.services[s.id]=s}),console.log(t),Ct.oldBooking=e,yt.set(t)}static get worker(){const e=Tn(yt);return je.GI().workers[e.workerId??""]}static setWorkerId(e){const t=Tn(yt);if(e===t.workerId){t.currentStep+=1,yt.set(t);return}je.GI().cancelAllWorkersRegularListenings();const s=je.GI().workers[e];s!=null&&je.GI().startWorkerListening(s);const r=je.GI().workers[e];r!=null&&(t.showVerificationAlert=pw(r)),t.workerId=e,t.currentStep+=1,yt.set(t)}static updateWorkerData(e){const t=Tn(yt);console.log("rrrrrrrrrrrrrrrr",t),he.debug("Getting new data for the worker");const s={...t.services};Object.keys(s).forEach(i=>{e.hasTreatemnt(i)||delete t.services[i]}),e.treatmentsSubjects.forEach((i,o)=>{i.treatments.forEach((a,c)=>{if(t.services.hasOwnProperty(a.id)){const u=t.services[a.id].count,l=Mt.fromTreatment(a);l.count=u,t.services[a.id]=l}})});const r=je.GI().workers[t.workerId];r!=null&&(t.showVerificationAlert=pw(r)),yt.set(t),t.workerId!=null&&Object.entries(t.services).length>0&&Ct.scheduleObj!=null&&(Ct.scheduleObj.deleteEvent(Object.values(Ct.timePickerObjects)),oV(Ct.scheduleObj.getCurrentViewDates(),Ct.worker,[30]),Ct.scheduleObj.addEvent(Object.values(Ct.timePickerObjects)))}static get bookingFromValues(){const e=Tn(yt),t=new Tt({workerId:e.workerId});t.bookingDate=e.date??new Date(0);const s=je.GI().workers[e.workerId??""];if(s==null)return t;const r=new Map;let i=0;return Object.entries(e.services).forEach(([o,a])=>{r.set(i.toString(),a),i+=1}),t.treatments=r,t}static onTapService(e){const t=Tn(yt);if(t.isBookingWithPaymentUpdate&&!t.services.hasOwnProperty(e.id)){Xs({text:J("cantEditTreatmentOnPaymentBooking"),status:"warning"});return}if(t.isUpdate&&e.amountInAdvance>0){Xs({text:J("cantChoosePaymentServiceOnBookingUpdate"),status:"warning"});return}t.services.hasOwnProperty(e.id)?t.pickMultipleServices?this.removeService(t,e):(t.currentStep+=1,yt.set(t)):e.isMulti?this.addMultiService(t,e):this.addService(t,e)}static addMultiService(e,t){if(e.pickMultipleServices&&Object.keys(e.services).length>0){Xs({text:J(e.hasMultiTreatment?"noMultiWithMulti":"noMultiWithRegular",void 0,!1),status:"warning"});return}e.services={[t.id]:t};const s=je.GI().workers[e.workerId??""];s!==void 0&&(je.GI().startTimesListening(s,t.isMulti),e.currentStep+=1,yt.set(e))}static removeService(e,t){Object.keys(e.services).length===1&&(e.currentCurrencyCode=void 0,e.currentPaymentType=void 0),e.services[t.id].count=1,delete e.services[t.id],yt.set(e)}static addService(e,t){console.log("addService");let s=0;Object.values(e.services).forEach(i=>{s+=i.count});const r=je.GI().workers[e.workerId??""];if(r!==void 0){if(e.pickMultipleServices&&e.hasMultiTreatment){Xs({text:J("noMultiWithRegular"),status:"warning"});return}if(s>=r.maxTreatments){Xs({text:J("userMaxTreatments").replace("AMOUNT",r.maxTreatments.toString()),status:"warning"});return}if(e.pickMultipleServices&&t.amountInAdvance>0&&t.paymentType!=null&&t.paymentType!=e.currentPaymentType&&e.currentPaymentType!=null){Xs({text:J("cantPickDiffrentPaymentType"),status:"warning"});return}if(e.pickMultipleServices&&t.price.currency.code!=e.currentCurrencyCode&&e.currentCurrencyCode!=null){Xs({text:J("cantPickDiffrentCurrencies"),status:"warning"});return}je.GI().startTimesListening(r,t.isMulti),e.currentCurrencyCode=t.price.currency.code,t.amountInAdvance>0&&(e.currentPaymentType=t.paymentType),e.pickMultipleServices||(e.services={},e.currentStep+=1),e.services[t.id]=t,yt.set(e)}}static onRemoveTreatmentCount(e){var s;const t=Tn(yt);t.services[e.id]!==void 0&&(((s=t.services[e.id])==null?void 0:s.count)===1?this.removeService(t,e):(t.services[e.id].count=-1,yt.set(t)))}static onAddTreatmentCount(e){const t=Tn(yt);if(t.services[e.id]==null)return;let s=0;if(Object.entries(t.services).forEach(([r,i])=>{if(t.services.hasOwnProperty(r)){const o=t.services[r];s+=o.count}}),s>=Ct.worker.maxTreatments){Xs({text:J("userMaxTreatments").replaceAll("AMOUNT",Ct.worker.maxTreatments.toString()),status:"warning"});return}yt.set(t)}};h(Ct,"timePickerObjects",{}),h(Ct,"oldBooking"),h(Ct,"visibleDates",[]),h(Ct,"scheduleObj"),h(Ct,"firstDateToShow");let Kt=Ct;function pw(n){const e=new Tt({});return e.userFcms=Ps.GI().user.fcmsTokens,e.isVerifiedPhone=!0,(K1({booking:e,worker:n})==X.message||n.mustVerifyPhone)&&!Ps.GI().user.isVerifiedPhone}const Wa=class Wa{constructor(){h(this,"defaultTheme","darkIos");h(this,"currentKeyTheme",null);h(this,"themeCauseMainBuilt",!1);h(this,"currentThemes",{...bI});h(this,"currentBusinessTheme",null)}static GI(){return Wa._singleton}async changeTheme(e,{needOverlayHandling:t=!0,ovveride:s=!1,needWaitOverlay:r=!1}={}){var o;const i=this.currentThemes[e];if(i==null||this.currentBusinessTheme==null||!i.isEqual(this.currentBusinessTheme)||s){switch((o=this.currentThemes[e])==null?void 0:o.brightness){case x0.light:je.GI().businessIcon="darkShopIcon";break;case x0.dark:je.GI().businessIcon="lightShopIcon";break;default:je.GI().businessIcon="lightShopIcon";break}return this.themeCauseMainBuilt=!0,this.currentKeyTheme=e,this.currentThemes.hasOwnProperty(e)&&(this.currentBusinessTheme=this.currentThemes[e]),!0}return!1}};h(Wa,"_singleton",new Wa);let Y0=Wa,hV=Po(),dV=Po();function fV(n,e){const t=e.split("--")[0];return xt.developers.hasOwnProperty(t)&&(n=xt.developers[t].businessProductId),n.includes("basic")?Br.basic:n.includes("landing")?Br.landingPage:n.includes("advanced")?Br.advanced:n.includes("golden")?Br.golden:Br.trial}const _s=class _s{constructor(){h(this,"generalRepo",new rD);h(this,"business",new hi({businessId:"",design:new As}));h(this,"workers",{});h(this,"businessIcon","");h(this,"businessSubtype",Br.trial)}static GI(){return _s.instance||(_s.instance=new _s),_s.instance}async initSettings(e,{fromLoading:t=!1}={}){try{this.workers={},xt.currentBusinesssId=e;const s=await Promise.all([this._loadSettingsDoc(e),this._loadBusinessWorkers(e)]);return this.businessSubtype=fV(this.business.productId,e),s.length>0&&s[0]===!1?!1:(this.makeBusinessDataListener(),!0)}catch(s){return he.error(`Error while initializing settings --> ${s}`),!1}}async loadBusiness(e,t,{fromLoading:s=!1,fromSearch:r=!1}={}){try{const i=await this.initSettings(e,{fromLoading:s});return Y0.GI().themeCauseMainBuilt,dV.set(_s.GI().workers),hV.set(_s.GI().business),!0}catch{return!1}}async _loadSettingsDoc(e){try{const t=await this.generalRepo.getDocRepo({path:kt,docId:e});return t===void 0||!t.exists||t.data()===null?(_e.GI().error=se.notFoundBusiness,!1):(this.business=hi.fromJson(t.data(),e),!0)}catch{return!1}}async _loadBusinessWorkers(e){try{const t=`${kt}/${e}/${un}`,s=await this.generalRepo.getAllDocsInsideCollection(t);return s!==null&&s.forEach(r=>{const i=_c.fromWorkerDocJson(r);Ps.GI().getPermission>1||(i.id,Ps.GI().user.id),this.workers[i.id]=i}),!0}catch(t){return t instanceof Error&&(he.error(`Error while loading the business workers docs --> ${t}`),he.error(t.stack)),!0}}async makeBusinessDataListener(){const e=Ya.GI().getBusinessDataPath(xt.currentBusinesssId);this.business.businessData.listener=this.generalRepo.listenToChild({childPath:e,callback:t=>{t.exists()&&this.business.businessData.setBusinessData(t)}})}startWorkerListening(e){try{console.log("cjdoscijdsoicdos"),e.workerDocListner||(console.log("cjdoscijdsoge2542353454"),e.workerDocListner=this.generalRepo.docListenerRepo({path:`${kt}/${this.business.businessId}/${un}`,docId:e.id,onChanged:t=>{this.updateWorkerObj(t,e.id)}})),e.publicCustomers.publicCustomersData===null&&this.generalRepo.getDocRepo({path:`${kt}/${xt.currentBusinesssId}/${un}/${e.id}/${dt}`,docId:oC}).then(t=>{t.exists()&&t.data()!==null&&e.publicCustomers.setPublicCustomersDataJson(t.data())})}catch(t){console.error(`Error while resuming the Worker listener --> ${t}`)}}updateWorkerObj(e,t){if(e.exists()){if(!Object.keys(this.workers).includes(t))return;this.workers[t].setFromWorkerDoc(e.data()),Kt.updateWorkerData(this.workers[t])}else{delete this.workers[t];return}he.info(`Get new worker for the current worker updateWorkerObj--> ${t}`)}cancelAllWorkersRegularListenings(e=!1){Object.values(this.workers).map(async t=>{try{(e||t.id!==Ps.GI().user.id&&Ps.GI().getPermission<2)&&(t.workerDocListner!=null&&(t.workerDocListner(),t.workerDocListner=void 0),t.recurrence.listener!=null&&(t.recurrence.listener(),t.recurrence.listener=void 0)),t.workerPublicData.listener!=null&&(t.workerPublicData.listener(),t.workerPublicData.listener=void 0),t.multiEventsTimes.listener!=null&&(t.multiEventsTimes.listener(),t.multiEventsTimes.listener=void 0),he.info("Workers Listenings have canceled")}catch{console.error("Error while canceling the Workers listeners")}})}startTimesListening(e,t){e.workerPublicData.listener==null&&(e.workerPublicData.listener=this.generalRepo.docListenerRepo({path:`${kt}/${this.business.businessId}/${un}/${e.id}/${dt}`,docId:cn,onChanged:s=>{this.updateWorkerPublicData(s,e.id)}})),e.recurrence.listener===void 0&&e.hasRecurrenceEvents&&e.isCustomersNeedRecurrence&&(e.recurrence.listener=this.generalRepo.docListenerRepo({path:`${kt}/${this.business.businessId}/${un}/${e.id}/${dt}`,docId:Gw,onChanged:s=>{this.updateReccurenceEvents(s,e.id)}})),e.multiEventsTimes.listener===void 0&&t&&(e.multiEventsTimes.listener=this.generalRepo.docListenerRepo({path:`${kt}/${this.business.businessId}/${un}/${e.id}/${dt}`,docId:Qw,onChanged:s=>{this.updateMultiEventsTimes(s,e.id)}}))}updateWorkerPublicData(e,t){this.workers[t]!==void 0&&(!e.exists()||e.data()===void 0||(this.workers[t].workerPublicData.setWorkerPublicData(e.data()),Kt.updateWorkerData(this.workers[t]),he.debug(`Get new workerData for the current worker updateWorkerPublicData--> ${t}`)))}updateReccurenceEvents(e,t){this.workers[t]!==void 0&&(!e.exists()||e.data()===void 0||(this.workers[t].recurrence.setRecurrenceEvents(e.data()??{},t,this.business),Kt.updateWorkerData(this.workers[t]),he.debug(`Get new workerData for the current worker updateReccurenceEvents --> ${t}`)))}updateMultiEventsTimes(e,t){this.workers[t]!==void 0&&(!e.exists()||e.data()===void 0||(this.workers[t].multiEventsTimes.setData(e.data()),Kt.updateWorkerData(this.workers[t]),he.debug(`Get new workerData for the current worker updateReccurenceEvents --> ${t}`)))}};h(_s,"instance");let je=_s;export{Ht as $,rE as A,je as B,f8 as C,X5 as D,d8 as E,Mt as F,rD as G,Z as H,V as I,YV as J,_e as K,se as L,tV as M,YD as N,KV as O,xa as P,Jw as Q,Tt as R,an as S,Be as T,Fa as U,q5 as V,W0 as W,AV as X,vu as Y,Ea as Z,zr as _,dt as a,un as a0,IV as a1,oe as a2,Gw as a3,DV as a4,zw as a5,Ya as a6,K1 as a7,QV as a8,ao as a9,wM as aA,gg as aB,zV as aC,pn as aD,GV as aE,$V as aF,dV as aG,_a as aH,qt as aI,Kt as aJ,Vn as aK,J1 as aL,bI as aM,vg as aN,JV as aO,VV as aP,yt as aQ,bn as aR,oV as aS,LV as aT,Q3 as aU,bV as aa,CV as ab,WV as ac,_8 as ad,zn as ae,di as af,so as ag,p8 as ah,HV as ai,Hf as aj,Xs as ak,nC as al,kV as am,PV as an,SV as ao,Df as ap,H5 as aq,zg as ar,Y0 as as,UV as at,X0 as au,Hl as av,G0 as aw,No as ax,fC as ay,hy as az,hV as b,cn as c,wV as d,kt as e,xt as f,xV as g,EV as h,vV as i,Dr as j,RV as k,U0 as l,Ps as m,Ee as n,qV as o,dg as p,Nt as q,TV as r,sD as s,J as t,on as u,he as v,_C as w,va as x,hn as y,Ze as z};
